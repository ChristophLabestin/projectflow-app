import{r as w,u as dn,R as nr,L as nt,a as ai,b as Yn,O as Gw,c as sr,d as xl,e as w0,B as Hw,f as Ow,g as Dt,N as Pf}from"./router-BC9BnqRm.js";import{r as qw,a as Fw,g as Vw}from"./vendor-B--z-fyW.js";import{i as Bw,g as $w,a as Yw,b as Jw,q as ds,o as lm,w as us,c as Un,d as Is,e as Pn,s as Ut,f as Lt,h as Xw,j as ot,u as mt,k as cn,l as Fs,m as to,n as ei,p as cm,r as S0,t as fl,v as ml,x as pl,y as va,z as Lf,A as j0,G as zf,B as Kw,C as dm,T as T0,D as Ww,E as C0,F as Qw,H as Zw,I as eS,J as tS,K as nS,L as fg}from"./firebase-CIy0KaHQ.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function s(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerPolicy&&(c.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?c.credentials="include":i.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(i){if(i.ep)return;i.ep=!0;const c=s(i);fetch(i.href,c)}})();var Nf={exports:{}},Zi={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mg;function sS(){if(mg)return Zi;mg=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function s(o,i,c){var u=null;if(c!==void 0&&(u=""+c),i.key!==void 0&&(u=""+i.key),"key"in i){c={};for(var m in i)m!=="key"&&(c[m]=i[m])}else c=i;return i=c.ref,{$$typeof:t,type:o,key:u,ref:i!==void 0?i:null,props:c}}return Zi.Fragment=e,Zi.jsx=s,Zi.jsxs=s,Zi}var pg;function rS(){return pg||(pg=1,Nf.exports=sS()),Nf.exports}var r=rS(),wf={exports:{}},el={},Sf={exports:{}},jf={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hg;function aS(){return hg||(hg=1,(function(t){function e(q,H){var R=q.length;q.push(H);e:for(;0<R;){var ue=R-1>>>1,Y=q[ue];if(0<i(Y,H))q[ue]=H,q[R]=Y,R=ue;else break e}}function s(q){return q.length===0?null:q[0]}function o(q){if(q.length===0)return null;var H=q[0],R=q.pop();if(R!==H){q[0]=R;e:for(var ue=0,Y=q.length,ye=Y>>>1;ue<ye;){var je=2*(ue+1)-1,J=q[je],we=je+1,be=q[we];if(0>i(J,R))we<Y&&0>i(be,J)?(q[ue]=be,q[we]=R,ue=we):(q[ue]=J,q[je]=R,ue=je);else if(we<Y&&0>i(be,R))q[ue]=be,q[we]=R,ue=we;else break e}}return H}function i(q,H){var R=q.sortIndex-H.sortIndex;return R!==0?R:q.id-H.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;t.unstable_now=function(){return c.now()}}else{var u=Date,m=u.now();t.unstable_now=function(){return u.now()-m}}var h=[],x=[],v=1,b=null,N=3,T=!1,_=!1,I=!1,E=!1,D=typeof setTimeout=="function"?setTimeout:null,z=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;function M(q){for(var H=s(x);H!==null;){if(H.callback===null)o(x);else if(H.startTime<=q)o(x),H.sortIndex=H.expirationTime,e(h,H);else break;H=s(x)}}function B(q){if(I=!1,M(q),!_)if(s(h)!==null)_=!0,L||(L=!0,F());else{var H=s(x);H!==null&&re(B,H.startTime-q)}}var L=!1,X=-1,de=5,V=-1;function Z(){return E?!0:!(t.unstable_now()-V<de)}function K(){if(E=!1,L){var q=t.unstable_now();V=q;var H=!0;try{e:{_=!1,I&&(I=!1,z(X),X=-1),T=!0;var R=N;try{t:{for(M(q),b=s(h);b!==null&&!(b.expirationTime>q&&Z());){var ue=b.callback;if(typeof ue=="function"){b.callback=null,N=b.priorityLevel;var Y=ue(b.expirationTime<=q);if(q=t.unstable_now(),typeof Y=="function"){b.callback=Y,M(q),H=!0;break t}b===s(h)&&o(h),M(q)}else o(h);b=s(h)}if(b!==null)H=!0;else{var ye=s(x);ye!==null&&re(B,ye.startTime-q),H=!1}}break e}finally{b=null,N=R,T=!1}H=void 0}}finally{H?F():L=!1}}}var F;if(typeof A=="function")F=function(){A(K)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,he=le.port2;le.port1.onmessage=K,F=function(){he.postMessage(null)}}else F=function(){D(K,0)};function re(q,H){X=D(function(){q(t.unstable_now())},H)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(q){q.callback=null},t.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):de=0<q?Math.floor(1e3/q):5},t.unstable_getCurrentPriorityLevel=function(){return N},t.unstable_next=function(q){switch(N){case 1:case 2:case 3:var H=3;break;default:H=N}var R=N;N=H;try{return q()}finally{N=R}},t.unstable_requestPaint=function(){E=!0},t.unstable_runWithPriority=function(q,H){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var R=N;N=q;try{return H()}finally{N=R}},t.unstable_scheduleCallback=function(q,H,R){var ue=t.unstable_now();switch(typeof R=="object"&&R!==null?(R=R.delay,R=typeof R=="number"&&0<R?ue+R:ue):R=ue,q){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=R+Y,q={id:v++,callback:H,priorityLevel:q,startTime:R,expirationTime:Y,sortIndex:-1},R>ue?(q.sortIndex=R,e(x,q),s(h)===null&&q===s(x)&&(I?(z(X),X=-1):I=!0,re(B,R-ue))):(q.sortIndex=Y,e(h,q),_||T||(_=!0,L||(L=!0,F()))),q},t.unstable_shouldYield=Z,t.unstable_wrapCallback=function(q){var H=N;return function(){var R=N;N=H;try{return q.apply(this,arguments)}finally{N=R}}}})(jf)),jf}var xg;function oS(){return xg||(xg=1,Sf.exports=aS()),Sf.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gg;function iS(){if(gg)return el;gg=1;var t=oS(),e=qw(),s=Fw();function o(n){var a="https://react.dev/errors/"+n;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)a+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+n+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function c(n){var a=n,l=n;if(n.alternate)for(;a.return;)a=a.return;else{n=a;do a=n,(a.flags&4098)!==0&&(l=a.return),n=a.return;while(n)}return a.tag===3?l:null}function u(n){if(n.tag===13){var a=n.memoizedState;if(a===null&&(n=n.alternate,n!==null&&(a=n.memoizedState)),a!==null)return a.dehydrated}return null}function m(n){if(n.tag===31){var a=n.memoizedState;if(a===null&&(n=n.alternate,n!==null&&(a=n.memoizedState)),a!==null)return a.dehydrated}return null}function h(n){if(c(n)!==n)throw Error(o(188))}function x(n){var a=n.alternate;if(!a){if(a=c(n),a===null)throw Error(o(188));return a!==n?null:n}for(var l=n,d=a;;){var g=l.return;if(g===null)break;var y=g.alternate;if(y===null){if(d=g.return,d!==null){l=d;continue}break}if(g.child===y.child){for(y=g.child;y;){if(y===l)return h(g),n;if(y===d)return h(g),a;y=y.sibling}throw Error(o(188))}if(l.return!==d.return)l=g,d=y;else{for(var S=!1,C=g.child;C;){if(C===l){S=!0,l=g,d=y;break}if(C===d){S=!0,d=g,l=y;break}C=C.sibling}if(!S){for(C=y.child;C;){if(C===l){S=!0,l=y,d=g;break}if(C===d){S=!0,d=y,l=g;break}C=C.sibling}if(!S)throw Error(o(189))}}if(l.alternate!==d)throw Error(o(190))}if(l.tag!==3)throw Error(o(188));return l.stateNode.current===l?n:a}function v(n){var a=n.tag;if(a===5||a===26||a===27||a===6)return n;for(n=n.child;n!==null;){if(a=v(n),a!==null)return a;n=n.sibling}return null}var b=Object.assign,N=Symbol.for("react.element"),T=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),z=Symbol.for("react.consumer"),A=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),X=Symbol.for("react.memo"),de=Symbol.for("react.lazy"),V=Symbol.for("react.activity"),Z=Symbol.for("react.memo_cache_sentinel"),K=Symbol.iterator;function F(n){return n===null||typeof n!="object"?null:(n=K&&n[K]||n["@@iterator"],typeof n=="function"?n:null)}var le=Symbol.for("react.client.reference");function he(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===le?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case I:return"Fragment";case D:return"Profiler";case E:return"StrictMode";case B:return"Suspense";case L:return"SuspenseList";case V:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case _:return"Portal";case A:return n.displayName||"Context";case z:return(n._context.displayName||"Context")+".Consumer";case M:var a=n.render;return n=n.displayName,n||(n=a.displayName||a.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case X:return a=n.displayName||null,a!==null?a:he(n.type)||"Memo";case de:a=n._payload,n=n._init;try{return he(n(a))}catch{}}return null}var re=Array.isArray,q=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,H=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,R={pending:!1,data:null,method:null,action:null},ue=[],Y=-1;function ye(n){return{current:n}}function je(n){0>Y||(n.current=ue[Y],ue[Y]=null,Y--)}function J(n,a){Y++,ue[Y]=n.current,n.current=a}var we=ye(null),be=ye(null),me=ye(null),Ae=ye(null);function De(n,a){switch(J(me,a),J(be,n),J(we,null),a.nodeType){case 9:case 11:n=(n=a.documentElement)&&(n=n.namespaceURI)?Ux(n):0;break;default:if(n=a.tagName,a=a.namespaceURI)a=Ux(a),n=Px(a,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}je(we),J(we,n)}function Ee(){je(we),je(be),je(me)}function ut(n){n.memoizedState!==null&&J(Ae,n);var a=we.current,l=Px(a,n.type);a!==l&&(J(be,n),J(we,l))}function He(n){be.current===n&&(je(we),je(be)),Ae.current===n&&(je(Ae),Xi._currentValue=R)}var Vt,Et;function Xe(n){if(Vt===void 0)try{throw Error()}catch(l){var a=l.stack.trim().match(/\n( *(at )?)/);Vt=a&&a[1]||"",Et=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Vt+n+Et}var Jt=!1;function ft(n,a){if(!n||Jt)return"";Jt=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(a){var ve=function(){throw Error()};if(Object.defineProperty(ve.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ve,[])}catch(ce){var ie=ce}Reflect.construct(n,[],ve)}else{try{ve.call()}catch(ce){ie=ce}n.call(ve.prototype)}}else{try{throw Error()}catch(ce){ie=ce}(ve=n())&&typeof ve.catch=="function"&&ve.catch(function(){})}}catch(ce){if(ce&&ie&&typeof ce.stack=="string")return[ce.stack,ie.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=d.DetermineComponentFrameRoot(),S=y[0],C=y[1];if(S&&C){var U=S.split(`
`),te=C.split(`
`);for(g=d=0;d<U.length&&!U[d].includes("DetermineComponentFrameRoot");)d++;for(;g<te.length&&!te[g].includes("DetermineComponentFrameRoot");)g++;if(d===U.length||g===te.length)for(d=U.length-1,g=te.length-1;1<=d&&0<=g&&U[d]!==te[g];)g--;for(;1<=d&&0<=g;d--,g--)if(U[d]!==te[g]){if(d!==1||g!==1)do if(d--,g--,0>g||U[d]!==te[g]){var fe=`
`+U[d].replace(" at new "," at ");return n.displayName&&fe.includes("<anonymous>")&&(fe=fe.replace("<anonymous>",n.displayName)),fe}while(1<=d&&0<=g);break}}}finally{Jt=!1,Error.prepareStackTrace=l}return(l=n?n.displayName||n.name:"")?Xe(l):""}function Pt(n,a){switch(n.tag){case 26:case 27:case 5:return Xe(n.type);case 16:return Xe("Lazy");case 13:return n.child!==a&&a!==null?Xe("Suspense Fallback"):Xe("Suspense");case 19:return Xe("SuspenseList");case 0:case 15:return ft(n.type,!1);case 11:return ft(n.type.render,!1);case 1:return ft(n.type,!0);case 31:return Xe("Activity");default:return""}}function Nt(n){try{var a="",l=null;do a+=Pt(n,l),l=n,n=n.return;while(n);return a}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}var zt=Object.prototype.hasOwnProperty,_t=t.unstable_scheduleCallback,un=t.unstable_cancelCallback,P=t.unstable_shouldYield,k=t.unstable_requestPaint,Q=t.unstable_now,ne=t.unstable_getCurrentPriorityLevel,se=t.unstable_ImmediatePriority,Se=t.unstable_UserBlockingPriority,Ce=t.unstable_NormalPriority,Te=t.unstable_LowPriority,Ge=t.unstable_IdlePriority,et=t.log,tt=t.unstable_setDisableYieldValue,gt=null,bt=null;function gn(n){if(typeof et=="function"&&tt(n),bt&&typeof bt.setStrictMode=="function")try{bt.setStrictMode(gt,n)}catch{}}var sn=Math.clz32?Math.clz32:Ln,fn=Math.log,Mt=Math.LN2;function Ln(n){return n>>>=0,n===0?32:31-(fn(n)/Mt|0)|0}var rr=256,$s=262144,ar=4194304;function fs(n){var a=n&42;if(a!==0)return a;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Ur(n,a,l){var d=n.pendingLanes;if(d===0)return 0;var g=0,y=n.suspendedLanes,S=n.pingedLanes;n=n.warmLanes;var C=d&134217727;return C!==0?(d=C&~y,d!==0?g=fs(d):(S&=C,S!==0?g=fs(S):l||(l=C&~n,l!==0&&(g=fs(l))))):(C=d&~y,C!==0?g=fs(C):S!==0?g=fs(S):l||(l=d&~n,l!==0&&(g=fs(l)))),g===0?0:a!==0&&a!==g&&(a&y)===0&&(y=g&-g,l=a&-a,y>=l||y===32&&(l&4194048)!==0)?a:g}function Ys(n,a){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&a)===0}function lo(n,a){switch(n){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Jn(){var n=ar;return ar<<=1,(ar&62914560)===0&&(ar=4194304),n}function En(n){for(var a=[],l=0;31>l;l++)a.push(n);return a}function Js(n,a){n.pendingLanes|=a,a!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function Pr(n,a,l,d,g,y){var S=n.pendingLanes;n.pendingLanes=l,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=l,n.entangledLanes&=l,n.errorRecoveryDisabledLanes&=l,n.shellSuspendCounter=0;var C=n.entanglements,U=n.expirationTimes,te=n.hiddenUpdates;for(l=S&~l;0<l;){var fe=31-sn(l),ve=1<<fe;C[fe]=0,U[fe]=-1;var ie=te[fe];if(ie!==null)for(te[fe]=null,fe=0;fe<ie.length;fe++){var ce=ie[fe];ce!==null&&(ce.lane&=-536870913)}l&=~ve}d!==0&&or(n,d,0),y!==0&&g===0&&n.tag!==0&&(n.suspendedLanes|=y&~(S&~a))}function or(n,a,l){n.pendingLanes|=a,n.suspendedLanes&=~a;var d=31-sn(a);n.entangledLanes|=a,n.entanglements[d]=n.entanglements[d]|1073741824|l&261930}function Ds(n,a){var l=n.entangledLanes|=a;for(n=n.entanglements;l;){var d=31-sn(l),g=1<<d;g&a|n[d]&a&&(n[d]|=a),l&=~g}}function wa(n,a){var l=a&-a;return l=(l&42)!==0?1:Sa(l),(l&(n.suspendedLanes|a))!==0?0:l}function Sa(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function Xn(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function Xs(){var n=H.p;return n!==0?n:(n=window.event,n===void 0?32:ag(n.type))}function ms(n,a){var l=H.p;try{return H.p=n,a()}finally{H.p=l}}var mn=Math.random().toString(36).slice(2),Bt="__reactFiber$"+mn,wt="__reactProps$"+mn,Kn="__reactContainer$"+mn,ir="__reactEvents$"+mn,ja="__reactListeners$"+mn,co="__reactHandles$"+mn,Ta="__reactResources$"+mn,ps="__reactMarker$"+mn;function Lr(n){delete n[Bt],delete n[wt],delete n[ir],delete n[ja],delete n[co]}function it(n){var a=n[Bt];if(a)return a;for(var l=n.parentNode;l;){if(a=l[Kn]||l[Bt]){if(l=a.alternate,a.child!==null||l!==null&&l.child!==null)for(n=Fx(n);n!==null;){if(l=n[Bt])return l;n=Fx(n)}return a}n=l,l=n.parentNode}return null}function hs(n){if(n=n[Bt]||n[Kn]){var a=n.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return n}return null}function lr(n){var a=n.tag;if(a===5||a===26||a===27||a===6)return n.stateNode;throw Error(o(33))}function Xt(n){var a=n[Ta];return a||(a=n[Ta]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function Gt(n){n[ps]=!0}var Ca=new Set,qt={};function xs(n,a){Wn(n,a),Wn(n+"Capture",a)}function Wn(n,a){for(qt[n]=a,n=0;n<a.length;n++)Ca.add(a[n])}var uo=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),fo={},zn={};function Ea(n){return zt.call(zn,n)?!0:zt.call(fo,n)?!1:uo.test(n)?zn[n]=!0:(fo[n]=!0,!1)}function cr(n,a,l){if(Ea(a))if(l===null)n.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":n.removeAttribute(a);return;case"boolean":var d=a.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){n.removeAttribute(a);return}}n.setAttribute(a,""+l)}}function ae(n,a,l){if(l===null)n.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(a);return}n.setAttribute(a,""+l)}}function Ie(n,a,l,d){if(d===null)n.removeAttribute(l);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(l);return}n.setAttributeNS(a,l,""+d)}}function Me(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function We(n){var a=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Gn(n,a,l){var d=Object.getOwnPropertyDescriptor(n.constructor.prototype,a);if(!n.hasOwnProperty(a)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var g=d.get,y=d.set;return Object.defineProperty(n,a,{configurable:!0,get:function(){return g.call(this)},set:function(S){l=""+S,y.call(this,S)}}),Object.defineProperty(n,a,{enumerable:d.enumerable}),{getValue:function(){return l},setValue:function(S){l=""+S},stopTracking:function(){n._valueTracker=null,delete n[a]}}}}function Ks(n){if(!n._valueTracker){var a=We(n)?"checked":"value";n._valueTracker=Gn(n,a,""+n[a])}}function dr(n){if(!n)return!1;var a=n._valueTracker;if(!a)return!0;var l=a.getValue(),d="";return n&&(d=We(n)?n.checked?"true":"false":n.value),n=d,n!==l?(a.setValue(n),!0):!1}function zr(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var ur=/[\n"\\]/g;function pn(n){return n.replace(ur,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function _a(n,a,l,d,g,y,S,C){n.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?n.type=S:n.removeAttribute("type"),a!=null?S==="number"?(a===0&&n.value===""||n.value!=a)&&(n.value=""+Me(a)):n.value!==""+Me(a)&&(n.value=""+Me(a)):S!=="submit"&&S!=="reset"||n.removeAttribute("value"),a!=null?vs(n,S,Me(a)):l!=null?vs(n,S,Me(l)):d!=null&&n.removeAttribute("value"),g==null&&y!=null&&(n.defaultChecked=!!y),g!=null&&(n.checked=g&&typeof g!="function"&&typeof g!="symbol"),C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"?n.name=""+Me(C):n.removeAttribute("name")}function gs(n,a,l,d,g,y,S,C){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(n.type=y),a!=null||l!=null){if(!(y!=="submit"&&y!=="reset"||a!=null)){Ks(n);return}l=l!=null?""+Me(l):"",a=a!=null?""+Me(a):l,C||a===n.value||(n.value=a),n.defaultValue=a}d=d??g,d=typeof d!="function"&&typeof d!="symbol"&&!!d,n.checked=C?n.checked:!!d,n.defaultChecked=!!d,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(n.name=S),Ks(n)}function vs(n,a,l){a==="number"&&zr(n.ownerDocument)===n||n.defaultValue===""+l||(n.defaultValue=""+l)}function Qn(n,a,l,d){if(n=n.options,a){a={};for(var g=0;g<l.length;g++)a["$"+l[g]]=!0;for(l=0;l<n.length;l++)g=a.hasOwnProperty("$"+n[l].value),n[l].selected!==g&&(n[l].selected=g),g&&d&&(n[l].defaultSelected=!0)}else{for(l=""+Me(l),a=null,g=0;g<n.length;g++){if(n[g].value===l){n[g].selected=!0,d&&(n[g].defaultSelected=!0);return}a!==null||n[g].disabled||(a=n[g])}a!==null&&(a.selected=!0)}}function jl(n,a,l){if(a!=null&&(a=""+Me(a),a!==n.value&&(n.value=a),l==null)){n.defaultValue!==a&&(n.defaultValue=a);return}n.defaultValue=l!=null?""+Me(l):""}function ui(n,a,l,d){if(a==null){if(d!=null){if(l!=null)throw Error(o(92));if(re(d)){if(1<d.length)throw Error(o(93));d=d[0]}l=d}l==null&&(l=""),a=l}l=Me(a),n.defaultValue=l,d=n.textContent,d===l&&d!==""&&d!==null&&(n.value=d),Ks(n)}function Gr(n,a){if(a){var l=n.firstChild;if(l&&l===n.lastChild&&l.nodeType===3){l.nodeValue=a;return}}n.textContent=a}var fi=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Tl(n,a,l){var d=a.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?d?n.setProperty(a,""):a==="float"?n.cssFloat="":n[a]="":d?n.setProperty(a,l):typeof l!="number"||l===0||fi.has(a)?a==="float"?n.cssFloat=l:n[a]=(""+l).trim():n[a]=l+"px"}function mo(n,a,l){if(a!=null&&typeof a!="object")throw Error(o(62));if(n=n.style,l!=null){for(var d in l)!l.hasOwnProperty(d)||a!=null&&a.hasOwnProperty(d)||(d.indexOf("--")===0?n.setProperty(d,""):d==="float"?n.cssFloat="":n[d]="");for(var g in a)d=a[g],a.hasOwnProperty(g)&&l[g]!==d&&Tl(n,g,d)}else for(var y in a)a.hasOwnProperty(y)&&Tl(n,y,a[y])}function mi(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wd=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Sd=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function po(n){return Sd.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function Us(){}var pi=null;function ho(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Hr=null,Or=null;function Cl(n){var a=hs(n);if(a&&(n=a.stateNode)){var l=n[wt]||null;e:switch(n=a.stateNode,a.type){case"input":if(_a(n,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),a=l.name,l.type==="radio"&&a!=null){for(l=n;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+pn(""+a)+'"][type="radio"]'),a=0;a<l.length;a++){var d=l[a];if(d!==n&&d.form===n.form){var g=d[wt]||null;if(!g)throw Error(o(90));_a(d,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(a=0;a<l.length;a++)d=l[a],d.form===n.form&&dr(d)}break e;case"textarea":jl(n,l.value,l.defaultValue);break e;case"select":a=l.value,a!=null&&Qn(n,!!l.multiple,a,!1)}}}var hi=!1;function El(n,a,l){if(hi)return n(a,l);hi=!0;try{var d=n(a);return d}finally{if(hi=!1,(Hr!==null||Or!==null)&&(cc(),Hr&&(a=Hr,n=Or,Or=Hr=null,Cl(a),n)))for(a=0;a<n.length;a++)Cl(n[a])}}function j(n,a){var l=n.stateNode;if(l===null)return null;var d=l[wt]||null;if(d===null)return null;l=d[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(n=n.type,d=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!d;break e;default:n=!1}if(n)return null;if(l&&typeof l!="function")throw Error(o(231,a,typeof l));return l}var G=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),W=!1;if(G)try{var oe={};Object.defineProperty(oe,"passive",{get:function(){W=!0}}),window.addEventListener("test",oe,oe),window.removeEventListener("test",oe,oe)}catch{W=!1}var pe=null,_e=null,qe=null;function Pe(){if(qe)return qe;var n,a=_e,l=a.length,d,g="value"in pe?pe.value:pe.textContent,y=g.length;for(n=0;n<l&&a[n]===g[n];n++);var S=l-n;for(d=1;d<=S&&a[l-d]===g[y-d];d++);return qe=g.slice(n,1<d?1-d:void 0)}function Je(n){var a=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&a===13&&(n=13)):n=a,n===10&&(n=13),32<=n||n===13?n:0}function St(){return!0}function en(){return!1}function $e(n){function a(l,d,g,y,S){this._reactName=l,this._targetInst=g,this.type=d,this.nativeEvent=y,this.target=S,this.currentTarget=null;for(var C in n)n.hasOwnProperty(C)&&(l=n[C],this[C]=l?l(y):y[C]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?St:en,this.isPropagationStopped=en,this}return b(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=St)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=St)},persist:function(){},isPersistent:St}),a}var Kt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zn=$e(Kt),es=b({},Kt,{view:0,detail:0}),qr=$e(es),Fr,fr,Ps,Hn=b({},es,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Td,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Ps&&(Ps&&n.type==="mousemove"?(Fr=n.screenX-Ps.screenX,fr=n.screenY-Ps.screenY):fr=Fr=0,Ps=n),Fr)},movementY:function(n){return"movementY"in n?n.movementY:fr}}),ys=$e(Hn),Aa=b({},Hn,{dataTransfer:0}),ka=$e(Aa),Hb=b({},es,{relatedTarget:0}),jd=$e(Hb),Ob=b({},Kt,{animationName:0,elapsedTime:0,pseudoElement:0}),qb=$e(Ob),Fb=b({},Kt,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Vb=$e(Fb),Bb=b({},Kt,{data:0}),Gm=$e(Bb),$b={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Yb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Jb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Xb(n){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(n):(n=Jb[n])?!!a[n]:!1}function Td(){return Xb}var Kb=b({},es,{key:function(n){if(n.key){var a=$b[n.key]||n.key;if(a!=="Unidentified")return a}return n.type==="keypress"?(n=Je(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Yb[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Td,charCode:function(n){return n.type==="keypress"?Je(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Je(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Wb=$e(Kb),Qb=b({},Hn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Hm=$e(Qb),Zb=b({},es,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Td}),eN=$e(Zb),tN=b({},Kt,{propertyName:0,elapsedTime:0,pseudoElement:0}),nN=$e(tN),sN=b({},Hn,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),rN=$e(sN),aN=b({},Kt,{newState:0,oldState:0}),oN=$e(aN),iN=[9,13,27,32],Cd=G&&"CompositionEvent"in window,xi=null;G&&"documentMode"in document&&(xi=document.documentMode);var lN=G&&"TextEvent"in window&&!xi,Om=G&&(!Cd||xi&&8<xi&&11>=xi),qm=" ",Fm=!1;function Vm(n,a){switch(n){case"keyup":return iN.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bm(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var xo=!1;function cN(n,a){switch(n){case"compositionend":return Bm(a);case"keypress":return a.which!==32?null:(Fm=!0,qm);case"textInput":return n=a.data,n===qm&&Fm?null:n;default:return null}}function dN(n,a){if(xo)return n==="compositionend"||!Cd&&Vm(n,a)?(n=Pe(),qe=_e=pe=null,xo=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Om&&a.locale!=="ko"?null:a.data;default:return null}}var uN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $m(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a==="input"?!!uN[n.type]:a==="textarea"}function Ym(n,a,l,d){Hr?Or?Or.push(d):Or=[d]:Hr=d,a=xc(a,"onChange"),0<a.length&&(l=new Zn("onChange","change",null,l,d),n.push({event:l,listeners:a}))}var gi=null,vi=null;function fN(n){Ax(n,0)}function _l(n){var a=lr(n);if(dr(a))return n}function Jm(n,a){if(n==="change")return a}var Xm=!1;if(G){var Ed;if(G){var _d="oninput"in document;if(!_d){var Km=document.createElement("div");Km.setAttribute("oninput","return;"),_d=typeof Km.oninput=="function"}Ed=_d}else Ed=!1;Xm=Ed&&(!document.documentMode||9<document.documentMode)}function Wm(){gi&&(gi.detachEvent("onpropertychange",Qm),vi=gi=null)}function Qm(n){if(n.propertyName==="value"&&_l(vi)){var a=[];Ym(a,vi,n,ho(n)),El(fN,a)}}function mN(n,a,l){n==="focusin"?(Wm(),gi=a,vi=l,gi.attachEvent("onpropertychange",Qm)):n==="focusout"&&Wm()}function pN(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return _l(vi)}function hN(n,a){if(n==="click")return _l(a)}function xN(n,a){if(n==="input"||n==="change")return _l(a)}function gN(n,a){return n===a&&(n!==0||1/n===1/a)||n!==n&&a!==a}var ts=typeof Object.is=="function"?Object.is:gN;function yi(n,a){if(ts(n,a))return!0;if(typeof n!="object"||n===null||typeof a!="object"||a===null)return!1;var l=Object.keys(n),d=Object.keys(a);if(l.length!==d.length)return!1;for(d=0;d<l.length;d++){var g=l[d];if(!zt.call(a,g)||!ts(n[g],a[g]))return!1}return!0}function Zm(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function ep(n,a){var l=Zm(n);n=0;for(var d;l;){if(l.nodeType===3){if(d=n+l.textContent.length,n<=a&&d>=a)return{node:l,offset:a-n};n=d}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Zm(l)}}function tp(n,a){return n&&a?n===a?!0:n&&n.nodeType===3?!1:a&&a.nodeType===3?tp(n,a.parentNode):"contains"in n?n.contains(a):n.compareDocumentPosition?!!(n.compareDocumentPosition(a)&16):!1:!1}function np(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var a=zr(n.document);a instanceof n.HTMLIFrameElement;){try{var l=typeof a.contentWindow.location.href=="string"}catch{l=!1}if(l)n=a.contentWindow;else break;a=zr(n.document)}return a}function Ad(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a&&(a==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||a==="textarea"||n.contentEditable==="true")}var vN=G&&"documentMode"in document&&11>=document.documentMode,go=null,kd=null,bi=null,Id=!1;function sp(n,a,l){var d=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Id||go==null||go!==zr(d)||(d=go,"selectionStart"in d&&Ad(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),bi&&yi(bi,d)||(bi=d,d=xc(kd,"onSelect"),0<d.length&&(a=new Zn("onSelect","select",null,a,l),n.push({event:a,listeners:d}),a.target=go)))}function Ia(n,a){var l={};return l[n.toLowerCase()]=a.toLowerCase(),l["Webkit"+n]="webkit"+a,l["Moz"+n]="moz"+a,l}var vo={animationend:Ia("Animation","AnimationEnd"),animationiteration:Ia("Animation","AnimationIteration"),animationstart:Ia("Animation","AnimationStart"),transitionrun:Ia("Transition","TransitionRun"),transitionstart:Ia("Transition","TransitionStart"),transitioncancel:Ia("Transition","TransitionCancel"),transitionend:Ia("Transition","TransitionEnd")},Md={},rp={};G&&(rp=document.createElement("div").style,"AnimationEvent"in window||(delete vo.animationend.animation,delete vo.animationiteration.animation,delete vo.animationstart.animation),"TransitionEvent"in window||delete vo.transitionend.transition);function Ma(n){if(Md[n])return Md[n];if(!vo[n])return n;var a=vo[n],l;for(l in a)if(a.hasOwnProperty(l)&&l in rp)return Md[n]=a[l];return n}var ap=Ma("animationend"),op=Ma("animationiteration"),ip=Ma("animationstart"),yN=Ma("transitionrun"),bN=Ma("transitionstart"),NN=Ma("transitioncancel"),lp=Ma("transitionend"),cp=new Map,Rd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Rd.push("scrollEnd");function Ls(n,a){cp.set(n,a),xs(a,[n])}var Al=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},bs=[],yo=0,Dd=0;function kl(){for(var n=yo,a=Dd=yo=0;a<n;){var l=bs[a];bs[a++]=null;var d=bs[a];bs[a++]=null;var g=bs[a];bs[a++]=null;var y=bs[a];if(bs[a++]=null,d!==null&&g!==null){var S=d.pending;S===null?g.next=g:(g.next=S.next,S.next=g),d.pending=g}y!==0&&dp(l,g,y)}}function Il(n,a,l,d){bs[yo++]=n,bs[yo++]=a,bs[yo++]=l,bs[yo++]=d,Dd|=d,n.lanes|=d,n=n.alternate,n!==null&&(n.lanes|=d)}function Ud(n,a,l,d){return Il(n,a,l,d),Ml(n)}function Ra(n,a){return Il(n,null,null,a),Ml(n)}function dp(n,a,l){n.lanes|=l;var d=n.alternate;d!==null&&(d.lanes|=l);for(var g=!1,y=n.return;y!==null;)y.childLanes|=l,d=y.alternate,d!==null&&(d.childLanes|=l),y.tag===22&&(n=y.stateNode,n===null||n._visibility&1||(g=!0)),n=y,y=y.return;return n.tag===3?(y=n.stateNode,g&&a!==null&&(g=31-sn(l),n=y.hiddenUpdates,d=n[g],d===null?n[g]=[a]:d.push(a),a.lane=l|536870912),y):null}function Ml(n){if(50<qi)throw qi=0,Vu=null,Error(o(185));for(var a=n.return;a!==null;)n=a,a=n.return;return n.tag===3?n.stateNode:null}var bo={};function wN(n,a,l,d){this.tag=n,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ns(n,a,l,d){return new wN(n,a,l,d)}function Pd(n){return n=n.prototype,!(!n||!n.isReactComponent)}function mr(n,a){var l=n.alternate;return l===null?(l=ns(n.tag,a,n.key,n.mode),l.elementType=n.elementType,l.type=n.type,l.stateNode=n.stateNode,l.alternate=n,n.alternate=l):(l.pendingProps=a,l.type=n.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=n.flags&65011712,l.childLanes=n.childLanes,l.lanes=n.lanes,l.child=n.child,l.memoizedProps=n.memoizedProps,l.memoizedState=n.memoizedState,l.updateQueue=n.updateQueue,a=n.dependencies,l.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},l.sibling=n.sibling,l.index=n.index,l.ref=n.ref,l.refCleanup=n.refCleanup,l}function up(n,a){n.flags&=65011714;var l=n.alternate;return l===null?(n.childLanes=0,n.lanes=a,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=l.childLanes,n.lanes=l.lanes,n.child=l.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=l.memoizedProps,n.memoizedState=l.memoizedState,n.updateQueue=l.updateQueue,n.type=l.type,a=l.dependencies,n.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),n}function Rl(n,a,l,d,g,y){var S=0;if(d=n,typeof n=="function")Pd(n)&&(S=1);else if(typeof n=="string")S=Ew(n,l,we.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case V:return n=ns(31,l,a,g),n.elementType=V,n.lanes=y,n;case I:return Da(l.children,g,y,a);case E:S=8,g|=24;break;case D:return n=ns(12,l,a,g|2),n.elementType=D,n.lanes=y,n;case B:return n=ns(13,l,a,g),n.elementType=B,n.lanes=y,n;case L:return n=ns(19,l,a,g),n.elementType=L,n.lanes=y,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case A:S=10;break e;case z:S=9;break e;case M:S=11;break e;case X:S=14;break e;case de:S=16,d=null;break e}S=29,l=Error(o(130,n===null?"null":typeof n,"")),d=null}return a=ns(S,l,a,g),a.elementType=n,a.type=d,a.lanes=y,a}function Da(n,a,l,d){return n=ns(7,n,d,a),n.lanes=l,n}function Ld(n,a,l){return n=ns(6,n,null,a),n.lanes=l,n}function fp(n){var a=ns(18,null,null,0);return a.stateNode=n,a}function zd(n,a,l){return a=ns(4,n.children!==null?n.children:[],n.key,a),a.lanes=l,a.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},a}var mp=new WeakMap;function Ns(n,a){if(typeof n=="object"&&n!==null){var l=mp.get(n);return l!==void 0?l:(a={value:n,source:a,stack:Nt(a)},mp.set(n,a),a)}return{value:n,source:a,stack:Nt(a)}}var No=[],wo=0,Dl=null,Ni=0,ws=[],Ss=0,Vr=null,Ws=1,Qs="";function pr(n,a){No[wo++]=Ni,No[wo++]=Dl,Dl=n,Ni=a}function pp(n,a,l){ws[Ss++]=Ws,ws[Ss++]=Qs,ws[Ss++]=Vr,Vr=n;var d=Ws;n=Qs;var g=32-sn(d)-1;d&=~(1<<g),l+=1;var y=32-sn(a)+g;if(30<y){var S=g-g%5;y=(d&(1<<S)-1).toString(32),d>>=S,g-=S,Ws=1<<32-sn(a)+g|l<<g|d,Qs=y+n}else Ws=1<<y|l<<g|d,Qs=n}function Gd(n){n.return!==null&&(pr(n,1),pp(n,1,0))}function Hd(n){for(;n===Dl;)Dl=No[--wo],No[wo]=null,Ni=No[--wo],No[wo]=null;for(;n===Vr;)Vr=ws[--Ss],ws[Ss]=null,Qs=ws[--Ss],ws[Ss]=null,Ws=ws[--Ss],ws[Ss]=null}function hp(n,a){ws[Ss++]=Ws,ws[Ss++]=Qs,ws[Ss++]=Vr,Ws=a.id,Qs=a.overflow,Vr=n}var Nn=null,Ht=null,dt=!1,Br=null,js=!1,Od=Error(o(519));function $r(n){var a=Error(o(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw wi(Ns(a,n)),Od}function xp(n){var a=n.stateNode,l=n.type,d=n.memoizedProps;switch(a[Bt]=n,a[wt]=d,l){case"dialog":at("cancel",a),at("close",a);break;case"iframe":case"object":case"embed":at("load",a);break;case"video":case"audio":for(l=0;l<Vi.length;l++)at(Vi[l],a);break;case"source":at("error",a);break;case"img":case"image":case"link":at("error",a),at("load",a);break;case"details":at("toggle",a);break;case"input":at("invalid",a),gs(a,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0);break;case"select":at("invalid",a);break;case"textarea":at("invalid",a),ui(a,d.value,d.defaultValue,d.children)}l=d.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||a.textContent===""+l||d.suppressHydrationWarning===!0||Rx(a.textContent,l)?(d.popover!=null&&(at("beforetoggle",a),at("toggle",a)),d.onScroll!=null&&at("scroll",a),d.onScrollEnd!=null&&at("scrollend",a),d.onClick!=null&&(a.onclick=Us),a=!0):a=!1,a||$r(n,!0)}function gp(n){for(Nn=n.return;Nn;)switch(Nn.tag){case 5:case 31:case 13:js=!1;return;case 27:case 3:js=!0;return;default:Nn=Nn.return}}function So(n){if(n!==Nn)return!1;if(!dt)return gp(n),dt=!0,!1;var a=n.tag,l;if((l=a!==3&&a!==27)&&((l=a===5)&&(l=n.type,l=!(l!=="form"&&l!=="button")||af(n.type,n.memoizedProps)),l=!l),l&&Ht&&$r(n),gp(n),a===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(o(317));Ht=qx(n)}else if(a===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(o(317));Ht=qx(n)}else a===27?(a=Ht,oa(n.type)?(n=uf,uf=null,Ht=n):Ht=a):Ht=Nn?Cs(n.stateNode.nextSibling):null;return!0}function Ua(){Ht=Nn=null,dt=!1}function qd(){var n=Br;return n!==null&&(Vn===null?Vn=n:Vn.push.apply(Vn,n),Br=null),n}function wi(n){Br===null?Br=[n]:Br.push(n)}var Fd=ye(null),Pa=null,hr=null;function Yr(n,a,l){J(Fd,a._currentValue),a._currentValue=l}function xr(n){n._currentValue=Fd.current,je(Fd)}function Vd(n,a,l){for(;n!==null;){var d=n.alternate;if((n.childLanes&a)!==a?(n.childLanes|=a,d!==null&&(d.childLanes|=a)):d!==null&&(d.childLanes&a)!==a&&(d.childLanes|=a),n===l)break;n=n.return}}function Bd(n,a,l,d){var g=n.child;for(g!==null&&(g.return=n);g!==null;){var y=g.dependencies;if(y!==null){var S=g.child;y=y.firstContext;e:for(;y!==null;){var C=y;y=g;for(var U=0;U<a.length;U++)if(C.context===a[U]){y.lanes|=l,C=y.alternate,C!==null&&(C.lanes|=l),Vd(y.return,l,n),d||(S=null);break e}y=C.next}}else if(g.tag===18){if(S=g.return,S===null)throw Error(o(341));S.lanes|=l,y=S.alternate,y!==null&&(y.lanes|=l),Vd(S,l,n),S=null}else S=g.child;if(S!==null)S.return=g;else for(S=g;S!==null;){if(S===n){S=null;break}if(g=S.sibling,g!==null){g.return=S.return,S=g;break}S=S.return}g=S}}function jo(n,a,l,d){n=null;for(var g=a,y=!1;g!==null;){if(!y){if((g.flags&524288)!==0)y=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var S=g.alternate;if(S===null)throw Error(o(387));if(S=S.memoizedProps,S!==null){var C=g.type;ts(g.pendingProps.value,S.value)||(n!==null?n.push(C):n=[C])}}else if(g===Ae.current){if(S=g.alternate,S===null)throw Error(o(387));S.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(n!==null?n.push(Xi):n=[Xi])}g=g.return}n!==null&&Bd(a,n,l,d),a.flags|=262144}function Ul(n){for(n=n.firstContext;n!==null;){if(!ts(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function La(n){Pa=n,hr=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function wn(n){return vp(Pa,n)}function Pl(n,a){return Pa===null&&La(n),vp(n,a)}function vp(n,a){var l=a._currentValue;if(a={context:a,memoizedValue:l,next:null},hr===null){if(n===null)throw Error(o(308));hr=a,n.dependencies={lanes:0,firstContext:a},n.flags|=524288}else hr=hr.next=a;return l}var SN=typeof AbortController<"u"?AbortController:function(){var n=[],a=this.signal={aborted:!1,addEventListener:function(l,d){n.push(d)}};this.abort=function(){a.aborted=!0,n.forEach(function(l){return l()})}},jN=t.unstable_scheduleCallback,TN=t.unstable_NormalPriority,rn={$$typeof:A,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function $d(){return{controller:new SN,data:new Map,refCount:0}}function Si(n){n.refCount--,n.refCount===0&&jN(TN,function(){n.controller.abort()})}var ji=null,Yd=0,To=0,Co=null;function CN(n,a){if(ji===null){var l=ji=[];Yd=0,To=Ku(),Co={status:"pending",value:void 0,then:function(d){l.push(d)}}}return Yd++,a.then(yp,yp),a}function yp(){if(--Yd===0&&ji!==null){Co!==null&&(Co.status="fulfilled");var n=ji;ji=null,To=0,Co=null;for(var a=0;a<n.length;a++)(0,n[a])()}}function EN(n,a){var l=[],d={status:"pending",value:null,reason:null,then:function(g){l.push(g)}};return n.then(function(){d.status="fulfilled",d.value=a;for(var g=0;g<l.length;g++)(0,l[g])(a)},function(g){for(d.status="rejected",d.reason=g,g=0;g<l.length;g++)(0,l[g])(void 0)}),d}var bp=q.S;q.S=function(n,a){sx=Q(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&CN(n,a),bp!==null&&bp(n,a)};var za=ye(null);function Jd(){var n=za.current;return n!==null?n:Rt.pooledCache}function Ll(n,a){a===null?J(za,za.current):J(za,a.pool)}function Np(){var n=Jd();return n===null?null:{parent:rn._currentValue,pool:n}}var Eo=Error(o(460)),Xd=Error(o(474)),zl=Error(o(542)),Gl={then:function(){}};function wp(n){return n=n.status,n==="fulfilled"||n==="rejected"}function Sp(n,a,l){switch(l=n[l],l===void 0?n.push(a):l!==a&&(a.then(Us,Us),a=l),a.status){case"fulfilled":return a.value;case"rejected":throw n=a.reason,Tp(n),n;default:if(typeof a.status=="string")a.then(Us,Us);else{if(n=Rt,n!==null&&100<n.shellSuspendCounter)throw Error(o(482));n=a,n.status="pending",n.then(function(d){if(a.status==="pending"){var g=a;g.status="fulfilled",g.value=d}},function(d){if(a.status==="pending"){var g=a;g.status="rejected",g.reason=d}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw n=a.reason,Tp(n),n}throw Ha=a,Eo}}function Ga(n){try{var a=n._init;return a(n._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(Ha=l,Eo):l}}var Ha=null;function jp(){if(Ha===null)throw Error(o(459));var n=Ha;return Ha=null,n}function Tp(n){if(n===Eo||n===zl)throw Error(o(483))}var _o=null,Ti=0;function Hl(n){var a=Ti;return Ti+=1,_o===null&&(_o=[]),Sp(_o,n,a)}function Ci(n,a){a=a.props.ref,n.ref=a!==void 0?a:null}function Ol(n,a){throw a.$$typeof===N?Error(o(525)):(n=Object.prototype.toString.call(a),Error(o(31,n==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":n)))}function Cp(n){function a($,O){if(n){var ee=$.deletions;ee===null?($.deletions=[O],$.flags|=16):ee.push(O)}}function l($,O){if(!n)return null;for(;O!==null;)a($,O),O=O.sibling;return null}function d($){for(var O=new Map;$!==null;)$.key!==null?O.set($.key,$):O.set($.index,$),$=$.sibling;return O}function g($,O){return $=mr($,O),$.index=0,$.sibling=null,$}function y($,O,ee){return $.index=ee,n?(ee=$.alternate,ee!==null?(ee=ee.index,ee<O?($.flags|=67108866,O):ee):($.flags|=67108866,O)):($.flags|=1048576,O)}function S($){return n&&$.alternate===null&&($.flags|=67108866),$}function C($,O,ee,ge){return O===null||O.tag!==6?(O=Ld(ee,$.mode,ge),O.return=$,O):(O=g(O,ee),O.return=$,O)}function U($,O,ee,ge){var Oe=ee.type;return Oe===I?fe($,O,ee.props.children,ge,ee.key):O!==null&&(O.elementType===Oe||typeof Oe=="object"&&Oe!==null&&Oe.$$typeof===de&&Ga(Oe)===O.type)?(O=g(O,ee.props),Ci(O,ee),O.return=$,O):(O=Rl(ee.type,ee.key,ee.props,null,$.mode,ge),Ci(O,ee),O.return=$,O)}function te($,O,ee,ge){return O===null||O.tag!==4||O.stateNode.containerInfo!==ee.containerInfo||O.stateNode.implementation!==ee.implementation?(O=zd(ee,$.mode,ge),O.return=$,O):(O=g(O,ee.children||[]),O.return=$,O)}function fe($,O,ee,ge,Oe){return O===null||O.tag!==7?(O=Da(ee,$.mode,ge,Oe),O.return=$,O):(O=g(O,ee),O.return=$,O)}function ve($,O,ee){if(typeof O=="string"&&O!==""||typeof O=="number"||typeof O=="bigint")return O=Ld(""+O,$.mode,ee),O.return=$,O;if(typeof O=="object"&&O!==null){switch(O.$$typeof){case T:return ee=Rl(O.type,O.key,O.props,null,$.mode,ee),Ci(ee,O),ee.return=$,ee;case _:return O=zd(O,$.mode,ee),O.return=$,O;case de:return O=Ga(O),ve($,O,ee)}if(re(O)||F(O))return O=Da(O,$.mode,ee,null),O.return=$,O;if(typeof O.then=="function")return ve($,Hl(O),ee);if(O.$$typeof===A)return ve($,Pl($,O),ee);Ol($,O)}return null}function ie($,O,ee,ge){var Oe=O!==null?O.key:null;if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return Oe!==null?null:C($,O,""+ee,ge);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case T:return ee.key===Oe?U($,O,ee,ge):null;case _:return ee.key===Oe?te($,O,ee,ge):null;case de:return ee=Ga(ee),ie($,O,ee,ge)}if(re(ee)||F(ee))return Oe!==null?null:fe($,O,ee,ge,null);if(typeof ee.then=="function")return ie($,O,Hl(ee),ge);if(ee.$$typeof===A)return ie($,O,Pl($,ee),ge);Ol($,ee)}return null}function ce($,O,ee,ge,Oe){if(typeof ge=="string"&&ge!==""||typeof ge=="number"||typeof ge=="bigint")return $=$.get(ee)||null,C(O,$,""+ge,Oe);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case T:return $=$.get(ge.key===null?ee:ge.key)||null,U(O,$,ge,Oe);case _:return $=$.get(ge.key===null?ee:ge.key)||null,te(O,$,ge,Oe);case de:return ge=Ga(ge),ce($,O,ee,ge,Oe)}if(re(ge)||F(ge))return $=$.get(ee)||null,fe(O,$,ge,Oe,null);if(typeof ge.then=="function")return ce($,O,ee,Hl(ge),Oe);if(ge.$$typeof===A)return ce($,O,ee,Pl(O,ge),Oe);Ol(O,ge)}return null}function Re($,O,ee,ge){for(var Oe=null,pt=null,Ue=O,Qe=O=0,ct=null;Ue!==null&&Qe<ee.length;Qe++){Ue.index>Qe?(ct=Ue,Ue=null):ct=Ue.sibling;var ht=ie($,Ue,ee[Qe],ge);if(ht===null){Ue===null&&(Ue=ct);break}n&&Ue&&ht.alternate===null&&a($,Ue),O=y(ht,O,Qe),pt===null?Oe=ht:pt.sibling=ht,pt=ht,Ue=ct}if(Qe===ee.length)return l($,Ue),dt&&pr($,Qe),Oe;if(Ue===null){for(;Qe<ee.length;Qe++)Ue=ve($,ee[Qe],ge),Ue!==null&&(O=y(Ue,O,Qe),pt===null?Oe=Ue:pt.sibling=Ue,pt=Ue);return dt&&pr($,Qe),Oe}for(Ue=d(Ue);Qe<ee.length;Qe++)ct=ce(Ue,$,Qe,ee[Qe],ge),ct!==null&&(n&&ct.alternate!==null&&Ue.delete(ct.key===null?Qe:ct.key),O=y(ct,O,Qe),pt===null?Oe=ct:pt.sibling=ct,pt=ct);return n&&Ue.forEach(function(ua){return a($,ua)}),dt&&pr($,Qe),Oe}function Fe($,O,ee,ge){if(ee==null)throw Error(o(151));for(var Oe=null,pt=null,Ue=O,Qe=O=0,ct=null,ht=ee.next();Ue!==null&&!ht.done;Qe++,ht=ee.next()){Ue.index>Qe?(ct=Ue,Ue=null):ct=Ue.sibling;var ua=ie($,Ue,ht.value,ge);if(ua===null){Ue===null&&(Ue=ct);break}n&&Ue&&ua.alternate===null&&a($,Ue),O=y(ua,O,Qe),pt===null?Oe=ua:pt.sibling=ua,pt=ua,Ue=ct}if(ht.done)return l($,Ue),dt&&pr($,Qe),Oe;if(Ue===null){for(;!ht.done;Qe++,ht=ee.next())ht=ve($,ht.value,ge),ht!==null&&(O=y(ht,O,Qe),pt===null?Oe=ht:pt.sibling=ht,pt=ht);return dt&&pr($,Qe),Oe}for(Ue=d(Ue);!ht.done;Qe++,ht=ee.next())ht=ce(Ue,$,Qe,ht.value,ge),ht!==null&&(n&&ht.alternate!==null&&Ue.delete(ht.key===null?Qe:ht.key),O=y(ht,O,Qe),pt===null?Oe=ht:pt.sibling=ht,pt=ht);return n&&Ue.forEach(function(zw){return a($,zw)}),dt&&pr($,Qe),Oe}function It($,O,ee,ge){if(typeof ee=="object"&&ee!==null&&ee.type===I&&ee.key===null&&(ee=ee.props.children),typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case T:e:{for(var Oe=ee.key;O!==null;){if(O.key===Oe){if(Oe=ee.type,Oe===I){if(O.tag===7){l($,O.sibling),ge=g(O,ee.props.children),ge.return=$,$=ge;break e}}else if(O.elementType===Oe||typeof Oe=="object"&&Oe!==null&&Oe.$$typeof===de&&Ga(Oe)===O.type){l($,O.sibling),ge=g(O,ee.props),Ci(ge,ee),ge.return=$,$=ge;break e}l($,O);break}else a($,O);O=O.sibling}ee.type===I?(ge=Da(ee.props.children,$.mode,ge,ee.key),ge.return=$,$=ge):(ge=Rl(ee.type,ee.key,ee.props,null,$.mode,ge),Ci(ge,ee),ge.return=$,$=ge)}return S($);case _:e:{for(Oe=ee.key;O!==null;){if(O.key===Oe)if(O.tag===4&&O.stateNode.containerInfo===ee.containerInfo&&O.stateNode.implementation===ee.implementation){l($,O.sibling),ge=g(O,ee.children||[]),ge.return=$,$=ge;break e}else{l($,O);break}else a($,O);O=O.sibling}ge=zd(ee,$.mode,ge),ge.return=$,$=ge}return S($);case de:return ee=Ga(ee),It($,O,ee,ge)}if(re(ee))return Re($,O,ee,ge);if(F(ee)){if(Oe=F(ee),typeof Oe!="function")throw Error(o(150));return ee=Oe.call(ee),Fe($,O,ee,ge)}if(typeof ee.then=="function")return It($,O,Hl(ee),ge);if(ee.$$typeof===A)return It($,O,Pl($,ee),ge);Ol($,ee)}return typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint"?(ee=""+ee,O!==null&&O.tag===6?(l($,O.sibling),ge=g(O,ee),ge.return=$,$=ge):(l($,O),ge=Ld(ee,$.mode,ge),ge.return=$,$=ge),S($)):l($,O)}return function($,O,ee,ge){try{Ti=0;var Oe=It($,O,ee,ge);return _o=null,Oe}catch(Ue){if(Ue===Eo||Ue===zl)throw Ue;var pt=ns(29,Ue,null,$.mode);return pt.lanes=ge,pt.return=$,pt}finally{}}}var Oa=Cp(!0),Ep=Cp(!1),Jr=!1;function Kd(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Wd(n,a){n=n.updateQueue,a.updateQueue===n&&(a.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Xr(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Kr(n,a,l){var d=n.updateQueue;if(d===null)return null;if(d=d.shared,(vt&2)!==0){var g=d.pending;return g===null?a.next=a:(a.next=g.next,g.next=a),d.pending=a,a=Ml(n),dp(n,null,l),a}return Il(n,d,a,l),Ml(n)}function Ei(n,a,l){if(a=a.updateQueue,a!==null&&(a=a.shared,(l&4194048)!==0)){var d=a.lanes;d&=n.pendingLanes,l|=d,a.lanes=l,Ds(n,l)}}function Qd(n,a){var l=n.updateQueue,d=n.alternate;if(d!==null&&(d=d.updateQueue,l===d)){var g=null,y=null;if(l=l.firstBaseUpdate,l!==null){do{var S={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};y===null?g=y=S:y=y.next=S,l=l.next}while(l!==null);y===null?g=y=a:y=y.next=a}else g=y=a;l={baseState:d.baseState,firstBaseUpdate:g,lastBaseUpdate:y,shared:d.shared,callbacks:d.callbacks},n.updateQueue=l;return}n=l.lastBaseUpdate,n===null?l.firstBaseUpdate=a:n.next=a,l.lastBaseUpdate=a}var Zd=!1;function _i(){if(Zd){var n=Co;if(n!==null)throw n}}function Ai(n,a,l,d){Zd=!1;var g=n.updateQueue;Jr=!1;var y=g.firstBaseUpdate,S=g.lastBaseUpdate,C=g.shared.pending;if(C!==null){g.shared.pending=null;var U=C,te=U.next;U.next=null,S===null?y=te:S.next=te,S=U;var fe=n.alternate;fe!==null&&(fe=fe.updateQueue,C=fe.lastBaseUpdate,C!==S&&(C===null?fe.firstBaseUpdate=te:C.next=te,fe.lastBaseUpdate=U))}if(y!==null){var ve=g.baseState;S=0,fe=te=U=null,C=y;do{var ie=C.lane&-536870913,ce=ie!==C.lane;if(ce?(lt&ie)===ie:(d&ie)===ie){ie!==0&&ie===To&&(Zd=!0),fe!==null&&(fe=fe.next={lane:0,tag:C.tag,payload:C.payload,callback:null,next:null});e:{var Re=n,Fe=C;ie=a;var It=l;switch(Fe.tag){case 1:if(Re=Fe.payload,typeof Re=="function"){ve=Re.call(It,ve,ie);break e}ve=Re;break e;case 3:Re.flags=Re.flags&-65537|128;case 0:if(Re=Fe.payload,ie=typeof Re=="function"?Re.call(It,ve,ie):Re,ie==null)break e;ve=b({},ve,ie);break e;case 2:Jr=!0}}ie=C.callback,ie!==null&&(n.flags|=64,ce&&(n.flags|=8192),ce=g.callbacks,ce===null?g.callbacks=[ie]:ce.push(ie))}else ce={lane:ie,tag:C.tag,payload:C.payload,callback:C.callback,next:null},fe===null?(te=fe=ce,U=ve):fe=fe.next=ce,S|=ie;if(C=C.next,C===null){if(C=g.shared.pending,C===null)break;ce=C,C=ce.next,ce.next=null,g.lastBaseUpdate=ce,g.shared.pending=null}}while(!0);fe===null&&(U=ve),g.baseState=U,g.firstBaseUpdate=te,g.lastBaseUpdate=fe,y===null&&(g.shared.lanes=0),ta|=S,n.lanes=S,n.memoizedState=ve}}function _p(n,a){if(typeof n!="function")throw Error(o(191,n));n.call(a)}function Ap(n,a){var l=n.callbacks;if(l!==null)for(n.callbacks=null,n=0;n<l.length;n++)_p(l[n],a)}var Ao=ye(null),ql=ye(0);function kp(n,a){n=Tr,J(ql,n),J(Ao,a),Tr=n|a.baseLanes}function eu(){J(ql,Tr),J(Ao,Ao.current)}function tu(){Tr=ql.current,je(Ao),je(ql)}var ss=ye(null),Ts=null;function Wr(n){var a=n.alternate;J(tn,tn.current&1),J(ss,n),Ts===null&&(a===null||Ao.current!==null||a.memoizedState!==null)&&(Ts=n)}function nu(n){J(tn,tn.current),J(ss,n),Ts===null&&(Ts=n)}function Ip(n){n.tag===22?(J(tn,tn.current),J(ss,n),Ts===null&&(Ts=n)):Qr()}function Qr(){J(tn,tn.current),J(ss,ss.current)}function rs(n){je(ss),Ts===n&&(Ts=null),je(tn)}var tn=ye(0);function Fl(n){for(var a=n;a!==null;){if(a.tag===13){var l=a.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||cf(l)||df(l)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var gr=0,Ke=null,At=null,an=null,Vl=!1,ko=!1,qa=!1,Bl=0,ki=0,Io=null,_N=0;function Wt(){throw Error(o(321))}function su(n,a){if(a===null)return!1;for(var l=0;l<a.length&&l<n.length;l++)if(!ts(n[l],a[l]))return!1;return!0}function ru(n,a,l,d,g,y){return gr=y,Ke=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,q.H=n===null||n.memoizedState===null?ph:yu,qa=!1,y=l(d,g),qa=!1,ko&&(y=Rp(a,l,d,g)),Mp(n),y}function Mp(n){q.H=Ri;var a=At!==null&&At.next!==null;if(gr=0,an=At=Ke=null,Vl=!1,ki=0,Io=null,a)throw Error(o(300));n===null||on||(n=n.dependencies,n!==null&&Ul(n)&&(on=!0))}function Rp(n,a,l,d){Ke=n;var g=0;do{if(ko&&(Io=null),ki=0,ko=!1,25<=g)throw Error(o(301));if(g+=1,an=At=null,n.updateQueue!=null){var y=n.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}q.H=hh,y=a(l,d)}while(ko);return y}function AN(){var n=q.H,a=n.useState()[0];return a=typeof a.then=="function"?Ii(a):a,n=n.useState()[0],(At!==null?At.memoizedState:null)!==n&&(Ke.flags|=1024),a}function au(){var n=Bl!==0;return Bl=0,n}function ou(n,a,l){a.updateQueue=n.updateQueue,a.flags&=-2053,n.lanes&=~l}function iu(n){if(Vl){for(n=n.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Vl=!1}gr=0,an=At=Ke=null,ko=!1,ki=Bl=0,Io=null}function kn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return an===null?Ke.memoizedState=an=n:an=an.next=n,an}function nn(){if(At===null){var n=Ke.alternate;n=n!==null?n.memoizedState:null}else n=At.next;var a=an===null?Ke.memoizedState:an.next;if(a!==null)an=a,At=n;else{if(n===null)throw Ke.alternate===null?Error(o(467)):Error(o(310));At=n,n={memoizedState:At.memoizedState,baseState:At.baseState,baseQueue:At.baseQueue,queue:At.queue,next:null},an===null?Ke.memoizedState=an=n:an=an.next=n}return an}function $l(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ii(n){var a=ki;return ki+=1,Io===null&&(Io=[]),n=Sp(Io,n,a),a=Ke,(an===null?a.memoizedState:an.next)===null&&(a=a.alternate,q.H=a===null||a.memoizedState===null?ph:yu),n}function Yl(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return Ii(n);if(n.$$typeof===A)return wn(n)}throw Error(o(438,String(n)))}function lu(n){var a=null,l=Ke.updateQueue;if(l!==null&&(a=l.memoCache),a==null){var d=Ke.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(a={data:d.data.map(function(g){return g.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),l===null&&(l=$l(),Ke.updateQueue=l),l.memoCache=a,l=a.data[a.index],l===void 0)for(l=a.data[a.index]=Array(n),d=0;d<n;d++)l[d]=Z;return a.index++,l}function vr(n,a){return typeof a=="function"?a(n):a}function Jl(n){var a=nn();return cu(a,At,n)}function cu(n,a,l){var d=n.queue;if(d===null)throw Error(o(311));d.lastRenderedReducer=l;var g=n.baseQueue,y=d.pending;if(y!==null){if(g!==null){var S=g.next;g.next=y.next,y.next=S}a.baseQueue=g=y,d.pending=null}if(y=n.baseState,g===null)n.memoizedState=y;else{a=g.next;var C=S=null,U=null,te=a,fe=!1;do{var ve=te.lane&-536870913;if(ve!==te.lane?(lt&ve)===ve:(gr&ve)===ve){var ie=te.revertLane;if(ie===0)U!==null&&(U=U.next={lane:0,revertLane:0,gesture:null,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null}),ve===To&&(fe=!0);else if((gr&ie)===ie){te=te.next,ie===To&&(fe=!0);continue}else ve={lane:0,revertLane:te.revertLane,gesture:null,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null},U===null?(C=U=ve,S=y):U=U.next=ve,Ke.lanes|=ie,ta|=ie;ve=te.action,qa&&l(y,ve),y=te.hasEagerState?te.eagerState:l(y,ve)}else ie={lane:ve,revertLane:te.revertLane,gesture:te.gesture,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null},U===null?(C=U=ie,S=y):U=U.next=ie,Ke.lanes|=ve,ta|=ve;te=te.next}while(te!==null&&te!==a);if(U===null?S=y:U.next=C,!ts(y,n.memoizedState)&&(on=!0,fe&&(l=Co,l!==null)))throw l;n.memoizedState=y,n.baseState=S,n.baseQueue=U,d.lastRenderedState=y}return g===null&&(d.lanes=0),[n.memoizedState,d.dispatch]}function du(n){var a=nn(),l=a.queue;if(l===null)throw Error(o(311));l.lastRenderedReducer=n;var d=l.dispatch,g=l.pending,y=a.memoizedState;if(g!==null){l.pending=null;var S=g=g.next;do y=n(y,S.action),S=S.next;while(S!==g);ts(y,a.memoizedState)||(on=!0),a.memoizedState=y,a.baseQueue===null&&(a.baseState=y),l.lastRenderedState=y}return[y,d]}function Dp(n,a,l){var d=Ke,g=nn(),y=dt;if(y){if(l===void 0)throw Error(o(407));l=l()}else l=a();var S=!ts((At||g).memoizedState,l);if(S&&(g.memoizedState=l,on=!0),g=g.queue,mu(Lp.bind(null,d,g,n),[n]),g.getSnapshot!==a||S||an!==null&&an.memoizedState.tag&1){if(d.flags|=2048,Mo(9,{destroy:void 0},Pp.bind(null,d,g,l,a),null),Rt===null)throw Error(o(349));y||(gr&127)!==0||Up(d,a,l)}return l}function Up(n,a,l){n.flags|=16384,n={getSnapshot:a,value:l},a=Ke.updateQueue,a===null?(a=$l(),Ke.updateQueue=a,a.stores=[n]):(l=a.stores,l===null?a.stores=[n]:l.push(n))}function Pp(n,a,l,d){a.value=l,a.getSnapshot=d,zp(a)&&Gp(n)}function Lp(n,a,l){return l(function(){zp(a)&&Gp(n)})}function zp(n){var a=n.getSnapshot;n=n.value;try{var l=a();return!ts(n,l)}catch{return!0}}function Gp(n){var a=Ra(n,2);a!==null&&Bn(a,n,2)}function uu(n){var a=kn();if(typeof n=="function"){var l=n;if(n=l(),qa){gn(!0);try{l()}finally{gn(!1)}}}return a.memoizedState=a.baseState=n,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:vr,lastRenderedState:n},a}function Hp(n,a,l,d){return n.baseState=l,cu(n,At,typeof d=="function"?d:vr)}function kN(n,a,l,d,g){if(Wl(n))throw Error(o(485));if(n=a.action,n!==null){var y={payload:g,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){y.listeners.push(S)}};q.T!==null?l(!0):y.isTransition=!1,d(y),l=a.pending,l===null?(y.next=a.pending=y,Op(a,y)):(y.next=l.next,a.pending=l.next=y)}}function Op(n,a){var l=a.action,d=a.payload,g=n.state;if(a.isTransition){var y=q.T,S={};q.T=S;try{var C=l(g,d),U=q.S;U!==null&&U(S,C),qp(n,a,C)}catch(te){fu(n,a,te)}finally{y!==null&&S.types!==null&&(y.types=S.types),q.T=y}}else try{y=l(g,d),qp(n,a,y)}catch(te){fu(n,a,te)}}function qp(n,a,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(d){Fp(n,a,d)},function(d){return fu(n,a,d)}):Fp(n,a,l)}function Fp(n,a,l){a.status="fulfilled",a.value=l,Vp(a),n.state=l,a=n.pending,a!==null&&(l=a.next,l===a?n.pending=null:(l=l.next,a.next=l,Op(n,l)))}function fu(n,a,l){var d=n.pending;if(n.pending=null,d!==null){d=d.next;do a.status="rejected",a.reason=l,Vp(a),a=a.next;while(a!==d)}n.action=null}function Vp(n){n=n.listeners;for(var a=0;a<n.length;a++)(0,n[a])()}function Bp(n,a){return a}function $p(n,a){if(dt){var l=Rt.formState;if(l!==null){e:{var d=Ke;if(dt){if(Ht){t:{for(var g=Ht,y=js;g.nodeType!==8;){if(!y){g=null;break t}if(g=Cs(g.nextSibling),g===null){g=null;break t}}y=g.data,g=y==="F!"||y==="F"?g:null}if(g){Ht=Cs(g.nextSibling),d=g.data==="F!";break e}}$r(d)}d=!1}d&&(a=l[0])}}return l=kn(),l.memoizedState=l.baseState=a,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Bp,lastRenderedState:a},l.queue=d,l=uh.bind(null,Ke,d),d.dispatch=l,d=uu(!1),y=vu.bind(null,Ke,!1,d.queue),d=kn(),g={state:a,dispatch:null,action:n,pending:null},d.queue=g,l=kN.bind(null,Ke,g,y,l),g.dispatch=l,d.memoizedState=n,[a,l,!1]}function Yp(n){var a=nn();return Jp(a,At,n)}function Jp(n,a,l){if(a=cu(n,a,Bp)[0],n=Jl(vr)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var d=Ii(a)}catch(S){throw S===Eo?zl:S}else d=a;a=nn();var g=a.queue,y=g.dispatch;return l!==a.memoizedState&&(Ke.flags|=2048,Mo(9,{destroy:void 0},IN.bind(null,g,l),null)),[d,y,n]}function IN(n,a){n.action=a}function Xp(n){var a=nn(),l=At;if(l!==null)return Jp(a,l,n);nn(),a=a.memoizedState,l=nn();var d=l.queue.dispatch;return l.memoizedState=n,[a,d,!1]}function Mo(n,a,l,d){return n={tag:n,create:l,deps:d,inst:a,next:null},a=Ke.updateQueue,a===null&&(a=$l(),Ke.updateQueue=a),l=a.lastEffect,l===null?a.lastEffect=n.next=n:(d=l.next,l.next=n,n.next=d,a.lastEffect=n),n}function Kp(){return nn().memoizedState}function Xl(n,a,l,d){var g=kn();Ke.flags|=n,g.memoizedState=Mo(1|a,{destroy:void 0},l,d===void 0?null:d)}function Kl(n,a,l,d){var g=nn();d=d===void 0?null:d;var y=g.memoizedState.inst;At!==null&&d!==null&&su(d,At.memoizedState.deps)?g.memoizedState=Mo(a,y,l,d):(Ke.flags|=n,g.memoizedState=Mo(1|a,y,l,d))}function Wp(n,a){Xl(8390656,8,n,a)}function mu(n,a){Kl(2048,8,n,a)}function MN(n){Ke.flags|=4;var a=Ke.updateQueue;if(a===null)a=$l(),Ke.updateQueue=a,a.events=[n];else{var l=a.events;l===null?a.events=[n]:l.push(n)}}function Qp(n){var a=nn().memoizedState;return MN({ref:a,nextImpl:n}),function(){if((vt&2)!==0)throw Error(o(440));return a.impl.apply(void 0,arguments)}}function Zp(n,a){return Kl(4,2,n,a)}function eh(n,a){return Kl(4,4,n,a)}function th(n,a){if(typeof a=="function"){n=n();var l=a(n);return function(){typeof l=="function"?l():a(null)}}if(a!=null)return n=n(),a.current=n,function(){a.current=null}}function nh(n,a,l){l=l!=null?l.concat([n]):null,Kl(4,4,th.bind(null,a,n),l)}function pu(){}function sh(n,a){var l=nn();a=a===void 0?null:a;var d=l.memoizedState;return a!==null&&su(a,d[1])?d[0]:(l.memoizedState=[n,a],n)}function rh(n,a){var l=nn();a=a===void 0?null:a;var d=l.memoizedState;if(a!==null&&su(a,d[1]))return d[0];if(d=n(),qa){gn(!0);try{n()}finally{gn(!1)}}return l.memoizedState=[d,a],d}function hu(n,a,l){return l===void 0||(gr&1073741824)!==0&&(lt&261930)===0?n.memoizedState=a:(n.memoizedState=l,n=ax(),Ke.lanes|=n,ta|=n,l)}function ah(n,a,l,d){return ts(l,a)?l:Ao.current!==null?(n=hu(n,l,d),ts(n,a)||(on=!0),n):(gr&42)===0||(gr&1073741824)!==0&&(lt&261930)===0?(on=!0,n.memoizedState=l):(n=ax(),Ke.lanes|=n,ta|=n,a)}function oh(n,a,l,d,g){var y=H.p;H.p=y!==0&&8>y?y:8;var S=q.T,C={};q.T=C,vu(n,!1,a,l);try{var U=g(),te=q.S;if(te!==null&&te(C,U),U!==null&&typeof U=="object"&&typeof U.then=="function"){var fe=EN(U,d);Mi(n,a,fe,is(n))}else Mi(n,a,d,is(n))}catch(ve){Mi(n,a,{then:function(){},status:"rejected",reason:ve},is())}finally{H.p=y,S!==null&&C.types!==null&&(S.types=C.types),q.T=S}}function RN(){}function xu(n,a,l,d){if(n.tag!==5)throw Error(o(476));var g=ih(n).queue;oh(n,g,a,R,l===null?RN:function(){return lh(n),l(d)})}function ih(n){var a=n.memoizedState;if(a!==null)return a;a={memoizedState:R,baseState:R,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:vr,lastRenderedState:R},next:null};var l={};return a.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:vr,lastRenderedState:l},next:null},n.memoizedState=a,n=n.alternate,n!==null&&(n.memoizedState=a),a}function lh(n){var a=ih(n);a.next===null&&(a=n.alternate.memoizedState),Mi(n,a.next.queue,{},is())}function gu(){return wn(Xi)}function ch(){return nn().memoizedState}function dh(){return nn().memoizedState}function DN(n){for(var a=n.return;a!==null;){switch(a.tag){case 24:case 3:var l=is();n=Xr(l);var d=Kr(a,n,l);d!==null&&(Bn(d,a,l),Ei(d,a,l)),a={cache:$d()},n.payload=a;return}a=a.return}}function UN(n,a,l){var d=is();l={lane:d,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Wl(n)?fh(a,l):(l=Ud(n,a,l,d),l!==null&&(Bn(l,n,d),mh(l,a,d)))}function uh(n,a,l){var d=is();Mi(n,a,l,d)}function Mi(n,a,l,d){var g={lane:d,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(Wl(n))fh(a,g);else{var y=n.alternate;if(n.lanes===0&&(y===null||y.lanes===0)&&(y=a.lastRenderedReducer,y!==null))try{var S=a.lastRenderedState,C=y(S,l);if(g.hasEagerState=!0,g.eagerState=C,ts(C,S))return Il(n,a,g,0),Rt===null&&kl(),!1}catch{}finally{}if(l=Ud(n,a,g,d),l!==null)return Bn(l,n,d),mh(l,a,d),!0}return!1}function vu(n,a,l,d){if(d={lane:2,revertLane:Ku(),gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},Wl(n)){if(a)throw Error(o(479))}else a=Ud(n,l,d,2),a!==null&&Bn(a,n,2)}function Wl(n){var a=n.alternate;return n===Ke||a!==null&&a===Ke}function fh(n,a){ko=Vl=!0;var l=n.pending;l===null?a.next=a:(a.next=l.next,l.next=a),n.pending=a}function mh(n,a,l){if((l&4194048)!==0){var d=a.lanes;d&=n.pendingLanes,l|=d,a.lanes=l,Ds(n,l)}}var Ri={readContext:wn,use:Yl,useCallback:Wt,useContext:Wt,useEffect:Wt,useImperativeHandle:Wt,useLayoutEffect:Wt,useInsertionEffect:Wt,useMemo:Wt,useReducer:Wt,useRef:Wt,useState:Wt,useDebugValue:Wt,useDeferredValue:Wt,useTransition:Wt,useSyncExternalStore:Wt,useId:Wt,useHostTransitionStatus:Wt,useFormState:Wt,useActionState:Wt,useOptimistic:Wt,useMemoCache:Wt,useCacheRefresh:Wt};Ri.useEffectEvent=Wt;var ph={readContext:wn,use:Yl,useCallback:function(n,a){return kn().memoizedState=[n,a===void 0?null:a],n},useContext:wn,useEffect:Wp,useImperativeHandle:function(n,a,l){l=l!=null?l.concat([n]):null,Xl(4194308,4,th.bind(null,a,n),l)},useLayoutEffect:function(n,a){return Xl(4194308,4,n,a)},useInsertionEffect:function(n,a){Xl(4,2,n,a)},useMemo:function(n,a){var l=kn();a=a===void 0?null:a;var d=n();if(qa){gn(!0);try{n()}finally{gn(!1)}}return l.memoizedState=[d,a],d},useReducer:function(n,a,l){var d=kn();if(l!==void 0){var g=l(a);if(qa){gn(!0);try{l(a)}finally{gn(!1)}}}else g=a;return d.memoizedState=d.baseState=g,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:g},d.queue=n,n=n.dispatch=UN.bind(null,Ke,n),[d.memoizedState,n]},useRef:function(n){var a=kn();return n={current:n},a.memoizedState=n},useState:function(n){n=uu(n);var a=n.queue,l=uh.bind(null,Ke,a);return a.dispatch=l,[n.memoizedState,l]},useDebugValue:pu,useDeferredValue:function(n,a){var l=kn();return hu(l,n,a)},useTransition:function(){var n=uu(!1);return n=oh.bind(null,Ke,n.queue,!0,!1),kn().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,a,l){var d=Ke,g=kn();if(dt){if(l===void 0)throw Error(o(407));l=l()}else{if(l=a(),Rt===null)throw Error(o(349));(lt&127)!==0||Up(d,a,l)}g.memoizedState=l;var y={value:l,getSnapshot:a};return g.queue=y,Wp(Lp.bind(null,d,y,n),[n]),d.flags|=2048,Mo(9,{destroy:void 0},Pp.bind(null,d,y,l,a),null),l},useId:function(){var n=kn(),a=Rt.identifierPrefix;if(dt){var l=Qs,d=Ws;l=(d&~(1<<32-sn(d)-1)).toString(32)+l,a="_"+a+"R_"+l,l=Bl++,0<l&&(a+="H"+l.toString(32)),a+="_"}else l=_N++,a="_"+a+"r_"+l.toString(32)+"_";return n.memoizedState=a},useHostTransitionStatus:gu,useFormState:$p,useActionState:$p,useOptimistic:function(n){var a=kn();a.memoizedState=a.baseState=n;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=l,a=vu.bind(null,Ke,!0,l),l.dispatch=a,[n,a]},useMemoCache:lu,useCacheRefresh:function(){return kn().memoizedState=DN.bind(null,Ke)},useEffectEvent:function(n){var a=kn(),l={impl:n};return a.memoizedState=l,function(){if((vt&2)!==0)throw Error(o(440));return l.impl.apply(void 0,arguments)}}},yu={readContext:wn,use:Yl,useCallback:sh,useContext:wn,useEffect:mu,useImperativeHandle:nh,useInsertionEffect:Zp,useLayoutEffect:eh,useMemo:rh,useReducer:Jl,useRef:Kp,useState:function(){return Jl(vr)},useDebugValue:pu,useDeferredValue:function(n,a){var l=nn();return ah(l,At.memoizedState,n,a)},useTransition:function(){var n=Jl(vr)[0],a=nn().memoizedState;return[typeof n=="boolean"?n:Ii(n),a]},useSyncExternalStore:Dp,useId:ch,useHostTransitionStatus:gu,useFormState:Yp,useActionState:Yp,useOptimistic:function(n,a){var l=nn();return Hp(l,At,n,a)},useMemoCache:lu,useCacheRefresh:dh};yu.useEffectEvent=Qp;var hh={readContext:wn,use:Yl,useCallback:sh,useContext:wn,useEffect:mu,useImperativeHandle:nh,useInsertionEffect:Zp,useLayoutEffect:eh,useMemo:rh,useReducer:du,useRef:Kp,useState:function(){return du(vr)},useDebugValue:pu,useDeferredValue:function(n,a){var l=nn();return At===null?hu(l,n,a):ah(l,At.memoizedState,n,a)},useTransition:function(){var n=du(vr)[0],a=nn().memoizedState;return[typeof n=="boolean"?n:Ii(n),a]},useSyncExternalStore:Dp,useId:ch,useHostTransitionStatus:gu,useFormState:Xp,useActionState:Xp,useOptimistic:function(n,a){var l=nn();return At!==null?Hp(l,At,n,a):(l.baseState=n,[n,l.queue.dispatch])},useMemoCache:lu,useCacheRefresh:dh};hh.useEffectEvent=Qp;function bu(n,a,l,d){a=n.memoizedState,l=l(d,a),l=l==null?a:b({},a,l),n.memoizedState=l,n.lanes===0&&(n.updateQueue.baseState=l)}var Nu={enqueueSetState:function(n,a,l){n=n._reactInternals;var d=is(),g=Xr(d);g.payload=a,l!=null&&(g.callback=l),a=Kr(n,g,d),a!==null&&(Bn(a,n,d),Ei(a,n,d))},enqueueReplaceState:function(n,a,l){n=n._reactInternals;var d=is(),g=Xr(d);g.tag=1,g.payload=a,l!=null&&(g.callback=l),a=Kr(n,g,d),a!==null&&(Bn(a,n,d),Ei(a,n,d))},enqueueForceUpdate:function(n,a){n=n._reactInternals;var l=is(),d=Xr(l);d.tag=2,a!=null&&(d.callback=a),a=Kr(n,d,l),a!==null&&(Bn(a,n,l),Ei(a,n,l))}};function xh(n,a,l,d,g,y,S){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(d,y,S):a.prototype&&a.prototype.isPureReactComponent?!yi(l,d)||!yi(g,y):!0}function gh(n,a,l,d){n=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(l,d),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(l,d),a.state!==n&&Nu.enqueueReplaceState(a,a.state,null)}function Fa(n,a){var l=a;if("ref"in a){l={};for(var d in a)d!=="ref"&&(l[d]=a[d])}if(n=n.defaultProps){l===a&&(l=b({},l));for(var g in n)l[g]===void 0&&(l[g]=n[g])}return l}function vh(n){Al(n)}function yh(n){console.error(n)}function bh(n){Al(n)}function Ql(n,a){try{var l=n.onUncaughtError;l(a.value,{componentStack:a.stack})}catch(d){setTimeout(function(){throw d})}}function Nh(n,a,l){try{var d=n.onCaughtError;d(l.value,{componentStack:l.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function wu(n,a,l){return l=Xr(l),l.tag=3,l.payload={element:null},l.callback=function(){Ql(n,a)},l}function wh(n){return n=Xr(n),n.tag=3,n}function Sh(n,a,l,d){var g=l.type.getDerivedStateFromError;if(typeof g=="function"){var y=d.value;n.payload=function(){return g(y)},n.callback=function(){Nh(a,l,d)}}var S=l.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(n.callback=function(){Nh(a,l,d),typeof g!="function"&&(na===null?na=new Set([this]):na.add(this));var C=d.stack;this.componentDidCatch(d.value,{componentStack:C!==null?C:""})})}function PN(n,a,l,d,g){if(l.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(a=l.alternate,a!==null&&jo(a,l,g,!0),l=ss.current,l!==null){switch(l.tag){case 31:case 13:return Ts===null?dc():l.alternate===null&&Qt===0&&(Qt=3),l.flags&=-257,l.flags|=65536,l.lanes=g,d===Gl?l.flags|=16384:(a=l.updateQueue,a===null?l.updateQueue=new Set([d]):a.add(d),Yu(n,d,g)),!1;case 22:return l.flags|=65536,d===Gl?l.flags|=16384:(a=l.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([d])},l.updateQueue=a):(l=a.retryQueue,l===null?a.retryQueue=new Set([d]):l.add(d)),Yu(n,d,g)),!1}throw Error(o(435,l.tag))}return Yu(n,d,g),dc(),!1}if(dt)return a=ss.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=g,d!==Od&&(n=Error(o(422),{cause:d}),wi(Ns(n,l)))):(d!==Od&&(a=Error(o(423),{cause:d}),wi(Ns(a,l))),n=n.current.alternate,n.flags|=65536,g&=-g,n.lanes|=g,d=Ns(d,l),g=wu(n.stateNode,d,g),Qd(n,g),Qt!==4&&(Qt=2)),!1;var y=Error(o(520),{cause:d});if(y=Ns(y,l),Oi===null?Oi=[y]:Oi.push(y),Qt!==4&&(Qt=2),a===null)return!0;d=Ns(d,l),l=a;do{switch(l.tag){case 3:return l.flags|=65536,n=g&-g,l.lanes|=n,n=wu(l.stateNode,d,n),Qd(l,n),!1;case 1:if(a=l.type,y=l.stateNode,(l.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(na===null||!na.has(y))))return l.flags|=65536,g&=-g,l.lanes|=g,g=wh(g),Sh(g,n,l,d),Qd(l,g),!1}l=l.return}while(l!==null);return!1}var Su=Error(o(461)),on=!1;function Sn(n,a,l,d){a.child=n===null?Ep(a,null,l,d):Oa(a,n.child,l,d)}function jh(n,a,l,d,g){l=l.render;var y=a.ref;if("ref"in d){var S={};for(var C in d)C!=="ref"&&(S[C]=d[C])}else S=d;return La(a),d=ru(n,a,l,S,y,g),C=au(),n!==null&&!on?(ou(n,a,g),yr(n,a,g)):(dt&&C&&Gd(a),a.flags|=1,Sn(n,a,d,g),a.child)}function Th(n,a,l,d,g){if(n===null){var y=l.type;return typeof y=="function"&&!Pd(y)&&y.defaultProps===void 0&&l.compare===null?(a.tag=15,a.type=y,Ch(n,a,y,d,g)):(n=Rl(l.type,null,d,a,a.mode,g),n.ref=a.ref,n.return=a,a.child=n)}if(y=n.child,!Iu(n,g)){var S=y.memoizedProps;if(l=l.compare,l=l!==null?l:yi,l(S,d)&&n.ref===a.ref)return yr(n,a,g)}return a.flags|=1,n=mr(y,d),n.ref=a.ref,n.return=a,a.child=n}function Ch(n,a,l,d,g){if(n!==null){var y=n.memoizedProps;if(yi(y,d)&&n.ref===a.ref)if(on=!1,a.pendingProps=d=y,Iu(n,g))(n.flags&131072)!==0&&(on=!0);else return a.lanes=n.lanes,yr(n,a,g)}return ju(n,a,l,d,g)}function Eh(n,a,l,d){var g=d.children,y=n!==null?n.memoizedState:null;if(n===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),d.mode==="hidden"){if((a.flags&128)!==0){if(y=y!==null?y.baseLanes|l:l,n!==null){for(d=a.child=n.child,g=0;d!==null;)g=g|d.lanes|d.childLanes,d=d.sibling;d=g&~y}else d=0,a.child=null;return _h(n,a,y,l,d)}if((l&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},n!==null&&Ll(a,y!==null?y.cachePool:null),y!==null?kp(a,y):eu(),Ip(a);else return d=a.lanes=536870912,_h(n,a,y!==null?y.baseLanes|l:l,l,d)}else y!==null?(Ll(a,y.cachePool),kp(a,y),Qr(),a.memoizedState=null):(n!==null&&Ll(a,null),eu(),Qr());return Sn(n,a,g,l),a.child}function Di(n,a){return n!==null&&n.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function _h(n,a,l,d,g){var y=Jd();return y=y===null?null:{parent:rn._currentValue,pool:y},a.memoizedState={baseLanes:l,cachePool:y},n!==null&&Ll(a,null),eu(),Ip(a),n!==null&&jo(n,a,d,!0),a.childLanes=g,null}function Zl(n,a){return a=tc({mode:a.mode,children:a.children},n.mode),a.ref=n.ref,n.child=a,a.return=n,a}function Ah(n,a,l){return Oa(a,n.child,null,l),n=Zl(a,a.pendingProps),n.flags|=2,rs(a),a.memoizedState=null,n}function LN(n,a,l){var d=a.pendingProps,g=(a.flags&128)!==0;if(a.flags&=-129,n===null){if(dt){if(d.mode==="hidden")return n=Zl(a,d),a.lanes=536870912,Di(null,n);if(nu(a),(n=Ht)?(n=Ox(n,js),n=n!==null&&n.data==="&"?n:null,n!==null&&(a.memoizedState={dehydrated:n,treeContext:Vr!==null?{id:Ws,overflow:Qs}:null,retryLane:536870912,hydrationErrors:null},l=fp(n),l.return=a,a.child=l,Nn=a,Ht=null)):n=null,n===null)throw $r(a);return a.lanes=536870912,null}return Zl(a,d)}var y=n.memoizedState;if(y!==null){var S=y.dehydrated;if(nu(a),g)if(a.flags&256)a.flags&=-257,a=Ah(n,a,l);else if(a.memoizedState!==null)a.child=n.child,a.flags|=128,a=null;else throw Error(o(558));else if(on||jo(n,a,l,!1),g=(l&n.childLanes)!==0,on||g){if(d=Rt,d!==null&&(S=wa(d,l),S!==0&&S!==y.retryLane))throw y.retryLane=S,Ra(n,S),Bn(d,n,S),Su;dc(),a=Ah(n,a,l)}else n=y.treeContext,Ht=Cs(S.nextSibling),Nn=a,dt=!0,Br=null,js=!1,n!==null&&hp(a,n),a=Zl(a,d),a.flags|=4096;return a}return n=mr(n.child,{mode:d.mode,children:d.children}),n.ref=a.ref,a.child=n,n.return=a,n}function ec(n,a){var l=a.ref;if(l===null)n!==null&&n.ref!==null&&(a.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(o(284));(n===null||n.ref!==l)&&(a.flags|=4194816)}}function ju(n,a,l,d,g){return La(a),l=ru(n,a,l,d,void 0,g),d=au(),n!==null&&!on?(ou(n,a,g),yr(n,a,g)):(dt&&d&&Gd(a),a.flags|=1,Sn(n,a,l,g),a.child)}function kh(n,a,l,d,g,y){return La(a),a.updateQueue=null,l=Rp(a,d,l,g),Mp(n),d=au(),n!==null&&!on?(ou(n,a,y),yr(n,a,y)):(dt&&d&&Gd(a),a.flags|=1,Sn(n,a,l,y),a.child)}function Ih(n,a,l,d,g){if(La(a),a.stateNode===null){var y=bo,S=l.contextType;typeof S=="object"&&S!==null&&(y=wn(S)),y=new l(d,y),a.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Nu,a.stateNode=y,y._reactInternals=a,y=a.stateNode,y.props=d,y.state=a.memoizedState,y.refs={},Kd(a),S=l.contextType,y.context=typeof S=="object"&&S!==null?wn(S):bo,y.state=a.memoizedState,S=l.getDerivedStateFromProps,typeof S=="function"&&(bu(a,l,S,d),y.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(S=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),S!==y.state&&Nu.enqueueReplaceState(y,y.state,null),Ai(a,d,y,g),_i(),y.state=a.memoizedState),typeof y.componentDidMount=="function"&&(a.flags|=4194308),d=!0}else if(n===null){y=a.stateNode;var C=a.memoizedProps,U=Fa(l,C);y.props=U;var te=y.context,fe=l.contextType;S=bo,typeof fe=="object"&&fe!==null&&(S=wn(fe));var ve=l.getDerivedStateFromProps;fe=typeof ve=="function"||typeof y.getSnapshotBeforeUpdate=="function",C=a.pendingProps!==C,fe||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(C||te!==S)&&gh(a,y,d,S),Jr=!1;var ie=a.memoizedState;y.state=ie,Ai(a,d,y,g),_i(),te=a.memoizedState,C||ie!==te||Jr?(typeof ve=="function"&&(bu(a,l,ve,d),te=a.memoizedState),(U=Jr||xh(a,l,U,d,ie,te,S))?(fe||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(a.flags|=4194308)):(typeof y.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=d,a.memoizedState=te),y.props=d,y.state=te,y.context=S,d=U):(typeof y.componentDidMount=="function"&&(a.flags|=4194308),d=!1)}else{y=a.stateNode,Wd(n,a),S=a.memoizedProps,fe=Fa(l,S),y.props=fe,ve=a.pendingProps,ie=y.context,te=l.contextType,U=bo,typeof te=="object"&&te!==null&&(U=wn(te)),C=l.getDerivedStateFromProps,(te=typeof C=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(S!==ve||ie!==U)&&gh(a,y,d,U),Jr=!1,ie=a.memoizedState,y.state=ie,Ai(a,d,y,g),_i();var ce=a.memoizedState;S!==ve||ie!==ce||Jr||n!==null&&n.dependencies!==null&&Ul(n.dependencies)?(typeof C=="function"&&(bu(a,l,C,d),ce=a.memoizedState),(fe=Jr||xh(a,l,fe,d,ie,ce,U)||n!==null&&n.dependencies!==null&&Ul(n.dependencies))?(te||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(d,ce,U),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(d,ce,U)),typeof y.componentDidUpdate=="function"&&(a.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof y.componentDidUpdate!="function"||S===n.memoizedProps&&ie===n.memoizedState||(a.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||S===n.memoizedProps&&ie===n.memoizedState||(a.flags|=1024),a.memoizedProps=d,a.memoizedState=ce),y.props=d,y.state=ce,y.context=U,d=fe):(typeof y.componentDidUpdate!="function"||S===n.memoizedProps&&ie===n.memoizedState||(a.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||S===n.memoizedProps&&ie===n.memoizedState||(a.flags|=1024),d=!1)}return y=d,ec(n,a),d=(a.flags&128)!==0,y||d?(y=a.stateNode,l=d&&typeof l.getDerivedStateFromError!="function"?null:y.render(),a.flags|=1,n!==null&&d?(a.child=Oa(a,n.child,null,g),a.child=Oa(a,null,l,g)):Sn(n,a,l,g),a.memoizedState=y.state,n=a.child):n=yr(n,a,g),n}function Mh(n,a,l,d){return Ua(),a.flags|=256,Sn(n,a,l,d),a.child}var Tu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Cu(n){return{baseLanes:n,cachePool:Np()}}function Eu(n,a,l){return n=n!==null?n.childLanes&~l:0,a&&(n|=os),n}function Rh(n,a,l){var d=a.pendingProps,g=!1,y=(a.flags&128)!==0,S;if((S=y)||(S=n!==null&&n.memoizedState===null?!1:(tn.current&2)!==0),S&&(g=!0,a.flags&=-129),S=(a.flags&32)!==0,a.flags&=-33,n===null){if(dt){if(g?Wr(a):Qr(),(n=Ht)?(n=Ox(n,js),n=n!==null&&n.data!=="&"?n:null,n!==null&&(a.memoizedState={dehydrated:n,treeContext:Vr!==null?{id:Ws,overflow:Qs}:null,retryLane:536870912,hydrationErrors:null},l=fp(n),l.return=a,a.child=l,Nn=a,Ht=null)):n=null,n===null)throw $r(a);return df(n)?a.lanes=32:a.lanes=536870912,null}var C=d.children;return d=d.fallback,g?(Qr(),g=a.mode,C=tc({mode:"hidden",children:C},g),d=Da(d,g,l,null),C.return=a,d.return=a,C.sibling=d,a.child=C,d=a.child,d.memoizedState=Cu(l),d.childLanes=Eu(n,S,l),a.memoizedState=Tu,Di(null,d)):(Wr(a),_u(a,C))}var U=n.memoizedState;if(U!==null&&(C=U.dehydrated,C!==null)){if(y)a.flags&256?(Wr(a),a.flags&=-257,a=Au(n,a,l)):a.memoizedState!==null?(Qr(),a.child=n.child,a.flags|=128,a=null):(Qr(),C=d.fallback,g=a.mode,d=tc({mode:"visible",children:d.children},g),C=Da(C,g,l,null),C.flags|=2,d.return=a,C.return=a,d.sibling=C,a.child=d,Oa(a,n.child,null,l),d=a.child,d.memoizedState=Cu(l),d.childLanes=Eu(n,S,l),a.memoizedState=Tu,a=Di(null,d));else if(Wr(a),df(C)){if(S=C.nextSibling&&C.nextSibling.dataset,S)var te=S.dgst;S=te,d=Error(o(419)),d.stack="",d.digest=S,wi({value:d,source:null,stack:null}),a=Au(n,a,l)}else if(on||jo(n,a,l,!1),S=(l&n.childLanes)!==0,on||S){if(S=Rt,S!==null&&(d=wa(S,l),d!==0&&d!==U.retryLane))throw U.retryLane=d,Ra(n,d),Bn(S,n,d),Su;cf(C)||dc(),a=Au(n,a,l)}else cf(C)?(a.flags|=192,a.child=n.child,a=null):(n=U.treeContext,Ht=Cs(C.nextSibling),Nn=a,dt=!0,Br=null,js=!1,n!==null&&hp(a,n),a=_u(a,d.children),a.flags|=4096);return a}return g?(Qr(),C=d.fallback,g=a.mode,U=n.child,te=U.sibling,d=mr(U,{mode:"hidden",children:d.children}),d.subtreeFlags=U.subtreeFlags&65011712,te!==null?C=mr(te,C):(C=Da(C,g,l,null),C.flags|=2),C.return=a,d.return=a,d.sibling=C,a.child=d,Di(null,d),d=a.child,C=n.child.memoizedState,C===null?C=Cu(l):(g=C.cachePool,g!==null?(U=rn._currentValue,g=g.parent!==U?{parent:U,pool:U}:g):g=Np(),C={baseLanes:C.baseLanes|l,cachePool:g}),d.memoizedState=C,d.childLanes=Eu(n,S,l),a.memoizedState=Tu,Di(n.child,d)):(Wr(a),l=n.child,n=l.sibling,l=mr(l,{mode:"visible",children:d.children}),l.return=a,l.sibling=null,n!==null&&(S=a.deletions,S===null?(a.deletions=[n],a.flags|=16):S.push(n)),a.child=l,a.memoizedState=null,l)}function _u(n,a){return a=tc({mode:"visible",children:a},n.mode),a.return=n,n.child=a}function tc(n,a){return n=ns(22,n,null,a),n.lanes=0,n}function Au(n,a,l){return Oa(a,n.child,null,l),n=_u(a,a.pendingProps.children),n.flags|=2,a.memoizedState=null,n}function Dh(n,a,l){n.lanes|=a;var d=n.alternate;d!==null&&(d.lanes|=a),Vd(n.return,a,l)}function ku(n,a,l,d,g,y){var S=n.memoizedState;S===null?n.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:d,tail:l,tailMode:g,treeForkCount:y}:(S.isBackwards=a,S.rendering=null,S.renderingStartTime=0,S.last=d,S.tail=l,S.tailMode=g,S.treeForkCount=y)}function Uh(n,a,l){var d=a.pendingProps,g=d.revealOrder,y=d.tail;d=d.children;var S=tn.current,C=(S&2)!==0;if(C?(S=S&1|2,a.flags|=128):S&=1,J(tn,S),Sn(n,a,d,l),d=dt?Ni:0,!C&&n!==null&&(n.flags&128)!==0)e:for(n=a.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Dh(n,l,a);else if(n.tag===19)Dh(n,l,a);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===a)break e;for(;n.sibling===null;){if(n.return===null||n.return===a)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(g){case"forwards":for(l=a.child,g=null;l!==null;)n=l.alternate,n!==null&&Fl(n)===null&&(g=l),l=l.sibling;l=g,l===null?(g=a.child,a.child=null):(g=l.sibling,l.sibling=null),ku(a,!1,g,l,y,d);break;case"backwards":case"unstable_legacy-backwards":for(l=null,g=a.child,a.child=null;g!==null;){if(n=g.alternate,n!==null&&Fl(n)===null){a.child=g;break}n=g.sibling,g.sibling=l,l=g,g=n}ku(a,!0,l,null,y,d);break;case"together":ku(a,!1,null,null,void 0,d);break;default:a.memoizedState=null}return a.child}function yr(n,a,l){if(n!==null&&(a.dependencies=n.dependencies),ta|=a.lanes,(l&a.childLanes)===0)if(n!==null){if(jo(n,a,l,!1),(l&a.childLanes)===0)return null}else return null;if(n!==null&&a.child!==n.child)throw Error(o(153));if(a.child!==null){for(n=a.child,l=mr(n,n.pendingProps),a.child=l,l.return=a;n.sibling!==null;)n=n.sibling,l=l.sibling=mr(n,n.pendingProps),l.return=a;l.sibling=null}return a.child}function Iu(n,a){return(n.lanes&a)!==0?!0:(n=n.dependencies,!!(n!==null&&Ul(n)))}function zN(n,a,l){switch(a.tag){case 3:De(a,a.stateNode.containerInfo),Yr(a,rn,n.memoizedState.cache),Ua();break;case 27:case 5:ut(a);break;case 4:De(a,a.stateNode.containerInfo);break;case 10:Yr(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,nu(a),null;break;case 13:var d=a.memoizedState;if(d!==null)return d.dehydrated!==null?(Wr(a),a.flags|=128,null):(l&a.child.childLanes)!==0?Rh(n,a,l):(Wr(a),n=yr(n,a,l),n!==null?n.sibling:null);Wr(a);break;case 19:var g=(n.flags&128)!==0;if(d=(l&a.childLanes)!==0,d||(jo(n,a,l,!1),d=(l&a.childLanes)!==0),g){if(d)return Uh(n,a,l);a.flags|=128}if(g=a.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),J(tn,tn.current),d)break;return null;case 22:return a.lanes=0,Eh(n,a,l,a.pendingProps);case 24:Yr(a,rn,n.memoizedState.cache)}return yr(n,a,l)}function Ph(n,a,l){if(n!==null)if(n.memoizedProps!==a.pendingProps)on=!0;else{if(!Iu(n,l)&&(a.flags&128)===0)return on=!1,zN(n,a,l);on=(n.flags&131072)!==0}else on=!1,dt&&(a.flags&1048576)!==0&&pp(a,Ni,a.index);switch(a.lanes=0,a.tag){case 16:e:{var d=a.pendingProps;if(n=Ga(a.elementType),a.type=n,typeof n=="function")Pd(n)?(d=Fa(n,d),a.tag=1,a=Ih(null,a,n,d,l)):(a.tag=0,a=ju(null,a,n,d,l));else{if(n!=null){var g=n.$$typeof;if(g===M){a.tag=11,a=jh(null,a,n,d,l);break e}else if(g===X){a.tag=14,a=Th(null,a,n,d,l);break e}}throw a=he(n)||n,Error(o(306,a,""))}}return a;case 0:return ju(n,a,a.type,a.pendingProps,l);case 1:return d=a.type,g=Fa(d,a.pendingProps),Ih(n,a,d,g,l);case 3:e:{if(De(a,a.stateNode.containerInfo),n===null)throw Error(o(387));d=a.pendingProps;var y=a.memoizedState;g=y.element,Wd(n,a),Ai(a,d,null,l);var S=a.memoizedState;if(d=S.cache,Yr(a,rn,d),d!==y.cache&&Bd(a,[rn],l,!0),_i(),d=S.element,y.isDehydrated)if(y={element:d,isDehydrated:!1,cache:S.cache},a.updateQueue.baseState=y,a.memoizedState=y,a.flags&256){a=Mh(n,a,d,l);break e}else if(d!==g){g=Ns(Error(o(424)),a),wi(g),a=Mh(n,a,d,l);break e}else{switch(n=a.stateNode.containerInfo,n.nodeType){case 9:n=n.body;break;default:n=n.nodeName==="HTML"?n.ownerDocument.body:n}for(Ht=Cs(n.firstChild),Nn=a,dt=!0,Br=null,js=!0,l=Ep(a,null,d,l),a.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Ua(),d===g){a=yr(n,a,l);break e}Sn(n,a,d,l)}a=a.child}return a;case 26:return ec(n,a),n===null?(l=Yx(a.type,null,a.pendingProps,null))?a.memoizedState=l:dt||(l=a.type,n=a.pendingProps,d=gc(me.current).createElement(l),d[Bt]=a,d[wt]=n,jn(d,l,n),Gt(d),a.stateNode=d):a.memoizedState=Yx(a.type,n.memoizedProps,a.pendingProps,n.memoizedState),null;case 27:return ut(a),n===null&&dt&&(d=a.stateNode=Vx(a.type,a.pendingProps,me.current),Nn=a,js=!0,g=Ht,oa(a.type)?(uf=g,Ht=Cs(d.firstChild)):Ht=g),Sn(n,a,a.pendingProps.children,l),ec(n,a),n===null&&(a.flags|=4194304),a.child;case 5:return n===null&&dt&&((g=d=Ht)&&(d=pw(d,a.type,a.pendingProps,js),d!==null?(a.stateNode=d,Nn=a,Ht=Cs(d.firstChild),js=!1,g=!0):g=!1),g||$r(a)),ut(a),g=a.type,y=a.pendingProps,S=n!==null?n.memoizedProps:null,d=y.children,af(g,y)?d=null:S!==null&&af(g,S)&&(a.flags|=32),a.memoizedState!==null&&(g=ru(n,a,AN,null,null,l),Xi._currentValue=g),ec(n,a),Sn(n,a,d,l),a.child;case 6:return n===null&&dt&&((n=l=Ht)&&(l=hw(l,a.pendingProps,js),l!==null?(a.stateNode=l,Nn=a,Ht=null,n=!0):n=!1),n||$r(a)),null;case 13:return Rh(n,a,l);case 4:return De(a,a.stateNode.containerInfo),d=a.pendingProps,n===null?a.child=Oa(a,null,d,l):Sn(n,a,d,l),a.child;case 11:return jh(n,a,a.type,a.pendingProps,l);case 7:return Sn(n,a,a.pendingProps,l),a.child;case 8:return Sn(n,a,a.pendingProps.children,l),a.child;case 12:return Sn(n,a,a.pendingProps.children,l),a.child;case 10:return d=a.pendingProps,Yr(a,a.type,d.value),Sn(n,a,d.children,l),a.child;case 9:return g=a.type._context,d=a.pendingProps.children,La(a),g=wn(g),d=d(g),a.flags|=1,Sn(n,a,d,l),a.child;case 14:return Th(n,a,a.type,a.pendingProps,l);case 15:return Ch(n,a,a.type,a.pendingProps,l);case 19:return Uh(n,a,l);case 31:return LN(n,a,l);case 22:return Eh(n,a,l,a.pendingProps);case 24:return La(a),d=wn(rn),n===null?(g=Jd(),g===null&&(g=Rt,y=$d(),g.pooledCache=y,y.refCount++,y!==null&&(g.pooledCacheLanes|=l),g=y),a.memoizedState={parent:d,cache:g},Kd(a),Yr(a,rn,g)):((n.lanes&l)!==0&&(Wd(n,a),Ai(a,null,null,l),_i()),g=n.memoizedState,y=a.memoizedState,g.parent!==d?(g={parent:d,cache:d},a.memoizedState=g,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=g),Yr(a,rn,d)):(d=y.cache,Yr(a,rn,d),d!==g.cache&&Bd(a,[rn],l,!0))),Sn(n,a,a.pendingProps.children,l),a.child;case 29:throw a.pendingProps}throw Error(o(156,a.tag))}function br(n){n.flags|=4}function Mu(n,a,l,d,g){if((a=(n.mode&32)!==0)&&(a=!1),a){if(n.flags|=16777216,(g&335544128)===g)if(n.stateNode.complete)n.flags|=8192;else if(cx())n.flags|=8192;else throw Ha=Gl,Xd}else n.flags&=-16777217}function Lh(n,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!Qx(a))if(cx())n.flags|=8192;else throw Ha=Gl,Xd}function nc(n,a){a!==null&&(n.flags|=4),n.flags&16384&&(a=n.tag!==22?Jn():536870912,n.lanes|=a,Po|=a)}function Ui(n,a){if(!dt)switch(n.tailMode){case"hidden":a=n.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?n.tail=null:l.sibling=null;break;case"collapsed":l=n.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?a||n.tail===null?n.tail=null:n.tail.sibling=null:d.sibling=null}}function Ot(n){var a=n.alternate!==null&&n.alternate.child===n.child,l=0,d=0;if(a)for(var g=n.child;g!==null;)l|=g.lanes|g.childLanes,d|=g.subtreeFlags&65011712,d|=g.flags&65011712,g.return=n,g=g.sibling;else for(g=n.child;g!==null;)l|=g.lanes|g.childLanes,d|=g.subtreeFlags,d|=g.flags,g.return=n,g=g.sibling;return n.subtreeFlags|=d,n.childLanes=l,a}function GN(n,a,l){var d=a.pendingProps;switch(Hd(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ot(a),null;case 1:return Ot(a),null;case 3:return l=a.stateNode,d=null,n!==null&&(d=n.memoizedState.cache),a.memoizedState.cache!==d&&(a.flags|=2048),xr(rn),Ee(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(n===null||n.child===null)&&(So(a)?br(a):n===null||n.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,qd())),Ot(a),null;case 26:var g=a.type,y=a.memoizedState;return n===null?(br(a),y!==null?(Ot(a),Lh(a,y)):(Ot(a),Mu(a,g,null,d,l))):y?y!==n.memoizedState?(br(a),Ot(a),Lh(a,y)):(Ot(a),a.flags&=-16777217):(n=n.memoizedProps,n!==d&&br(a),Ot(a),Mu(a,g,n,d,l)),null;case 27:if(He(a),l=me.current,g=a.type,n!==null&&a.stateNode!=null)n.memoizedProps!==d&&br(a);else{if(!d){if(a.stateNode===null)throw Error(o(166));return Ot(a),null}n=we.current,So(a)?xp(a):(n=Vx(g,d,l),a.stateNode=n,br(a))}return Ot(a),null;case 5:if(He(a),g=a.type,n!==null&&a.stateNode!=null)n.memoizedProps!==d&&br(a);else{if(!d){if(a.stateNode===null)throw Error(o(166));return Ot(a),null}if(y=we.current,So(a))xp(a);else{var S=gc(me.current);switch(y){case 1:y=S.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:y=S.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":y=S.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":y=S.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":y=S.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof d.is=="string"?S.createElement("select",{is:d.is}):S.createElement("select"),d.multiple?y.multiple=!0:d.size&&(y.size=d.size);break;default:y=typeof d.is=="string"?S.createElement(g,{is:d.is}):S.createElement(g)}}y[Bt]=a,y[wt]=d;e:for(S=a.child;S!==null;){if(S.tag===5||S.tag===6)y.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===a)break e;for(;S.sibling===null;){if(S.return===null||S.return===a)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}a.stateNode=y;e:switch(jn(y,g,d),g){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}d&&br(a)}}return Ot(a),Mu(a,a.type,n===null?null:n.memoizedProps,a.pendingProps,l),null;case 6:if(n&&a.stateNode!=null)n.memoizedProps!==d&&br(a);else{if(typeof d!="string"&&a.stateNode===null)throw Error(o(166));if(n=me.current,So(a)){if(n=a.stateNode,l=a.memoizedProps,d=null,g=Nn,g!==null)switch(g.tag){case 27:case 5:d=g.memoizedProps}n[Bt]=a,n=!!(n.nodeValue===l||d!==null&&d.suppressHydrationWarning===!0||Rx(n.nodeValue,l)),n||$r(a,!0)}else n=gc(n).createTextNode(d),n[Bt]=a,a.stateNode=n}return Ot(a),null;case 31:if(l=a.memoizedState,n===null||n.memoizedState!==null){if(d=So(a),l!==null){if(n===null){if(!d)throw Error(o(318));if(n=a.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(o(557));n[Bt]=a}else Ua(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Ot(a),n=!1}else l=qd(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=l),n=!0;if(!n)return a.flags&256?(rs(a),a):(rs(a),null);if((a.flags&128)!==0)throw Error(o(558))}return Ot(a),null;case 13:if(d=a.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(g=So(a),d!==null&&d.dehydrated!==null){if(n===null){if(!g)throw Error(o(318));if(g=a.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(o(317));g[Bt]=a}else Ua(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Ot(a),g=!1}else g=qd(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=g),g=!0;if(!g)return a.flags&256?(rs(a),a):(rs(a),null)}return rs(a),(a.flags&128)!==0?(a.lanes=l,a):(l=d!==null,n=n!==null&&n.memoizedState!==null,l&&(d=a.child,g=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(g=d.alternate.memoizedState.cachePool.pool),y=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(y=d.memoizedState.cachePool.pool),y!==g&&(d.flags|=2048)),l!==n&&l&&(a.child.flags|=8192),nc(a,a.updateQueue),Ot(a),null);case 4:return Ee(),n===null&&ef(a.stateNode.containerInfo),Ot(a),null;case 10:return xr(a.type),Ot(a),null;case 19:if(je(tn),d=a.memoizedState,d===null)return Ot(a),null;if(g=(a.flags&128)!==0,y=d.rendering,y===null)if(g)Ui(d,!1);else{if(Qt!==0||n!==null&&(n.flags&128)!==0)for(n=a.child;n!==null;){if(y=Fl(n),y!==null){for(a.flags|=128,Ui(d,!1),n=y.updateQueue,a.updateQueue=n,nc(a,n),a.subtreeFlags=0,n=l,l=a.child;l!==null;)up(l,n),l=l.sibling;return J(tn,tn.current&1|2),dt&&pr(a,d.treeForkCount),a.child}n=n.sibling}d.tail!==null&&Q()>ic&&(a.flags|=128,g=!0,Ui(d,!1),a.lanes=4194304)}else{if(!g)if(n=Fl(y),n!==null){if(a.flags|=128,g=!0,n=n.updateQueue,a.updateQueue=n,nc(a,n),Ui(d,!0),d.tail===null&&d.tailMode==="hidden"&&!y.alternate&&!dt)return Ot(a),null}else 2*Q()-d.renderingStartTime>ic&&l!==536870912&&(a.flags|=128,g=!0,Ui(d,!1),a.lanes=4194304);d.isBackwards?(y.sibling=a.child,a.child=y):(n=d.last,n!==null?n.sibling=y:a.child=y,d.last=y)}return d.tail!==null?(n=d.tail,d.rendering=n,d.tail=n.sibling,d.renderingStartTime=Q(),n.sibling=null,l=tn.current,J(tn,g?l&1|2:l&1),dt&&pr(a,d.treeForkCount),n):(Ot(a),null);case 22:case 23:return rs(a),tu(),d=a.memoizedState!==null,n!==null?n.memoizedState!==null!==d&&(a.flags|=8192):d&&(a.flags|=8192),d?(l&536870912)!==0&&(a.flags&128)===0&&(Ot(a),a.subtreeFlags&6&&(a.flags|=8192)):Ot(a),l=a.updateQueue,l!==null&&nc(a,l.retryQueue),l=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(l=n.memoizedState.cachePool.pool),d=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(d=a.memoizedState.cachePool.pool),d!==l&&(a.flags|=2048),n!==null&&je(za),null;case 24:return l=null,n!==null&&(l=n.memoizedState.cache),a.memoizedState.cache!==l&&(a.flags|=2048),xr(rn),Ot(a),null;case 25:return null;case 30:return null}throw Error(o(156,a.tag))}function HN(n,a){switch(Hd(a),a.tag){case 1:return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 3:return xr(rn),Ee(),n=a.flags,(n&65536)!==0&&(n&128)===0?(a.flags=n&-65537|128,a):null;case 26:case 27:case 5:return He(a),null;case 31:if(a.memoizedState!==null){if(rs(a),a.alternate===null)throw Error(o(340));Ua()}return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 13:if(rs(a),n=a.memoizedState,n!==null&&n.dehydrated!==null){if(a.alternate===null)throw Error(o(340));Ua()}return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 19:return je(tn),null;case 4:return Ee(),null;case 10:return xr(a.type),null;case 22:case 23:return rs(a),tu(),n!==null&&je(za),n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 24:return xr(rn),null;case 25:return null;default:return null}}function zh(n,a){switch(Hd(a),a.tag){case 3:xr(rn),Ee();break;case 26:case 27:case 5:He(a);break;case 4:Ee();break;case 31:a.memoizedState!==null&&rs(a);break;case 13:rs(a);break;case 19:je(tn);break;case 10:xr(a.type);break;case 22:case 23:rs(a),tu(),n!==null&&je(za);break;case 24:xr(rn)}}function Pi(n,a){try{var l=a.updateQueue,d=l!==null?l.lastEffect:null;if(d!==null){var g=d.next;l=g;do{if((l.tag&n)===n){d=void 0;var y=l.create,S=l.inst;d=y(),S.destroy=d}l=l.next}while(l!==g)}}catch(C){Tt(a,a.return,C)}}function Zr(n,a,l){try{var d=a.updateQueue,g=d!==null?d.lastEffect:null;if(g!==null){var y=g.next;d=y;do{if((d.tag&n)===n){var S=d.inst,C=S.destroy;if(C!==void 0){S.destroy=void 0,g=a;var U=l,te=C;try{te()}catch(fe){Tt(g,U,fe)}}}d=d.next}while(d!==y)}}catch(fe){Tt(a,a.return,fe)}}function Gh(n){var a=n.updateQueue;if(a!==null){var l=n.stateNode;try{Ap(a,l)}catch(d){Tt(n,n.return,d)}}}function Hh(n,a,l){l.props=Fa(n.type,n.memoizedProps),l.state=n.memoizedState;try{l.componentWillUnmount()}catch(d){Tt(n,a,d)}}function Li(n,a){try{var l=n.ref;if(l!==null){switch(n.tag){case 26:case 27:case 5:var d=n.stateNode;break;case 30:d=n.stateNode;break;default:d=n.stateNode}typeof l=="function"?n.refCleanup=l(d):l.current=d}}catch(g){Tt(n,a,g)}}function Zs(n,a){var l=n.ref,d=n.refCleanup;if(l!==null)if(typeof d=="function")try{d()}catch(g){Tt(n,a,g)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(g){Tt(n,a,g)}else l.current=null}function Oh(n){var a=n.type,l=n.memoizedProps,d=n.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":l.autoFocus&&d.focus();break e;case"img":l.src?d.src=l.src:l.srcSet&&(d.srcset=l.srcSet)}}catch(g){Tt(n,n.return,g)}}function Ru(n,a,l){try{var d=n.stateNode;lw(d,n.type,l,a),d[wt]=a}catch(g){Tt(n,n.return,g)}}function qh(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&oa(n.type)||n.tag===4}function Du(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||qh(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&oa(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Uu(n,a,l){var d=n.tag;if(d===5||d===6)n=n.stateNode,a?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(n,a):(a=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,a.appendChild(n),l=l._reactRootContainer,l!=null||a.onclick!==null||(a.onclick=Us));else if(d!==4&&(d===27&&oa(n.type)&&(l=n.stateNode,a=null),n=n.child,n!==null))for(Uu(n,a,l),n=n.sibling;n!==null;)Uu(n,a,l),n=n.sibling}function sc(n,a,l){var d=n.tag;if(d===5||d===6)n=n.stateNode,a?l.insertBefore(n,a):l.appendChild(n);else if(d!==4&&(d===27&&oa(n.type)&&(l=n.stateNode),n=n.child,n!==null))for(sc(n,a,l),n=n.sibling;n!==null;)sc(n,a,l),n=n.sibling}function Fh(n){var a=n.stateNode,l=n.memoizedProps;try{for(var d=n.type,g=a.attributes;g.length;)a.removeAttributeNode(g[0]);jn(a,d,l),a[Bt]=n,a[wt]=l}catch(y){Tt(n,n.return,y)}}var Nr=!1,ln=!1,Pu=!1,Vh=typeof WeakSet=="function"?WeakSet:Set,vn=null;function ON(n,a){if(n=n.containerInfo,sf=jc,n=np(n),Ad(n)){if("selectionStart"in n)var l={start:n.selectionStart,end:n.selectionEnd};else e:{l=(l=n.ownerDocument)&&l.defaultView||window;var d=l.getSelection&&l.getSelection();if(d&&d.rangeCount!==0){l=d.anchorNode;var g=d.anchorOffset,y=d.focusNode;d=d.focusOffset;try{l.nodeType,y.nodeType}catch{l=null;break e}var S=0,C=-1,U=-1,te=0,fe=0,ve=n,ie=null;t:for(;;){for(var ce;ve!==l||g!==0&&ve.nodeType!==3||(C=S+g),ve!==y||d!==0&&ve.nodeType!==3||(U=S+d),ve.nodeType===3&&(S+=ve.nodeValue.length),(ce=ve.firstChild)!==null;)ie=ve,ve=ce;for(;;){if(ve===n)break t;if(ie===l&&++te===g&&(C=S),ie===y&&++fe===d&&(U=S),(ce=ve.nextSibling)!==null)break;ve=ie,ie=ve.parentNode}ve=ce}l=C===-1||U===-1?null:{start:C,end:U}}else l=null}l=l||{start:0,end:0}}else l=null;for(rf={focusedElem:n,selectionRange:l},jc=!1,vn=a;vn!==null;)if(a=vn,n=a.child,(a.subtreeFlags&1028)!==0&&n!==null)n.return=a,vn=n;else for(;vn!==null;){switch(a=vn,y=a.alternate,n=a.flags,a.tag){case 0:if((n&4)!==0&&(n=a.updateQueue,n=n!==null?n.events:null,n!==null))for(l=0;l<n.length;l++)g=n[l],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&y!==null){n=void 0,l=a,g=y.memoizedProps,y=y.memoizedState,d=l.stateNode;try{var Re=Fa(l.type,g);n=d.getSnapshotBeforeUpdate(Re,y),d.__reactInternalSnapshotBeforeUpdate=n}catch(Fe){Tt(l,l.return,Fe)}}break;case 3:if((n&1024)!==0){if(n=a.stateNode.containerInfo,l=n.nodeType,l===9)lf(n);else if(l===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":lf(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(o(163))}if(n=a.sibling,n!==null){n.return=a.return,vn=n;break}vn=a.return}}function Bh(n,a,l){var d=l.flags;switch(l.tag){case 0:case 11:case 15:Sr(n,l),d&4&&Pi(5,l);break;case 1:if(Sr(n,l),d&4)if(n=l.stateNode,a===null)try{n.componentDidMount()}catch(S){Tt(l,l.return,S)}else{var g=Fa(l.type,a.memoizedProps);a=a.memoizedState;try{n.componentDidUpdate(g,a,n.__reactInternalSnapshotBeforeUpdate)}catch(S){Tt(l,l.return,S)}}d&64&&Gh(l),d&512&&Li(l,l.return);break;case 3:if(Sr(n,l),d&64&&(n=l.updateQueue,n!==null)){if(a=null,l.child!==null)switch(l.child.tag){case 27:case 5:a=l.child.stateNode;break;case 1:a=l.child.stateNode}try{Ap(n,a)}catch(S){Tt(l,l.return,S)}}break;case 27:a===null&&d&4&&Fh(l);case 26:case 5:Sr(n,l),a===null&&d&4&&Oh(l),d&512&&Li(l,l.return);break;case 12:Sr(n,l);break;case 31:Sr(n,l),d&4&&Jh(n,l);break;case 13:Sr(n,l),d&4&&Xh(n,l),d&64&&(n=l.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(l=KN.bind(null,l),xw(n,l))));break;case 22:if(d=l.memoizedState!==null||Nr,!d){a=a!==null&&a.memoizedState!==null||ln,g=Nr;var y=ln;Nr=d,(ln=a)&&!y?jr(n,l,(l.subtreeFlags&8772)!==0):Sr(n,l),Nr=g,ln=y}break;case 30:break;default:Sr(n,l)}}function $h(n){var a=n.alternate;a!==null&&(n.alternate=null,$h(a)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(a=n.stateNode,a!==null&&Lr(a)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var Ft=null,On=!1;function wr(n,a,l){for(l=l.child;l!==null;)Yh(n,a,l),l=l.sibling}function Yh(n,a,l){if(bt&&typeof bt.onCommitFiberUnmount=="function")try{bt.onCommitFiberUnmount(gt,l)}catch{}switch(l.tag){case 26:ln||Zs(l,a),wr(n,a,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:ln||Zs(l,a);var d=Ft,g=On;oa(l.type)&&(Ft=l.stateNode,On=!1),wr(n,a,l),$i(l.stateNode),Ft=d,On=g;break;case 5:ln||Zs(l,a);case 6:if(d=Ft,g=On,Ft=null,wr(n,a,l),Ft=d,On=g,Ft!==null)if(On)try{(Ft.nodeType===9?Ft.body:Ft.nodeName==="HTML"?Ft.ownerDocument.body:Ft).removeChild(l.stateNode)}catch(y){Tt(l,a,y)}else try{Ft.removeChild(l.stateNode)}catch(y){Tt(l,a,y)}break;case 18:Ft!==null&&(On?(n=Ft,Gx(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,l.stateNode),Vo(n)):Gx(Ft,l.stateNode));break;case 4:d=Ft,g=On,Ft=l.stateNode.containerInfo,On=!0,wr(n,a,l),Ft=d,On=g;break;case 0:case 11:case 14:case 15:Zr(2,l,a),ln||Zr(4,l,a),wr(n,a,l);break;case 1:ln||(Zs(l,a),d=l.stateNode,typeof d.componentWillUnmount=="function"&&Hh(l,a,d)),wr(n,a,l);break;case 21:wr(n,a,l);break;case 22:ln=(d=ln)||l.memoizedState!==null,wr(n,a,l),ln=d;break;default:wr(n,a,l)}}function Jh(n,a){if(a.memoizedState===null&&(n=a.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{Vo(n)}catch(l){Tt(a,a.return,l)}}}function Xh(n,a){if(a.memoizedState===null&&(n=a.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Vo(n)}catch(l){Tt(a,a.return,l)}}function qN(n){switch(n.tag){case 31:case 13:case 19:var a=n.stateNode;return a===null&&(a=n.stateNode=new Vh),a;case 22:return n=n.stateNode,a=n._retryCache,a===null&&(a=n._retryCache=new Vh),a;default:throw Error(o(435,n.tag))}}function rc(n,a){var l=qN(n);a.forEach(function(d){if(!l.has(d)){l.add(d);var g=WN.bind(null,n,d);d.then(g,g)}})}function qn(n,a){var l=a.deletions;if(l!==null)for(var d=0;d<l.length;d++){var g=l[d],y=n,S=a,C=S;e:for(;C!==null;){switch(C.tag){case 27:if(oa(C.type)){Ft=C.stateNode,On=!1;break e}break;case 5:Ft=C.stateNode,On=!1;break e;case 3:case 4:Ft=C.stateNode.containerInfo,On=!0;break e}C=C.return}if(Ft===null)throw Error(o(160));Yh(y,S,g),Ft=null,On=!1,y=g.alternate,y!==null&&(y.return=null),g.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)Kh(a,n),a=a.sibling}var zs=null;function Kh(n,a){var l=n.alternate,d=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:qn(a,n),Fn(n),d&4&&(Zr(3,n,n.return),Pi(3,n),Zr(5,n,n.return));break;case 1:qn(a,n),Fn(n),d&512&&(ln||l===null||Zs(l,l.return)),d&64&&Nr&&(n=n.updateQueue,n!==null&&(d=n.callbacks,d!==null&&(l=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=l===null?d:l.concat(d))));break;case 26:var g=zs;if(qn(a,n),Fn(n),d&512&&(ln||l===null||Zs(l,l.return)),d&4){var y=l!==null?l.memoizedState:null;if(d=n.memoizedState,l===null)if(d===null)if(n.stateNode===null){e:{d=n.type,l=n.memoizedProps,g=g.ownerDocument||g;t:switch(d){case"title":y=g.getElementsByTagName("title")[0],(!y||y[ps]||y[Bt]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=g.createElement(d),g.head.insertBefore(y,g.querySelector("head > title"))),jn(y,d,l),y[Bt]=n,Gt(y),d=y;break e;case"link":var S=Kx("link","href",g).get(d+(l.href||""));if(S){for(var C=0;C<S.length;C++)if(y=S[C],y.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&y.getAttribute("rel")===(l.rel==null?null:l.rel)&&y.getAttribute("title")===(l.title==null?null:l.title)&&y.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){S.splice(C,1);break t}}y=g.createElement(d),jn(y,d,l),g.head.appendChild(y);break;case"meta":if(S=Kx("meta","content",g).get(d+(l.content||""))){for(C=0;C<S.length;C++)if(y=S[C],y.getAttribute("content")===(l.content==null?null:""+l.content)&&y.getAttribute("name")===(l.name==null?null:l.name)&&y.getAttribute("property")===(l.property==null?null:l.property)&&y.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&y.getAttribute("charset")===(l.charSet==null?null:l.charSet)){S.splice(C,1);break t}}y=g.createElement(d),jn(y,d,l),g.head.appendChild(y);break;default:throw Error(o(468,d))}y[Bt]=n,Gt(y),d=y}n.stateNode=d}else Wx(g,n.type,n.stateNode);else n.stateNode=Xx(g,d,n.memoizedProps);else y!==d?(y===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):y.count--,d===null?Wx(g,n.type,n.stateNode):Xx(g,d,n.memoizedProps)):d===null&&n.stateNode!==null&&Ru(n,n.memoizedProps,l.memoizedProps)}break;case 27:qn(a,n),Fn(n),d&512&&(ln||l===null||Zs(l,l.return)),l!==null&&d&4&&Ru(n,n.memoizedProps,l.memoizedProps);break;case 5:if(qn(a,n),Fn(n),d&512&&(ln||l===null||Zs(l,l.return)),n.flags&32){g=n.stateNode;try{Gr(g,"")}catch(Re){Tt(n,n.return,Re)}}d&4&&n.stateNode!=null&&(g=n.memoizedProps,Ru(n,g,l!==null?l.memoizedProps:g)),d&1024&&(Pu=!0);break;case 6:if(qn(a,n),Fn(n),d&4){if(n.stateNode===null)throw Error(o(162));d=n.memoizedProps,l=n.stateNode;try{l.nodeValue=d}catch(Re){Tt(n,n.return,Re)}}break;case 3:if(bc=null,g=zs,zs=vc(a.containerInfo),qn(a,n),zs=g,Fn(n),d&4&&l!==null&&l.memoizedState.isDehydrated)try{Vo(a.containerInfo)}catch(Re){Tt(n,n.return,Re)}Pu&&(Pu=!1,Wh(n));break;case 4:d=zs,zs=vc(n.stateNode.containerInfo),qn(a,n),Fn(n),zs=d;break;case 12:qn(a,n),Fn(n);break;case 31:qn(a,n),Fn(n),d&4&&(d=n.updateQueue,d!==null&&(n.updateQueue=null,rc(n,d)));break;case 13:qn(a,n),Fn(n),n.child.flags&8192&&n.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(oc=Q()),d&4&&(d=n.updateQueue,d!==null&&(n.updateQueue=null,rc(n,d)));break;case 22:g=n.memoizedState!==null;var U=l!==null&&l.memoizedState!==null,te=Nr,fe=ln;if(Nr=te||g,ln=fe||U,qn(a,n),ln=fe,Nr=te,Fn(n),d&8192)e:for(a=n.stateNode,a._visibility=g?a._visibility&-2:a._visibility|1,g&&(l===null||U||Nr||ln||Va(n)),l=null,a=n;;){if(a.tag===5||a.tag===26){if(l===null){U=l=a;try{if(y=U.stateNode,g)S=y.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{C=U.stateNode;var ve=U.memoizedProps.style,ie=ve!=null&&ve.hasOwnProperty("display")?ve.display:null;C.style.display=ie==null||typeof ie=="boolean"?"":(""+ie).trim()}}catch(Re){Tt(U,U.return,Re)}}}else if(a.tag===6){if(l===null){U=a;try{U.stateNode.nodeValue=g?"":U.memoizedProps}catch(Re){Tt(U,U.return,Re)}}}else if(a.tag===18){if(l===null){U=a;try{var ce=U.stateNode;g?Hx(ce,!0):Hx(U.stateNode,!1)}catch(Re){Tt(U,U.return,Re)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===n)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===n)break e;for(;a.sibling===null;){if(a.return===null||a.return===n)break e;l===a&&(l=null),a=a.return}l===a&&(l=null),a.sibling.return=a.return,a=a.sibling}d&4&&(d=n.updateQueue,d!==null&&(l=d.retryQueue,l!==null&&(d.retryQueue=null,rc(n,l))));break;case 19:qn(a,n),Fn(n),d&4&&(d=n.updateQueue,d!==null&&(n.updateQueue=null,rc(n,d)));break;case 30:break;case 21:break;default:qn(a,n),Fn(n)}}function Fn(n){var a=n.flags;if(a&2){try{for(var l,d=n.return;d!==null;){if(qh(d)){l=d;break}d=d.return}if(l==null)throw Error(o(160));switch(l.tag){case 27:var g=l.stateNode,y=Du(n);sc(n,y,g);break;case 5:var S=l.stateNode;l.flags&32&&(Gr(S,""),l.flags&=-33);var C=Du(n);sc(n,C,S);break;case 3:case 4:var U=l.stateNode.containerInfo,te=Du(n);Uu(n,te,U);break;default:throw Error(o(161))}}catch(fe){Tt(n,n.return,fe)}n.flags&=-3}a&4096&&(n.flags&=-4097)}function Wh(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var a=n;Wh(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),n=n.sibling}}function Sr(n,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)Bh(n,a.alternate,a),a=a.sibling}function Va(n){for(n=n.child;n!==null;){var a=n;switch(a.tag){case 0:case 11:case 14:case 15:Zr(4,a,a.return),Va(a);break;case 1:Zs(a,a.return);var l=a.stateNode;typeof l.componentWillUnmount=="function"&&Hh(a,a.return,l),Va(a);break;case 27:$i(a.stateNode);case 26:case 5:Zs(a,a.return),Va(a);break;case 22:a.memoizedState===null&&Va(a);break;case 30:Va(a);break;default:Va(a)}n=n.sibling}}function jr(n,a,l){for(l=l&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var d=a.alternate,g=n,y=a,S=y.flags;switch(y.tag){case 0:case 11:case 15:jr(g,y,l),Pi(4,y);break;case 1:if(jr(g,y,l),d=y,g=d.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(te){Tt(d,d.return,te)}if(d=y,g=d.updateQueue,g!==null){var C=d.stateNode;try{var U=g.shared.hiddenCallbacks;if(U!==null)for(g.shared.hiddenCallbacks=null,g=0;g<U.length;g++)_p(U[g],C)}catch(te){Tt(d,d.return,te)}}l&&S&64&&Gh(y),Li(y,y.return);break;case 27:Fh(y);case 26:case 5:jr(g,y,l),l&&d===null&&S&4&&Oh(y),Li(y,y.return);break;case 12:jr(g,y,l);break;case 31:jr(g,y,l),l&&S&4&&Jh(g,y);break;case 13:jr(g,y,l),l&&S&4&&Xh(g,y);break;case 22:y.memoizedState===null&&jr(g,y,l),Li(y,y.return);break;case 30:break;default:jr(g,y,l)}a=a.sibling}}function Lu(n,a){var l=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(l=n.memoizedState.cachePool.pool),n=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(n=a.memoizedState.cachePool.pool),n!==l&&(n!=null&&n.refCount++,l!=null&&Si(l))}function zu(n,a){n=null,a.alternate!==null&&(n=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==n&&(a.refCount++,n!=null&&Si(n))}function Gs(n,a,l,d){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)Qh(n,a,l,d),a=a.sibling}function Qh(n,a,l,d){var g=a.flags;switch(a.tag){case 0:case 11:case 15:Gs(n,a,l,d),g&2048&&Pi(9,a);break;case 1:Gs(n,a,l,d);break;case 3:Gs(n,a,l,d),g&2048&&(n=null,a.alternate!==null&&(n=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==n&&(a.refCount++,n!=null&&Si(n)));break;case 12:if(g&2048){Gs(n,a,l,d),n=a.stateNode;try{var y=a.memoizedProps,S=y.id,C=y.onPostCommit;typeof C=="function"&&C(S,a.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(U){Tt(a,a.return,U)}}else Gs(n,a,l,d);break;case 31:Gs(n,a,l,d);break;case 13:Gs(n,a,l,d);break;case 23:break;case 22:y=a.stateNode,S=a.alternate,a.memoizedState!==null?y._visibility&2?Gs(n,a,l,d):zi(n,a):y._visibility&2?Gs(n,a,l,d):(y._visibility|=2,Ro(n,a,l,d,(a.subtreeFlags&10256)!==0||!1)),g&2048&&Lu(S,a);break;case 24:Gs(n,a,l,d),g&2048&&zu(a.alternate,a);break;default:Gs(n,a,l,d)}}function Ro(n,a,l,d,g){for(g=g&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var y=n,S=a,C=l,U=d,te=S.flags;switch(S.tag){case 0:case 11:case 15:Ro(y,S,C,U,g),Pi(8,S);break;case 23:break;case 22:var fe=S.stateNode;S.memoizedState!==null?fe._visibility&2?Ro(y,S,C,U,g):zi(y,S):(fe._visibility|=2,Ro(y,S,C,U,g)),g&&te&2048&&Lu(S.alternate,S);break;case 24:Ro(y,S,C,U,g),g&&te&2048&&zu(S.alternate,S);break;default:Ro(y,S,C,U,g)}a=a.sibling}}function zi(n,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var l=n,d=a,g=d.flags;switch(d.tag){case 22:zi(l,d),g&2048&&Lu(d.alternate,d);break;case 24:zi(l,d),g&2048&&zu(d.alternate,d);break;default:zi(l,d)}a=a.sibling}}var Gi=8192;function Do(n,a,l){if(n.subtreeFlags&Gi)for(n=n.child;n!==null;)Zh(n,a,l),n=n.sibling}function Zh(n,a,l){switch(n.tag){case 26:Do(n,a,l),n.flags&Gi&&n.memoizedState!==null&&_w(l,zs,n.memoizedState,n.memoizedProps);break;case 5:Do(n,a,l);break;case 3:case 4:var d=zs;zs=vc(n.stateNode.containerInfo),Do(n,a,l),zs=d;break;case 22:n.memoizedState===null&&(d=n.alternate,d!==null&&d.memoizedState!==null?(d=Gi,Gi=16777216,Do(n,a,l),Gi=d):Do(n,a,l));break;default:Do(n,a,l)}}function ex(n){var a=n.alternate;if(a!==null&&(n=a.child,n!==null)){a.child=null;do a=n.sibling,n.sibling=null,n=a;while(n!==null)}}function Hi(n){var a=n.deletions;if((n.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var d=a[l];vn=d,nx(d,n)}ex(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)tx(n),n=n.sibling}function tx(n){switch(n.tag){case 0:case 11:case 15:Hi(n),n.flags&2048&&Zr(9,n,n.return);break;case 3:Hi(n);break;case 12:Hi(n);break;case 22:var a=n.stateNode;n.memoizedState!==null&&a._visibility&2&&(n.return===null||n.return.tag!==13)?(a._visibility&=-3,ac(n)):Hi(n);break;default:Hi(n)}}function ac(n){var a=n.deletions;if((n.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var d=a[l];vn=d,nx(d,n)}ex(n)}for(n=n.child;n!==null;){switch(a=n,a.tag){case 0:case 11:case 15:Zr(8,a,a.return),ac(a);break;case 22:l=a.stateNode,l._visibility&2&&(l._visibility&=-3,ac(a));break;default:ac(a)}n=n.sibling}}function nx(n,a){for(;vn!==null;){var l=vn;switch(l.tag){case 0:case 11:case 15:Zr(8,l,a);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var d=l.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:Si(l.memoizedState.cache)}if(d=l.child,d!==null)d.return=l,vn=d;else e:for(l=n;vn!==null;){d=vn;var g=d.sibling,y=d.return;if($h(d),d===l){vn=null;break e}if(g!==null){g.return=y,vn=g;break e}vn=y}}}var FN={getCacheForType:function(n){var a=wn(rn),l=a.data.get(n);return l===void 0&&(l=n(),a.data.set(n,l)),l},cacheSignal:function(){return wn(rn).controller.signal}},VN=typeof WeakMap=="function"?WeakMap:Map,vt=0,Rt=null,rt=null,lt=0,jt=0,as=null,ea=!1,Uo=!1,Gu=!1,Tr=0,Qt=0,ta=0,Ba=0,Hu=0,os=0,Po=0,Oi=null,Vn=null,Ou=!1,oc=0,sx=0,ic=1/0,lc=null,na=null,hn=0,sa=null,Lo=null,Cr=0,qu=0,Fu=null,rx=null,qi=0,Vu=null;function is(){return(vt&2)!==0&&lt!==0?lt&-lt:q.T!==null?Ku():Xs()}function ax(){if(os===0)if((lt&536870912)===0||dt){var n=$s;$s<<=1,($s&3932160)===0&&($s=262144),os=n}else os=536870912;return n=ss.current,n!==null&&(n.flags|=32),os}function Bn(n,a,l){(n===Rt&&(jt===2||jt===9)||n.cancelPendingCommit!==null)&&(zo(n,0),ra(n,lt,os,!1)),Js(n,l),((vt&2)===0||n!==Rt)&&(n===Rt&&((vt&2)===0&&(Ba|=l),Qt===4&&ra(n,lt,os,!1)),er(n))}function ox(n,a,l){if((vt&6)!==0)throw Error(o(327));var d=!l&&(a&127)===0&&(a&n.expiredLanes)===0||Ys(n,a),g=d?YN(n,a):$u(n,a,!0),y=d;do{if(g===0){Uo&&!d&&ra(n,a,0,!1);break}else{if(l=n.current.alternate,y&&!BN(l)){g=$u(n,a,!1),y=!1;continue}if(g===2){if(y=a,n.errorRecoveryDisabledLanes&y)var S=0;else S=n.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){a=S;e:{var C=n;g=Oi;var U=C.current.memoizedState.isDehydrated;if(U&&(zo(C,S).flags|=256),S=$u(C,S,!1),S!==2){if(Gu&&!U){C.errorRecoveryDisabledLanes|=y,Ba|=y,g=4;break e}y=Vn,Vn=g,y!==null&&(Vn===null?Vn=y:Vn.push.apply(Vn,y))}g=S}if(y=!1,g!==2)continue}}if(g===1){zo(n,0),ra(n,a,0,!0);break}e:{switch(d=n,y=g,y){case 0:case 1:throw Error(o(345));case 4:if((a&4194048)!==a)break;case 6:ra(d,a,os,!ea);break e;case 2:Vn=null;break;case 3:case 5:break;default:throw Error(o(329))}if((a&62914560)===a&&(g=oc+300-Q(),10<g)){if(ra(d,a,os,!ea),Ur(d,0,!0)!==0)break e;Cr=a,d.timeoutHandle=Lx(ix.bind(null,d,l,Vn,lc,Ou,a,os,Ba,Po,ea,y,"Throttled",-0,0),g);break e}ix(d,l,Vn,lc,Ou,a,os,Ba,Po,ea,y,null,-0,0)}}break}while(!0);er(n)}function ix(n,a,l,d,g,y,S,C,U,te,fe,ve,ie,ce){if(n.timeoutHandle=-1,ve=a.subtreeFlags,ve&8192||(ve&16785408)===16785408){ve={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Us},Zh(a,y,ve);var Re=(y&62914560)===y?oc-Q():(y&4194048)===y?sx-Q():0;if(Re=Aw(ve,Re),Re!==null){Cr=y,n.cancelPendingCommit=Re(hx.bind(null,n,a,y,l,d,g,S,C,U,fe,ve,null,ie,ce)),ra(n,y,S,!te);return}}hx(n,a,y,l,d,g,S,C,U)}function BN(n){for(var a=n;;){var l=a.tag;if((l===0||l===11||l===15)&&a.flags&16384&&(l=a.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var d=0;d<l.length;d++){var g=l[d],y=g.getSnapshot;g=g.value;try{if(!ts(y(),g))return!1}catch{return!1}}if(l=a.child,a.subtreeFlags&16384&&l!==null)l.return=a,a=l;else{if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function ra(n,a,l,d){a&=~Hu,a&=~Ba,n.suspendedLanes|=a,n.pingedLanes&=~a,d&&(n.warmLanes|=a),d=n.expirationTimes;for(var g=a;0<g;){var y=31-sn(g),S=1<<y;d[y]=-1,g&=~S}l!==0&&or(n,l,a)}function cc(){return(vt&6)===0?(Fi(0),!1):!0}function Bu(){if(rt!==null){if(jt===0)var n=rt.return;else n=rt,hr=Pa=null,iu(n),_o=null,Ti=0,n=rt;for(;n!==null;)zh(n.alternate,n),n=n.return;rt=null}}function zo(n,a){var l=n.timeoutHandle;l!==-1&&(n.timeoutHandle=-1,uw(l)),l=n.cancelPendingCommit,l!==null&&(n.cancelPendingCommit=null,l()),Cr=0,Bu(),Rt=n,rt=l=mr(n.current,null),lt=a,jt=0,as=null,ea=!1,Uo=Ys(n,a),Gu=!1,Po=os=Hu=Ba=ta=Qt=0,Vn=Oi=null,Ou=!1,(a&8)!==0&&(a|=a&32);var d=n.entangledLanes;if(d!==0)for(n=n.entanglements,d&=a;0<d;){var g=31-sn(d),y=1<<g;a|=n[g],d&=~y}return Tr=a,kl(),l}function lx(n,a){Ke=null,q.H=Ri,a===Eo||a===zl?(a=jp(),jt=3):a===Xd?(a=jp(),jt=4):jt=a===Su?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,as=a,rt===null&&(Qt=1,Ql(n,Ns(a,n.current)))}function cx(){var n=ss.current;return n===null?!0:(lt&4194048)===lt?Ts===null:(lt&62914560)===lt||(lt&536870912)!==0?n===Ts:!1}function dx(){var n=q.H;return q.H=Ri,n===null?Ri:n}function ux(){var n=q.A;return q.A=FN,n}function dc(){Qt=4,ea||(lt&4194048)!==lt&&ss.current!==null||(Uo=!0),(ta&134217727)===0&&(Ba&134217727)===0||Rt===null||ra(Rt,lt,os,!1)}function $u(n,a,l){var d=vt;vt|=2;var g=dx(),y=ux();(Rt!==n||lt!==a)&&(lc=null,zo(n,a)),a=!1;var S=Qt;e:do try{if(jt!==0&&rt!==null){var C=rt,U=as;switch(jt){case 8:Bu(),S=6;break e;case 3:case 2:case 9:case 6:ss.current===null&&(a=!0);var te=jt;if(jt=0,as=null,Go(n,C,U,te),l&&Uo){S=0;break e}break;default:te=jt,jt=0,as=null,Go(n,C,U,te)}}$N(),S=Qt;break}catch(fe){lx(n,fe)}while(!0);return a&&n.shellSuspendCounter++,hr=Pa=null,vt=d,q.H=g,q.A=y,rt===null&&(Rt=null,lt=0,kl()),S}function $N(){for(;rt!==null;)fx(rt)}function YN(n,a){var l=vt;vt|=2;var d=dx(),g=ux();Rt!==n||lt!==a?(lc=null,ic=Q()+500,zo(n,a)):Uo=Ys(n,a);e:do try{if(jt!==0&&rt!==null){a=rt;var y=as;t:switch(jt){case 1:jt=0,as=null,Go(n,a,y,1);break;case 2:case 9:if(wp(y)){jt=0,as=null,mx(a);break}a=function(){jt!==2&&jt!==9||Rt!==n||(jt=7),er(n)},y.then(a,a);break e;case 3:jt=7;break e;case 4:jt=5;break e;case 7:wp(y)?(jt=0,as=null,mx(a)):(jt=0,as=null,Go(n,a,y,7));break;case 5:var S=null;switch(rt.tag){case 26:S=rt.memoizedState;case 5:case 27:var C=rt;if(S?Qx(S):C.stateNode.complete){jt=0,as=null;var U=C.sibling;if(U!==null)rt=U;else{var te=C.return;te!==null?(rt=te,uc(te)):rt=null}break t}}jt=0,as=null,Go(n,a,y,5);break;case 6:jt=0,as=null,Go(n,a,y,6);break;case 8:Bu(),Qt=6;break e;default:throw Error(o(462))}}JN();break}catch(fe){lx(n,fe)}while(!0);return hr=Pa=null,q.H=d,q.A=g,vt=l,rt!==null?0:(Rt=null,lt=0,kl(),Qt)}function JN(){for(;rt!==null&&!P();)fx(rt)}function fx(n){var a=Ph(n.alternate,n,Tr);n.memoizedProps=n.pendingProps,a===null?uc(n):rt=a}function mx(n){var a=n,l=a.alternate;switch(a.tag){case 15:case 0:a=kh(l,a,a.pendingProps,a.type,void 0,lt);break;case 11:a=kh(l,a,a.pendingProps,a.type.render,a.ref,lt);break;case 5:iu(a);default:zh(l,a),a=rt=up(a,Tr),a=Ph(l,a,Tr)}n.memoizedProps=n.pendingProps,a===null?uc(n):rt=a}function Go(n,a,l,d){hr=Pa=null,iu(a),_o=null,Ti=0;var g=a.return;try{if(PN(n,g,a,l,lt)){Qt=1,Ql(n,Ns(l,n.current)),rt=null;return}}catch(y){if(g!==null)throw rt=g,y;Qt=1,Ql(n,Ns(l,n.current)),rt=null;return}a.flags&32768?(dt||d===1?n=!0:Uo||(lt&536870912)!==0?n=!1:(ea=n=!0,(d===2||d===9||d===3||d===6)&&(d=ss.current,d!==null&&d.tag===13&&(d.flags|=16384))),px(a,n)):uc(a)}function uc(n){var a=n;do{if((a.flags&32768)!==0){px(a,ea);return}n=a.return;var l=GN(a.alternate,a,Tr);if(l!==null){rt=l;return}if(a=a.sibling,a!==null){rt=a;return}rt=a=n}while(a!==null);Qt===0&&(Qt=5)}function px(n,a){do{var l=HN(n.alternate,n);if(l!==null){l.flags&=32767,rt=l;return}if(l=n.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!a&&(n=n.sibling,n!==null)){rt=n;return}rt=n=l}while(n!==null);Qt=6,rt=null}function hx(n,a,l,d,g,y,S,C,U){n.cancelPendingCommit=null;do fc();while(hn!==0);if((vt&6)!==0)throw Error(o(327));if(a!==null){if(a===n.current)throw Error(o(177));if(y=a.lanes|a.childLanes,y|=Dd,Pr(n,l,y,S,C,U),n===Rt&&(rt=Rt=null,lt=0),Lo=a,sa=n,Cr=l,qu=y,Fu=g,rx=d,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,QN(Ce,function(){return bx(),null})):(n.callbackNode=null,n.callbackPriority=0),d=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||d){d=q.T,q.T=null,g=H.p,H.p=2,S=vt,vt|=4;try{ON(n,a,l)}finally{vt=S,H.p=g,q.T=d}}hn=1,xx(),gx(),vx()}}function xx(){if(hn===1){hn=0;var n=sa,a=Lo,l=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||l){l=q.T,q.T=null;var d=H.p;H.p=2;var g=vt;vt|=4;try{Kh(a,n);var y=rf,S=np(n.containerInfo),C=y.focusedElem,U=y.selectionRange;if(S!==C&&C&&C.ownerDocument&&tp(C.ownerDocument.documentElement,C)){if(U!==null&&Ad(C)){var te=U.start,fe=U.end;if(fe===void 0&&(fe=te),"selectionStart"in C)C.selectionStart=te,C.selectionEnd=Math.min(fe,C.value.length);else{var ve=C.ownerDocument||document,ie=ve&&ve.defaultView||window;if(ie.getSelection){var ce=ie.getSelection(),Re=C.textContent.length,Fe=Math.min(U.start,Re),It=U.end===void 0?Fe:Math.min(U.end,Re);!ce.extend&&Fe>It&&(S=It,It=Fe,Fe=S);var $=ep(C,Fe),O=ep(C,It);if($&&O&&(ce.rangeCount!==1||ce.anchorNode!==$.node||ce.anchorOffset!==$.offset||ce.focusNode!==O.node||ce.focusOffset!==O.offset)){var ee=ve.createRange();ee.setStart($.node,$.offset),ce.removeAllRanges(),Fe>It?(ce.addRange(ee),ce.extend(O.node,O.offset)):(ee.setEnd(O.node,O.offset),ce.addRange(ee))}}}}for(ve=[],ce=C;ce=ce.parentNode;)ce.nodeType===1&&ve.push({element:ce,left:ce.scrollLeft,top:ce.scrollTop});for(typeof C.focus=="function"&&C.focus(),C=0;C<ve.length;C++){var ge=ve[C];ge.element.scrollLeft=ge.left,ge.element.scrollTop=ge.top}}jc=!!sf,rf=sf=null}finally{vt=g,H.p=d,q.T=l}}n.current=a,hn=2}}function gx(){if(hn===2){hn=0;var n=sa,a=Lo,l=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||l){l=q.T,q.T=null;var d=H.p;H.p=2;var g=vt;vt|=4;try{Bh(n,a.alternate,a)}finally{vt=g,H.p=d,q.T=l}}hn=3}}function vx(){if(hn===4||hn===3){hn=0,k();var n=sa,a=Lo,l=Cr,d=rx;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?hn=5:(hn=0,Lo=sa=null,yx(n,n.pendingLanes));var g=n.pendingLanes;if(g===0&&(na=null),Xn(l),a=a.stateNode,bt&&typeof bt.onCommitFiberRoot=="function")try{bt.onCommitFiberRoot(gt,a,void 0,(a.current.flags&128)===128)}catch{}if(d!==null){a=q.T,g=H.p,H.p=2,q.T=null;try{for(var y=n.onRecoverableError,S=0;S<d.length;S++){var C=d[S];y(C.value,{componentStack:C.stack})}}finally{q.T=a,H.p=g}}(Cr&3)!==0&&fc(),er(n),g=n.pendingLanes,(l&261930)!==0&&(g&42)!==0?n===Vu?qi++:(qi=0,Vu=n):qi=0,Fi(0)}}function yx(n,a){(n.pooledCacheLanes&=a)===0&&(a=n.pooledCache,a!=null&&(n.pooledCache=null,Si(a)))}function fc(){return xx(),gx(),vx(),bx()}function bx(){if(hn!==5)return!1;var n=sa,a=qu;qu=0;var l=Xn(Cr),d=q.T,g=H.p;try{H.p=32>l?32:l,q.T=null,l=Fu,Fu=null;var y=sa,S=Cr;if(hn=0,Lo=sa=null,Cr=0,(vt&6)!==0)throw Error(o(331));var C=vt;if(vt|=4,tx(y.current),Qh(y,y.current,S,l),vt=C,Fi(0,!1),bt&&typeof bt.onPostCommitFiberRoot=="function")try{bt.onPostCommitFiberRoot(gt,y)}catch{}return!0}finally{H.p=g,q.T=d,yx(n,a)}}function Nx(n,a,l){a=Ns(l,a),a=wu(n.stateNode,a,2),n=Kr(n,a,2),n!==null&&(Js(n,2),er(n))}function Tt(n,a,l){if(n.tag===3)Nx(n,n,l);else for(;a!==null;){if(a.tag===3){Nx(a,n,l);break}else if(a.tag===1){var d=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(na===null||!na.has(d))){n=Ns(l,n),l=wh(2),d=Kr(a,l,2),d!==null&&(Sh(l,d,a,n),Js(d,2),er(d));break}}a=a.return}}function Yu(n,a,l){var d=n.pingCache;if(d===null){d=n.pingCache=new VN;var g=new Set;d.set(a,g)}else g=d.get(a),g===void 0&&(g=new Set,d.set(a,g));g.has(l)||(Gu=!0,g.add(l),n=XN.bind(null,n,a,l),a.then(n,n))}function XN(n,a,l){var d=n.pingCache;d!==null&&d.delete(a),n.pingedLanes|=n.suspendedLanes&l,n.warmLanes&=~l,Rt===n&&(lt&l)===l&&(Qt===4||Qt===3&&(lt&62914560)===lt&&300>Q()-oc?(vt&2)===0&&zo(n,0):Hu|=l,Po===lt&&(Po=0)),er(n)}function wx(n,a){a===0&&(a=Jn()),n=Ra(n,a),n!==null&&(Js(n,a),er(n))}function KN(n){var a=n.memoizedState,l=0;a!==null&&(l=a.retryLane),wx(n,l)}function WN(n,a){var l=0;switch(n.tag){case 31:case 13:var d=n.stateNode,g=n.memoizedState;g!==null&&(l=g.retryLane);break;case 19:d=n.stateNode;break;case 22:d=n.stateNode._retryCache;break;default:throw Error(o(314))}d!==null&&d.delete(a),wx(n,l)}function QN(n,a){return _t(n,a)}var mc=null,Ho=null,Ju=!1,pc=!1,Xu=!1,aa=0;function er(n){n!==Ho&&n.next===null&&(Ho===null?mc=Ho=n:Ho=Ho.next=n),pc=!0,Ju||(Ju=!0,ew())}function Fi(n,a){if(!Xu&&pc){Xu=!0;do for(var l=!1,d=mc;d!==null;){if(n!==0){var g=d.pendingLanes;if(g===0)var y=0;else{var S=d.suspendedLanes,C=d.pingedLanes;y=(1<<31-sn(42|n)+1)-1,y&=g&~(S&~C),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(l=!0,Cx(d,y))}else y=lt,y=Ur(d,d===Rt?y:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(y&3)===0||Ys(d,y)||(l=!0,Cx(d,y));d=d.next}while(l);Xu=!1}}function ZN(){Sx()}function Sx(){pc=Ju=!1;var n=0;aa!==0&&dw()&&(n=aa);for(var a=Q(),l=null,d=mc;d!==null;){var g=d.next,y=jx(d,a);y===0?(d.next=null,l===null?mc=g:l.next=g,g===null&&(Ho=l)):(l=d,(n!==0||(y&3)!==0)&&(pc=!0)),d=g}hn!==0&&hn!==5||Fi(n),aa!==0&&(aa=0)}function jx(n,a){for(var l=n.suspendedLanes,d=n.pingedLanes,g=n.expirationTimes,y=n.pendingLanes&-62914561;0<y;){var S=31-sn(y),C=1<<S,U=g[S];U===-1?((C&l)===0||(C&d)!==0)&&(g[S]=lo(C,a)):U<=a&&(n.expiredLanes|=C),y&=~C}if(a=Rt,l=lt,l=Ur(n,n===a?l:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),d=n.callbackNode,l===0||n===a&&(jt===2||jt===9)||n.cancelPendingCommit!==null)return d!==null&&d!==null&&un(d),n.callbackNode=null,n.callbackPriority=0;if((l&3)===0||Ys(n,l)){if(a=l&-l,a===n.callbackPriority)return a;switch(d!==null&&un(d),Xn(l)){case 2:case 8:l=Se;break;case 32:l=Ce;break;case 268435456:l=Ge;break;default:l=Ce}return d=Tx.bind(null,n),l=_t(l,d),n.callbackPriority=a,n.callbackNode=l,a}return d!==null&&d!==null&&un(d),n.callbackPriority=2,n.callbackNode=null,2}function Tx(n,a){if(hn!==0&&hn!==5)return n.callbackNode=null,n.callbackPriority=0,null;var l=n.callbackNode;if(fc()&&n.callbackNode!==l)return null;var d=lt;return d=Ur(n,n===Rt?d:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),d===0?null:(ox(n,d,a),jx(n,Q()),n.callbackNode!=null&&n.callbackNode===l?Tx.bind(null,n):null)}function Cx(n,a){if(fc())return null;ox(n,a,!0)}function ew(){fw(function(){(vt&6)!==0?_t(se,ZN):Sx()})}function Ku(){if(aa===0){var n=To;n===0&&(n=rr,rr<<=1,(rr&261888)===0&&(rr=256)),aa=n}return aa}function Ex(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:po(""+n)}function _x(n,a){var l=a.ownerDocument.createElement("input");return l.name=a.name,l.value=a.value,n.id&&l.setAttribute("form",n.id),a.parentNode.insertBefore(l,a),n=new FormData(n),l.parentNode.removeChild(l),n}function tw(n,a,l,d,g){if(a==="submit"&&l&&l.stateNode===g){var y=Ex((g[wt]||null).action),S=d.submitter;S&&(a=(a=S[wt]||null)?Ex(a.formAction):S.getAttribute("formAction"),a!==null&&(y=a,S=null));var C=new Zn("action","action",null,d,g);n.push({event:C,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(aa!==0){var U=S?_x(g,S):new FormData(g);xu(l,{pending:!0,data:U,method:g.method,action:y},null,U)}}else typeof y=="function"&&(C.preventDefault(),U=S?_x(g,S):new FormData(g),xu(l,{pending:!0,data:U,method:g.method,action:y},y,U))},currentTarget:g}]})}}for(var Wu=0;Wu<Rd.length;Wu++){var Qu=Rd[Wu],nw=Qu.toLowerCase(),sw=Qu[0].toUpperCase()+Qu.slice(1);Ls(nw,"on"+sw)}Ls(ap,"onAnimationEnd"),Ls(op,"onAnimationIteration"),Ls(ip,"onAnimationStart"),Ls("dblclick","onDoubleClick"),Ls("focusin","onFocus"),Ls("focusout","onBlur"),Ls(yN,"onTransitionRun"),Ls(bN,"onTransitionStart"),Ls(NN,"onTransitionCancel"),Ls(lp,"onTransitionEnd"),Wn("onMouseEnter",["mouseout","mouseover"]),Wn("onMouseLeave",["mouseout","mouseover"]),Wn("onPointerEnter",["pointerout","pointerover"]),Wn("onPointerLeave",["pointerout","pointerover"]),xs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),xs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),xs("onBeforeInput",["compositionend","keypress","textInput","paste"]),xs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),xs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),xs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),rw=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Vi));function Ax(n,a){a=(a&4)!==0;for(var l=0;l<n.length;l++){var d=n[l],g=d.event;d=d.listeners;e:{var y=void 0;if(a)for(var S=d.length-1;0<=S;S--){var C=d[S],U=C.instance,te=C.currentTarget;if(C=C.listener,U!==y&&g.isPropagationStopped())break e;y=C,g.currentTarget=te;try{y(g)}catch(fe){Al(fe)}g.currentTarget=null,y=U}else for(S=0;S<d.length;S++){if(C=d[S],U=C.instance,te=C.currentTarget,C=C.listener,U!==y&&g.isPropagationStopped())break e;y=C,g.currentTarget=te;try{y(g)}catch(fe){Al(fe)}g.currentTarget=null,y=U}}}}function at(n,a){var l=a[ir];l===void 0&&(l=a[ir]=new Set);var d=n+"__bubble";l.has(d)||(kx(a,n,2,!1),l.add(d))}function Zu(n,a,l){var d=0;a&&(d|=4),kx(l,n,d,a)}var hc="_reactListening"+Math.random().toString(36).slice(2);function ef(n){if(!n[hc]){n[hc]=!0,Ca.forEach(function(l){l!=="selectionchange"&&(rw.has(l)||Zu(l,!1,n),Zu(l,!0,n))});var a=n.nodeType===9?n:n.ownerDocument;a===null||a[hc]||(a[hc]=!0,Zu("selectionchange",!1,a))}}function kx(n,a,l,d){switch(ag(a)){case 2:var g=Mw;break;case 8:g=Rw;break;default:g=xf}l=g.bind(null,a,l,n),g=void 0,!W||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(g=!0),d?g!==void 0?n.addEventListener(a,l,{capture:!0,passive:g}):n.addEventListener(a,l,!0):g!==void 0?n.addEventListener(a,l,{passive:g}):n.addEventListener(a,l,!1)}function tf(n,a,l,d,g){var y=d;if((a&1)===0&&(a&2)===0&&d!==null)e:for(;;){if(d===null)return;var S=d.tag;if(S===3||S===4){var C=d.stateNode.containerInfo;if(C===g)break;if(S===4)for(S=d.return;S!==null;){var U=S.tag;if((U===3||U===4)&&S.stateNode.containerInfo===g)return;S=S.return}for(;C!==null;){if(S=it(C),S===null)return;if(U=S.tag,U===5||U===6||U===26||U===27){d=y=S;continue e}C=C.parentNode}}d=d.return}El(function(){var te=y,fe=ho(l),ve=[];e:{var ie=cp.get(n);if(ie!==void 0){var ce=Zn,Re=n;switch(n){case"keypress":if(Je(l)===0)break e;case"keydown":case"keyup":ce=Wb;break;case"focusin":Re="focus",ce=jd;break;case"focusout":Re="blur",ce=jd;break;case"beforeblur":case"afterblur":ce=jd;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ce=ys;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ce=ka;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ce=eN;break;case ap:case op:case ip:ce=qb;break;case lp:ce=nN;break;case"scroll":case"scrollend":ce=qr;break;case"wheel":ce=rN;break;case"copy":case"cut":case"paste":ce=Vb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ce=Hm;break;case"toggle":case"beforetoggle":ce=oN}var Fe=(a&4)!==0,It=!Fe&&(n==="scroll"||n==="scrollend"),$=Fe?ie!==null?ie+"Capture":null:ie;Fe=[];for(var O=te,ee;O!==null;){var ge=O;if(ee=ge.stateNode,ge=ge.tag,ge!==5&&ge!==26&&ge!==27||ee===null||$===null||(ge=j(O,$),ge!=null&&Fe.push(Bi(O,ge,ee))),It)break;O=O.return}0<Fe.length&&(ie=new ce(ie,Re,null,l,fe),ve.push({event:ie,listeners:Fe}))}}if((a&7)===0){e:{if(ie=n==="mouseover"||n==="pointerover",ce=n==="mouseout"||n==="pointerout",ie&&l!==pi&&(Re=l.relatedTarget||l.fromElement)&&(it(Re)||Re[Kn]))break e;if((ce||ie)&&(ie=fe.window===fe?fe:(ie=fe.ownerDocument)?ie.defaultView||ie.parentWindow:window,ce?(Re=l.relatedTarget||l.toElement,ce=te,Re=Re?it(Re):null,Re!==null&&(It=c(Re),Fe=Re.tag,Re!==It||Fe!==5&&Fe!==27&&Fe!==6)&&(Re=null)):(ce=null,Re=te),ce!==Re)){if(Fe=ys,ge="onMouseLeave",$="onMouseEnter",O="mouse",(n==="pointerout"||n==="pointerover")&&(Fe=Hm,ge="onPointerLeave",$="onPointerEnter",O="pointer"),It=ce==null?ie:lr(ce),ee=Re==null?ie:lr(Re),ie=new Fe(ge,O+"leave",ce,l,fe),ie.target=It,ie.relatedTarget=ee,ge=null,it(fe)===te&&(Fe=new Fe($,O+"enter",Re,l,fe),Fe.target=ee,Fe.relatedTarget=It,ge=Fe),It=ge,ce&&Re)t:{for(Fe=aw,$=ce,O=Re,ee=0,ge=$;ge;ge=Fe(ge))ee++;ge=0;for(var Oe=O;Oe;Oe=Fe(Oe))ge++;for(;0<ee-ge;)$=Fe($),ee--;for(;0<ge-ee;)O=Fe(O),ge--;for(;ee--;){if($===O||O!==null&&$===O.alternate){Fe=$;break t}$=Fe($),O=Fe(O)}Fe=null}else Fe=null;ce!==null&&Ix(ve,ie,ce,Fe,!1),Re!==null&&It!==null&&Ix(ve,It,Re,Fe,!0)}}e:{if(ie=te?lr(te):window,ce=ie.nodeName&&ie.nodeName.toLowerCase(),ce==="select"||ce==="input"&&ie.type==="file")var pt=Jm;else if($m(ie))if(Xm)pt=xN;else{pt=pN;var Ue=mN}else ce=ie.nodeName,!ce||ce.toLowerCase()!=="input"||ie.type!=="checkbox"&&ie.type!=="radio"?te&&mi(te.elementType)&&(pt=Jm):pt=hN;if(pt&&(pt=pt(n,te))){Ym(ve,pt,l,fe);break e}Ue&&Ue(n,ie,te),n==="focusout"&&te&&ie.type==="number"&&te.memoizedProps.value!=null&&vs(ie,"number",ie.value)}switch(Ue=te?lr(te):window,n){case"focusin":($m(Ue)||Ue.contentEditable==="true")&&(go=Ue,kd=te,bi=null);break;case"focusout":bi=kd=go=null;break;case"mousedown":Id=!0;break;case"contextmenu":case"mouseup":case"dragend":Id=!1,sp(ve,l,fe);break;case"selectionchange":if(vN)break;case"keydown":case"keyup":sp(ve,l,fe)}var Qe;if(Cd)e:{switch(n){case"compositionstart":var ct="onCompositionStart";break e;case"compositionend":ct="onCompositionEnd";break e;case"compositionupdate":ct="onCompositionUpdate";break e}ct=void 0}else xo?Vm(n,l)&&(ct="onCompositionEnd"):n==="keydown"&&l.keyCode===229&&(ct="onCompositionStart");ct&&(Om&&l.locale!=="ko"&&(xo||ct!=="onCompositionStart"?ct==="onCompositionEnd"&&xo&&(Qe=Pe()):(pe=fe,_e="value"in pe?pe.value:pe.textContent,xo=!0)),Ue=xc(te,ct),0<Ue.length&&(ct=new Gm(ct,n,null,l,fe),ve.push({event:ct,listeners:Ue}),Qe?ct.data=Qe:(Qe=Bm(l),Qe!==null&&(ct.data=Qe)))),(Qe=lN?cN(n,l):dN(n,l))&&(ct=xc(te,"onBeforeInput"),0<ct.length&&(Ue=new Gm("onBeforeInput","beforeinput",null,l,fe),ve.push({event:Ue,listeners:ct}),Ue.data=Qe)),tw(ve,n,te,l,fe)}Ax(ve,a)})}function Bi(n,a,l){return{instance:n,listener:a,currentTarget:l}}function xc(n,a){for(var l=a+"Capture",d=[];n!==null;){var g=n,y=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||y===null||(g=j(n,l),g!=null&&d.unshift(Bi(n,g,y)),g=j(n,a),g!=null&&d.push(Bi(n,g,y))),n.tag===3)return d;n=n.return}return[]}function aw(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function Ix(n,a,l,d,g){for(var y=a._reactName,S=[];l!==null&&l!==d;){var C=l,U=C.alternate,te=C.stateNode;if(C=C.tag,U!==null&&U===d)break;C!==5&&C!==26&&C!==27||te===null||(U=te,g?(te=j(l,y),te!=null&&S.unshift(Bi(l,te,U))):g||(te=j(l,y),te!=null&&S.push(Bi(l,te,U)))),l=l.return}S.length!==0&&n.push({event:a,listeners:S})}var ow=/\r\n?/g,iw=/\u0000|\uFFFD/g;function Mx(n){return(typeof n=="string"?n:""+n).replace(ow,`
`).replace(iw,"")}function Rx(n,a){return a=Mx(a),Mx(n)===a}function kt(n,a,l,d,g,y){switch(l){case"children":typeof d=="string"?a==="body"||a==="textarea"&&d===""||Gr(n,d):(typeof d=="number"||typeof d=="bigint")&&a!=="body"&&Gr(n,""+d);break;case"className":ae(n,"class",d);break;case"tabIndex":ae(n,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":ae(n,l,d);break;case"style":mo(n,d,y);break;case"data":if(a!=="object"){ae(n,"data",d);break}case"src":case"href":if(d===""&&(a!=="a"||l!=="href")){n.removeAttribute(l);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){n.removeAttribute(l);break}d=po(""+d),n.setAttribute(l,d);break;case"action":case"formAction":if(typeof d=="function"){n.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(l==="formAction"?(a!=="input"&&kt(n,a,"name",g.name,g,null),kt(n,a,"formEncType",g.formEncType,g,null),kt(n,a,"formMethod",g.formMethod,g,null),kt(n,a,"formTarget",g.formTarget,g,null)):(kt(n,a,"encType",g.encType,g,null),kt(n,a,"method",g.method,g,null),kt(n,a,"target",g.target,g,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){n.removeAttribute(l);break}d=po(""+d),n.setAttribute(l,d);break;case"onClick":d!=null&&(n.onclick=Us);break;case"onScroll":d!=null&&at("scroll",n);break;case"onScrollEnd":d!=null&&at("scrollend",n);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(o(61));if(l=d.__html,l!=null){if(g.children!=null)throw Error(o(60));n.innerHTML=l}}break;case"multiple":n.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":n.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){n.removeAttribute("xlink:href");break}l=po(""+d),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?n.setAttribute(l,""+d):n.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?n.setAttribute(l,""):n.removeAttribute(l);break;case"capture":case"download":d===!0?n.setAttribute(l,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?n.setAttribute(l,d):n.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?n.setAttribute(l,d):n.removeAttribute(l);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?n.removeAttribute(l):n.setAttribute(l,d);break;case"popover":at("beforetoggle",n),at("toggle",n),cr(n,"popover",d);break;case"xlinkActuate":Ie(n,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":Ie(n,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":Ie(n,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":Ie(n,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":Ie(n,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":Ie(n,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":Ie(n,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":Ie(n,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":Ie(n,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":cr(n,"is",d);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=wd.get(l)||l,cr(n,l,d))}}function nf(n,a,l,d,g,y){switch(l){case"style":mo(n,d,y);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(o(61));if(l=d.__html,l!=null){if(g.children!=null)throw Error(o(60));n.innerHTML=l}}break;case"children":typeof d=="string"?Gr(n,d):(typeof d=="number"||typeof d=="bigint")&&Gr(n,""+d);break;case"onScroll":d!=null&&at("scroll",n);break;case"onScrollEnd":d!=null&&at("scrollend",n);break;case"onClick":d!=null&&(n.onclick=Us);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!qt.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(g=l.endsWith("Capture"),a=l.slice(2,g?l.length-7:void 0),y=n[wt]||null,y=y!=null?y[l]:null,typeof y=="function"&&n.removeEventListener(a,y,g),typeof d=="function")){typeof y!="function"&&y!==null&&(l in n?n[l]=null:n.hasAttribute(l)&&n.removeAttribute(l)),n.addEventListener(a,d,g);break e}l in n?n[l]=d:d===!0?n.setAttribute(l,""):cr(n,l,d)}}}function jn(n,a,l){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":at("error",n),at("load",n);var d=!1,g=!1,y;for(y in l)if(l.hasOwnProperty(y)){var S=l[y];if(S!=null)switch(y){case"src":d=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,a));default:kt(n,a,y,S,l,null)}}g&&kt(n,a,"srcSet",l.srcSet,l,null),d&&kt(n,a,"src",l.src,l,null);return;case"input":at("invalid",n);var C=y=S=g=null,U=null,te=null;for(d in l)if(l.hasOwnProperty(d)){var fe=l[d];if(fe!=null)switch(d){case"name":g=fe;break;case"type":S=fe;break;case"checked":U=fe;break;case"defaultChecked":te=fe;break;case"value":y=fe;break;case"defaultValue":C=fe;break;case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(o(137,a));break;default:kt(n,a,d,fe,l,null)}}gs(n,y,C,U,te,S,g,!1);return;case"select":at("invalid",n),d=S=y=null;for(g in l)if(l.hasOwnProperty(g)&&(C=l[g],C!=null))switch(g){case"value":y=C;break;case"defaultValue":S=C;break;case"multiple":d=C;default:kt(n,a,g,C,l,null)}a=y,l=S,n.multiple=!!d,a!=null?Qn(n,!!d,a,!1):l!=null&&Qn(n,!!d,l,!0);return;case"textarea":at("invalid",n),y=g=d=null;for(S in l)if(l.hasOwnProperty(S)&&(C=l[S],C!=null))switch(S){case"value":d=C;break;case"defaultValue":g=C;break;case"children":y=C;break;case"dangerouslySetInnerHTML":if(C!=null)throw Error(o(91));break;default:kt(n,a,S,C,l,null)}ui(n,d,g,y);return;case"option":for(U in l)if(l.hasOwnProperty(U)&&(d=l[U],d!=null))switch(U){case"selected":n.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:kt(n,a,U,d,l,null)}return;case"dialog":at("beforetoggle",n),at("toggle",n),at("cancel",n),at("close",n);break;case"iframe":case"object":at("load",n);break;case"video":case"audio":for(d=0;d<Vi.length;d++)at(Vi[d],n);break;case"image":at("error",n),at("load",n);break;case"details":at("toggle",n);break;case"embed":case"source":case"link":at("error",n),at("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(te in l)if(l.hasOwnProperty(te)&&(d=l[te],d!=null))switch(te){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,a));default:kt(n,a,te,d,l,null)}return;default:if(mi(a)){for(fe in l)l.hasOwnProperty(fe)&&(d=l[fe],d!==void 0&&nf(n,a,fe,d,l,void 0));return}}for(C in l)l.hasOwnProperty(C)&&(d=l[C],d!=null&&kt(n,a,C,d,l,null))}function lw(n,a,l,d){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,y=null,S=null,C=null,U=null,te=null,fe=null;for(ce in l){var ve=l[ce];if(l.hasOwnProperty(ce)&&ve!=null)switch(ce){case"checked":break;case"value":break;case"defaultValue":U=ve;default:d.hasOwnProperty(ce)||kt(n,a,ce,null,d,ve)}}for(var ie in d){var ce=d[ie];if(ve=l[ie],d.hasOwnProperty(ie)&&(ce!=null||ve!=null))switch(ie){case"type":y=ce;break;case"name":g=ce;break;case"checked":te=ce;break;case"defaultChecked":fe=ce;break;case"value":S=ce;break;case"defaultValue":C=ce;break;case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(o(137,a));break;default:ce!==ve&&kt(n,a,ie,ce,d,ve)}}_a(n,S,C,U,te,fe,y,g);return;case"select":ce=S=C=ie=null;for(y in l)if(U=l[y],l.hasOwnProperty(y)&&U!=null)switch(y){case"value":break;case"multiple":ce=U;default:d.hasOwnProperty(y)||kt(n,a,y,null,d,U)}for(g in d)if(y=d[g],U=l[g],d.hasOwnProperty(g)&&(y!=null||U!=null))switch(g){case"value":ie=y;break;case"defaultValue":C=y;break;case"multiple":S=y;default:y!==U&&kt(n,a,g,y,d,U)}a=C,l=S,d=ce,ie!=null?Qn(n,!!l,ie,!1):!!d!=!!l&&(a!=null?Qn(n,!!l,a,!0):Qn(n,!!l,l?[]:"",!1));return;case"textarea":ce=ie=null;for(C in l)if(g=l[C],l.hasOwnProperty(C)&&g!=null&&!d.hasOwnProperty(C))switch(C){case"value":break;case"children":break;default:kt(n,a,C,null,d,g)}for(S in d)if(g=d[S],y=l[S],d.hasOwnProperty(S)&&(g!=null||y!=null))switch(S){case"value":ie=g;break;case"defaultValue":ce=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(o(91));break;default:g!==y&&kt(n,a,S,g,d,y)}jl(n,ie,ce);return;case"option":for(var Re in l)if(ie=l[Re],l.hasOwnProperty(Re)&&ie!=null&&!d.hasOwnProperty(Re))switch(Re){case"selected":n.selected=!1;break;default:kt(n,a,Re,null,d,ie)}for(U in d)if(ie=d[U],ce=l[U],d.hasOwnProperty(U)&&ie!==ce&&(ie!=null||ce!=null))switch(U){case"selected":n.selected=ie&&typeof ie!="function"&&typeof ie!="symbol";break;default:kt(n,a,U,ie,d,ce)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Fe in l)ie=l[Fe],l.hasOwnProperty(Fe)&&ie!=null&&!d.hasOwnProperty(Fe)&&kt(n,a,Fe,null,d,ie);for(te in d)if(ie=d[te],ce=l[te],d.hasOwnProperty(te)&&ie!==ce&&(ie!=null||ce!=null))switch(te){case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(o(137,a));break;default:kt(n,a,te,ie,d,ce)}return;default:if(mi(a)){for(var It in l)ie=l[It],l.hasOwnProperty(It)&&ie!==void 0&&!d.hasOwnProperty(It)&&nf(n,a,It,void 0,d,ie);for(fe in d)ie=d[fe],ce=l[fe],!d.hasOwnProperty(fe)||ie===ce||ie===void 0&&ce===void 0||nf(n,a,fe,ie,d,ce);return}}for(var $ in l)ie=l[$],l.hasOwnProperty($)&&ie!=null&&!d.hasOwnProperty($)&&kt(n,a,$,null,d,ie);for(ve in d)ie=d[ve],ce=l[ve],!d.hasOwnProperty(ve)||ie===ce||ie==null&&ce==null||kt(n,a,ve,ie,d,ce)}function Dx(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function cw(){if(typeof performance.getEntriesByType=="function"){for(var n=0,a=0,l=performance.getEntriesByType("resource"),d=0;d<l.length;d++){var g=l[d],y=g.transferSize,S=g.initiatorType,C=g.duration;if(y&&C&&Dx(S)){for(S=0,C=g.responseEnd,d+=1;d<l.length;d++){var U=l[d],te=U.startTime;if(te>C)break;var fe=U.transferSize,ve=U.initiatorType;fe&&Dx(ve)&&(U=U.responseEnd,S+=fe*(U<C?1:(C-te)/(U-te)))}if(--d,a+=8*(y+S)/(g.duration/1e3),n++,10<n)break}}if(0<n)return a/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var sf=null,rf=null;function gc(n){return n.nodeType===9?n:n.ownerDocument}function Ux(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Px(n,a){if(n===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&a==="foreignObject"?0:n}function af(n,a){return n==="textarea"||n==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var of=null;function dw(){var n=window.event;return n&&n.type==="popstate"?n===of?!1:(of=n,!0):(of=null,!1)}var Lx=typeof setTimeout=="function"?setTimeout:void 0,uw=typeof clearTimeout=="function"?clearTimeout:void 0,zx=typeof Promise=="function"?Promise:void 0,fw=typeof queueMicrotask=="function"?queueMicrotask:typeof zx<"u"?function(n){return zx.resolve(null).then(n).catch(mw)}:Lx;function mw(n){setTimeout(function(){throw n})}function oa(n){return n==="head"}function Gx(n,a){var l=a,d=0;do{var g=l.nextSibling;if(n.removeChild(l),g&&g.nodeType===8)if(l=g.data,l==="/$"||l==="/&"){if(d===0){n.removeChild(g),Vo(a);return}d--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")d++;else if(l==="html")$i(n.ownerDocument.documentElement);else if(l==="head"){l=n.ownerDocument.head,$i(l);for(var y=l.firstChild;y;){var S=y.nextSibling,C=y.nodeName;y[ps]||C==="SCRIPT"||C==="STYLE"||C==="LINK"&&y.rel.toLowerCase()==="stylesheet"||l.removeChild(y),y=S}}else l==="body"&&$i(n.ownerDocument.body);l=g}while(l);Vo(a)}function Hx(n,a){var l=n;n=0;do{var d=l.nextSibling;if(l.nodeType===1?a?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(a?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),d&&d.nodeType===8)if(l=d.data,l==="/$"){if(n===0)break;n--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||n++;l=d}while(l)}function lf(n){var a=n.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var l=a;switch(a=a.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":lf(l),Lr(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}n.removeChild(l)}}function pw(n,a,l,d){for(;n.nodeType===1;){var g=l;if(n.nodeName.toLowerCase()!==a.toLowerCase()){if(!d&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(d){if(!n[ps])switch(a){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(y=n.getAttribute("rel"),y==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(y!==g.rel||n.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||n.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||n.getAttribute("title")!==(g.title==null?null:g.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(y=n.getAttribute("src"),(y!==(g.src==null?null:g.src)||n.getAttribute("type")!==(g.type==null?null:g.type)||n.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&y&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(a==="input"&&n.type==="hidden"){var y=g.name==null?null:""+g.name;if(g.type==="hidden"&&n.getAttribute("name")===y)return n}else return n;if(n=Cs(n.nextSibling),n===null)break}return null}function hw(n,a,l){if(a==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!l||(n=Cs(n.nextSibling),n===null))return null;return n}function Ox(n,a){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!a||(n=Cs(n.nextSibling),n===null))return null;return n}function cf(n){return n.data==="$?"||n.data==="$~"}function df(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function xw(n,a){var l=n.ownerDocument;if(n.data==="$~")n._reactRetry=a;else if(n.data!=="$?"||l.readyState!=="loading")a();else{var d=function(){a(),l.removeEventListener("DOMContentLoaded",d)};l.addEventListener("DOMContentLoaded",d),n._reactRetry=d}}function Cs(n){for(;n!=null;n=n.nextSibling){var a=n.nodeType;if(a===1||a===3)break;if(a===8){if(a=n.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return n}var uf=null;function qx(n){n=n.nextSibling;for(var a=0;n;){if(n.nodeType===8){var l=n.data;if(l==="/$"||l==="/&"){if(a===0)return Cs(n.nextSibling);a--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||a++}n=n.nextSibling}return null}function Fx(n){n=n.previousSibling;for(var a=0;n;){if(n.nodeType===8){var l=n.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(a===0)return n;a--}else l!=="/$"&&l!=="/&"||a++}n=n.previousSibling}return null}function Vx(n,a,l){switch(a=gc(l),n){case"html":if(n=a.documentElement,!n)throw Error(o(452));return n;case"head":if(n=a.head,!n)throw Error(o(453));return n;case"body":if(n=a.body,!n)throw Error(o(454));return n;default:throw Error(o(451))}}function $i(n){for(var a=n.attributes;a.length;)n.removeAttributeNode(a[0]);Lr(n)}var Es=new Map,Bx=new Set;function vc(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Er=H.d;H.d={f:gw,r:vw,D:yw,C:bw,L:Nw,m:ww,X:jw,S:Sw,M:Tw};function gw(){var n=Er.f(),a=cc();return n||a}function vw(n){var a=hs(n);a!==null&&a.tag===5&&a.type==="form"?lh(a):Er.r(n)}var Oo=typeof document>"u"?null:document;function $x(n,a,l){var d=Oo;if(d&&typeof a=="string"&&a){var g=pn(a);g='link[rel="'+n+'"][href="'+g+'"]',typeof l=="string"&&(g+='[crossorigin="'+l+'"]'),Bx.has(g)||(Bx.add(g),n={rel:n,crossOrigin:l,href:a},d.querySelector(g)===null&&(a=d.createElement("link"),jn(a,"link",n),Gt(a),d.head.appendChild(a)))}}function yw(n){Er.D(n),$x("dns-prefetch",n,null)}function bw(n,a){Er.C(n,a),$x("preconnect",n,a)}function Nw(n,a,l){Er.L(n,a,l);var d=Oo;if(d&&n&&a){var g='link[rel="preload"][as="'+pn(a)+'"]';a==="image"&&l&&l.imageSrcSet?(g+='[imagesrcset="'+pn(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(g+='[imagesizes="'+pn(l.imageSizes)+'"]')):g+='[href="'+pn(n)+'"]';var y=g;switch(a){case"style":y=qo(n);break;case"script":y=Fo(n)}Es.has(y)||(n=b({rel:"preload",href:a==="image"&&l&&l.imageSrcSet?void 0:n,as:a},l),Es.set(y,n),d.querySelector(g)!==null||a==="style"&&d.querySelector(Yi(y))||a==="script"&&d.querySelector(Ji(y))||(a=d.createElement("link"),jn(a,"link",n),Gt(a),d.head.appendChild(a)))}}function ww(n,a){Er.m(n,a);var l=Oo;if(l&&n){var d=a&&typeof a.as=="string"?a.as:"script",g='link[rel="modulepreload"][as="'+pn(d)+'"][href="'+pn(n)+'"]',y=g;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=Fo(n)}if(!Es.has(y)&&(n=b({rel:"modulepreload",href:n},a),Es.set(y,n),l.querySelector(g)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(Ji(y)))return}d=l.createElement("link"),jn(d,"link",n),Gt(d),l.head.appendChild(d)}}}function Sw(n,a,l){Er.S(n,a,l);var d=Oo;if(d&&n){var g=Xt(d).hoistableStyles,y=qo(n);a=a||"default";var S=g.get(y);if(!S){var C={loading:0,preload:null};if(S=d.querySelector(Yi(y)))C.loading=5;else{n=b({rel:"stylesheet",href:n,"data-precedence":a},l),(l=Es.get(y))&&ff(n,l);var U=S=d.createElement("link");Gt(U),jn(U,"link",n),U._p=new Promise(function(te,fe){U.onload=te,U.onerror=fe}),U.addEventListener("load",function(){C.loading|=1}),U.addEventListener("error",function(){C.loading|=2}),C.loading|=4,yc(S,a,d)}S={type:"stylesheet",instance:S,count:1,state:C},g.set(y,S)}}}function jw(n,a){Er.X(n,a);var l=Oo;if(l&&n){var d=Xt(l).hoistableScripts,g=Fo(n),y=d.get(g);y||(y=l.querySelector(Ji(g)),y||(n=b({src:n,async:!0},a),(a=Es.get(g))&&mf(n,a),y=l.createElement("script"),Gt(y),jn(y,"link",n),l.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},d.set(g,y))}}function Tw(n,a){Er.M(n,a);var l=Oo;if(l&&n){var d=Xt(l).hoistableScripts,g=Fo(n),y=d.get(g);y||(y=l.querySelector(Ji(g)),y||(n=b({src:n,async:!0,type:"module"},a),(a=Es.get(g))&&mf(n,a),y=l.createElement("script"),Gt(y),jn(y,"link",n),l.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},d.set(g,y))}}function Yx(n,a,l,d){var g=(g=me.current)?vc(g):null;if(!g)throw Error(o(446));switch(n){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(a=qo(l.href),l=Xt(g).hoistableStyles,d=l.get(a),d||(d={type:"style",instance:null,count:0,state:null},l.set(a,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){n=qo(l.href);var y=Xt(g).hoistableStyles,S=y.get(n);if(S||(g=g.ownerDocument||g,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(n,S),(y=g.querySelector(Yi(n)))&&!y._p&&(S.instance=y,S.state.loading=5),Es.has(n)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Es.set(n,l),y||Cw(g,n,l,S.state))),a&&d===null)throw Error(o(528,""));return S}if(a&&d!==null)throw Error(o(529,""));return null;case"script":return a=l.async,l=l.src,typeof l=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Fo(l),l=Xt(g).hoistableScripts,d=l.get(a),d||(d={type:"script",instance:null,count:0,state:null},l.set(a,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,n))}}function qo(n){return'href="'+pn(n)+'"'}function Yi(n){return'link[rel="stylesheet"]['+n+"]"}function Jx(n){return b({},n,{"data-precedence":n.precedence,precedence:null})}function Cw(n,a,l,d){n.querySelector('link[rel="preload"][as="style"]['+a+"]")?d.loading=1:(a=n.createElement("link"),d.preload=a,a.addEventListener("load",function(){return d.loading|=1}),a.addEventListener("error",function(){return d.loading|=2}),jn(a,"link",l),Gt(a),n.head.appendChild(a))}function Fo(n){return'[src="'+pn(n)+'"]'}function Ji(n){return"script[async]"+n}function Xx(n,a,l){if(a.count++,a.instance===null)switch(a.type){case"style":var d=n.querySelector('style[data-href~="'+pn(l.href)+'"]');if(d)return a.instance=d,Gt(d),d;var g=b({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return d=(n.ownerDocument||n).createElement("style"),Gt(d),jn(d,"style",g),yc(d,l.precedence,n),a.instance=d;case"stylesheet":g=qo(l.href);var y=n.querySelector(Yi(g));if(y)return a.state.loading|=4,a.instance=y,Gt(y),y;d=Jx(l),(g=Es.get(g))&&ff(d,g),y=(n.ownerDocument||n).createElement("link"),Gt(y);var S=y;return S._p=new Promise(function(C,U){S.onload=C,S.onerror=U}),jn(y,"link",d),a.state.loading|=4,yc(y,l.precedence,n),a.instance=y;case"script":return y=Fo(l.src),(g=n.querySelector(Ji(y)))?(a.instance=g,Gt(g),g):(d=l,(g=Es.get(y))&&(d=b({},l),mf(d,g)),n=n.ownerDocument||n,g=n.createElement("script"),Gt(g),jn(g,"link",d),n.head.appendChild(g),a.instance=g);case"void":return null;default:throw Error(o(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(d=a.instance,a.state.loading|=4,yc(d,l.precedence,n));return a.instance}function yc(n,a,l){for(var d=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=d.length?d[d.length-1]:null,y=g,S=0;S<d.length;S++){var C=d[S];if(C.dataset.precedence===a)y=C;else if(y!==g)break}y?y.parentNode.insertBefore(n,y.nextSibling):(a=l.nodeType===9?l.head:l,a.insertBefore(n,a.firstChild))}function ff(n,a){n.crossOrigin==null&&(n.crossOrigin=a.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=a.referrerPolicy),n.title==null&&(n.title=a.title)}function mf(n,a){n.crossOrigin==null&&(n.crossOrigin=a.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=a.referrerPolicy),n.integrity==null&&(n.integrity=a.integrity)}var bc=null;function Kx(n,a,l){if(bc===null){var d=new Map,g=bc=new Map;g.set(l,d)}else g=bc,d=g.get(l),d||(d=new Map,g.set(l,d));if(d.has(n))return d;for(d.set(n,null),l=l.getElementsByTagName(n),g=0;g<l.length;g++){var y=l[g];if(!(y[ps]||y[Bt]||n==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var S=y.getAttribute(a)||"";S=n+S;var C=d.get(S);C?C.push(y):d.set(S,[y])}}return d}function Wx(n,a,l){n=n.ownerDocument||n,n.head.insertBefore(l,a==="title"?n.querySelector("head > title"):null)}function Ew(n,a,l){if(l===1||a.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return n=a.disabled,typeof a.precedence=="string"&&n==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function Qx(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function _w(n,a,l,d){if(l.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var g=qo(d.href),y=a.querySelector(Yi(g));if(y){a=y._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(n.count++,n=Nc.bind(n),a.then(n,n)),l.state.loading|=4,l.instance=y,Gt(y);return}y=a.ownerDocument||a,d=Jx(d),(g=Es.get(g))&&ff(d,g),y=y.createElement("link"),Gt(y);var S=y;S._p=new Promise(function(C,U){S.onload=C,S.onerror=U}),jn(y,"link",d),l.instance=y}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(l,a),(a=l.state.preload)&&(l.state.loading&3)===0&&(n.count++,l=Nc.bind(n),a.addEventListener("load",l),a.addEventListener("error",l))}}var pf=0;function Aw(n,a){return n.stylesheets&&n.count===0&&Sc(n,n.stylesheets),0<n.count||0<n.imgCount?function(l){var d=setTimeout(function(){if(n.stylesheets&&Sc(n,n.stylesheets),n.unsuspend){var y=n.unsuspend;n.unsuspend=null,y()}},6e4+a);0<n.imgBytes&&pf===0&&(pf=62500*cw());var g=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&Sc(n,n.stylesheets),n.unsuspend)){var y=n.unsuspend;n.unsuspend=null,y()}},(n.imgBytes>pf?50:800)+a);return n.unsuspend=l,function(){n.unsuspend=null,clearTimeout(d),clearTimeout(g)}}:null}function Nc(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Sc(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var wc=null;function Sc(n,a){n.stylesheets=null,n.unsuspend!==null&&(n.count++,wc=new Map,a.forEach(kw,n),wc=null,Nc.call(n))}function kw(n,a){if(!(a.state.loading&4)){var l=wc.get(n);if(l)var d=l.get(null);else{l=new Map,wc.set(n,l);for(var g=n.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<g.length;y++){var S=g[y];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(l.set(S.dataset.precedence,S),d=S)}d&&l.set(null,d)}g=a.instance,S=g.getAttribute("data-precedence"),y=l.get(S)||d,y===d&&l.set(null,g),l.set(S,g),this.count++,d=Nc.bind(this),g.addEventListener("load",d),g.addEventListener("error",d),y?y.parentNode.insertBefore(g,y.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(g,n.firstChild)),a.state.loading|=4}}var Xi={$$typeof:A,Provider:null,Consumer:null,_currentValue:R,_currentValue2:R,_threadCount:0};function Iw(n,a,l,d,g,y,S,C,U){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=En(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=En(0),this.hiddenUpdates=En(null),this.identifierPrefix=d,this.onUncaughtError=g,this.onCaughtError=y,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=U,this.incompleteTransitions=new Map}function Zx(n,a,l,d,g,y,S,C,U,te,fe,ve){return n=new Iw(n,a,l,S,U,te,fe,ve,C),a=1,y===!0&&(a|=24),y=ns(3,null,null,a),n.current=y,y.stateNode=n,a=$d(),a.refCount++,n.pooledCache=a,a.refCount++,y.memoizedState={element:d,isDehydrated:l,cache:a},Kd(y),n}function eg(n){return n?(n=bo,n):bo}function tg(n,a,l,d,g,y){g=eg(g),d.context===null?d.context=g:d.pendingContext=g,d=Xr(a),d.payload={element:l},y=y===void 0?null:y,y!==null&&(d.callback=y),l=Kr(n,d,a),l!==null&&(Bn(l,n,a),Ei(l,n,a))}function ng(n,a){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var l=n.retryLane;n.retryLane=l!==0&&l<a?l:a}}function hf(n,a){ng(n,a),(n=n.alternate)&&ng(n,a)}function sg(n){if(n.tag===13||n.tag===31){var a=Ra(n,67108864);a!==null&&Bn(a,n,67108864),hf(n,67108864)}}function rg(n){if(n.tag===13||n.tag===31){var a=is();a=Sa(a);var l=Ra(n,a);l!==null&&Bn(l,n,a),hf(n,a)}}var jc=!0;function Mw(n,a,l,d){var g=q.T;q.T=null;var y=H.p;try{H.p=2,xf(n,a,l,d)}finally{H.p=y,q.T=g}}function Rw(n,a,l,d){var g=q.T;q.T=null;var y=H.p;try{H.p=8,xf(n,a,l,d)}finally{H.p=y,q.T=g}}function xf(n,a,l,d){if(jc){var g=gf(d);if(g===null)tf(n,a,d,Tc,l),og(n,d);else if(Uw(g,n,a,l,d))d.stopPropagation();else if(og(n,d),a&4&&-1<Dw.indexOf(n)){for(;g!==null;){var y=hs(g);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var S=fs(y.pendingLanes);if(S!==0){var C=y;for(C.pendingLanes|=2,C.entangledLanes|=2;S;){var U=1<<31-sn(S);C.entanglements[1]|=U,S&=~U}er(y),(vt&6)===0&&(ic=Q()+500,Fi(0))}}break;case 31:case 13:C=Ra(y,2),C!==null&&Bn(C,y,2),cc(),hf(y,2)}if(y=gf(d),y===null&&tf(n,a,d,Tc,l),y===g)break;g=y}g!==null&&d.stopPropagation()}else tf(n,a,d,null,l)}}function gf(n){return n=ho(n),vf(n)}var Tc=null;function vf(n){if(Tc=null,n=it(n),n!==null){var a=c(n);if(a===null)n=null;else{var l=a.tag;if(l===13){if(n=u(a),n!==null)return n;n=null}else if(l===31){if(n=m(a),n!==null)return n;n=null}else if(l===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;n=null}else a!==n&&(n=null)}}return Tc=n,null}function ag(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ne()){case se:return 2;case Se:return 8;case Ce:case Te:return 32;case Ge:return 268435456;default:return 32}default:return 32}}var yf=!1,ia=null,la=null,ca=null,Ki=new Map,Wi=new Map,da=[],Dw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function og(n,a){switch(n){case"focusin":case"focusout":ia=null;break;case"dragenter":case"dragleave":la=null;break;case"mouseover":case"mouseout":ca=null;break;case"pointerover":case"pointerout":Ki.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Wi.delete(a.pointerId)}}function Qi(n,a,l,d,g,y){return n===null||n.nativeEvent!==y?(n={blockedOn:a,domEventName:l,eventSystemFlags:d,nativeEvent:y,targetContainers:[g]},a!==null&&(a=hs(a),a!==null&&sg(a)),n):(n.eventSystemFlags|=d,a=n.targetContainers,g!==null&&a.indexOf(g)===-1&&a.push(g),n)}function Uw(n,a,l,d,g){switch(a){case"focusin":return ia=Qi(ia,n,a,l,d,g),!0;case"dragenter":return la=Qi(la,n,a,l,d,g),!0;case"mouseover":return ca=Qi(ca,n,a,l,d,g),!0;case"pointerover":var y=g.pointerId;return Ki.set(y,Qi(Ki.get(y)||null,n,a,l,d,g)),!0;case"gotpointercapture":return y=g.pointerId,Wi.set(y,Qi(Wi.get(y)||null,n,a,l,d,g)),!0}return!1}function ig(n){var a=it(n.target);if(a!==null){var l=c(a);if(l!==null){if(a=l.tag,a===13){if(a=u(l),a!==null){n.blockedOn=a,ms(n.priority,function(){rg(l)});return}}else if(a===31){if(a=m(l),a!==null){n.blockedOn=a,ms(n.priority,function(){rg(l)});return}}else if(a===3&&l.stateNode.current.memoizedState.isDehydrated){n.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Cc(n){if(n.blockedOn!==null)return!1;for(var a=n.targetContainers;0<a.length;){var l=gf(n.nativeEvent);if(l===null){l=n.nativeEvent;var d=new l.constructor(l.type,l);pi=d,l.target.dispatchEvent(d),pi=null}else return a=hs(l),a!==null&&sg(a),n.blockedOn=l,!1;a.shift()}return!0}function lg(n,a,l){Cc(n)&&l.delete(a)}function Pw(){yf=!1,ia!==null&&Cc(ia)&&(ia=null),la!==null&&Cc(la)&&(la=null),ca!==null&&Cc(ca)&&(ca=null),Ki.forEach(lg),Wi.forEach(lg)}function Ec(n,a){n.blockedOn===a&&(n.blockedOn=null,yf||(yf=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Pw)))}var _c=null;function cg(n){_c!==n&&(_c=n,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){_c===n&&(_c=null);for(var a=0;a<n.length;a+=3){var l=n[a],d=n[a+1],g=n[a+2];if(typeof d!="function"){if(vf(d||l)===null)continue;break}var y=hs(l);y!==null&&(n.splice(a,3),a-=3,xu(y,{pending:!0,data:g,method:l.method,action:d},d,g))}}))}function Vo(n){function a(U){return Ec(U,n)}ia!==null&&Ec(ia,n),la!==null&&Ec(la,n),ca!==null&&Ec(ca,n),Ki.forEach(a),Wi.forEach(a);for(var l=0;l<da.length;l++){var d=da[l];d.blockedOn===n&&(d.blockedOn=null)}for(;0<da.length&&(l=da[0],l.blockedOn===null);)ig(l),l.blockedOn===null&&da.shift();if(l=(n.ownerDocument||n).$$reactFormReplay,l!=null)for(d=0;d<l.length;d+=3){var g=l[d],y=l[d+1],S=g[wt]||null;if(typeof y=="function")S||cg(l);else if(S){var C=null;if(y&&y.hasAttribute("formAction")){if(g=y,S=y[wt]||null)C=S.formAction;else if(vf(g)!==null)continue}else C=S.action;typeof C=="function"?l[d+1]=C:(l.splice(d,3),d-=3),cg(l)}}}function dg(){function n(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(S){return g=S})},focusReset:"manual",scroll:"manual"})}function a(){g!==null&&(g(),g=null),d||setTimeout(l,20)}function l(){if(!d&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var d=!1,g=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(l,100),function(){d=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),g!==null&&(g(),g=null)}}}function bf(n){this._internalRoot=n}Ac.prototype.render=bf.prototype.render=function(n){var a=this._internalRoot;if(a===null)throw Error(o(409));var l=a.current,d=is();tg(l,d,n,a,null,null)},Ac.prototype.unmount=bf.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var a=n.containerInfo;tg(n.current,2,null,n,null,null),cc(),a[Kn]=null}};function Ac(n){this._internalRoot=n}Ac.prototype.unstable_scheduleHydration=function(n){if(n){var a=Xs();n={blockedOn:null,target:n,priority:a};for(var l=0;l<da.length&&a!==0&&a<da[l].priority;l++);da.splice(l,0,n),l===0&&ig(n)}};var ug=e.version;if(ug!=="19.2.3")throw Error(o(527,ug,"19.2.3"));H.findDOMNode=function(n){var a=n._reactInternals;if(a===void 0)throw typeof n.render=="function"?Error(o(188)):(n=Object.keys(n).join(","),Error(o(268,n)));return n=x(a),n=n!==null?v(n):null,n=n===null?null:n.stateNode,n};var Lw={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:q,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kc.isDisabled&&kc.supportsFiber)try{gt=kc.inject(Lw),bt=kc}catch{}}return el.createRoot=function(n,a){if(!i(n))throw Error(o(299));var l=!1,d="",g=vh,y=yh,S=bh;return a!=null&&(a.unstable_strictMode===!0&&(l=!0),a.identifierPrefix!==void 0&&(d=a.identifierPrefix),a.onUncaughtError!==void 0&&(g=a.onUncaughtError),a.onCaughtError!==void 0&&(y=a.onCaughtError),a.onRecoverableError!==void 0&&(S=a.onRecoverableError)),a=Zx(n,1,!1,null,null,l,d,null,g,y,S,dg),n[Kn]=a.current,ef(n),new bf(a)},el.hydrateRoot=function(n,a,l){if(!i(n))throw Error(o(299));var d=!1,g="",y=vh,S=yh,C=bh,U=null;return l!=null&&(l.unstable_strictMode===!0&&(d=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onUncaughtError!==void 0&&(y=l.onUncaughtError),l.onCaughtError!==void 0&&(S=l.onCaughtError),l.onRecoverableError!==void 0&&(C=l.onRecoverableError),l.formState!==void 0&&(U=l.formState)),a=Zx(n,1,!0,a,l??null,d,g,U,y,S,C,dg),a.context=eg(null),l=a.current,d=is(),d=Sa(d),g=Xr(d),g.callback=null,Kr(l,g,d),l=d,a.current.lanes=l,Js(a,l),er(a),n[Kn]=a.current,ef(n),new Ac(a)},el.version="19.2.3",el}var vg;function lS(){if(vg)return wf.exports;vg=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),wf.exports=iS(),wf.exports}var cS=lS();const dS={apiKey:"AIzaSyBo-pzCCfgPTIyoUNjDI3xhKytpjXaTTtw",authDomain:"project-manager-9d0ad.firebaseapp.com",projectId:"project-manager-9d0ad",storageBucket:"project-manager-9d0ad.firebasestorage.app",messagingSenderId:"156746866932",appId:"1:156746866932:web:48cc57f5ae6509dcc9bea1",measurementId:"G-1X19XQK677"};let Ic,xe,Ze,Wo;try{Ic=Bw(dS),xe=$w(Ic),Ze=Yw(Ic),Wo=Jw(Ic)}catch(t){throw console.error("Firebase initialization error:",t),t}const Le=t=>{if(!t)return 0;if(typeof t=="number")return t;if(t instanceof Date)return t.getTime();if(typeof t.toMillis=="function")return t.toMillis();if(t&&typeof t.seconds=="number")return t.seconds*1e3;if(typeof t=="string"){const e=new Date(t);return isNaN(e.getTime())?0:e.getTime()}return 0},Hc=t=>{if(!t)return"";const e=Math.abs(Date.now()-Le(t)),s=Math.round(e/6e4);if(s<60)return`${s||1}m ago`;const o=Math.round(s/60);if(o<24)return`${o}h ago`;const i=Math.round(o/24);if(i<30)return`${i}d ago`;const c=Math.round(i/30);return c<12?`${c}mo ago`:`${Math.round(c/12)}y ago`},rd="notifications",ti=async t=>{const e=xe.currentUser;if((e==null?void 0:e.uid)!==t.userId)try{await Pn(Un(Ze,rd),{...t,actorId:e==null?void 0:e.uid,actorName:(e==null?void 0:e.displayName)||"Someone",actorPhotoURL:(e==null?void 0:e.photoURL)||"",read:!1,createdAt:Ut()})}catch(s){console.error("Failed to create notification:",s)}},uS=(t,e)=>{const s=ds(Un(Ze,rd),us("userId","==",t),lm("createdAt","desc"));return Is(s,o=>{const i=o.docs.map(c=>({id:c.id,...c.data()}));e(i)},o=>{console.error("Error subscribing to notifications:",o),e([])})},fS=async t=>{try{const e=ot(Ze,rd,t);await mt(e,{read:!0})}catch(e){console.error("Failed to mark notification as read:",e)}},mS=async t=>{try{const e=ds(Un(Ze,rd),us("userId","==",t),us("read","==",!1)),s=await Lt(e),o=Xw(Ze);s.docs.forEach(i=>{o.update(i.ref,{read:!0})}),await o.commit()}catch(e){console.error("Failed to mark all notifications as read:",e)}},Gf=async(t,e,s,o,i)=>{await ti({userId:t,type:"task_assigned",title:"New Task Assignment",message:`You've been assigned to "${e}"`,projectId:s,taskId:o,tenantId:i})},pS=async(t,e,s,o,i,c,u)=>{await ti({userId:t,type:"comment_added",title:"New Comment",message:`New comment on ${s} "${e}"`,projectId:o,taskId:s==="task"?i:void 0,issueId:s==="issue"?i:void 0,commentId:c,tenantId:u})},hS=async(t,e,s,o)=>{await ti({userId:t,type:"project_invite",title:"Project Invitation",message:`You've been invited to project "${e}"`,projectId:s,tenantId:o})},xS=async(t,e,s,o,i,c)=>{await ti({userId:t,type:"subtask_assigned",title:"New Subtask Assignment",message:`You've been assigned to subtask "${e}" in task "${s}"`,projectId:o,taskId:i,tenantId:c})},gS=async(t,e)=>{try{const s={Accept:"application/vnd.github.v3+json"};e&&(s.Authorization=`token ${e}`);const o=await fetch(`https://api.github.com/repos/${t}/commits?per_page=5`,{headers:s});if(!o.ok){const i=await o.json();throw new Error(i.message||"Failed to fetch commits")}return await o.json()}catch(s){throw console.error("Error fetching GitHub commits:",s),s}},vS=async(t,e,s,o)=>{try{const i=await fetch(`https://api.github.com/repos/${t}/issues`,{method:"POST",headers:{Accept:"application/vnd.github.v3+json",Authorization:`token ${e}`,"Content-Type":"application/json"},body:JSON.stringify({title:s,body:o})});if(!i.ok){const u=await i.json();throw new Error(u.message||"Failed to create GitHub issue")}const c=await i.json();return{url:c.html_url,number:c.number}}catch(i){throw console.error("Error creating GitHub issue:",i),i}},yg=async t=>{try{const e=await fetch("https://api.github.com/user/repos?per_page=100&sort=updated",{headers:{Accept:"application/vnd.github.v3+json",Authorization:`token ${t}`}});if(!e.ok){const s=await e.json();throw new Error(s.message||"Failed to fetch repositories")}return await e.json()}catch(e){throw console.error("Error fetching user repositories:",e),e}},E0=async(t,e,s,o)=>{try{const i=await fetch(`https://api.github.com/repos/${t}/issues/${s}`,{method:"PATCH",headers:{Accept:"application/vnd.github.v3+json",Authorization:`token ${e}`,"Content-Type":"application/json"},body:JSON.stringify(o)});if(!i.ok){const c=await i.json();throw new Error(c.message||"Failed to update GitHub issue")}}catch(i){throw console.error("Error updating GitHub issue:",i),i}},yS=async(t,e,s,o)=>{try{const i=await fetch(`https://api.github.com/repos/${t}/issues/${s}/comments`,{method:"POST",headers:{Accept:"application/vnd.github.v3+json",Authorization:`token ${e}`,"Content-Type":"application/json"},body:JSON.stringify({body:o})});if(!i.ok){const c=await i.json();throw new Error(c.message||"Failed to post GitHub comment")}}catch(i){throw console.error("Error posting GitHub comment:",i),i}},bS=async(t,e,s)=>{try{const o={Accept:"application/vnd.github.v3+json"};e&&(o.Authorization=`token ${e}`);const i=await fetch(`https://api.github.com/repos/${t}/commits?per_page=100`,{headers:o});if(!i.ok){const m=await i.json();throw new Error(m.message||"Failed to fetch commits for reference")}const c=await i.json(),u=new RegExp(`(#|/issues/)${s}(\\D|$)`,"i");return c.filter(m=>u.test(m.commit.message))}catch(o){throw console.error("Error fetching commits for issue:",o),o}},_0="tenants",ad="projects",NS="users",ma="tasks",Fc="subtasks",pa="issues",no="ideas",Vc="mindmaps",od="activities",A0="taskCategories",um="comments",k0="geminiReports",I0="activeTenantId",so=()=>{try{return typeof localStorage>"u"?void 0:localStorage.getItem(I0)||void 0}catch{return}},gl=t=>{try{typeof localStorage<"u"&&localStorage.setItem(I0,t)}catch{}},Ar=()=>so(),ze=t=>{const e=xe.currentUser,s=t||so()||(e==null?void 0:e.uid);if(!s)throw new Error("User not authenticated");return s},ha=t=>ot(Ze,_0,t),kr=t=>Un(ha(t),NS),ro=t=>Un(ha(t),ad),Ms=(t,e)=>ot(ha(t),ad,e),yt=(t,e,s)=>Un(Ms(t,e),s),Zt=async(t,e)=>{const s=xe.currentUser;if(!s)return;const o=s.uid===t;if(o&&await to(ha(t),{tenantId:t,name:s.displayName||"Workspace",updatedAt:Ut()},{merge:!0}),!(await cn(ha(t))).exists()&&!o){console.warn(`ensureTenantAndUser: Tenant ${t} does not exist and user is not owner. Skipping.`);return}const c={uid:s.uid,email:s.email||"",displayName:s.displayName||"User",photoURL:s.photoURL||"",updatedAt:Ut()};e?c.role=e:o&&(c.role="Owner"),c.joinedAt=Ut(),await to(ot(kr(t),s.uid),c,{merge:!0});const u=ot(kr(t),s.uid),m=await cn(u);m.exists()&&!m.data().aiUsage&&await mt(u,{aiUsage:{tokensUsed:0,tokenLimit:1e6,lastReset:Ut()}})},Mn=async(t,e)=>{const s=ze(e),o=await cn(ot(kr(s),t));return o.exists()?o.data():null},ni=async(t,e,s)=>{const o=ze(s);await to(ot(kr(o),t),e,{merge:!0})},fm=async()=>{const t=xe.currentUser;if(!t)throw new Error("No user logged in");const e=new zf;e.addScope("repo"),e.addScope("user");try{const s=await Kw(t,e),o=zf.credentialFromResult(s);if(!(o!=null&&o.accessToken))throw new Error("Failed to get GitHub access token");return o.accessToken}catch(s){throw console.error("GitHub link error",s),s.code==="auth/credential-already-in-use"?new Error("This GitHub account is already linked to another user."):s}},vl=async(t,e)=>{var s,o;try{const i=ze(e),c=ot(kr(i),t),u=await cn(c);if(u.exists()){const m=u.data();if(m.aiUsage){const h=((o=(s=m.aiUsage.lastReset)==null?void 0:s.toDate)==null?void 0:o.call(s))||new Date(m.aiUsage.lastReset),x=new Date;if(x.getMonth()!==h.getMonth()||x.getFullYear()!==h.getFullYear()){const v={...m.aiUsage,tokensUsed:0,lastReset:Ut()};return await mt(c,{aiUsage:v}),v}}return m.aiUsage||null}}catch(i){console.warn("Failed to get AI usage",i)}return null},mm=async(t,e,s)=>{const o=ze(s),i=ot(kr(o),t);await mt(i,{"aiUsage.tokensUsed":cm(e)})},M0=async t=>{const e=await cn(ha(t));return e.exists()?{id:e.id,...e.data()}:null},R0=async(t,e)=>{if(!xe.currentUser)throw new Error("User not authenticated");await mt(ha(t),e)},ya=t=>{var o,i;const e=(o=t.parent)==null?void 0:o.parent,s=(i=e==null?void 0:e.parent)==null?void 0:i.parent;return{projectId:e==null?void 0:e.id,tenantId:s==null?void 0:s.id,projectRef:e}},Vs=async(t,e,s)=>{if(e&&s){const u=ot(yt(s,e,ma),t),m=await cn(u);if(m.exists())return m}if(e&&!s){const u=await $t(e);if(u!=null&&u.tenantId){const m=ot(yt(u.tenantId,e,ma),t),h=await cn(m);if(h.exists())return h}}const o=Fs(Ze,ma);return(await Lt(o)).docs.find(u=>u.id===t)||null},Bc=async(t,e,s)=>{if(e){const c=ze(s),u=ot(yt(c,e,no),t),m=await cn(u);if(m.exists())return m}const o=ds(Fs(Ze,no),us(dm(),"==",t));return(await Lt(o)).docs[0]||null},wS=async(t,e,s)=>{if(e){const c=ze(s),u=ot(yt(c,e,Vc),t),m=await cn(u);if(m.exists())return m}const o=ds(Fs(Ze,Vc),us(dm(),"==",t));return(await Lt(o)).docs[0]||null},pm=async(t,e,s,o)=>{if(e){const u=await Vs(e,s,o);if(u){const m=ot(Un(u.ref,Fc),t),h=await cn(m);if(h.exists())return h}}const i=ds(Fs(Ze,Fc),us(dm(),"==",t));return(await Lt(i)).docs[0]||null},Cn=async(t,e,s)=>{const o=xe.currentUser;if(!o)return;const i=ze(s);await Zt(i),await Pn(yt(i,t,od),{projectId:t,tenantId:i,ownerId:o.uid,user:e.user||o.displayName||"User",userAvatar:e.userAvatar||o.photoURL||"",action:e.action,target:e.target,details:e.details||"",type:e.type||"task",createdAt:Ut()})},id=async(t,e="Member")=>{gl(t),await Zt(t,e)},il=async t=>{const e=xe.currentUser;if(!e)throw new Error("User not authenticated");await Zt(e.uid);const s=t||so()||e.uid;s!==e.uid&&await Zt(s),gl(s)},hm=async(t,e,s,o,i)=>{const c=xe.currentUser;if(!c)throw new Error("User not authenticated");const u=ze(i);await Zt(u);let m="",h="";const x=[];try{if(e){const b=fl(Wo,`tenants/${u}/projects/${Date.now()}_${e.name}`);await ml(b,e),m=await pl(b)}}catch(b){console.warn("Cover upload failed, proceeding without cover",b)}try{if(s){const b=fl(Wo,`tenants/${u}/projects/${Date.now()}_icon_${s.name}`);await ml(b,s),h=await pl(b)}}catch(b){console.warn("Icon upload failed, proceeding without icon",b)}if(o&&o.length)for(const b of o)try{const N=fl(Wo,`tenants/${u}/projects/${Date.now()}_shot_${b.name}`);await ml(N,b);const T=await pl(N);x.push(T)}catch(N){console.warn("Screenshot upload failed, skipping file",b==null?void 0:b.name,N)}const v=await Pn(ro(u),{...t,tenantId:u,ownerId:c.uid,coverImage:m,squareIcon:h,screenshots:x,progress:0,members:[c.uid],memberIds:[c.uid],createdAt:Ut()});return await Cn(v.id,{action:`Created project "${t.title||"Project"}"`,target:"Project",type:"status"},u),v.id},D0=async(t,e,s,o)=>{const i=ze(o),c=Ms(i,t);await mt(c,e),s!=null&&s.action&&await Cn(t,{action:s.action,target:s.target||"Project",type:s.type||"status"},i)},U0=async(t,e,s)=>{const o=xe.currentUser;if(!o)throw new Error("User not authenticated");const i=ze(s);await Pn(yt(i,t,k0),{projectId:t,content:e,createdBy:o.uid,userName:o.displayName||"User",createdAt:Ut()}),await Cn(t,{action:"Generated project report",target:"AI Report",details:e,type:"report"},i)},Hf=async(t,e)=>{const s=ze(e),o=ds(yt(s,t,k0),lm("createdAt","desc"),S0(1)),i=await Lt(o);if(i.empty)return null;const c=i.docs[0].data();return{id:i.docs[0].id,...c}},P0=t=>{const e=t.path.split("/");return e[0]===_0&&e.length>=2?e[1]:null},$t=async(t,e)=>{try{const c=ze(e),u=await cn(Ms(c,t));if(u.exists())return{id:u.id,tenantId:c,...u.data()}}catch(c){console.warn("Failed to lookup project in active tenant, trying global search",c)}const s=Fs(Ze,ad),i=(await Lt(s)).docs.find(c=>c.id===t);if(i){const c=P0(i.ref);return{id:i.id,tenantId:c,...i.data()}}return null},L0=async(t,e)=>{const s=ze(e),o=Ms(s,t);await va(o)},xm=async()=>{const t=xe.currentUser;if(!t)return[];const e=ds(Fs(Ze,ad),us("memberIds","array-contains",t.uid));return(await Lt(e)).docs.map(o=>({id:o.id,tenantId:P0(o.ref),...o.data()})).filter(o=>o.ownerId!==t.uid).sort((o,i)=>Le(i.createdAt)-Le(o.createdAt))},z0=async(t,e=20)=>{if(!xe.currentUser)return[];const o=ze(t),i=ds(Fs(Ze,od),us("tenantId","==",o),lm("createdAt","desc"),S0(e));try{return(await Lt(i)).docs.map(u=>({id:u.id,...u.data()}))}catch(c){return console.error("Error fetching global activities:",c),[]}},G0=async(t,e,s="Editor")=>{const o=xe.currentUser;if(!o)throw new Error("User not authenticated");const i=Ms(e,t),c=await cn(i);if(!c.exists())throw new Error("Project not found");const u=c.data(),m=u.members||[];if(!(typeof m[0]=="string"?m.includes(o.uid):m.some(x=>x.userId===o.uid))){const x={userId:o.uid,role:s,joinedAt:new Date,invitedBy:u.ownerId};await mt(i,{members:[...m,x],memberIds:ei(o.uid)}),await to(ot(kr(e),o.uid),{uid:o.uid,email:o.email||"",displayName:o.displayName||"User",photoURL:o.photoURL||"",role:"Member",joinedAt:Ut(),updatedAt:Ut()},{merge:!0}),await Cn(t,{action:`${o.displayName||"User"} joined the project`,target:"Team",type:"status",user:o.displayName||"User"},e),u.ownerId!==o.uid&&await hS(u.ownerId,u.title||"Project",t,e)}},yl=async(t,e)=>{const s=ze(e),o=await $t(t,s);return!o||!o.members?[]:o.members.filter(i=>i!=null).map(i=>typeof i=="string"?i:i.userId)},$c=async(t,e,s)=>{const o=xe.currentUser;if(!o)throw new Error("User not authenticated");const i=ze(s),c=Ms(i,t),u=await cn(c);if(!u.exists())throw new Error("Project not found");const m=u.data();if(m.ownerId!==o.uid)throw new Error("Only the project owner can remove members");const h=m.members||[];console.log("Current members:",h),console.log("Removing userId:",e);const x=h.filter(v=>(typeof v=="string"?v:v.userId)!==e);console.log("Updated members:",x),await mt(c,{members:x,memberIds:Lf(e),updatedAt:Ut()}),console.log("Member removed successfully")},SS=async(t,e,s,o=24,i)=>{const c=xe.currentUser;if(!c)throw new Error("User not authenticated");const u=ze(i),m=await $t(t,u);if(!m)throw new Error("Project not found");if(m.ownerId!==c.uid)throw new Error("Only the project owner can create invite links");const h=Un(Ze,`tenants/${u}/projects/${t}/inviteLinks`),x={projectId:t,role:e,createdBy:c.uid,createdAt:Ut(),expiresAt:new Date(Date.now()+o*60*60*1e3),maxUses:s||null,uses:0,isActive:!0},v=await Pn(h,x);return`${window.location.origin}/join/${v.id}?projectId=${t}&tenantId=${u}`},H0=async(t,e,s)=>{var m,h;const o=ot(Ze,`tenants/${s}/projects/${e}/inviteLinks`,t),i=await cn(o);if(!i.exists())throw new Error("Invalid invite link");const c=i.data();if(!c.isActive)throw new Error("This invite link has been disabled");if((((h=(m=c.expiresAt)==null?void 0:m.toDate)==null?void 0:h.call(m))||new Date(c.expiresAt))<new Date)throw new Error("This invite link has expired");if(c.maxUses&&c.uses>=c.maxUses)throw new Error("This invite link has reached its maximum number of uses");return c.role},O0=async(t,e,s)=>{const o=xe.currentUser;if(!o)throw new Error("User not authenticated");const i=await H0(t,e,s),c=ot(Ze,`tenants/${s}/projects`,e),u=await cn(c);if(!u.exists())throw new Error("Project not found");const h=u.data().members||[];if(typeof h[0]=="string"?h.includes(o.uid):h.some(N=>N.userId===o.uid))throw new Error("You are already a member of this project");const v={userId:o.uid,role:i,joinedAt:new Date,invitedBy:"link"};await mt(c,{members:[...h,v],memberIds:ei(o.uid)}),await to(ot(Ze,`tenants/${s}/users`,o.uid),{uid:o.uid,displayName:o.displayName||"User",email:o.email,photoURL:o.photoURL,joinedAt:Ut(),lastActive:Ut()},{merge:!0});const b=ot(Ze,`tenants/${s}/projects/${e}/inviteLinks`,t);await mt(b,{uses:cm(1)}),await Cn(e,{action:`${o.displayName||"User"} joined the project`,target:"Team",type:"status",user:o.displayName||"User"},s)},q0=async(t="Member",e,s=24,o)=>{const i=xe.currentUser;if(!i)throw new Error("User not authenticated");const c=ze(o),u=Un(Ze,`tenants/${c}/inviteLinks`),m={createdBy:i.uid,createdAt:Ut(),expiresAt:new Date(Date.now()+s*60*60*1e3),maxUses:e||null,uses:0,role:t,isActive:!0},h=await Pn(u,m);return`${window.location.origin}/join-workspace/${h.id}?tenantId=${c}`},F0=async(t,e)=>{var u,m;const s=ot(Ze,`tenants/${e}/inviteLinks`,t),o=await cn(s);if(!o.exists())throw new Error("Invalid invite link");const i=o.data();if(!i.isActive)throw new Error("This invite link has been disabled");if((((m=(u=i.expiresAt)==null?void 0:u.toDate)==null?void 0:m.call(u))||new Date(i.expiresAt))<new Date)throw new Error("This invite link has expired");if(i.maxUses&&i.uses>=i.maxUses)throw new Error("This invite link has reached its maximum number of uses");return i.role||"Member"},V0=async(t,e)=>{if(!xe.currentUser)throw new Error("User not authenticated");const o=await F0(t,e);await id(e,o);const i=ot(Ze,`tenants/${e}/inviteLinks`,t);await mt(i,{uses:cm(1)})},gm=async t=>{const e=xe.currentUser;if(!e)return[];const s=so()||e.uid;await Zt(s);const o=ds(ro(s),us("ownerId","==",e.uid));return(await Lt(o)).docs.map(c=>({id:c.id,...c.data()})).sort((c,u)=>Le(u.createdAt)-Le(c.createdAt))},bl=async t=>{const e=xe.currentUser;if(!e)return[];const s=t||so()||e.uid;return await Zt(s),(await Lt(ro(s))).docs.map(i=>({id:i.id,...i.data()})).sort((i,c)=>Le(c.createdAt)-Le(i.createdAt))},vm=async t=>{const e=xe.currentUser;if(!e)return[];const s=so()||e.uid;await Zt(s);const i=(await bl(s)).map(async u=>{try{return(await Ir(u.id,u.tenantId)).map(h=>({...h,tenantId:u.tenantId}))}catch(m){return console.warn(`Failed to fetch tasks for project ${u.id}`,m),[]}});return(await Promise.all(i)).flat()},B0=async(t,e,s)=>{const o=xe.currentUser,c=(Array.isArray(e)?e:[e||""]).map(v=>v.trim()).filter(Boolean);if(!c.length)return;const u=ze(s),m=yt(u,t,A0),x=(await Lt(m)).docs.map(v=>(v.data().normalized||v.data().name||"").toLowerCase());for(const v of c){const b=v.toLowerCase();x.includes(b)||await Pn(m,{projectId:t,tenantId:u,ownerId:(o==null?void 0:o.uid)||"",name:v,normalized:b,createdAt:Ut()})}},Of=async(t,e)=>{const s=ze(e);return(await Lt(yt(s,t,A0))).docs.map(i=>({id:i.id,...i.data()})).sort((i,c)=>Le(c.createdAt)-Le(i.createdAt))},xa=async(t,e,s,o,i="Medium",c,u)=>{const m=xe.currentUser;if(!m)throw new Error("User not authenticated");const h=ze(u);await Zt(h);const x={projectId:t,tenantId:h,ownerId:m.uid,title:e,isCompleted:!1,dueDate:s||"",assignee:o||"",priority:i,description:(c==null?void 0:c.description)||"",category:(c==null?void 0:c.category)||[],status:(c==null?void 0:c.status)||"Open",assigneeId:(c==null?void 0:c.assigneeId)||(m.uid===o?m.uid:null),assigneeIds:(c==null?void 0:c.assigneeIds)||(c!=null&&c.assigneeId?[c.assigneeId]:[]),createdAt:Ut()};c!=null&&c.linkedIssueId&&(x.linkedIssueId=c.linkedIssueId);const v=await Pn(yt(h,t,ma),x);await B0(t,c==null?void 0:c.category,h),await Cn(t,{action:`Added task "${e}"`,target:"Tasks",type:"task"},h),await oi(t,h);const b=(c==null?void 0:c.assigneeIds)||(c!=null&&c.assigneeId?[c.assigneeId]:[]);for(const N of b)N&&N!==m.uid&&await Gf(N,e,t,v.id,h);return v.id},oi=async(t,e)=>{const s=ze(e),i=(await Lt(yt(s,t,ma))).docs.map(m=>m.data());if(i.length===0){await mt(Ms(s,t),{progress:0});return}const c=i.filter(m=>m.isCompleted||m.status==="Done").length,u=Math.round(c/i.length*100);await mt(Ms(s,t),{progress:u,updatedAt:Ut()})},$0=async(t,e,s)=>{const o=await Vs(t,e,s);if(o!=null&&o.exists()){const{tenantId:i,projectId:c}=ya(o.ref);return{id:o.id,tenantId:i,projectId:c,...o.data()}}return null},Ir=async(t,e)=>{const s=ze(e);return await Zt(s),(await Lt(yt(s,t,ma))).docs.map(i=>({id:i.id,...i.data(),path:i.ref.path})).sort((i,c)=>Le(c.createdAt)-Le(i.createdAt))},si=async()=>{const t=xe.currentUser;if(!t)return[];const e=ze(),s=ro(e);let o=[];try{o=(await Lt(s)).docs.map(x=>({id:x.id,...x.data()}))}catch(h){console.warn("Failed to fetch projects for user tasks",h)}const c=o.filter(h=>{var x;return((x=h.memberIds)==null?void 0:x.includes(t.uid))||h.ownerId===t.uid}).map(async h=>{try{return(await Ir(h.id,h.tenantId)).map(v=>({...v,tenantId:h.tenantId}))}catch{return[]}});return(await Promise.all(c)).flat().filter(h=>h.assigneeId===t.uid||h.assigneeIds&&h.assigneeIds.includes(t.uid)||h.ownerId===t.uid&&!h.assigneeId&&(!h.assigneeIds||h.assigneeIds.length===0))},Y0=async()=>{const t=xe.currentUser;if(!t)return[];const e=ze(),s=ro(e);let o=[];try{o=(await Lt(s)).docs.map(x=>({id:x.id,...x.data()}))}catch(h){console.warn("Failed to fetch projects for unassigned tasks",h)}const c=o.filter(h=>{var x;return((x=h.memberIds)==null?void 0:x.includes(t.uid))||h.ownerId===t.uid}).map(async h=>{try{return(await Ir(h.id,h.tenantId)).map(v=>({...v,tenantId:h.tenantId}))}catch{return[]}});return(await Promise.all(c)).flat().filter(h=>!h.assigneeId&&(!h.assigneeIds||h.assigneeIds.length===0))},J0=async t=>{if(!t||t.length===0)return[];const e=ze(),s=ro(e);let o=[];try{o=(await Lt(s)).docs.map(x=>({id:x.id,...x.data()}))}catch(h){console.warn("Failed to fetch projects for team tasks",h)}const c=o.filter(h=>h.ownerId&&t.includes(h.ownerId)||h.memberIds&&h.memberIds.some(x=>t.includes(x))).map(async h=>{try{return(await Ir(h.id,h.tenantId)).map(v=>({...v,tenantId:h.tenantId}))}catch{return[]}});return(await Promise.all(c)).flat().filter(h=>h.assigneeId&&t.includes(h.assigneeId)||h.assigneeIds&&h.assigneeIds.some(x=>t.includes(x)))},$a=async(t,e,s,o,i)=>{if(i){const u=ot(Ze,i);await mt(u,e);return}const c=await Vs(t,s,o);if(!c)throw new Error("Task not found");await mt(c.ref,e)},Nl=async(t,e,s,o)=>{const i=await Vs(t,s,o);if(!i)throw new Error("Task not found");const c=!e;await mt(i.ref,{isCompleted:c});const u=i.data(),{tenantId:m}=ya(i.ref);if(await Cn(u.projectId,{action:`${c?"Completed":"Reopened"} task "${u.title}"`,target:"Tasks",type:"task"},m),await oi(u.projectId,m),u.linkedIssueId)try{const h=ot(yt(m,u.projectId,pa),u.linkedIssueId);await mt(h,{status:c?"Resolved":"Open"}),await Cn(u.projectId,{action:`Auto-${c?"resolved":"reopened"} linked issue`,target:"Issues",type:"status"},m)}catch(h){console.warn("Failed to sync linked issue status",h)}},Xa=async(t,e,s,o)=>{const i=await Vs(t,s,o);if(!i)throw new Error("Task not found");const c=i.data(),u={};if(Object.entries(e).forEach(([x,v])=>{v!==void 0&&(u[x]=v)}),Object.keys(u).length===0)return;await mt(i.ref,u);const m=i.data(),{tenantId:h}=ya(i.ref);if(await Cn(m.projectId,{action:`Updated task "${m.title}"`,target:"Tasks",type:"task"},h),u.category&&await B0(m.projectId,u.category,h),(u.isCompleted!==void 0||u.status!==void 0)&&await oi(m.projectId,h),u.assigneeIds){const x=c.assigneeIds||[],b=(u.assigneeIds||[]).filter(N=>!x.includes(N));for(const N of b)await Gf(N,m.title,m.projectId,t,h)}else u.assigneeId&&u.assigneeId!==c.assigneeId&&await Gf(u.assigneeId,m.title,m.projectId,t,h)},X0=async(t,e,s)=>{const o=await Vs(t,e,s);if(!o)return;const i=o.data(),{tenantId:c}=ya(o.ref);await va(o.ref),await Cn(i.projectId,{action:`Deleted task "${i.title}"`,target:"Tasks",type:"task"},c),await oi(i.projectId,c)},K0=async(t,e,s,o)=>{const i=xe.currentUser;if(!i)throw new Error("User not authenticated");const c=await Vs(t,s,o);if(!c)throw new Error("Parent task not found");const u=c.data(),{tenantId:m}=ya(c.ref);await Pn(Un(c.ref,Fc),{taskId:t,projectId:u.projectId,tenantId:m,ownerId:i.uid,title:e,isCompleted:!1,createdAt:Ut()}),await Cn(u.projectId,{action:`Added subtask "${e}"`,target:u.title,type:"task"},m)},Yc=async(t,e,s)=>{const o=await Vs(t,e,s);return o?(await Lt(Un(o.ref,Fc))).docs.map(c=>({id:c.id,...c.data()})).sort((c,u)=>Le(u.createdAt)-Le(c.createdAt)):[]},W0=async(t,e,s,o,i)=>{const c=await pm(t,s,o,i);if(!c)return;await mt(c.ref,{isCompleted:!e});const u=c.data();if(!u)return;const m=await Vs(u.taskId,o,i),h=m==null?void 0:m.data(),{tenantId:x}=ya(c.ref);h&&await Cn(h.projectId,{action:`${e?"Reopened":"Completed"} subtask "${u.title}"`,target:h.title,type:"task"},x)},Q0=async(t,e,s,o)=>{const i=await pm(t,e,s,o);if(!i)return;const c=i.data(),{tenantId:u}=ya(i.ref);await va(i.ref),await Cn(c.projectId,{action:`Deleted subtask "${c.title}"`,target:"Tasks",type:"task"},u)},Z0=async(t,e,s,o,i)=>{const c=await pm(t,s,o,i);if(!c)throw new Error("Subtask not found");const u=c.data();if(await mt(c.ref,e),e.assigneeId&&e.assigneeId!==u.assigneeId){const m=await Vs(u.taskId,o,i),h=m==null?void 0:m.data();h&&await xS(e.assigneeId,u.title,h.title,h.projectId,u.taskId,i)}},Za=async(t,e)=>{const s=xe.currentUser;if(!s)throw new Error("User not authenticated");const o=ze(e);await Zt(o);const i=t.projectId?yt(o,t.projectId,no):Un(ha(o),no);await Pn(i,{...t,tenantId:o,ownerId:s.uid,createdAt:Ut()})},cs=async(t,e,s,o)=>{const i=await Bc(t,s,o);if(!i)throw new Error("Idea not found");await mt(i.ref,e)},Jc=async(t,e,s)=>{const o=await Bc(t,e,s);o&&await va(o.ref)},Xc=async()=>{const t=xe.currentUser;if(!t)return[];const e=ds(Fs(Ze,no),us("ownerId","==",t.uid));return(await Lt(e)).docs.map(o=>({id:o.id,...o.data()})).sort((o,i)=>Le(i.createdAt)-Le(o.createdAt))},ld=async(t,e)=>{const s=ze(e);return await Zt(s),(await Lt(yt(s,t,no))).docs.map(i=>({id:i.id,...i.data()})).sort((i,c)=>Le(c.createdAt)-Le(i.createdAt))},Ka=async(t,e)=>{const s=ze(e);return await Zt(s),(await Lt(yt(s,t,Vc))).docs.map(i=>({id:i.id,...i.data()})).sort((i,c)=>Le(i.createdAt)-Le(c.createdAt))},qf=async(t,e,s)=>{const o=xe.currentUser;if(!o)throw new Error("User not authenticated");const i=ze(s);return await Zt(i),(await Pn(yt(i,t,Vc),{projectId:t,tenantId:i,ownerId:o.uid,name:e,createdAt:Ut()})).id},ey=async(t,e,s,o)=>{const i=await wS(t,s,o);if(!i)throw new Error("Mindmap not found");await mt(i.ref,{name:e})},ty=async(t,e)=>{const s=ze(e);return await Zt(s),(await Lt(yt(s,t,od))).docs.map(i=>({id:i.id,...i.data()})).sort((i,c)=>Le(c.createdAt)-Le(i.createdAt)).slice(0,20)},ym=async(t,e,s)=>{const o=xe.currentUser;if(!o)throw new Error("User not authenticated");const i=ze(s);await Zt(i);const c={projectId:t,tenantId:i,ownerId:o.uid,title:e.title||"Untitled Issue",description:e.description||"",status:e.status||"Open",priority:e.priority||"Medium",reporter:o.displayName||"User",assignee:e.assignee||"",assigneeId:e.assigneeId||null,assigneeIds:e.assigneeIds||(e.assigneeId?[e.assigneeId]:[]),reporterId:o.uid,createdAt:Ut()};try{const u=await $t(t,i);if(u!=null&&u.githubIssueSync&&u.githubRepo){let m=u.githubToken;if(!m&&o.uid){const h=await Mn(o.uid,i);m=h==null?void 0:h.githubToken}if(m){const h=await vS(u.githubRepo,m,c.title,c.description||"Created via ProjectFlow");c.githubIssueUrl=h.url,c.githubIssueNumber=h.number}}}catch(u){console.warn("GitHub issue sync failed",u)}await Pn(yt(i,t,pa),c),await Cn(t,{action:`Reported issue "${e.title}"`,target:"Issues",type:"report"},i)},cd=async(t,e,s,o)=>{if(e){const u=ze(s),m=ot(yt(u,e,pa),t),h=await cn(m);if(h.exists())return h}const i=Fs(Ze,pa);return(await Lt(i)).docs.find(u=>u.id===t)||null},Kc=async(t,e,s)=>{const o=await cd(t,e,s);if(o!=null&&o.exists()){const{tenantId:i,projectId:c}=ya(o.ref);return{id:o.id,tenantId:i,projectId:c,...o.data()}}return null},Hs=async(t,e,s,o,i)=>{const c=ze(o);let u=null,m=null;if(i){m=ot(Ze,i);const h=await cn(m);h.exists()&&(u={id:h.id,...h.data()}),await mt(m,e)}else{const h=await cd(t,s,o);if(!h)throw new Error("Issue not found or access denied");u={id:h.id,...h.data()},m=h.ref,await mt(m,e)}if(u!=null&&u.githubIssueNumber&&(e.status||e.title||e.description))try{const h=await $t(s,c);if(h!=null&&h.githubIssueSync&&h.githubRepo){const x=xe.currentUser;let v=h.githubToken;if(!v&&(x!=null&&x.uid)){const b=await Mn(x.uid,c);v=b==null?void 0:b.githubToken}if(v){const b={};e.status&&(b.state=e.status==="Resolved"||e.status==="Closed"?"closed":"open"),e.title&&(b.title=e.title),e.description&&(b.body=e.description),Object.keys(b).length>0&&await E0(h.githubRepo,v,u.githubIssueNumber,b)}}}catch(h){console.warn("Failed to sync changes to GitHub",h)}if(u!=null&&u.linkedTaskId&&e.status){const h=e.status==="Resolved"||e.status==="Closed",x=e.status==="Open"||e.status==="In Progress";if(h||x)try{const v=ot(yt(c,s,ma),u.linkedTaskId),b=await cn(v);if(b.exists()){const N=b.data(),T=h&&!N.isCompleted,_=x&&N.isCompleted;(T||_)&&(await mt(v,{isCompleted:h,status:h?"Done":"Open"}),await Cn(s,{action:`Auto-${h?"completed":"reopened"} linked task`,target:"Tasks",type:"task"},c),await oi(s,c))}}catch(v){console.warn("Failed to sync linked task status",v)}}},ny=async(t,e,s,o)=>{const i=await cd(t,e,s);if(!i)return;const c=i.data();if(c!=null&&c.githubIssueNumber)try{const u=ze(s),m=await $t(e,u);if(m!=null&&m.githubIssueSync&&m.githubRepo){const h=xe.currentUser;let x=m.githubToken;if(!x&&(h!=null&&h.uid)){const v=await Mn(h.uid,u);x=v==null?void 0:v.githubToken}x&&await E0(m.githubRepo,x,c.githubIssueNumber,{state:"closed"})}}catch(u){console.warn("Failed to close GitHub issue on delete",u)}await va(i.ref)},wl=(t,e,s)=>{const o=ze(s);return Is(yt(o,t,pa),i=>{const c=i.docs.map(u=>({id:u.id,...u.data()})).sort((u,m)=>Le(m.createdAt)-Le(u.createdAt));e(c)})},ii=(t,e,s)=>{const o=ze(s);return Is(yt(o,t,ma),i=>{const c=i.docs.map(u=>({id:u.id,...u.data()})).sort((u,m)=>Le(m.createdAt)-Le(u.createdAt));e(c)})},ll=async(t,e,s)=>{const o=xe.currentUser;if(!o)return;const i=ze(s),c=ot(yt(i,t,"presence"),o.uid);try{await to(c,{uid:o.uid,displayName:o.displayName||"User",photoURL:o.photoURL||"",email:o.email||"",state:e,title:o.title||"",lastChanged:Ut()},{merge:!0})}catch(u){console.error("Failed to update presence",u)}},sy=async t=>{const e=xe.currentUser;if(!e)throw new Error("No user");let s=t.photoURL||e.photoURL;const o=so();if(t.file){const i=o?`tenants/${o}/users/${e.uid}/avatar_${Date.now()}`:`users/${e.uid}/avatar_${Date.now()}`,c=fl(Wo,i);await ml(c,t.file),s=await pl(c)}if((t.displayName||s)&&await j0(e,{displayName:t.displayName||e.displayName,photoURL:s}),o){const i=ot(kr(o),e.uid);await to(i,{displayName:t.displayName||e.displayName,photoURL:s,title:t.title||"",bio:t.bio||"",email:e.email},{merge:!0})}return s},ry=(t,e,s)=>{const o=ze(s);return Is(yt(o,t,"presence"),i=>{const c=i.docs.map(u=>u.data()).filter(u=>u.state==="online"||u.lastChanged&&Date.now()-Le(u.lastChanged)<3e5).map(u=>({...u,isOnline:!0}));e(c)})},bm=(t,e,s)=>{if(s)return Zt(s).catch(()=>{}),Is(Ms(s,t),i=>{i.exists()?e({id:i.id,tenantId:s,...i.data()}):e(null)});let o;return $t(t).then(i=>{if(!i){e(null);return}const c=i.tenantId||ze();Zt(c).catch(()=>{}),o=Is(Ms(c,t),u=>{u.exists()?e({id:u.id,tenantId:c,...u.data()}):e(null)})}).catch(i=>{console.error("Failed to find project for subscription",i),e(null)}),()=>{o&&o()}},Nm=(t,e,s)=>{const o=ze(s);return Is(yt(o,t,no),i=>{const c=i.docs.map(u=>({id:u.id,...u.data()})).sort((u,m)=>Le(m.createdAt)-Le(u.createdAt));e(c)})},ay=(t,e,s)=>{const o=ze(s);return Is(yt(o,t,od),i=>{const c=i.docs.map(u=>({id:u.id,...u.data()})).sort((u,m)=>Le(m.createdAt)-Le(u.createdAt)).slice(0,20);e(c)})},ba=(t,e)=>{const s=ze(e);return Is(kr(s),o=>{const i=o.docs.map(c=>({id:c.id,...c.data()}));t(i)})},oy=async(t,e,s,o,i)=>{const c=xe.currentUser;if(!c)throw new Error("User not authenticated");const u=ze(i);await Zt(u);const m=await Pn(yt(u,t,um),{projectId:t,targetId:e,targetType:s,userId:c.uid,userDisplayName:c.displayName||"User",userPhotoURL:c.photoURL||"",content:o,createdAt:Ut()});if(s==="idea"){const v=await Bc(e,t,u);if(v){const b=v.data().comments||0;mt(v.ref,{comments:b+1})}}if(s==="issue")try{const v=await Kc(e,t,u);if(v!=null&&v.githubIssueNumber){const b=await $t(t,u);if(b!=null&&b.githubIssueSync&&b.githubRepo){let N=b.githubToken;if(!N&&c.uid){const T=await Mn(c.uid,u);N=T==null?void 0:T.githubToken}N&&await yS(b.githubRepo,N,v.githubIssueNumber,`${o}

 *Shared from ProjectFlow by ${c.displayName||"User"}*`)}}}catch(v){console.warn("Failed to sync comment to GitHub",v)}let h="",x="";if(s==="task"){const v=await Vs(e,t,u);if(v){const b=v.data();h=b.title,x=b.ownerId}}else if(s==="issue"){const v=await cd(e,t,u);if(v){const b=v.data();h=b.title,x=b.ownerId}}else if(s==="idea"){const v=await Bc(e,t,u);if(v){const b=v.data();h=b.title,x=b.ownerId||""}}x&&x!==c.uid&&await pS(x,h,s,t,e,m.id,u)},iy=(t,e,s,o)=>{const i=ze(o),c=ds(yt(i,t,um),us("targetId","==",e));return Is(c,u=>{const m=u.docs.map(h=>({id:h.id,...h.data()})).sort((h,x)=>Le(h.createdAt)-Le(x.createdAt));s(m)})},ly=async(t,e,s)=>{const o=ze(s);await va(ot(yt(o,e,um),t))},wm=async()=>{const t=xe.currentUser;if(!t)return[];const e=ds(Fs(Ze,pa),us("assigneeId","==",t.uid)),o=(await Lt(e)).docs.map(h=>{const x=h.data(),v=h.ref.path.split("/"),b=v.length>=2&&v[0]==="tenants"?v[1]:void 0,N=v.length>=4&&v[2]==="projects"?v[3]:void 0;return{id:h.id,...x,tenantId:x.tenantId||b,projectId:x.projectId||N,path:h.ref.path}}),i=ds(Fs(Ze,pa),us("assigneeIds","array-contains",t.uid)),u=(await Lt(i)).docs.map(h=>{const x=h.data(),v=h.ref.path.split("/"),b=v.length>=2&&v[0]==="tenants"?v[1]:void 0,N=v.length>=4&&v[2]==="projects"?v[3]:void 0;return{id:h.id,...x,tenantId:x.tenantId||b,projectId:x.projectId||N,path:h.ref.path}}),m=[...o];return u.forEach(h=>{m.find(x=>x.id===h.id)||m.push(h)}),m.sort((h,x)=>Le(x.createdAt)-Le(h.createdAt))},cy=(t,e)=>{const s=ze(e);return Zt(s).catch(()=>{}),Is(ro(s),o=>{const i=o.docs.map(c=>({id:c.id,...c.data()}));t(i)})},dy=async(t,e,s)=>{const o=ze(s),i=ot(Ze,`tenants/${o}/users`,t);await mt(i,{role:e})},uy=(t,e)=>{const s=ze(e);return Is(Un(Ze,`tenants/${s}/groups`),o=>{const i=o.docs.map(c=>({id:c.id,...c.data()}));t(i)})},fy=async(t,e,s,o)=>{const i=ze(o);await Pn(Un(Ze,`tenants/${i}/groups`),{tenantId:i,name:t,color:e||"#3b82f6",description:s||"",memberIds:[],createdAt:Ut()})},my=async(t,e)=>{const s=ze(e);await va(ot(Ze,`tenants/${s}/groups`,t))},py=async(t,e,s)=>{const o=ze(s),i=ot(Ze,`tenants/${o}/groups`,e);await mt(i,{memberIds:ei(t)});const c=ot(Ze,`tenants/${o}/users`,t);await mt(c,{groupIds:ei(e)})},Sm=async(t,e,s)=>{const o=ze(s),i=ot(Ze,`tenants/${o}/groups`,e);await mt(i,{memberIds:Lf(t)});const c=ot(Ze,`tenants/${o}/users`,t);await mt(c,{groupIds:Lf(e)})},hy=async(t,e)=>{const s=ot(Ze,`tenants/${e}/users/${t}`),o=await cn(s);if(o.exists()){const c=o.data().groupIds||[];for(const u of c)await Sm(t,u,e)}await va(s)},xy=async(t,e,s="Viewer",o)=>{const i=ze(o),c=Ms(i,t),u=await Mn(e,i),m=xe.currentUser,h={userId:e,role:s,joinedAt:T0.now(),invitedBy:(m==null?void 0:m.uid)||"system",displayName:(u==null?void 0:u.displayName)||"Unknown",email:(u==null?void 0:u.email)||"",photoURL:(u==null?void 0:u.photoURL)||""};await mt(c,{members:ei(h),memberIds:ei(e)});try{await Cn(t,{action:`added ${(u==null?void 0:u.displayName)||"a member"} to the team`,target:"Team",type:"member"},i)}catch(x){console.warn("Failed to log activity",x)}},gy=async(t,e)=>{var u;const s=xe.currentUser;if(!s)throw new Error("Must be logged in");const o=ze(e);await Zt(o);const i=await $t(t,o);if(!i)throw new Error("Project not found");if((u=i.members)!=null&&u.some(m=>m.userId===s.uid)||i.ownerId===s.uid)throw new Error("Already a member");const c={type:"project_join_request",userId:i.ownerId,title:"Project Join Request",message:`${s.displayName||"A user"} requested to join ${i.title}`,read:!1,createdAt:Ut(),projectId:i.id,actorId:s.uid,actorName:s.displayName||"Unknown",actorPhotoURL:s.photoURL||null,tenantId:o};await Pn(Un(Ze,"notifications"),c),await Cn(t,{action:"requested to join the project",target:"Team",type:"member"},o)},vy=async(t,e,s,o,i)=>{const c=ze(i),u=xe.currentUser;if(await mt(ot(Ze,"notifications",t),{type:o?"project_join_request_accepted":"project_join_request_denied",read:!0}),o){await xy(e,s,"Editor",c);const m=await $t(e,c);await ti({type:"project_shared",userId:s,title:"Request Approved",message:`Your request to join ${(m==null?void 0:m.title)||"a project"} was approved.`,projectId:e,actorId:u==null?void 0:u.uid,tenantId:c})}else{const m=await $t(e,c);await ti({type:"project_shared",userId:s,title:"Request Denied",message:`Your request to join ${(m==null?void 0:m.title)||"a project"} was denied.`,projectId:e,actorId:u==null?void 0:u.uid,tenantId:c})}},yy=async(t,e,s,o)=>{const i=ze(o),c=Ms(i,t);await Ww(Ze,async u=>{const m=await u.get(c);if(!m.exists())throw new Error("Project not found");const x=m.data().members||[],v=x.findIndex(_=>(typeof _=="string"?_:_.userId)===e);if(v===-1)throw new Error("Member not found in project");const b=x[v];let N;typeof b=="string"?N={userId:b,role:s,joinedAt:T0.now(),invitedBy:"system",displayName:"Member",email:"",photoURL:""}:N={...b,role:s};const T=[...x];T[v]=N,u.update(c,{members:T})})},by=Object.freeze(Object.defineProperty({__proto__:null,ISSUES:pa,addComment:oy,addProjectMember:xy,addSubTask:K0,addTask:xa,addUserToGroup:py,bootstrapTenantForCurrentUser:il,createIssue:ym,createMindmap:qf,createProject:hm,createWorkspaceGroup:fy,deleteComment:ly,deleteIdea:Jc,deleteIssue:ny,deleteProjectById:L0,deleteSubTask:Q0,deleteTask:X0,deleteWorkspaceGroup:my,ensureTenantAndUser:Zt,generateInviteLink:SS,generateWorkspaceInviteLink:q0,getAIUsage:vl,getActiveTenantId:Ar,getAllWorkspaceProjects:bl,getAllWorkspaceTasks:vm,getIssueById:Kc,getLatestGeminiReport:Hf,getProjectActivity:ty,getProjectById:$t,getProjectCategories:Of,getProjectIdeas:ld,getProjectMembers:yl,getProjectMindmaps:Ka,getProjectTasks:Ir,getSharedProjects:xm,getSubTasks:Yc,getTaskById:$0,getTenant:M0,getUnassignedTasks:Y0,getUserGlobalActivities:z0,getUserIdeas:Xc,getUserIssues:wm,getUserProfile:Mn,getUserProjects:gm,getUserTasks:si,getUsersTasks:J0,incrementAIUsage:mm,joinProject:G0,joinProjectViaLink:O0,joinTenant:id,joinWorkspaceViaLink:V0,linkWithGithub:fm,projectSubCollection:yt,removeMember:$c,removeUserFromGroup:Sm,removeUserFromWorkspace:hy,requestJoinProject:gy,resolveTenantId:ze,respondToJoinRequest:vy,saveGeminiReport:U0,saveIdea:Za,setActiveTenantId:gl,subscribeComments:iy,subscribeProject:bm,subscribeProjectActivity:ay,subscribeProjectIdeas:Nm,subscribeProjectIssues:wl,subscribeProjectPresence:ry,subscribeProjectTasks:ii,subscribeTenantProjects:cy,subscribeTenantUsers:ba,subscribeWorkspaceGroups:uy,syncProjectProgress:oi,toggleSubTaskStatus:W0,toggleTaskStatus:Nl,updateIdea:cs,updateIssue:Hs,updateMindmapName:ey,updatePresence:ll,updateProjectFields:D0,updateProjectMemberRole:yy,updateSubtaskFields:Z0,updateTask:$a,updateTaskFields:Xa,updateTenant:R0,updateUserData:ni,updateUserProfile:sy,updateUserRole:dy,validateInviteLink:H0,validateWorkspaceInviteLink:F0},Symbol.toStringTag,{value:"Module"})),jS="/assets/logo-DSjP0oUR.svg",TS={theme:"light",setTheme:()=>null},Ny=w.createContext(TS);function CS({children:t,defaultTheme:e="light",storageKey:s="vite-ui-theme"}){const[o,i]=w.useState(()=>localStorage.getItem(s)||e);w.useEffect(()=>{const u=C0(xe,async m=>{if(m)try{const h=await Mn(m.uid);h!=null&&h.theme&&(h.theme==="light"||h.theme==="dark"||h.theme==="system")&&(i(h.theme),localStorage.setItem(s,h.theme))}catch(h){console.warn("Failed to sync theme from profile",h)}});return()=>u()},[s]),w.useEffect(()=>{const u=window.document.documentElement;if(u.classList.remove("light","dark"),o==="system"){const m=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";u.classList.add(m);return}u.classList.add(o)},[o]);const c={theme:o,setTheme:u=>{localStorage.setItem(s,u),i(u),xe.currentUser&&ni(xe.currentUser.uid,{theme:u}).catch(m=>console.error("Failed to sync theme to cloud",m))}};return r.jsx(Ny.Provider,{value:c,children:t})}const wy=()=>{const t=w.useContext(Ny);if(t===void 0)throw new Error("useTheme must be used within a ThemeProvider");return t},_s=({to:t,icon:e,label:s,badge:o,onClick:i,exact:c=!1,isSubItem:u=!1})=>{const m=ai(),h=c?m.pathname===t:t==="/"?m.pathname==="/":m.pathname.startsWith(t);return r.jsxs(nt,{to:t,onClick:i,className:`
                group flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all duration-200
                ${u?"ml-4":""}
                ${h?"bg-[var(--color-surface-hover)] text-[var(--color-text-main)] font-bold shadow-sm":"text-[var(--color-text-muted)] hover:bg-[var(--color-surface-hover)] hover:text-[var(--color-text-main)]"}
            `,children:[r.jsx("span",{className:`material-symbols-outlined text-[20px] transition-colors ${h?"text-[var(--color-text-main)]":"group-hover:text-[var(--color-text-main)]"}`,children:e}),r.jsx("span",{className:"text-sm flex-1 truncate",children:s}),o!==void 0&&o>0&&r.jsx("span",{className:`
                    text-[10px] font-bold px-2 py-0.5 rounded-full 
                    ${h?"bg-[var(--color-text-main)] text-[var(--color-surface-bg)]":"bg-[var(--color-surface-border)] text-[var(--color-text-muted)] group-hover:bg-[var(--color-surface-border)]"}
                `,children:o})]})},bg=({isDrawer:t=!1,onClose:e,workspace:s})=>{const o=dn(),i=xe.currentUser,[c,u]=nr.useState(0),[m,h]=nr.useState(0),[x,v]=nr.useState(!1);nr.useEffect(()=>{let N=!0;return(async()=>{try{const[T,_]=await Promise.all([si(),ld("").catch(()=>[])]);if(N&&i){const I=Array.isArray(T)?T.filter(E=>!E.isCompleted&&(E.assigneeId===i.uid||E.assigneeIds&&E.assigneeIds.includes(i.uid))):[];u(I.length),h(Array.isArray(_)?_.length:0)}}catch(T){console.warn("Failed to load counts",T)}})(),()=>{N=!1}},[i]);const b=async()=>{try{await Qw(xe),o("/login")}catch(N){console.error("Error signing out:",N)}};return r.jsxs("aside",{className:`
                flex flex-col bg-[var(--color-surface-card)] border-r border-[var(--color-surface-border)]
                ${t?"w-full h-full":"hidden md:flex w-72"}
                transition-all duration-300
            `,children:[r.jsxs("div",{className:"flex items-center gap-3 px-6 py-5 border-b border-[var(--color-surface-border)]",children:[r.jsx("img",{src:jS,alt:"ProjectFlow",className:"size-8 object-contain"}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("h2",{className:"text-lg font-bold leading-tight text-[var(--color-text-main)] tracking-tight",children:"ProjectFlow"}),r.jsx("p",{className:"text-xs text-[var(--color-text-muted)] truncate",children:"Workspace"})]}),t&&r.jsx("button",{onClick:e,className:"size-8 rounded-full hover:bg-[var(--color-surface-hover)] flex items-center justify-center text-[var(--color-text-muted)]",children:r.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),r.jsx("div",{className:"px-4 py-4",children:r.jsxs(nt,{to:"/create",onClick:t?e:void 0,className:`
                        w-full flex items-center justify-center gap-2 px-4 py-2.5 
                        bg-[var(--color-primary)] text-white 
                        dark:text-black
                        hover:bg-opacity-90 hover:shadow-lg
                        rounded-xl text-sm font-semibold transition-all duration-200
                        active:scale-95 shadow-md shadow-gray-900/10
                    `,children:[r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"add"}),"New Project"]})}),r.jsxs("nav",{className:"flex flex-col gap-1 px-4 flex-1 overflow-y-auto",children:[(s==null?void 0:s.projectId)&&r.jsxs("div",{className:"mb-6",children:[r.jsx("div",{className:"flex items-center gap-2 px-3 mb-2",children:r.jsx("span",{className:"text-[11px] font-bold uppercase tracking-wider text-[var(--color-text-subtle)]",children:"Active Project"})}),r.jsxs("div",{className:"bg-[var(--color-surface-bg)] rounded-2xl p-2 border border-[var(--color-surface-border)]",children:[r.jsx(_s,{to:`/project/${s.projectId}`,icon:"space_dashboard",label:"Overview",exact:!0,onClick:t?e:void 0}),(!s.modules||s.modules.includes("tasks"))&&r.jsx(_s,{to:`/project/${s.projectId}/tasks`,icon:"checklist",label:"Tasks",badge:s.tasksCount,onClick:t?e:void 0}),(!s.modules||s.modules.includes("ideas"))&&r.jsx(_s,{to:`/project/${s.projectId}/ideas`,icon:"lightbulb",label:"Ideas",badge:s.ideasCount,onClick:t?e:void 0}),(!s.modules||s.modules.includes("mindmap"))&&r.jsx(_s,{to:`/project/${s.projectId}/mindmap`,icon:"hub",label:"Mindmap",onClick:t?e:void 0}),(!s.modules||s.modules.includes("activity"))&&r.jsx(_s,{to:`/project/${s.projectId}/activity`,icon:"history",label:"Activity",onClick:t?e:void 0}),(!s.modules||s.modules.includes("issues"))&&r.jsx(_s,{to:`/project/${s.projectId}/issues`,icon:"bug_report",label:"Issues",badge:s.issuesCount,onClick:t?e:void 0}),s.externalResources&&s.externalResources.length>0&&r.jsxs("div",{className:"mt-2 pt-2 border-t border-[var(--color-surface-border)]",children:[r.jsx("p",{className:"px-3 mb-1 text-[10px] uppercase font-bold text-[var(--color-text-subtle)]",children:"Links"}),s.externalResources.map((N,T)=>r.jsxs("a",{href:N.url,target:"_blank",rel:"noopener noreferrer",className:"group flex items-center gap-3 px-3 py-2 rounded-xl text-[var(--color-text-muted)] hover:bg-[var(--color-surface-hover)] hover:text-[var(--color-text-main)] transition-all duration-200",onClick:t?e:void 0,children:[r.jsx("span",{className:"material-symbols-outlined text-[18px] group-hover:text-[var(--color-text-main)]",children:N.icon||"open_in_new"}),r.jsx("span",{className:"text-sm flex-1 truncate",children:N.title})]},T))]}),r.jsx("div",{className:"h-px bg-[var(--color-surface-border)] my-2 mx-2"}),r.jsxs(nt,{to:"/",className:"flex items-center gap-2 px-3 py-2 text-xs font-semibold text-[var(--color-text-muted)] hover:text-[var(--color-text-main)] transition-colors",children:[r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"arrow_back"}),"Back to Dashboard"]})]})]}),r.jsxs("div",{className:"mb-2",children:[r.jsx("p",{className:"px-3 mb-2 text-[11px] font-bold uppercase tracking-wider text-[var(--color-text-subtle)]",children:"Main Menu"}),r.jsx(_s,{to:"/",icon:"dashboard",label:"Dashboard",exact:!0,onClick:t?e:void 0}),r.jsx(_s,{to:"/calendar",icon:"calendar_month",label:"Calendar",onClick:t?e:void 0}),r.jsx(_s,{to:"/projects",icon:"folder",label:"Projects",onClick:t?e:void 0}),r.jsx(_s,{to:"/tasks",icon:"check_circle",label:"My Tasks",badge:c,onClick:t?e:void 0}),r.jsx(_s,{to:"/brainstorm",icon:"auto_awesome",label:"AI Studio",badge:m,onClick:t?e:void 0}),r.jsx(_s,{to:"/team",icon:"group",label:"Team",onClick:t?e:void 0})]})]}),r.jsxs("div",{className:"p-4 border-t border-[var(--color-surface-border)]",children:[r.jsx("div",{className:"mb-3 flex justify-start",children:r.jsx(ES,{})}),r.jsxs("div",{className:"relative",children:[x&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>v(!1)}),r.jsxs("div",{className:"absolute bottom-full left-0 right-0 mb-2 bg-[var(--color-surface-bg)] border border-[var(--color-surface-border)] shadow-2xl rounded-xl z-20 overflow-hidden animate-fade-up ring-1 ring-black/5 dark:ring-white/10",children:[r.jsx("div",{className:"p-2 border-b border-[var(--color-surface-border)] bg-[var(--color-surface-hover)]/30",children:r.jsx("p",{className:"px-2 text-xs font-bold text-[var(--color-text-muted)] uppercase",children:"My Account"})}),r.jsxs(nt,{to:"/profile",onClick:()=>{v(!1),t&&e&&e()},className:"flex items-center gap-3 px-4 py-3 hover:bg-[var(--color-surface-hover)] text-[var(--color-text-main)] transition-colors",children:[r.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"badge"}),r.jsx("span",{className:"text-sm font-medium",children:"Profile"})]}),r.jsxs(nt,{to:"/settings",onClick:()=>{v(!1),t&&e&&e()},className:"flex items-center gap-3 px-4 py-3 hover:bg-[var(--color-surface-hover)] text-[var(--color-text-main)] transition-colors",children:[r.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"settings"}),r.jsx("span",{className:"text-sm font-medium",children:"Team Settings"})]}),r.jsxs("button",{onClick:b,className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-red-50 dark:hover:bg-red-900/10 text-red-600 dark:text-red-400 transition-colors text-left",children:[r.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"logout"}),r.jsx("span",{className:"text-sm font-medium",children:"Log Out"})]})]})]}),r.jsxs("div",{onClick:()=>v(!x),className:`flex items-center gap-3 p-2 rounded-xl border transition-all cursor-pointer group ${x?"bg-[var(--color-surface-hover)] border-[var(--color-primary)] ring-1 ring-[var(--color-primary)]":"bg-transparent border-transparent hover:bg-[var(--color-surface-hover)]"}`,children:[r.jsx("div",{className:"bg-center bg-no-repeat aspect-square bg-cover rounded-full size-9 border border-[var(--color-surface-border)] shadow-sm shrink-0",style:{backgroundImage:i!=null&&i.photoURL?`url("${i.photoURL}")`:'url("https://lh3.googleusercontent.com/aida-public/AB6AXuAUDnuDd21ZOybk43aAFZMF8BuZPooFbf615qSB3FofT8gp9e1995VjvW8jb9otnKFfzKlRUh60cKlpKWO3PvuhE5SmZa8nS03FSRIcFLcXxBiGJtYkrxjsmdGVHcgXXCySiQs7nDjqbvc0w8WmGBVGn6T-oQ43k7QWEmuuRT63iGTXNcnzfTKZ9eU-yYSgTWcRFORG_HHCxTuCFSUWxbu8OjYbx5-4qd8bOwHJCBM2tr-e5Ml5LlAUucWxYA4xRF_69RInugzbiW0")'}}),r.jsxs("div",{className:"flex flex-col flex-1 min-w-0",children:[r.jsx("span",{className:"text-sm font-bold text-[var(--color-text-main)] truncate",children:(i==null?void 0:i.displayName)||"User"}),r.jsx("span",{className:"text-[11px] text-[var(--color-text-muted)] truncate",children:i==null?void 0:i.email})]}),r.jsx("span",{className:`material-symbols-outlined text-[var(--color-text-muted)] transition-transform duration-300 ${x?"rotate-180":""}`,children:"expand_less"})]})]})]})]})},ES=()=>{const{theme:t,setTheme:e}=wy();return r.jsxs("div",{className:"flex bg-[var(--color-surface-hover)] p-1 rounded-full border border-[var(--color-surface-border)] relative w-fit",children:[r.jsxs("button",{onClick:()=>e("light"),className:`relative z-10 flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-bold transition-all duration-300 ${t==="light"?"text-yellow-600 bg-white shadow-sm":"text-[var(--color-text-muted)] hover:text-[var(--color-text-main)]"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"light_mode"}),r.jsx("span",{children:"Light"})]}),r.jsxs("button",{onClick:()=>e("dark"),className:`relative z-10 flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-bold transition-all duration-300 ${t==="dark"?"text-indigo-200 bg-slate-800 shadow-sm":"text-[var(--color-text-muted)] hover:text-[var(--color-text-main)]"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"dark_mode"}),r.jsx("span",{children:"Dark"})]})]})},_S=({items:t=[]})=>{ai();const e=[r.jsx(nt,{to:"/",className:"text-[var(--color-text-muted)] hover:text-[var(--color-text-main)] transition-colors flex items-center",children:r.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"home"})},"home")];return t.length>0&&t.forEach((s,o)=>{e.push(r.jsx("span",{className:"text-[var(--color-text-subtle)] mx-1",children:"/"},`sep-${o}`)),s.to?e.push(r.jsx(nt,{to:s.to,className:"text-sm font-semibold text-[var(--color-text-muted)] hover:text-[var(--color-text-main)] transition-colors",children:s.label},o)):e.push(r.jsx("span",{className:"text-sm font-semibold text-[var(--color-text-main)]",children:s.label},o))}),r.jsx("div",{className:"flex items-center",children:e})};var AS={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let kS,IS;function MS(){return{geminiUrl:kS,vertexUrl:IS}}function RS(t,e,s,o){var i,c;if(!(t!=null&&t.baseUrl)){const u=MS();return e?(i=u.vertexUrl)!==null&&i!==void 0?i:s:(c=u.geminiUrl)!==null&&c!==void 0?c:o}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Rr{}function ke(t,e){const s=/\{([^}]+)\}/g;return t.replace(s,(o,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const c=e[i];return c!=null?String(c):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function p(t,e,s){for(let c=0;c<e.length-1;c++){const u=e[c];if(u.endsWith("[]")){const m=u.slice(0,-2);if(!(m in t))if(Array.isArray(s))t[m]=Array.from({length:s.length},()=>({}));else throw new Error(`Value must be a list given an array path ${u}`);if(Array.isArray(t[m])){const h=t[m];if(Array.isArray(s))for(let x=0;x<h.length;x++){const v=h[x];p(v,e.slice(c+1),s[x])}else for(const x of h)p(x,e.slice(c+1),s)}return}else if(u.endsWith("[0]")){const m=u.slice(0,-3);m in t||(t[m]=[{}]);const h=t[m];p(h[0],e.slice(c+1),s);return}(!t[u]||typeof t[u]!="object")&&(t[u]={}),t=t[u]}const o=e[e.length-1],i=t[o];if(i!==void 0){if(!s||typeof s=="object"&&Object.keys(s).length===0||s===i)return;if(typeof i=="object"&&typeof s=="object"&&i!==null&&s!==null)Object.assign(i,s);else throw new Error(`Cannot set value for an existing key. Key: ${o}`)}else o==="_self"&&typeof s=="object"&&s!==null&&!Array.isArray(s)?Object.assign(t,s):t[o]=s}function f(t,e,s=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let o=0;o<e.length;o++){if(typeof t!="object"||t===null)return s;const i=e[o];if(i.endsWith("[]")){const c=i.slice(0,-2);if(c in t){const u=t[c];return Array.isArray(u)?u.map(m=>f(m,e.slice(o+1),s)):s}else return s}else t=t[i]}return t}catch(o){if(o instanceof TypeError)return s;throw o}}function DS(t,e){for(const[s,o]of Object.entries(e)){const i=s.split("."),c=o.split("."),u=new Set;let m=-1;for(let h=0;h<i.length;h++)if(i[h]==="*"){m=h;break}if(m!==-1&&c.length>m)for(let h=m;h<c.length;h++){const x=c[h];x!=="*"&&!x.endsWith("[]")&&!x.endsWith("[0]")&&u.add(x)}Ff(t,i,c,0,u)}}function Ff(t,e,s,o,i){if(o>=e.length||typeof t!="object"||t===null)return;const c=e[o];if(c.endsWith("[]")){const u=c.slice(0,-2),m=t;if(u in m&&Array.isArray(m[u]))for(const h of m[u])Ff(h,e,s,o+1,i)}else if(c==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const u=t,m=Object.keys(u).filter(x=>!x.startsWith("_")&&!i.has(x)),h={};for(const x of m)h[x]=u[x];for(const[x,v]of Object.entries(h)){const b=[];for(const N of s.slice(o))N==="*"?b.push(x):b.push(N);p(u,b,v)}for(const x of m)delete u[x]}}else{const u=t;c in u&&Ff(u[c],e,s,o+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function jm(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function US(t){const e={},s=f(t,["operationName"]);s!=null&&p(e,["operationName"],s);const o=f(t,["resourceName"]);return o!=null&&p(e,["_url","resourceName"],o),e}function PS(t){const e={},s=f(t,["name"]);s!=null&&p(e,["name"],s);const o=f(t,["metadata"]);o!=null&&p(e,["metadata"],o);const i=f(t,["done"]);i!=null&&p(e,["done"],i);const c=f(t,["error"]);c!=null&&p(e,["error"],c);const u=f(t,["response","generateVideoResponse"]);return u!=null&&p(e,["response"],zS(u)),e}function LS(t){const e={},s=f(t,["name"]);s!=null&&p(e,["name"],s);const o=f(t,["metadata"]);o!=null&&p(e,["metadata"],o);const i=f(t,["done"]);i!=null&&p(e,["done"],i);const c=f(t,["error"]);c!=null&&p(e,["error"],c);const u=f(t,["response"]);return u!=null&&p(e,["response"],GS(u)),e}function zS(t){const e={},s=f(t,["generatedSamples"]);if(s!=null){let c=s;Array.isArray(c)&&(c=c.map(u=>HS(u))),p(e,["generatedVideos"],c)}const o=f(t,["raiMediaFilteredCount"]);o!=null&&p(e,["raiMediaFilteredCount"],o);const i=f(t,["raiMediaFilteredReasons"]);return i!=null&&p(e,["raiMediaFilteredReasons"],i),e}function GS(t){const e={},s=f(t,["videos"]);if(s!=null){let c=s;Array.isArray(c)&&(c=c.map(u=>OS(u))),p(e,["generatedVideos"],c)}const o=f(t,["raiMediaFilteredCount"]);o!=null&&p(e,["raiMediaFilteredCount"],o);const i=f(t,["raiMediaFilteredReasons"]);return i!=null&&p(e,["raiMediaFilteredReasons"],i),e}function HS(t){const e={},s=f(t,["video"]);return s!=null&&p(e,["video"],YS(s)),e}function OS(t){const e={},s=f(t,["_self"]);return s!=null&&p(e,["video"],JS(s)),e}function qS(t){const e={},s=f(t,["operationName"]);return s!=null&&p(e,["_url","operationName"],s),e}function FS(t){const e={},s=f(t,["operationName"]);return s!=null&&p(e,["_url","operationName"],s),e}function VS(t){const e={},s=f(t,["name"]);s!=null&&p(e,["name"],s);const o=f(t,["metadata"]);o!=null&&p(e,["metadata"],o);const i=f(t,["done"]);i!=null&&p(e,["done"],i);const c=f(t,["error"]);c!=null&&p(e,["error"],c);const u=f(t,["response"]);return u!=null&&p(e,["response"],BS(u)),e}function BS(t){const e={},s=f(t,["sdkHttpResponse"]);s!=null&&p(e,["sdkHttpResponse"],s);const o=f(t,["parent"]);o!=null&&p(e,["parent"],o);const i=f(t,["documentName"]);return i!=null&&p(e,["documentName"],i),e}function Sy(t){const e={},s=f(t,["name"]);s!=null&&p(e,["name"],s);const o=f(t,["metadata"]);o!=null&&p(e,["metadata"],o);const i=f(t,["done"]);i!=null&&p(e,["done"],i);const c=f(t,["error"]);c!=null&&p(e,["error"],c);const u=f(t,["response"]);return u!=null&&p(e,["response"],$S(u)),e}function $S(t){const e={},s=f(t,["sdkHttpResponse"]);s!=null&&p(e,["sdkHttpResponse"],s);const o=f(t,["parent"]);o!=null&&p(e,["parent"],o);const i=f(t,["documentName"]);return i!=null&&p(e,["documentName"],i),e}function YS(t){const e={},s=f(t,["uri"]);s!=null&&p(e,["uri"],s);const o=f(t,["encodedVideo"]);o!=null&&p(e,["videoBytes"],jm(o));const i=f(t,["encoding"]);return i!=null&&p(e,["mimeType"],i),e}function JS(t){const e={},s=f(t,["gcsUri"]);s!=null&&p(e,["uri"],s);const o=f(t,["bytesBase64Encoded"]);o!=null&&p(e,["videoBytes"],jm(o));const i=f(t,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ng;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Ng||(Ng={}));var wg;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(wg||(wg={}));var Sg;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(Sg||(Sg={}));var Ve;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(Ve||(Ve={}));var jg;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(jg||(jg={}));var Tg;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Tg||(Tg={}));var Cg;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(Cg||(Cg={}));var Eg;(function(t){t.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",t.HTTP_IN_QUERY="HTTP_IN_QUERY",t.HTTP_IN_HEADER="HTTP_IN_HEADER",t.HTTP_IN_PATH="HTTP_IN_PATH",t.HTTP_IN_BODY="HTTP_IN_BODY",t.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(Eg||(Eg={}));var _g;(function(t){t.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",t.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",t.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",t.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(_g||(_g={}));var Ag;(function(t){t.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",t.LOW="LOW",t.HIGH="HIGH"})(Ag||(Ag={}));var kg;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(kg||(kg={}));var Ig;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(Ig||(Ig={}));var Mg;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(Mg||(Mg={}));var Rg;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE",t.IMAGE_RECITATION="IMAGE_RECITATION",t.IMAGE_OTHER="IMAGE_OTHER"})(Rg||(Rg={}));var Dg;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(Dg||(Dg={}));var Ug;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Ug||(Ug={}));var Pg;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Pg||(Pg={}));var Lg;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY",t.MODEL_ARMOR="MODEL_ARMOR",t.JAILBREAK="JAILBREAK"})(Lg||(Lg={}));var zg;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(zg||(zg={}));var Wc;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(Wc||(Wc={}));var Gg;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Gg||(Gg={}));var Hg;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(Hg||(Hg={}));var Og;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Og||(Og={}));var Vf;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Vf||(Vf={}));var qg;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V",t.TUNING_TASK_R2V="TUNING_TASK_R2V"})(qg||(qg={}));var Fg;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Fg||(Fg={}));var Vg;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(Vg||(Vg={}));var Bg;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(Bg||(Bg={}));var $g;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})($g||($g={}));var Yg;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(Yg||(Yg={}));var Jg;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(Jg||(Jg={}));var Xg;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(Xg||(Xg={}));var Kg;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(Kg||(Kg={}));var Wg;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(Wg||(Wg={}));var Qg;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Qg||(Qg={}));var Zg;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Zg||(Zg={}));var ev;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(ev||(ev={}));var tv;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(tv||(tv={}));var nv;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(nv||(nv={}));var sv;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(sv||(sv={}));var rv;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(rv||(rv={}));var av;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(av||(av={}));var ov;(function(t){t.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",t.PREFERENCE_TUNING="PREFERENCE_TUNING"})(ov||(ov={}));var iv;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.STATE_PENDING="STATE_PENDING",t.STATE_ACTIVE="STATE_ACTIVE",t.STATE_FAILED="STATE_FAILED"})(iv||(iv={}));var lv;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(lv||(lv={}));var cv;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(cv||(cv={}));var dv;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(dv||(dv={}));var uv;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(uv||(uv={}));var fv;(function(t){t.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",t.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",t.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(fv||(fv={}));var mv;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(mv||(mv={}));var pv;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(pv||(pv={}));var hv;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(hv||(hv={}));var xv;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(xv||(xv={}));var gv;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(gv||(gv={}));var vv;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(vv||(vv={}));var Jo;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(Jo||(Jo={}));class Bf{constructor(e){const s={};for(const o of e.headers.entries())s[o[0]]=o[1];this.headers=s,this.responseInternal=e}json(){return this.responseInternal.json()}}class tl{get text(){var e,s,o,i,c,u,m,h;if(((i=(o=(s=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||s===void 0?void 0:s.content)===null||o===void 0?void 0:o.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let x="",v=!1;const b=[];for(const N of(h=(m=(u=(c=this.candidates)===null||c===void 0?void 0:c[0])===null||u===void 0?void 0:u.content)===null||m===void 0?void 0:m.parts)!==null&&h!==void 0?h:[]){for(const[T,_]of Object.entries(N))T!=="text"&&T!=="thought"&&T!=="thoughtSignature"&&(_!==null||_!==void 0)&&b.push(T);if(typeof N.text=="string"){if(typeof N.thought=="boolean"&&N.thought)continue;v=!0,x+=N.text}}return b.length>0&&console.warn(`there are non-text parts ${b} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),v?x:void 0}get data(){var e,s,o,i,c,u,m,h;if(((i=(o=(s=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||s===void 0?void 0:s.content)===null||o===void 0?void 0:o.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let x="";const v=[];for(const b of(h=(m=(u=(c=this.candidates)===null||c===void 0?void 0:c[0])===null||u===void 0?void 0:u.content)===null||m===void 0?void 0:m.parts)!==null&&h!==void 0?h:[]){for(const[N,T]of Object.entries(b))N!=="inlineData"&&(T!==null||T!==void 0)&&v.push(N);b.inlineData&&typeof b.inlineData.data=="string"&&(x+=atob(b.inlineData.data))}return v.length>0&&console.warn(`there are non-data parts ${v} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),x.length>0?btoa(x):void 0}get functionCalls(){var e,s,o,i,c,u,m,h;if(((i=(o=(s=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||s===void 0?void 0:s.content)===null||o===void 0?void 0:o.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const x=(h=(m=(u=(c=this.candidates)===null||c===void 0?void 0:c[0])===null||u===void 0?void 0:u.content)===null||m===void 0?void 0:m.parts)===null||h===void 0?void 0:h.filter(v=>v.functionCall).map(v=>v.functionCall).filter(v=>v!==void 0);if((x==null?void 0:x.length)!==0)return x}get executableCode(){var e,s,o,i,c,u,m,h,x;if(((i=(o=(s=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||s===void 0?void 0:s.content)===null||o===void 0?void 0:o.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const v=(h=(m=(u=(c=this.candidates)===null||c===void 0?void 0:c[0])===null||u===void 0?void 0:u.content)===null||m===void 0?void 0:m.parts)===null||h===void 0?void 0:h.filter(b=>b.executableCode).map(b=>b.executableCode).filter(b=>b!==void 0);if((v==null?void 0:v.length)!==0)return(x=v==null?void 0:v[0])===null||x===void 0?void 0:x.code}get codeExecutionResult(){var e,s,o,i,c,u,m,h,x;if(((i=(o=(s=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||s===void 0?void 0:s.content)===null||o===void 0?void 0:o.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const v=(h=(m=(u=(c=this.candidates)===null||c===void 0?void 0:c[0])===null||u===void 0?void 0:u.content)===null||m===void 0?void 0:m.parts)===null||h===void 0?void 0:h.filter(b=>b.codeExecutionResult).map(b=>b.codeExecutionResult).filter(b=>b!==void 0);if((v==null?void 0:v.length)!==0)return(x=v==null?void 0:v[0])===null||x===void 0?void 0:x.output}}class yv{}class bv{}class XS{}class KS{}class WS{}class QS{}class Nv{}class wv{}class Sv{}class ZS{}class Qc{_fromAPIResponse({apiResponse:e,_isVertexAI:s}){const o=new Qc;let i;const c=e;return s?i=LS(c):i=PS(c),Object.assign(o,i),o}}class jv{}class Tv{}class Cv{}class Ev{}class ej{}class tj{}class nj{}class Tm{_fromAPIResponse({apiResponse:e,_isVertexAI:s}){const o=new Tm,c=VS(e);return Object.assign(o,c),o}}class sj{}class rj{}class aj{}class _v{}class oj{get text(){var e,s,o;let i="",c=!1;const u=[];for(const m of(o=(s=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||s===void 0?void 0:s.parts)!==null&&o!==void 0?o:[]){for(const[h,x]of Object.entries(m))h!=="text"&&h!=="thought"&&x!==null&&u.push(h);if(typeof m.text=="string"){if(typeof m.thought=="boolean"&&m.thought)continue;c=!0,i+=m.text}}return u.length>0&&console.warn(`there are non-text parts ${u} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),c?i:void 0}get data(){var e,s,o;let i="";const c=[];for(const u of(o=(s=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||s===void 0?void 0:s.parts)!==null&&o!==void 0?o:[]){for(const[m,h]of Object.entries(u))m!=="inlineData"&&h!==null&&c.push(m);u.inlineData&&typeof u.inlineData.data=="string"&&(i+=atob(u.inlineData.data))}return c.length>0&&console.warn(`there are non-data parts ${c} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class ij{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class Cm{_fromAPIResponse({apiResponse:e,_isVertexAI:s}){const o=new Cm,c=Sy(e);return Object.assign(o,c),o}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xt(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const s=e.split("/",2);return`publishers/${s[0]}/models/${s[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function jy(t,e){const s=xt(t,e);return s?s.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${s}`:s.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${s}`:s:""}function Ty(t){return Array.isArray(t)?t.map(e=>Zc(e)):[Zc(t)]}function Zc(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function Cy(t){const e=Zc(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Ey(t){const e=Zc(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Av(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function _y(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>Av(e)):[Av(t)]}function $f(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function kv(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function Iv(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function _n(t){if(t==null)throw new Error("ContentUnion is required");return $f(t)?t:{role:"user",parts:_y(t)}}function Em(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(s=>{const o=_n(s);return o.parts&&o.parts.length>0&&o.parts[0].text!==void 0?[o.parts[0].text]:[]});if(t.isVertexAI()){const s=_n(e);return s.parts&&s.parts.length>0&&s.parts[0].text!==void 0?[s.parts[0].text]:[]}return Array.isArray(e)?e.map(s=>_n(s)):[_n(e)]}function ks(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(kv(t)||Iv(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[_n(t)]}const e=[],s=[],o=$f(t[0]);for(const i of t){const c=$f(i);if(c!=o)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(c)e.push(i);else{if(kv(i)||Iv(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");s.push(i)}}return o||e.push({role:"user",parts:_y(s)}),e}function lj(t,e){t.includes("null")&&(e.nullable=!0);const s=t.filter(o=>o!=="null");if(s.length===1)e.type=Object.values(Ve).includes(s[0].toUpperCase())?s[0].toUpperCase():Ve.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const o of s)e.anyOf.push({type:Object.values(Ve).includes(o.toUpperCase())?o.toUpperCase():Ve.TYPE_UNSPECIFIED})}}function Qo(t){const e={},s=["items"],o=["anyOf"],i=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const c=t.anyOf;c!=null&&c.length==2&&(c[0].type==="null"?(e.nullable=!0,t=c[1]):c[1].type==="null"&&(e.nullable=!0,t=c[0])),t.type instanceof Array&&lj(t.type,e);for(const[u,m]of Object.entries(t))if(m!=null)if(u=="type"){if(m==="null")throw new Error("type: null can not be the only possible type for the field.");if(m instanceof Array)continue;e.type=Object.values(Ve).includes(m.toUpperCase())?m.toUpperCase():Ve.TYPE_UNSPECIFIED}else if(s.includes(u))e[u]=Qo(m);else if(o.includes(u)){const h=[];for(const x of m){if(x.type=="null"){e.nullable=!0;continue}h.push(Qo(x))}e[u]=h}else if(i.includes(u)){const h={};for(const[x,v]of Object.entries(m))h[x]=Qo(v);e[u]=h}else{if(u==="additionalProperties")continue;e[u]=m}return e}function _m(t){return Qo(t)}function Am(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function km(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function li(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Qo(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Qo(e.response));return t}function ci(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const s of t)e.push(s);return e}function cj(t,e,s,o=1){const i=!e.startsWith(`${s}/`)&&e.split("/").length===o;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${s}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:i?`projects/${t.getProject()}/locations/${t.getLocation()}/${s}/${e}`:e:i?`${s}/${e}`:e}function Dr(t,e){if(typeof e!="string")throw new Error("name must be a string");return cj(t,e,"cachedContents")}function Ay(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function Na(t){return jm(t)}function dj(t){return t!=null&&typeof t=="object"&&"name"in t}function uj(t){return t!=null&&typeof t=="object"&&"video"in t}function fj(t){return t!=null&&typeof t=="object"&&"uri"in t}function ky(t){var e;let s;if(dj(t)&&(s=t.name),!(fj(t)&&(s=t.uri,s===void 0))&&!(uj(t)&&(s=(e=t.video)===null||e===void 0?void 0:e.uri,s===void 0))){if(typeof t=="string"&&(s=t),s===void 0)throw new Error("Could not extract file name from the provided input.");if(s.startsWith("https://")){const i=s.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${s}`);s=i[0]}else s.startsWith("files/")&&(s=s.split("files/")[1]);return s}}function Iy(t,e){let s;return t.isVertexAI()?s=e?"publishers/google/models":"models":s=e?"models":"tunedModels",s}function My(t){for(const e of["models","tunedModels","publisherModels"])if(mj(t,e))return t[e];return[]}function mj(t,e){return t!==null&&typeof t=="object"&&e in t}function pj(t,e={}){const s=t,o={name:s.name,description:s.description,parametersJsonSchema:s.inputSchema};return s.outputSchema&&(o.responseJsonSchema=s.outputSchema),e.behavior&&(o.behavior=e.behavior),{functionDeclarations:[o]}}function hj(t,e={}){const s=[],o=new Set;for(const i of t){const c=i.name;if(o.has(c))throw new Error(`Duplicate function name ${c} found in MCP tools. Please ensure function names are unique.`);o.add(c);const u=pj(i,e);u.functionDeclarations&&s.push(...u.functionDeclarations)}return{functionDeclarations:s}}function Ry(t,e){let s;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))s={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))s={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))s={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");s={inlinedRequests:e}}else s=e;const o=[s.gcsUri,s.bigqueryUri].filter(Boolean).length,i=[s.inlinedRequests,s.fileName].filter(Boolean).length;if(t.isVertexAI()){if(i>0||o!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(o>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return s}function xj(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function Dy(t){if(typeof t!="object"||t===null)return{};const e=t,s=e.inlinedResponses;if(typeof s!="object"||s===null)return t;const i=s.inlinedResponses;if(!Array.isArray(i)||i.length===0)return t;let c=!1;for(const u of i){if(typeof u!="object"||u===null)continue;const h=u.response;if(typeof h!="object"||h===null)continue;if(h.embedding!==void 0){c=!0;break}}return c&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function di(t,e){const s=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(s))return s.split("/").pop();throw new Error(`Invalid batch job name: ${s}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(s))return s.split("/").pop();if(/^\d+$/.test(s))return s;throw new Error(`Invalid batch job name: ${s}.`)}function Uy(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function gj(t){const e={},s=f(t,["responsesFile"]);s!=null&&p(e,["fileName"],s);const o=f(t,["inlinedResponses","inlinedResponses"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(u=>Wj(u))),p(e,["inlinedResponses"],c)}const i=f(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(u=>u)),p(e,["inlinedEmbedContentResponses"],c)}return e}function vj(t){const e={},s=f(t,["predictionsFormat"]);s!=null&&p(e,["format"],s);const o=f(t,["gcsDestination","outputUriPrefix"]);o!=null&&p(e,["gcsUri"],o);const i=f(t,["bigqueryDestination","outputUri"]);return i!=null&&p(e,["bigqueryUri"],i),e}function yj(t){const e={},s=f(t,["format"]);s!=null&&p(e,["predictionsFormat"],s);const o=f(t,["gcsUri"]);o!=null&&p(e,["gcsDestination","outputUriPrefix"],o);const i=f(t,["bigqueryUri"]);if(i!=null&&p(e,["bigqueryDestination","outputUri"],i),f(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(f(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(f(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Oc(t){const e={},s=f(t,["name"]);s!=null&&p(e,["name"],s);const o=f(t,["metadata","displayName"]);o!=null&&p(e,["displayName"],o);const i=f(t,["metadata","state"]);i!=null&&p(e,["state"],Uy(i));const c=f(t,["metadata","createTime"]);c!=null&&p(e,["createTime"],c);const u=f(t,["metadata","endTime"]);u!=null&&p(e,["endTime"],u);const m=f(t,["metadata","updateTime"]);m!=null&&p(e,["updateTime"],m);const h=f(t,["metadata","model"]);h!=null&&p(e,["model"],h);const x=f(t,["metadata","output"]);return x!=null&&p(e,["dest"],gj(Dy(x))),e}function Yf(t){const e={},s=f(t,["name"]);s!=null&&p(e,["name"],s);const o=f(t,["displayName"]);o!=null&&p(e,["displayName"],o);const i=f(t,["state"]);i!=null&&p(e,["state"],Uy(i));const c=f(t,["error"]);c!=null&&p(e,["error"],c);const u=f(t,["createTime"]);u!=null&&p(e,["createTime"],u);const m=f(t,["startTime"]);m!=null&&p(e,["startTime"],m);const h=f(t,["endTime"]);h!=null&&p(e,["endTime"],h);const x=f(t,["updateTime"]);x!=null&&p(e,["updateTime"],x);const v=f(t,["model"]);v!=null&&p(e,["model"],v);const b=f(t,["inputConfig"]);b!=null&&p(e,["src"],bj(b));const N=f(t,["outputConfig"]);N!=null&&p(e,["dest"],vj(Dy(N)));const T=f(t,["completionStats"]);return T!=null&&p(e,["completionStats"],T),e}function bj(t){const e={},s=f(t,["instancesFormat"]);s!=null&&p(e,["format"],s);const o=f(t,["gcsSource","uris"]);o!=null&&p(e,["gcsUri"],o);const i=f(t,["bigquerySource","inputUri"]);return i!=null&&p(e,["bigqueryUri"],i),e}function Nj(t,e){const s={};if(f(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(f(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(f(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const o=f(e,["fileName"]);o!=null&&p(s,["fileName"],o);const i=f(e,["inlinedRequests"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(u=>Kj(t,u))),p(s,["requests","requests"],c)}return s}function wj(t){const e={},s=f(t,["format"]);s!=null&&p(e,["instancesFormat"],s);const o=f(t,["gcsUri"]);o!=null&&p(e,["gcsSource","uris"],o);const i=f(t,["bigqueryUri"]);if(i!=null&&p(e,["bigquerySource","inputUri"],i),f(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(f(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function Sj(t){const e={},s=f(t,["data"]);if(s!=null&&p(e,["data"],s),f(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=f(t,["mimeType"]);return o!=null&&p(e,["mimeType"],o),e}function jj(t,e){const s={},o=f(e,["name"]);return o!=null&&p(s,["_url","name"],di(t,o)),s}function Tj(t,e){const s={},o=f(e,["name"]);return o!=null&&p(s,["_url","name"],di(t,o)),s}function Cj(t){const e={},s=f(t,["content"]);s!=null&&p(e,["content"],s);const o=f(t,["citationMetadata"]);o!=null&&p(e,["citationMetadata"],Ej(o));const i=f(t,["tokenCount"]);i!=null&&p(e,["tokenCount"],i);const c=f(t,["finishReason"]);c!=null&&p(e,["finishReason"],c);const u=f(t,["avgLogprobs"]);u!=null&&p(e,["avgLogprobs"],u);const m=f(t,["groundingMetadata"]);m!=null&&p(e,["groundingMetadata"],m);const h=f(t,["index"]);h!=null&&p(e,["index"],h);const x=f(t,["logprobsResult"]);x!=null&&p(e,["logprobsResult"],x);const v=f(t,["safetyRatings"]);if(v!=null){let N=v;Array.isArray(N)&&(N=N.map(T=>T)),p(e,["safetyRatings"],N)}const b=f(t,["urlContextMetadata"]);return b!=null&&p(e,["urlContextMetadata"],b),e}function Ej(t){const e={},s=f(t,["citationSources"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(i=>i)),p(e,["citations"],o)}return e}function Py(t){const e={},s=f(t,["parts"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(c=>rT(c))),p(e,["parts"],i)}const o=f(t,["role"]);return o!=null&&p(e,["role"],o),e}function _j(t,e){const s={},o=f(t,["displayName"]);if(e!==void 0&&o!=null&&p(e,["batch","displayName"],o),f(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return s}function Aj(t,e){const s={},o=f(t,["displayName"]);e!==void 0&&o!=null&&p(e,["displayName"],o);const i=f(t,["dest"]);return e!==void 0&&i!=null&&p(e,["outputConfig"],yj(xj(i))),s}function Mv(t,e){const s={},o=f(e,["model"]);o!=null&&p(s,["_url","model"],xt(t,o));const i=f(e,["src"]);i!=null&&p(s,["batch","inputConfig"],Nj(t,Ry(t,i)));const c=f(e,["config"]);return c!=null&&_j(c,s),s}function kj(t,e){const s={},o=f(e,["model"]);o!=null&&p(s,["model"],xt(t,o));const i=f(e,["src"]);i!=null&&p(s,["inputConfig"],wj(Ry(t,i)));const c=f(e,["config"]);return c!=null&&Aj(c,s),s}function Ij(t,e){const s={},o=f(t,["displayName"]);return e!==void 0&&o!=null&&p(e,["batch","displayName"],o),s}function Mj(t,e){const s={},o=f(e,["model"]);o!=null&&p(s,["_url","model"],xt(t,o));const i=f(e,["src"]);i!=null&&p(s,["batch","inputConfig"],Gj(t,i));const c=f(e,["config"]);return c!=null&&Ij(c,s),s}function Rj(t,e){const s={},o=f(e,["name"]);return o!=null&&p(s,["_url","name"],di(t,o)),s}function Dj(t,e){const s={},o=f(e,["name"]);return o!=null&&p(s,["_url","name"],di(t,o)),s}function Uj(t){const e={},s=f(t,["sdkHttpResponse"]);s!=null&&p(e,["sdkHttpResponse"],s);const o=f(t,["name"]);o!=null&&p(e,["name"],o);const i=f(t,["done"]);i!=null&&p(e,["done"],i);const c=f(t,["error"]);return c!=null&&p(e,["error"],c),e}function Pj(t){const e={},s=f(t,["sdkHttpResponse"]);s!=null&&p(e,["sdkHttpResponse"],s);const o=f(t,["name"]);o!=null&&p(e,["name"],o);const i=f(t,["done"]);i!=null&&p(e,["done"],i);const c=f(t,["error"]);return c!=null&&p(e,["error"],c),e}function Lj(t,e){const s={},o=f(e,["contents"]);if(o!=null){let c=Em(t,o);Array.isArray(c)&&(c=c.map(u=>u)),p(s,["requests[]","request","content"],c)}const i=f(e,["config"]);return i!=null&&(p(s,["_self"],zj(i,s)),DS(s,{"requests[].*":"requests[].request.*"})),s}function zj(t,e){const s={},o=f(t,["taskType"]);e!==void 0&&o!=null&&p(e,["requests[]","taskType"],o);const i=f(t,["title"]);e!==void 0&&i!=null&&p(e,["requests[]","title"],i);const c=f(t,["outputDimensionality"]);if(e!==void 0&&c!=null&&p(e,["requests[]","outputDimensionality"],c),f(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(f(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return s}function Gj(t,e){const s={},o=f(e,["fileName"]);o!=null&&p(s,["file_name"],o);const i=f(e,["inlinedRequests"]);return i!=null&&p(s,["requests"],Lj(t,i)),s}function Hj(t){const e={};if(f(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=f(t,["fileUri"]);s!=null&&p(e,["fileUri"],s);const o=f(t,["mimeType"]);return o!=null&&p(e,["mimeType"],o),e}function Oj(t){const e={},s=f(t,["id"]);s!=null&&p(e,["id"],s);const o=f(t,["args"]);o!=null&&p(e,["args"],o);const i=f(t,["name"]);if(i!=null&&p(e,["name"],i),f(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function qj(t){const e={},s=f(t,["mode"]);s!=null&&p(e,["mode"],s);const o=f(t,["allowedFunctionNames"]);if(o!=null&&p(e,["allowedFunctionNames"],o),f(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function Fj(t,e,s){const o={},i=f(e,["systemInstruction"]);s!==void 0&&i!=null&&p(s,["systemInstruction"],Py(_n(i)));const c=f(e,["temperature"]);c!=null&&p(o,["temperature"],c);const u=f(e,["topP"]);u!=null&&p(o,["topP"],u);const m=f(e,["topK"]);m!=null&&p(o,["topK"],m);const h=f(e,["candidateCount"]);h!=null&&p(o,["candidateCount"],h);const x=f(e,["maxOutputTokens"]);x!=null&&p(o,["maxOutputTokens"],x);const v=f(e,["stopSequences"]);v!=null&&p(o,["stopSequences"],v);const b=f(e,["responseLogprobs"]);b!=null&&p(o,["responseLogprobs"],b);const N=f(e,["logprobs"]);N!=null&&p(o,["logprobs"],N);const T=f(e,["presencePenalty"]);T!=null&&p(o,["presencePenalty"],T);const _=f(e,["frequencyPenalty"]);_!=null&&p(o,["frequencyPenalty"],_);const I=f(e,["seed"]);I!=null&&p(o,["seed"],I);const E=f(e,["responseMimeType"]);E!=null&&p(o,["responseMimeType"],E);const D=f(e,["responseSchema"]);D!=null&&p(o,["responseSchema"],_m(D));const z=f(e,["responseJsonSchema"]);if(z!=null&&p(o,["responseJsonSchema"],z),f(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(f(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const A=f(e,["safetySettings"]);if(s!==void 0&&A!=null){let le=A;Array.isArray(le)&&(le=le.map(he=>aT(he))),p(s,["safetySettings"],le)}const M=f(e,["tools"]);if(s!==void 0&&M!=null){let le=ci(M);Array.isArray(le)&&(le=le.map(he=>iT(li(he)))),p(s,["tools"],le)}const B=f(e,["toolConfig"]);if(s!==void 0&&B!=null&&p(s,["toolConfig"],oT(B)),f(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const L=f(e,["cachedContent"]);s!==void 0&&L!=null&&p(s,["cachedContent"],Dr(t,L));const X=f(e,["responseModalities"]);X!=null&&p(o,["responseModalities"],X);const de=f(e,["mediaResolution"]);de!=null&&p(o,["mediaResolution"],de);const V=f(e,["speechConfig"]);if(V!=null&&p(o,["speechConfig"],Am(V)),f(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const Z=f(e,["thinkingConfig"]);Z!=null&&p(o,["thinkingConfig"],Z);const K=f(e,["imageConfig"]);K!=null&&p(o,["imageConfig"],Xj(K));const F=f(e,["enableEnhancedCivicAnswers"]);return F!=null&&p(o,["enableEnhancedCivicAnswers"],F),o}function Vj(t){const e={},s=f(t,["sdkHttpResponse"]);s!=null&&p(e,["sdkHttpResponse"],s);const o=f(t,["candidates"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(x=>Cj(x))),p(e,["candidates"],h)}const i=f(t,["modelVersion"]);i!=null&&p(e,["modelVersion"],i);const c=f(t,["promptFeedback"]);c!=null&&p(e,["promptFeedback"],c);const u=f(t,["responseId"]);u!=null&&p(e,["responseId"],u);const m=f(t,["usageMetadata"]);return m!=null&&p(e,["usageMetadata"],m),e}function Bj(t,e){const s={},o=f(e,["name"]);return o!=null&&p(s,["_url","name"],di(t,o)),s}function $j(t,e){const s={},o=f(e,["name"]);return o!=null&&p(s,["_url","name"],di(t,o)),s}function Yj(t){const e={};if(f(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const s=f(t,["enableWidget"]);return s!=null&&p(e,["enableWidget"],s),e}function Jj(t){const e={};if(f(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const s=f(t,["timeRangeFilter"]);return s!=null&&p(e,["timeRangeFilter"],s),e}function Xj(t){const e={},s=f(t,["aspectRatio"]);s!=null&&p(e,["aspectRatio"],s);const o=f(t,["imageSize"]);if(o!=null&&p(e,["imageSize"],o),f(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(f(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function Kj(t,e){const s={},o=f(e,["model"]);o!=null&&p(s,["request","model"],xt(t,o));const i=f(e,["contents"]);if(i!=null){let m=ks(i);Array.isArray(m)&&(m=m.map(h=>Py(h))),p(s,["request","contents"],m)}const c=f(e,["metadata"]);c!=null&&p(s,["metadata"],c);const u=f(e,["config"]);return u!=null&&p(s,["request","generationConfig"],Fj(t,u,f(s,["request"],{}))),s}function Wj(t){const e={},s=f(t,["response"]);s!=null&&p(e,["response"],Vj(s));const o=f(t,["error"]);return o!=null&&p(e,["error"],o),e}function Qj(t,e){const s={},o=f(t,["pageSize"]);e!==void 0&&o!=null&&p(e,["_query","pageSize"],o);const i=f(t,["pageToken"]);if(e!==void 0&&i!=null&&p(e,["_query","pageToken"],i),f(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return s}function Zj(t,e){const s={},o=f(t,["pageSize"]);e!==void 0&&o!=null&&p(e,["_query","pageSize"],o);const i=f(t,["pageToken"]);e!==void 0&&i!=null&&p(e,["_query","pageToken"],i);const c=f(t,["filter"]);return e!==void 0&&c!=null&&p(e,["_query","filter"],c),s}function eT(t){const e={},s=f(t,["config"]);return s!=null&&Qj(s,e),e}function tT(t){const e={},s=f(t,["config"]);return s!=null&&Zj(s,e),e}function nT(t){const e={},s=f(t,["sdkHttpResponse"]);s!=null&&p(e,["sdkHttpResponse"],s);const o=f(t,["nextPageToken"]);o!=null&&p(e,["nextPageToken"],o);const i=f(t,["operations"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(u=>Oc(u))),p(e,["batchJobs"],c)}return e}function sT(t){const e={},s=f(t,["sdkHttpResponse"]);s!=null&&p(e,["sdkHttpResponse"],s);const o=f(t,["nextPageToken"]);o!=null&&p(e,["nextPageToken"],o);const i=f(t,["batchPredictionJobs"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(u=>Yf(u))),p(e,["batchJobs"],c)}return e}function rT(t){const e={},s=f(t,["mediaResolution"]);s!=null&&p(e,["mediaResolution"],s);const o=f(t,["codeExecutionResult"]);o!=null&&p(e,["codeExecutionResult"],o);const i=f(t,["executableCode"]);i!=null&&p(e,["executableCode"],i);const c=f(t,["fileData"]);c!=null&&p(e,["fileData"],Hj(c));const u=f(t,["functionCall"]);u!=null&&p(e,["functionCall"],Oj(u));const m=f(t,["functionResponse"]);m!=null&&p(e,["functionResponse"],m);const h=f(t,["inlineData"]);h!=null&&p(e,["inlineData"],Sj(h));const x=f(t,["text"]);x!=null&&p(e,["text"],x);const v=f(t,["thought"]);v!=null&&p(e,["thought"],v);const b=f(t,["thoughtSignature"]);b!=null&&p(e,["thoughtSignature"],b);const N=f(t,["videoMetadata"]);return N!=null&&p(e,["videoMetadata"],N),e}function aT(t){const e={},s=f(t,["category"]);if(s!=null&&p(e,["category"],s),f(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const o=f(t,["threshold"]);return o!=null&&p(e,["threshold"],o),e}function oT(t){const e={},s=f(t,["functionCallingConfig"]);s!=null&&p(e,["functionCallingConfig"],qj(s));const o=f(t,["retrievalConfig"]);return o!=null&&p(e,["retrievalConfig"],o),e}function iT(t){const e={},s=f(t,["functionDeclarations"]);if(s!=null){let v=s;Array.isArray(v)&&(v=v.map(b=>b)),p(e,["functionDeclarations"],v)}if(f(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=f(t,["googleSearchRetrieval"]);o!=null&&p(e,["googleSearchRetrieval"],o);const i=f(t,["computerUse"]);i!=null&&p(e,["computerUse"],i);const c=f(t,["fileSearch"]);c!=null&&p(e,["fileSearch"],c);const u=f(t,["codeExecution"]);if(u!=null&&p(e,["codeExecution"],u),f(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const m=f(t,["googleMaps"]);m!=null&&p(e,["googleMaps"],Yj(m));const h=f(t,["googleSearch"]);h!=null&&p(e,["googleSearch"],Jj(h));const x=f(t,["urlContext"]);return x!=null&&p(e,["urlContext"],x),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Mr;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents",t.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",t.PAGED_ITEM_DOCUMENTS="documents"})(Mr||(Mr={}));class ao{constructor(e,s,o,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=s,this.init(e,o,i)}init(e,s,o){var i,c;this.nameInternal=e,this.pageInternal=s[this.nameInternal]||[],this.sdkHttpResponseInternal=s==null?void 0:s.sdkHttpResponse,this.idxInternal=0;let u={config:{}};!o||Object.keys(o).length===0?u={config:{}}:typeof o=="object"?u=Object.assign({},o):u=o,u.config&&(u.config.pageToken=s.nextPageToken),this.paramsInternal=u,this.pageInternalSize=(c=(i=u.config)===null||i===void 0?void 0:i.pageSize)!==null&&c!==void 0?c:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class lT extends Rr{constructor(e){super(),this.apiClient=e,this.list=async(s={})=>new ao(Mr.PAGED_ITEM_BATCH_JOBS,o=>this.listInternal(o),await this.listInternal(s),s),this.create=async s=>(this.apiClient.isVertexAI()&&(s.config=this.formatDestination(s.src,s.config)),this.createInternal(s)),this.createEmbeddings=async s=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(s)}}createInlinedGenerateContentRequest(e){const s=Mv(this.apiClient,e),o=s._url,i=ke("{model}:batchGenerateContent",o),m=s.batch.inputConfig.requests,h=m.requests,x=[];for(const v of h){const b=Object.assign({},v);if(b.systemInstruction){const N=b.systemInstruction;delete b.systemInstruction;const T=b.request;T.systemInstruction=N,b.request=T}x.push(b)}return m.requests=x,delete s.config,delete s._url,delete s._query,{path:i,body:s}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,s){const o=s?Object.assign({},s):{},i=Date.now().toString();if(o.displayName||(o.displayName=`genaiBatchJob_${i}`),o.dest===void 0){const c=this.getGcsUri(e),u=this.getBigqueryUri(e);if(c)c.endsWith(".jsonl")?o.dest=`${c.slice(0,-6)}/dest`:o.dest=`${c}_dest_${i}`;else if(u)o.dest=`${u}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return o}async createInternal(e){var s,o,i,c;let u,m="",h={};if(this.apiClient.isVertexAI()){const x=kj(this.apiClient,e);return m=ke("batchPredictionJobs",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),u.then(v=>Yf(v))}else{const x=Mv(this.apiClient,e);return m=ke("{model}:batchGenerateContent",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json()),u.then(v=>Oc(v))}}async createEmbeddingsInternal(e){var s,o;let i,c="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=Mj(this.apiClient,e);return c=ke("{model}:asyncBatchEmbedContent",m._url),u=m._query,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>Oc(h))}}async get(e){var s,o,i,c;let u,m="",h={};if(this.apiClient.isVertexAI()){const x=$j(this.apiClient,e);return m=ke("batchPredictionJobs/{name}",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),u.then(v=>Yf(v))}else{const x=Bj(this.apiClient,e);return m=ke("batches/{name}",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json()),u.then(v=>Oc(v))}}async cancel(e){var s,o,i,c;let u="",m={};if(this.apiClient.isVertexAI()){const h=Tj(this.apiClient,e);u=ke("batchPredictionJobs/{name}:cancel",h._url),m=h._query,delete h._url,delete h._query,await this.apiClient.request({path:u,queryParams:m,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}else{const h=jj(this.apiClient,e);u=ke("batches/{name}:cancel",h._url),m=h._query,delete h._url,delete h._query,await this.apiClient.request({path:u,queryParams:m,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal})}}async listInternal(e){var s,o,i,c;let u,m="",h={};if(this.apiClient.isVertexAI()){const x=tT(e);return m=ke("batchPredictionJobs",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(b=>{const N=b;return N.sdkHttpResponse={headers:v.headers},N})),u.then(v=>{const b=sT(v),N=new _v;return Object.assign(N,b),N})}else{const x=eT(e);return m=ke("batches",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(b=>{const N=b;return N.sdkHttpResponse={headers:v.headers},N})),u.then(v=>{const b=nT(v),N=new _v;return Object.assign(N,b),N})}}async delete(e){var s,o,i,c;let u,m="",h={};if(this.apiClient.isVertexAI()){const x=Dj(this.apiClient,e);return m=ke("batchPredictionJobs/{name}",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(b=>{const N=b;return N.sdkHttpResponse={headers:v.headers},N})),u.then(v=>Pj(v))}else{const x=Rj(this.apiClient,e);return m=ke("batches/{name}",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(b=>{const N=b;return N.sdkHttpResponse={headers:v.headers},N})),u.then(v=>Uj(v))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function cT(t){const e={},s=f(t,["data"]);if(s!=null&&p(e,["data"],s),f(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=f(t,["mimeType"]);return o!=null&&p(e,["mimeType"],o),e}function Rv(t){const e={},s=f(t,["parts"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(c=>MT(c))),p(e,["parts"],i)}const o=f(t,["role"]);return o!=null&&p(e,["role"],o),e}function dT(t,e){const s={},o=f(t,["ttl"]);e!==void 0&&o!=null&&p(e,["ttl"],o);const i=f(t,["expireTime"]);e!==void 0&&i!=null&&p(e,["expireTime"],i);const c=f(t,["displayName"]);e!==void 0&&c!=null&&p(e,["displayName"],c);const u=f(t,["contents"]);if(e!==void 0&&u!=null){let v=ks(u);Array.isArray(v)&&(v=v.map(b=>Rv(b))),p(e,["contents"],v)}const m=f(t,["systemInstruction"]);e!==void 0&&m!=null&&p(e,["systemInstruction"],Rv(_n(m)));const h=f(t,["tools"]);if(e!==void 0&&h!=null){let v=h;Array.isArray(v)&&(v=v.map(b=>DT(b))),p(e,["tools"],v)}const x=f(t,["toolConfig"]);if(e!==void 0&&x!=null&&p(e,["toolConfig"],RT(x)),f(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return s}function uT(t,e){const s={},o=f(t,["ttl"]);e!==void 0&&o!=null&&p(e,["ttl"],o);const i=f(t,["expireTime"]);e!==void 0&&i!=null&&p(e,["expireTime"],i);const c=f(t,["displayName"]);e!==void 0&&c!=null&&p(e,["displayName"],c);const u=f(t,["contents"]);if(e!==void 0&&u!=null){let b=ks(u);Array.isArray(b)&&(b=b.map(N=>N)),p(e,["contents"],b)}const m=f(t,["systemInstruction"]);e!==void 0&&m!=null&&p(e,["systemInstruction"],_n(m));const h=f(t,["tools"]);if(e!==void 0&&h!=null){let b=h;Array.isArray(b)&&(b=b.map(N=>UT(N))),p(e,["tools"],b)}const x=f(t,["toolConfig"]);e!==void 0&&x!=null&&p(e,["toolConfig"],x);const v=f(t,["kmsKeyName"]);return e!==void 0&&v!=null&&p(e,["encryption_spec","kmsKeyName"],v),s}function fT(t,e){const s={},o=f(e,["model"]);o!=null&&p(s,["model"],jy(t,o));const i=f(e,["config"]);return i!=null&&dT(i,s),s}function mT(t,e){const s={},o=f(e,["model"]);o!=null&&p(s,["model"],jy(t,o));const i=f(e,["config"]);return i!=null&&uT(i,s),s}function pT(t,e){const s={},o=f(e,["name"]);return o!=null&&p(s,["_url","name"],Dr(t,o)),s}function hT(t,e){const s={},o=f(e,["name"]);return o!=null&&p(s,["_url","name"],Dr(t,o)),s}function xT(t){const e={},s=f(t,["sdkHttpResponse"]);return s!=null&&p(e,["sdkHttpResponse"],s),e}function gT(t){const e={},s=f(t,["sdkHttpResponse"]);return s!=null&&p(e,["sdkHttpResponse"],s),e}function vT(t){const e={};if(f(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=f(t,["fileUri"]);s!=null&&p(e,["fileUri"],s);const o=f(t,["mimeType"]);return o!=null&&p(e,["mimeType"],o),e}function yT(t){const e={},s=f(t,["id"]);s!=null&&p(e,["id"],s);const o=f(t,["args"]);o!=null&&p(e,["args"],o);const i=f(t,["name"]);if(i!=null&&p(e,["name"],i),f(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function bT(t){const e={},s=f(t,["mode"]);s!=null&&p(e,["mode"],s);const o=f(t,["allowedFunctionNames"]);if(o!=null&&p(e,["allowedFunctionNames"],o),f(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function NT(t){const e={};if(f(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const s=f(t,["description"]);s!=null&&p(e,["description"],s);const o=f(t,["name"]);o!=null&&p(e,["name"],o);const i=f(t,["parameters"]);i!=null&&p(e,["parameters"],i);const c=f(t,["parametersJsonSchema"]);c!=null&&p(e,["parametersJsonSchema"],c);const u=f(t,["response"]);u!=null&&p(e,["response"],u);const m=f(t,["responseJsonSchema"]);return m!=null&&p(e,["responseJsonSchema"],m),e}function wT(t,e){const s={},o=f(e,["name"]);return o!=null&&p(s,["_url","name"],Dr(t,o)),s}function ST(t,e){const s={},o=f(e,["name"]);return o!=null&&p(s,["_url","name"],Dr(t,o)),s}function jT(t){const e={};if(f(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const s=f(t,["enableWidget"]);return s!=null&&p(e,["enableWidget"],s),e}function TT(t){const e={};if(f(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const s=f(t,["timeRangeFilter"]);return s!=null&&p(e,["timeRangeFilter"],s),e}function CT(t,e){const s={},o=f(t,["pageSize"]);e!==void 0&&o!=null&&p(e,["_query","pageSize"],o);const i=f(t,["pageToken"]);return e!==void 0&&i!=null&&p(e,["_query","pageToken"],i),s}function ET(t,e){const s={},o=f(t,["pageSize"]);e!==void 0&&o!=null&&p(e,["_query","pageSize"],o);const i=f(t,["pageToken"]);return e!==void 0&&i!=null&&p(e,["_query","pageToken"],i),s}function _T(t){const e={},s=f(t,["config"]);return s!=null&&CT(s,e),e}function AT(t){const e={},s=f(t,["config"]);return s!=null&&ET(s,e),e}function kT(t){const e={},s=f(t,["sdkHttpResponse"]);s!=null&&p(e,["sdkHttpResponse"],s);const o=f(t,["nextPageToken"]);o!=null&&p(e,["nextPageToken"],o);const i=f(t,["cachedContents"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(u=>u)),p(e,["cachedContents"],c)}return e}function IT(t){const e={},s=f(t,["sdkHttpResponse"]);s!=null&&p(e,["sdkHttpResponse"],s);const o=f(t,["nextPageToken"]);o!=null&&p(e,["nextPageToken"],o);const i=f(t,["cachedContents"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(u=>u)),p(e,["cachedContents"],c)}return e}function MT(t){const e={},s=f(t,["mediaResolution"]);s!=null&&p(e,["mediaResolution"],s);const o=f(t,["codeExecutionResult"]);o!=null&&p(e,["codeExecutionResult"],o);const i=f(t,["executableCode"]);i!=null&&p(e,["executableCode"],i);const c=f(t,["fileData"]);c!=null&&p(e,["fileData"],vT(c));const u=f(t,["functionCall"]);u!=null&&p(e,["functionCall"],yT(u));const m=f(t,["functionResponse"]);m!=null&&p(e,["functionResponse"],m);const h=f(t,["inlineData"]);h!=null&&p(e,["inlineData"],cT(h));const x=f(t,["text"]);x!=null&&p(e,["text"],x);const v=f(t,["thought"]);v!=null&&p(e,["thought"],v);const b=f(t,["thoughtSignature"]);b!=null&&p(e,["thoughtSignature"],b);const N=f(t,["videoMetadata"]);return N!=null&&p(e,["videoMetadata"],N),e}function RT(t){const e={},s=f(t,["functionCallingConfig"]);s!=null&&p(e,["functionCallingConfig"],bT(s));const o=f(t,["retrievalConfig"]);return o!=null&&p(e,["retrievalConfig"],o),e}function DT(t){const e={},s=f(t,["functionDeclarations"]);if(s!=null){let v=s;Array.isArray(v)&&(v=v.map(b=>b)),p(e,["functionDeclarations"],v)}if(f(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=f(t,["googleSearchRetrieval"]);o!=null&&p(e,["googleSearchRetrieval"],o);const i=f(t,["computerUse"]);i!=null&&p(e,["computerUse"],i);const c=f(t,["fileSearch"]);c!=null&&p(e,["fileSearch"],c);const u=f(t,["codeExecution"]);if(u!=null&&p(e,["codeExecution"],u),f(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const m=f(t,["googleMaps"]);m!=null&&p(e,["googleMaps"],jT(m));const h=f(t,["googleSearch"]);h!=null&&p(e,["googleSearch"],TT(h));const x=f(t,["urlContext"]);return x!=null&&p(e,["urlContext"],x),e}function UT(t){const e={},s=f(t,["functionDeclarations"]);if(s!=null){let b=s;Array.isArray(b)&&(b=b.map(N=>NT(N))),p(e,["functionDeclarations"],b)}const o=f(t,["retrieval"]);o!=null&&p(e,["retrieval"],o);const i=f(t,["googleSearchRetrieval"]);i!=null&&p(e,["googleSearchRetrieval"],i);const c=f(t,["computerUse"]);if(c!=null&&p(e,["computerUse"],c),f(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const u=f(t,["codeExecution"]);u!=null&&p(e,["codeExecution"],u);const m=f(t,["enterpriseWebSearch"]);m!=null&&p(e,["enterpriseWebSearch"],m);const h=f(t,["googleMaps"]);h!=null&&p(e,["googleMaps"],h);const x=f(t,["googleSearch"]);x!=null&&p(e,["googleSearch"],x);const v=f(t,["urlContext"]);return v!=null&&p(e,["urlContext"],v),e}function PT(t,e){const s={},o=f(t,["ttl"]);e!==void 0&&o!=null&&p(e,["ttl"],o);const i=f(t,["expireTime"]);return e!==void 0&&i!=null&&p(e,["expireTime"],i),s}function LT(t,e){const s={},o=f(t,["ttl"]);e!==void 0&&o!=null&&p(e,["ttl"],o);const i=f(t,["expireTime"]);return e!==void 0&&i!=null&&p(e,["expireTime"],i),s}function zT(t,e){const s={},o=f(e,["name"]);o!=null&&p(s,["_url","name"],Dr(t,o));const i=f(e,["config"]);return i!=null&&PT(i,s),s}function GT(t,e){const s={},o=f(e,["name"]);o!=null&&p(s,["_url","name"],Dr(t,o));const i=f(e,["config"]);return i!=null&&LT(i,s),s}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class HT extends Rr{constructor(e){super(),this.apiClient=e,this.list=async(s={})=>new ao(Mr.PAGED_ITEM_CACHED_CONTENTS,o=>this.listInternal(o),await this.listInternal(s),s)}async create(e){var s,o,i,c;let u,m="",h={};if(this.apiClient.isVertexAI()){const x=mT(this.apiClient,e);return m=ke("cachedContents",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),u.then(v=>v)}else{const x=fT(this.apiClient,e);return m=ke("cachedContents",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json()),u.then(v=>v)}}async get(e){var s,o,i,c;let u,m="",h={};if(this.apiClient.isVertexAI()){const x=ST(this.apiClient,e);return m=ke("{name}",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),u.then(v=>v)}else{const x=wT(this.apiClient,e);return m=ke("{name}",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json()),u.then(v=>v)}}async delete(e){var s,o,i,c;let u,m="",h={};if(this.apiClient.isVertexAI()){const x=hT(this.apiClient,e);return m=ke("{name}",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(b=>{const N=b;return N.sdkHttpResponse={headers:v.headers},N})),u.then(v=>{const b=gT(v),N=new Cv;return Object.assign(N,b),N})}else{const x=pT(this.apiClient,e);return m=ke("{name}",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(b=>{const N=b;return N.sdkHttpResponse={headers:v.headers},N})),u.then(v=>{const b=xT(v),N=new Cv;return Object.assign(N,b),N})}}async update(e){var s,o,i,c;let u,m="",h={};if(this.apiClient.isVertexAI()){const x=GT(this.apiClient,e);return m=ke("{name}",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),u.then(v=>v)}else{const x=zT(this.apiClient,e);return m=ke("{name}",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json()),u.then(v=>v)}}async listInternal(e){var s,o,i,c;let u,m="",h={};if(this.apiClient.isVertexAI()){const x=AT(e);return m=ke("cachedContents",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(b=>{const N=b;return N.sdkHttpResponse={headers:v.headers},N})),u.then(v=>{const b=IT(v),N=new Ev;return Object.assign(N,b),N})}else{const x=_T(e);return m=ke("cachedContents",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(b=>{const N=b;return N.sdkHttpResponse={headers:v.headers},N})),u.then(v=>{const b=kT(v),N=new Ev;return Object.assign(N,b),N})}}}function ed(t,e){var s={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(s[o]=t[o]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,o=Object.getOwnPropertySymbols(t);i<o.length;i++)e.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(t,o[i])&&(s[o[i]]=t[o[i]]);return s}function Dv(t){var e=typeof Symbol=="function"&&Symbol.iterator,s=e&&t[e],o=0;if(s)return s.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ye(t){return this instanceof Ye?(this.v=t,this):new Ye(t)}function Os(t,e,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o=s.apply(t,e||[]),i,c=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),m("next"),m("throw"),m("return",u),i[Symbol.asyncIterator]=function(){return this},i;function u(T){return function(_){return Promise.resolve(_).then(T,b)}}function m(T,_){o[T]&&(i[T]=function(I){return new Promise(function(E,D){c.push([T,I,E,D])>1||h(T,I)})},_&&(i[T]=_(i[T])))}function h(T,_){try{x(o[T](_))}catch(I){N(c[0][3],I)}}function x(T){T.value instanceof Ye?Promise.resolve(T.value.v).then(v,b):N(c[0][2],T)}function v(T){h("next",T)}function b(T){h("throw",T)}function N(T,_){T(_),c.shift(),c.length&&h(c[0][0],c[0][1])}}function qs(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],s;return e?e.call(t):(t=typeof Dv=="function"?Dv(t):t[Symbol.iterator](),s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s);function o(c){s[c]=t[c]&&function(u){return new Promise(function(m,h){u=t[c](u),i(m,h,u.done,u.value)})}}function i(c,u,m,h){Promise.resolve(h).then(function(x){c({value:x,done:m})},u)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function OT(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const s=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return s===void 0?!1:Ly(s)}function Ly(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function qT(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function Uv(t){if(t===void 0||t.length===0)return[];const e=[],s=t.length;let o=0;for(;o<s;)if(t[o].role==="user")e.push(t[o]),o++;else{const i=[];let c=!0;for(;o<s&&t[o].role==="model";)i.push(t[o]),c&&!Ly(t[o])&&(c=!1),o++;c?e.push(...i):e.pop()}return e}class FT{constructor(e,s){this.modelsModule=e,this.apiClient=s}create(e){return new VT(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class VT{constructor(e,s,o,i={},c=[]){this.apiClient=e,this.modelsModule=s,this.model=o,this.config=i,this.history=c,this.sendPromise=Promise.resolve(),qT(c)}async sendMessage(e){var s;await this.sendPromise;const o=_n(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(o),config:(s=e.config)!==null&&s!==void 0?s:this.config});return this.sendPromise=(async()=>{var c,u,m;const h=await i,x=(u=(c=h.candidates)===null||c===void 0?void 0:c[0])===null||u===void 0?void 0:u.content,v=h.automaticFunctionCallingHistory,b=this.getHistory(!0).length;let N=[];v!=null&&(N=(m=v.slice(b))!==null&&m!==void 0?m:[]);const T=x?[x]:[];this.recordHistory(o,T,N)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var s;await this.sendPromise;const o=_n(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(o),config:(s=e.config)!==null&&s!==void 0?s:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const c=await i;return this.processStreamResponse(c,o)}getHistory(e=!1){const s=e?Uv(this.history):this.history;return structuredClone(s)}processStreamResponse(e,s){return Os(this,arguments,function*(){var i,c,u,m,h,x;const v=[];try{for(var b=!0,N=qs(e),T;T=yield Ye(N.next()),i=T.done,!i;b=!0){m=T.value,b=!1;const _=m;if(OT(_)){const I=(x=(h=_.candidates)===null||h===void 0?void 0:h[0])===null||x===void 0?void 0:x.content;I!==void 0&&v.push(I)}yield yield Ye(_)}}catch(_){c={error:_}}finally{try{!b&&!i&&(u=N.return)&&(yield Ye(u.call(N)))}finally{if(c)throw c.error}}this.recordHistory(s,v)})}recordHistory(e,s,o){let i=[];s.length>0&&s.every(c=>c.role!==void 0)?i=s:i.push({role:"model",parts:[]}),o&&o.length>0?this.history.push(...Uv(o)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class dd extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,dd.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function BT(t){const e={},s=f(t,["file"]);return s!=null&&p(e,["file"],s),e}function $T(t){const e={},s=f(t,["sdkHttpResponse"]);return s!=null&&p(e,["sdkHttpResponse"],s),e}function YT(t){const e={},s=f(t,["name"]);return s!=null&&p(e,["_url","file"],ky(s)),e}function JT(t){const e={},s=f(t,["sdkHttpResponse"]);return s!=null&&p(e,["sdkHttpResponse"],s),e}function XT(t){const e={},s=f(t,["name"]);return s!=null&&p(e,["_url","file"],ky(s)),e}function KT(t,e){const s={},o=f(t,["pageSize"]);e!==void 0&&o!=null&&p(e,["_query","pageSize"],o);const i=f(t,["pageToken"]);return e!==void 0&&i!=null&&p(e,["_query","pageToken"],i),s}function WT(t){const e={},s=f(t,["config"]);return s!=null&&KT(s,e),e}function QT(t){const e={},s=f(t,["sdkHttpResponse"]);s!=null&&p(e,["sdkHttpResponse"],s);const o=f(t,["nextPageToken"]);o!=null&&p(e,["nextPageToken"],o);const i=f(t,["files"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(u=>u)),p(e,["files"],c)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ZT extends Rr{constructor(e){super(),this.apiClient=e,this.list=async(s={})=>new ao(Mr.PAGED_ITEM_FILES,o=>this.listInternal(o),await this.listInternal(s),s)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(s=>s)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var s,o;let i,c="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=WT(e);return c=ke("files",m._url),u=m._query,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:h.headers},v})),i.then(h=>{const x=QT(h),v=new sj;return Object.assign(v,x),v})}}async createInternal(e){var s,o;let i,c="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=BT(e);return c=ke("upload/v1beta/files",m._url),u=m._query,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>{const x=$T(h),v=new rj;return Object.assign(v,x),v})}}async get(e){var s,o;let i,c="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=XT(e);return c=ke("files/{file}",m._url),u=m._query,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>h)}}async delete(e){var s,o;let i,c="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=YT(e);return c=ke("files/{file}",m._url),u=m._query,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(m),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:h.headers},v})),i.then(h=>{const x=JT(h),v=new aj;return Object.assign(v,x),v})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function qc(t){const e={},s=f(t,["data"]);if(s!=null&&p(e,["data"],s),f(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=f(t,["mimeType"]);return o!=null&&p(e,["mimeType"],o),e}function eC(t){const e={},s=f(t,["parts"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(c=>xC(c))),p(e,["parts"],i)}const o=f(t,["role"]);return o!=null&&p(e,["role"],o),e}function tC(t){const e={};if(f(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=f(t,["fileUri"]);s!=null&&p(e,["fileUri"],s);const o=f(t,["mimeType"]);return o!=null&&p(e,["mimeType"],o),e}function nC(t){const e={},s=f(t,["id"]);s!=null&&p(e,["id"],s);const o=f(t,["args"]);o!=null&&p(e,["args"],o);const i=f(t,["name"]);if(i!=null&&p(e,["name"],i),f(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function sC(t){const e={};if(f(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const s=f(t,["description"]);s!=null&&p(e,["description"],s);const o=f(t,["name"]);o!=null&&p(e,["name"],o);const i=f(t,["parameters"]);i!=null&&p(e,["parameters"],i);const c=f(t,["parametersJsonSchema"]);c!=null&&p(e,["parametersJsonSchema"],c);const u=f(t,["response"]);u!=null&&p(e,["response"],u);const m=f(t,["responseJsonSchema"]);return m!=null&&p(e,["responseJsonSchema"],m),e}function rC(t){const e={},s=f(t,["modelSelectionConfig"]);s!=null&&p(e,["modelConfig"],s);const o=f(t,["responseJsonSchema"]);o!=null&&p(e,["responseJsonSchema"],o);const i=f(t,["audioTimestamp"]);i!=null&&p(e,["audioTimestamp"],i);const c=f(t,["candidateCount"]);c!=null&&p(e,["candidateCount"],c);const u=f(t,["enableAffectiveDialog"]);u!=null&&p(e,["enableAffectiveDialog"],u);const m=f(t,["frequencyPenalty"]);m!=null&&p(e,["frequencyPenalty"],m);const h=f(t,["logprobs"]);h!=null&&p(e,["logprobs"],h);const x=f(t,["maxOutputTokens"]);x!=null&&p(e,["maxOutputTokens"],x);const v=f(t,["mediaResolution"]);v!=null&&p(e,["mediaResolution"],v);const b=f(t,["presencePenalty"]);b!=null&&p(e,["presencePenalty"],b);const N=f(t,["responseLogprobs"]);N!=null&&p(e,["responseLogprobs"],N);const T=f(t,["responseMimeType"]);T!=null&&p(e,["responseMimeType"],T);const _=f(t,["responseModalities"]);_!=null&&p(e,["responseModalities"],_);const I=f(t,["responseSchema"]);I!=null&&p(e,["responseSchema"],I);const E=f(t,["routingConfig"]);E!=null&&p(e,["routingConfig"],E);const D=f(t,["seed"]);D!=null&&p(e,["seed"],D);const z=f(t,["speechConfig"]);z!=null&&p(e,["speechConfig"],zy(z));const A=f(t,["stopSequences"]);A!=null&&p(e,["stopSequences"],A);const M=f(t,["temperature"]);M!=null&&p(e,["temperature"],M);const B=f(t,["thinkingConfig"]);B!=null&&p(e,["thinkingConfig"],B);const L=f(t,["topK"]);L!=null&&p(e,["topK"],L);const X=f(t,["topP"]);if(X!=null&&p(e,["topP"],X),f(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function aC(t){const e={};if(f(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const s=f(t,["enableWidget"]);return s!=null&&p(e,["enableWidget"],s),e}function oC(t){const e={};if(f(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const s=f(t,["timeRangeFilter"]);return s!=null&&p(e,["timeRangeFilter"],s),e}function iC(t,e){const s={},o=f(t,["generationConfig"]);e!==void 0&&o!=null&&p(e,["setup","generationConfig"],o);const i=f(t,["responseModalities"]);e!==void 0&&i!=null&&p(e,["setup","generationConfig","responseModalities"],i);const c=f(t,["temperature"]);e!==void 0&&c!=null&&p(e,["setup","generationConfig","temperature"],c);const u=f(t,["topP"]);e!==void 0&&u!=null&&p(e,["setup","generationConfig","topP"],u);const m=f(t,["topK"]);e!==void 0&&m!=null&&p(e,["setup","generationConfig","topK"],m);const h=f(t,["maxOutputTokens"]);e!==void 0&&h!=null&&p(e,["setup","generationConfig","maxOutputTokens"],h);const x=f(t,["mediaResolution"]);e!==void 0&&x!=null&&p(e,["setup","generationConfig","mediaResolution"],x);const v=f(t,["seed"]);e!==void 0&&v!=null&&p(e,["setup","generationConfig","seed"],v);const b=f(t,["speechConfig"]);e!==void 0&&b!=null&&p(e,["setup","generationConfig","speechConfig"],km(b));const N=f(t,["thinkingConfig"]);e!==void 0&&N!=null&&p(e,["setup","generationConfig","thinkingConfig"],N);const T=f(t,["enableAffectiveDialog"]);e!==void 0&&T!=null&&p(e,["setup","generationConfig","enableAffectiveDialog"],T);const _=f(t,["systemInstruction"]);e!==void 0&&_!=null&&p(e,["setup","systemInstruction"],eC(_n(_)));const I=f(t,["tools"]);if(e!==void 0&&I!=null){let L=ci(I);Array.isArray(L)&&(L=L.map(X=>vC(li(X)))),p(e,["setup","tools"],L)}const E=f(t,["sessionResumption"]);e!==void 0&&E!=null&&p(e,["setup","sessionResumption"],gC(E));const D=f(t,["inputAudioTranscription"]);e!==void 0&&D!=null&&p(e,["setup","inputAudioTranscription"],D);const z=f(t,["outputAudioTranscription"]);e!==void 0&&z!=null&&p(e,["setup","outputAudioTranscription"],z);const A=f(t,["realtimeInputConfig"]);e!==void 0&&A!=null&&p(e,["setup","realtimeInputConfig"],A);const M=f(t,["contextWindowCompression"]);e!==void 0&&M!=null&&p(e,["setup","contextWindowCompression"],M);const B=f(t,["proactivity"]);if(e!==void 0&&B!=null&&p(e,["setup","proactivity"],B),f(t,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return s}function lC(t,e){const s={},o=f(t,["generationConfig"]);e!==void 0&&o!=null&&p(e,["setup","generationConfig"],rC(o));const i=f(t,["responseModalities"]);e!==void 0&&i!=null&&p(e,["setup","generationConfig","responseModalities"],i);const c=f(t,["temperature"]);e!==void 0&&c!=null&&p(e,["setup","generationConfig","temperature"],c);const u=f(t,["topP"]);e!==void 0&&u!=null&&p(e,["setup","generationConfig","topP"],u);const m=f(t,["topK"]);e!==void 0&&m!=null&&p(e,["setup","generationConfig","topK"],m);const h=f(t,["maxOutputTokens"]);e!==void 0&&h!=null&&p(e,["setup","generationConfig","maxOutputTokens"],h);const x=f(t,["mediaResolution"]);e!==void 0&&x!=null&&p(e,["setup","generationConfig","mediaResolution"],x);const v=f(t,["seed"]);e!==void 0&&v!=null&&p(e,["setup","generationConfig","seed"],v);const b=f(t,["speechConfig"]);e!==void 0&&b!=null&&p(e,["setup","generationConfig","speechConfig"],zy(km(b)));const N=f(t,["thinkingConfig"]);e!==void 0&&N!=null&&p(e,["setup","generationConfig","thinkingConfig"],N);const T=f(t,["enableAffectiveDialog"]);e!==void 0&&T!=null&&p(e,["setup","generationConfig","enableAffectiveDialog"],T);const _=f(t,["systemInstruction"]);e!==void 0&&_!=null&&p(e,["setup","systemInstruction"],_n(_));const I=f(t,["tools"]);if(e!==void 0&&I!=null){let X=ci(I);Array.isArray(X)&&(X=X.map(de=>yC(li(de)))),p(e,["setup","tools"],X)}const E=f(t,["sessionResumption"]);e!==void 0&&E!=null&&p(e,["setup","sessionResumption"],E);const D=f(t,["inputAudioTranscription"]);e!==void 0&&D!=null&&p(e,["setup","inputAudioTranscription"],D);const z=f(t,["outputAudioTranscription"]);e!==void 0&&z!=null&&p(e,["setup","outputAudioTranscription"],z);const A=f(t,["realtimeInputConfig"]);e!==void 0&&A!=null&&p(e,["setup","realtimeInputConfig"],A);const M=f(t,["contextWindowCompression"]);e!==void 0&&M!=null&&p(e,["setup","contextWindowCompression"],M);const B=f(t,["proactivity"]);e!==void 0&&B!=null&&p(e,["setup","proactivity"],B);const L=f(t,["explicitVadSignal"]);return e!==void 0&&L!=null&&p(e,["setup","explicitVadSignal"],L),s}function cC(t,e){const s={},o=f(e,["model"]);o!=null&&p(s,["setup","model"],xt(t,o));const i=f(e,["config"]);return i!=null&&p(s,["config"],iC(i,s)),s}function dC(t,e){const s={},o=f(e,["model"]);o!=null&&p(s,["setup","model"],xt(t,o));const i=f(e,["config"]);return i!=null&&p(s,["config"],lC(i,s)),s}function uC(t){const e={},s=f(t,["musicGenerationConfig"]);return s!=null&&p(e,["musicGenerationConfig"],s),e}function fC(t){const e={},s=f(t,["weightedPrompts"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(i=>i)),p(e,["weightedPrompts"],o)}return e}function mC(t){const e={},s=f(t,["media"]);if(s!=null){let x=Ty(s);Array.isArray(x)&&(x=x.map(v=>qc(v))),p(e,["mediaChunks"],x)}const o=f(t,["audio"]);o!=null&&p(e,["audio"],qc(Ey(o)));const i=f(t,["audioStreamEnd"]);i!=null&&p(e,["audioStreamEnd"],i);const c=f(t,["video"]);c!=null&&p(e,["video"],qc(Cy(c)));const u=f(t,["text"]);u!=null&&p(e,["text"],u);const m=f(t,["activityStart"]);m!=null&&p(e,["activityStart"],m);const h=f(t,["activityEnd"]);return h!=null&&p(e,["activityEnd"],h),e}function pC(t){const e={},s=f(t,["media"]);if(s!=null){let x=Ty(s);Array.isArray(x)&&(x=x.map(v=>v)),p(e,["mediaChunks"],x)}const o=f(t,["audio"]);o!=null&&p(e,["audio"],Ey(o));const i=f(t,["audioStreamEnd"]);i!=null&&p(e,["audioStreamEnd"],i);const c=f(t,["video"]);c!=null&&p(e,["video"],Cy(c));const u=f(t,["text"]);u!=null&&p(e,["text"],u);const m=f(t,["activityStart"]);m!=null&&p(e,["activityStart"],m);const h=f(t,["activityEnd"]);return h!=null&&p(e,["activityEnd"],h),e}function hC(t){const e={},s=f(t,["setupComplete"]);s!=null&&p(e,["setupComplete"],s);const o=f(t,["serverContent"]);o!=null&&p(e,["serverContent"],o);const i=f(t,["toolCall"]);i!=null&&p(e,["toolCall"],i);const c=f(t,["toolCallCancellation"]);c!=null&&p(e,["toolCallCancellation"],c);const u=f(t,["usageMetadata"]);u!=null&&p(e,["usageMetadata"],bC(u));const m=f(t,["goAway"]);m!=null&&p(e,["goAway"],m);const h=f(t,["sessionResumptionUpdate"]);h!=null&&p(e,["sessionResumptionUpdate"],h);const x=f(t,["voiceActivityDetectionSignal"]);return x!=null&&p(e,["voiceActivityDetectionSignal"],x),e}function xC(t){const e={},s=f(t,["mediaResolution"]);s!=null&&p(e,["mediaResolution"],s);const o=f(t,["codeExecutionResult"]);o!=null&&p(e,["codeExecutionResult"],o);const i=f(t,["executableCode"]);i!=null&&p(e,["executableCode"],i);const c=f(t,["fileData"]);c!=null&&p(e,["fileData"],tC(c));const u=f(t,["functionCall"]);u!=null&&p(e,["functionCall"],nC(u));const m=f(t,["functionResponse"]);m!=null&&p(e,["functionResponse"],m);const h=f(t,["inlineData"]);h!=null&&p(e,["inlineData"],qc(h));const x=f(t,["text"]);x!=null&&p(e,["text"],x);const v=f(t,["thought"]);v!=null&&p(e,["thought"],v);const b=f(t,["thoughtSignature"]);b!=null&&p(e,["thoughtSignature"],b);const N=f(t,["videoMetadata"]);return N!=null&&p(e,["videoMetadata"],N),e}function gC(t){const e={},s=f(t,["handle"]);if(s!=null&&p(e,["handle"],s),f(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function zy(t){const e={},s=f(t,["voiceConfig"]);s!=null&&p(e,["voiceConfig"],s);const o=f(t,["languageCode"]);if(o!=null&&p(e,["languageCode"],o),f(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function vC(t){const e={},s=f(t,["functionDeclarations"]);if(s!=null){let v=s;Array.isArray(v)&&(v=v.map(b=>b)),p(e,["functionDeclarations"],v)}if(f(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=f(t,["googleSearchRetrieval"]);o!=null&&p(e,["googleSearchRetrieval"],o);const i=f(t,["computerUse"]);i!=null&&p(e,["computerUse"],i);const c=f(t,["fileSearch"]);c!=null&&p(e,["fileSearch"],c);const u=f(t,["codeExecution"]);if(u!=null&&p(e,["codeExecution"],u),f(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const m=f(t,["googleMaps"]);m!=null&&p(e,["googleMaps"],aC(m));const h=f(t,["googleSearch"]);h!=null&&p(e,["googleSearch"],oC(h));const x=f(t,["urlContext"]);return x!=null&&p(e,["urlContext"],x),e}function yC(t){const e={},s=f(t,["functionDeclarations"]);if(s!=null){let b=s;Array.isArray(b)&&(b=b.map(N=>sC(N))),p(e,["functionDeclarations"],b)}const o=f(t,["retrieval"]);o!=null&&p(e,["retrieval"],o);const i=f(t,["googleSearchRetrieval"]);i!=null&&p(e,["googleSearchRetrieval"],i);const c=f(t,["computerUse"]);if(c!=null&&p(e,["computerUse"],c),f(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const u=f(t,["codeExecution"]);u!=null&&p(e,["codeExecution"],u);const m=f(t,["enterpriseWebSearch"]);m!=null&&p(e,["enterpriseWebSearch"],m);const h=f(t,["googleMaps"]);h!=null&&p(e,["googleMaps"],h);const x=f(t,["googleSearch"]);x!=null&&p(e,["googleSearch"],x);const v=f(t,["urlContext"]);return v!=null&&p(e,["urlContext"],v),e}function bC(t){const e={},s=f(t,["promptTokenCount"]);s!=null&&p(e,["promptTokenCount"],s);const o=f(t,["cachedContentTokenCount"]);o!=null&&p(e,["cachedContentTokenCount"],o);const i=f(t,["candidatesTokenCount"]);i!=null&&p(e,["responseTokenCount"],i);const c=f(t,["toolUsePromptTokenCount"]);c!=null&&p(e,["toolUsePromptTokenCount"],c);const u=f(t,["thoughtsTokenCount"]);u!=null&&p(e,["thoughtsTokenCount"],u);const m=f(t,["totalTokenCount"]);m!=null&&p(e,["totalTokenCount"],m);const h=f(t,["promptTokensDetails"]);if(h!=null){let T=h;Array.isArray(T)&&(T=T.map(_=>_)),p(e,["promptTokensDetails"],T)}const x=f(t,["cacheTokensDetails"]);if(x!=null){let T=x;Array.isArray(T)&&(T=T.map(_=>_)),p(e,["cacheTokensDetails"],T)}const v=f(t,["candidatesTokensDetails"]);if(v!=null){let T=v;Array.isArray(T)&&(T=T.map(_=>_)),p(e,["responseTokensDetails"],T)}const b=f(t,["toolUsePromptTokensDetails"]);if(b!=null){let T=b;Array.isArray(T)&&(T=T.map(_=>_)),p(e,["toolUsePromptTokensDetails"],T)}const N=f(t,["trafficType"]);return N!=null&&p(e,["trafficType"],N),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function NC(t){const e={},s=f(t,["data"]);if(s!=null&&p(e,["data"],s),f(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=f(t,["mimeType"]);return o!=null&&p(e,["mimeType"],o),e}function wC(t){const e={},s=f(t,["content"]);s!=null&&p(e,["content"],s);const o=f(t,["citationMetadata"]);o!=null&&p(e,["citationMetadata"],SC(o));const i=f(t,["tokenCount"]);i!=null&&p(e,["tokenCount"],i);const c=f(t,["finishReason"]);c!=null&&p(e,["finishReason"],c);const u=f(t,["avgLogprobs"]);u!=null&&p(e,["avgLogprobs"],u);const m=f(t,["groundingMetadata"]);m!=null&&p(e,["groundingMetadata"],m);const h=f(t,["index"]);h!=null&&p(e,["index"],h);const x=f(t,["logprobsResult"]);x!=null&&p(e,["logprobsResult"],x);const v=f(t,["safetyRatings"]);if(v!=null){let N=v;Array.isArray(N)&&(N=N.map(T=>T)),p(e,["safetyRatings"],N)}const b=f(t,["urlContextMetadata"]);return b!=null&&p(e,["urlContextMetadata"],b),e}function SC(t){const e={},s=f(t,["citationSources"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(i=>i)),p(e,["citations"],o)}return e}function jC(t,e){const s={},o=f(e,["model"]);o!=null&&p(s,["_url","model"],xt(t,o));const i=f(e,["contents"]);if(i!=null){let c=ks(i);Array.isArray(c)&&(c=c.map(u=>u)),p(s,["contents"],c)}return s}function TC(t){const e={},s=f(t,["sdkHttpResponse"]);s!=null&&p(e,["sdkHttpResponse"],s);const o=f(t,["tokensInfo"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(c=>c)),p(e,["tokensInfo"],i)}return e}function CC(t){const e={},s=f(t,["values"]);s!=null&&p(e,["values"],s);const o=f(t,["statistics"]);return o!=null&&p(e,["statistics"],EC(o)),e}function EC(t){const e={},s=f(t,["truncated"]);s!=null&&p(e,["truncated"],s);const o=f(t,["token_count"]);return o!=null&&p(e,["tokenCount"],o),e}function ud(t){const e={},s=f(t,["parts"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(c=>PE(c))),p(e,["parts"],i)}const o=f(t,["role"]);return o!=null&&p(e,["role"],o),e}function _C(t){const e={},s=f(t,["controlType"]);s!=null&&p(e,["controlType"],s);const o=f(t,["enableControlImageComputation"]);return o!=null&&p(e,["computeControl"],o),e}function AC(t){const e={};if(f(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(f(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(f(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function kC(t,e){const s={},o=f(t,["systemInstruction"]);e!==void 0&&o!=null&&p(e,["systemInstruction"],_n(o));const i=f(t,["tools"]);if(e!==void 0&&i!=null){let u=i;Array.isArray(u)&&(u=u.map(m=>Fy(m))),p(e,["tools"],u)}const c=f(t,["generationConfig"]);return e!==void 0&&c!=null&&p(e,["generationConfig"],NE(c)),s}function IC(t,e){const s={},o=f(e,["model"]);o!=null&&p(s,["_url","model"],xt(t,o));const i=f(e,["contents"]);if(i!=null){let u=ks(i);Array.isArray(u)&&(u=u.map(m=>ud(m))),p(s,["contents"],u)}const c=f(e,["config"]);return c!=null&&AC(c),s}function MC(t,e){const s={},o=f(e,["model"]);o!=null&&p(s,["_url","model"],xt(t,o));const i=f(e,["contents"]);if(i!=null){let u=ks(i);Array.isArray(u)&&(u=u.map(m=>m)),p(s,["contents"],u)}const c=f(e,["config"]);return c!=null&&kC(c,s),s}function RC(t){const e={},s=f(t,["sdkHttpResponse"]);s!=null&&p(e,["sdkHttpResponse"],s);const o=f(t,["totalTokens"]);o!=null&&p(e,["totalTokens"],o);const i=f(t,["cachedContentTokenCount"]);return i!=null&&p(e,["cachedContentTokenCount"],i),e}function DC(t){const e={},s=f(t,["sdkHttpResponse"]);s!=null&&p(e,["sdkHttpResponse"],s);const o=f(t,["totalTokens"]);return o!=null&&p(e,["totalTokens"],o),e}function UC(t,e){const s={},o=f(e,["model"]);return o!=null&&p(s,["_url","name"],xt(t,o)),s}function PC(t,e){const s={},o=f(e,["model"]);return o!=null&&p(s,["_url","name"],xt(t,o)),s}function LC(t){const e={},s=f(t,["sdkHttpResponse"]);return s!=null&&p(e,["sdkHttpResponse"],s),e}function zC(t){const e={},s=f(t,["sdkHttpResponse"]);return s!=null&&p(e,["sdkHttpResponse"],s),e}function GC(t,e){const s={},o=f(t,["outputGcsUri"]);e!==void 0&&o!=null&&p(e,["parameters","storageUri"],o);const i=f(t,["negativePrompt"]);e!==void 0&&i!=null&&p(e,["parameters","negativePrompt"],i);const c=f(t,["numberOfImages"]);e!==void 0&&c!=null&&p(e,["parameters","sampleCount"],c);const u=f(t,["aspectRatio"]);e!==void 0&&u!=null&&p(e,["parameters","aspectRatio"],u);const m=f(t,["guidanceScale"]);e!==void 0&&m!=null&&p(e,["parameters","guidanceScale"],m);const h=f(t,["seed"]);e!==void 0&&h!=null&&p(e,["parameters","seed"],h);const x=f(t,["safetyFilterLevel"]);e!==void 0&&x!=null&&p(e,["parameters","safetySetting"],x);const v=f(t,["personGeneration"]);e!==void 0&&v!=null&&p(e,["parameters","personGeneration"],v);const b=f(t,["includeSafetyAttributes"]);e!==void 0&&b!=null&&p(e,["parameters","includeSafetyAttributes"],b);const N=f(t,["includeRaiReason"]);e!==void 0&&N!=null&&p(e,["parameters","includeRaiReason"],N);const T=f(t,["language"]);e!==void 0&&T!=null&&p(e,["parameters","language"],T);const _=f(t,["outputMimeType"]);e!==void 0&&_!=null&&p(e,["parameters","outputOptions","mimeType"],_);const I=f(t,["outputCompressionQuality"]);e!==void 0&&I!=null&&p(e,["parameters","outputOptions","compressionQuality"],I);const E=f(t,["addWatermark"]);e!==void 0&&E!=null&&p(e,["parameters","addWatermark"],E);const D=f(t,["labels"]);e!==void 0&&D!=null&&p(e,["labels"],D);const z=f(t,["editMode"]);e!==void 0&&z!=null&&p(e,["parameters","editMode"],z);const A=f(t,["baseSteps"]);return e!==void 0&&A!=null&&p(e,["parameters","editConfig","baseSteps"],A),s}function HC(t,e){const s={},o=f(e,["model"]);o!=null&&p(s,["_url","model"],xt(t,o));const i=f(e,["prompt"]);i!=null&&p(s,["instances[0]","prompt"],i);const c=f(e,["referenceImages"]);if(c!=null){let m=c;Array.isArray(m)&&(m=m.map(h=>qE(h))),p(s,["instances[0]","referenceImages"],m)}const u=f(e,["config"]);return u!=null&&GC(u,s),s}function OC(t){const e={},s=f(t,["sdkHttpResponse"]);s!=null&&p(e,["sdkHttpResponse"],s);const o=f(t,["predictions"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(c=>fd(c))),p(e,["generatedImages"],i)}return e}function qC(t,e){const s={},o=f(t,["taskType"]);e!==void 0&&o!=null&&p(e,["requests[]","taskType"],o);const i=f(t,["title"]);e!==void 0&&i!=null&&p(e,["requests[]","title"],i);const c=f(t,["outputDimensionality"]);if(e!==void 0&&c!=null&&p(e,["requests[]","outputDimensionality"],c),f(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(f(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return s}function FC(t,e){const s={},o=f(t,["taskType"]);e!==void 0&&o!=null&&p(e,["instances[]","task_type"],o);const i=f(t,["title"]);e!==void 0&&i!=null&&p(e,["instances[]","title"],i);const c=f(t,["outputDimensionality"]);e!==void 0&&c!=null&&p(e,["parameters","outputDimensionality"],c);const u=f(t,["mimeType"]);e!==void 0&&u!=null&&p(e,["instances[]","mimeType"],u);const m=f(t,["autoTruncate"]);return e!==void 0&&m!=null&&p(e,["parameters","autoTruncate"],m),s}function VC(t,e){const s={},o=f(e,["model"]);o!=null&&p(s,["_url","model"],xt(t,o));const i=f(e,["contents"]);if(i!=null){let m=Em(t,i);Array.isArray(m)&&(m=m.map(h=>h)),p(s,["requests[]","content"],m)}const c=f(e,["config"]);c!=null&&qC(c,s);const u=f(e,["model"]);return u!==void 0&&p(s,["requests[]","model"],xt(t,u)),s}function BC(t,e){const s={},o=f(e,["model"]);o!=null&&p(s,["_url","model"],xt(t,o));const i=f(e,["contents"]);if(i!=null){let u=Em(t,i);Array.isArray(u)&&(u=u.map(m=>m)),p(s,["instances[]","content"],u)}const c=f(e,["config"]);return c!=null&&FC(c,s),s}function $C(t){const e={},s=f(t,["sdkHttpResponse"]);s!=null&&p(e,["sdkHttpResponse"],s);const o=f(t,["embeddings"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(u=>u)),p(e,["embeddings"],c)}const i=f(t,["metadata"]);return i!=null&&p(e,["metadata"],i),e}function YC(t){const e={},s=f(t,["sdkHttpResponse"]);s!=null&&p(e,["sdkHttpResponse"],s);const o=f(t,["predictions[]","embeddings"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(u=>CC(u))),p(e,["embeddings"],c)}const i=f(t,["metadata"]);return i!=null&&p(e,["metadata"],i),e}function JC(t){const e={},s=f(t,["endpoint"]);s!=null&&p(e,["name"],s);const o=f(t,["deployedModelId"]);return o!=null&&p(e,["deployedModelId"],o),e}function XC(t){const e={};if(f(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=f(t,["fileUri"]);s!=null&&p(e,["fileUri"],s);const o=f(t,["mimeType"]);return o!=null&&p(e,["mimeType"],o),e}function KC(t){const e={},s=f(t,["id"]);s!=null&&p(e,["id"],s);const o=f(t,["args"]);o!=null&&p(e,["args"],o);const i=f(t,["name"]);if(i!=null&&p(e,["name"],i),f(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function WC(t){const e={},s=f(t,["mode"]);s!=null&&p(e,["mode"],s);const o=f(t,["allowedFunctionNames"]);if(o!=null&&p(e,["allowedFunctionNames"],o),f(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function QC(t){const e={};if(f(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const s=f(t,["description"]);s!=null&&p(e,["description"],s);const o=f(t,["name"]);o!=null&&p(e,["name"],o);const i=f(t,["parameters"]);i!=null&&p(e,["parameters"],i);const c=f(t,["parametersJsonSchema"]);c!=null&&p(e,["parametersJsonSchema"],c);const u=f(t,["response"]);u!=null&&p(e,["response"],u);const m=f(t,["responseJsonSchema"]);return m!=null&&p(e,["responseJsonSchema"],m),e}function ZC(t,e,s){const o={},i=f(e,["systemInstruction"]);s!==void 0&&i!=null&&p(s,["systemInstruction"],ud(_n(i)));const c=f(e,["temperature"]);c!=null&&p(o,["temperature"],c);const u=f(e,["topP"]);u!=null&&p(o,["topP"],u);const m=f(e,["topK"]);m!=null&&p(o,["topK"],m);const h=f(e,["candidateCount"]);h!=null&&p(o,["candidateCount"],h);const x=f(e,["maxOutputTokens"]);x!=null&&p(o,["maxOutputTokens"],x);const v=f(e,["stopSequences"]);v!=null&&p(o,["stopSequences"],v);const b=f(e,["responseLogprobs"]);b!=null&&p(o,["responseLogprobs"],b);const N=f(e,["logprobs"]);N!=null&&p(o,["logprobs"],N);const T=f(e,["presencePenalty"]);T!=null&&p(o,["presencePenalty"],T);const _=f(e,["frequencyPenalty"]);_!=null&&p(o,["frequencyPenalty"],_);const I=f(e,["seed"]);I!=null&&p(o,["seed"],I);const E=f(e,["responseMimeType"]);E!=null&&p(o,["responseMimeType"],E);const D=f(e,["responseSchema"]);D!=null&&p(o,["responseSchema"],_m(D));const z=f(e,["responseJsonSchema"]);if(z!=null&&p(o,["responseJsonSchema"],z),f(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(f(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const A=f(e,["safetySettings"]);if(s!==void 0&&A!=null){let le=A;Array.isArray(le)&&(le=le.map(he=>FE(he))),p(s,["safetySettings"],le)}const M=f(e,["tools"]);if(s!==void 0&&M!=null){let le=ci(M);Array.isArray(le)&&(le=le.map(he=>KE(li(he)))),p(s,["tools"],le)}const B=f(e,["toolConfig"]);if(s!==void 0&&B!=null&&p(s,["toolConfig"],XE(B)),f(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const L=f(e,["cachedContent"]);s!==void 0&&L!=null&&p(s,["cachedContent"],Dr(t,L));const X=f(e,["responseModalities"]);X!=null&&p(o,["responseModalities"],X);const de=f(e,["mediaResolution"]);de!=null&&p(o,["mediaResolution"],de);const V=f(e,["speechConfig"]);if(V!=null&&p(o,["speechConfig"],Am(V)),f(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const Z=f(e,["thinkingConfig"]);Z!=null&&p(o,["thinkingConfig"],Z);const K=f(e,["imageConfig"]);K!=null&&p(o,["imageConfig"],CE(K));const F=f(e,["enableEnhancedCivicAnswers"]);return F!=null&&p(o,["enableEnhancedCivicAnswers"],F),o}function eE(t,e,s){const o={},i=f(e,["systemInstruction"]);s!==void 0&&i!=null&&p(s,["systemInstruction"],_n(i));const c=f(e,["temperature"]);c!=null&&p(o,["temperature"],c);const u=f(e,["topP"]);u!=null&&p(o,["topP"],u);const m=f(e,["topK"]);m!=null&&p(o,["topK"],m);const h=f(e,["candidateCount"]);h!=null&&p(o,["candidateCount"],h);const x=f(e,["maxOutputTokens"]);x!=null&&p(o,["maxOutputTokens"],x);const v=f(e,["stopSequences"]);v!=null&&p(o,["stopSequences"],v);const b=f(e,["responseLogprobs"]);b!=null&&p(o,["responseLogprobs"],b);const N=f(e,["logprobs"]);N!=null&&p(o,["logprobs"],N);const T=f(e,["presencePenalty"]);T!=null&&p(o,["presencePenalty"],T);const _=f(e,["frequencyPenalty"]);_!=null&&p(o,["frequencyPenalty"],_);const I=f(e,["seed"]);I!=null&&p(o,["seed"],I);const E=f(e,["responseMimeType"]);E!=null&&p(o,["responseMimeType"],E);const D=f(e,["responseSchema"]);D!=null&&p(o,["responseSchema"],_m(D));const z=f(e,["responseJsonSchema"]);z!=null&&p(o,["responseJsonSchema"],z);const A=f(e,["routingConfig"]);A!=null&&p(o,["routingConfig"],A);const M=f(e,["modelSelectionConfig"]);M!=null&&p(o,["modelConfig"],M);const B=f(e,["safetySettings"]);if(s!==void 0&&B!=null){let q=B;Array.isArray(q)&&(q=q.map(H=>H)),p(s,["safetySettings"],q)}const L=f(e,["tools"]);if(s!==void 0&&L!=null){let q=ci(L);Array.isArray(q)&&(q=q.map(H=>Fy(li(H)))),p(s,["tools"],q)}const X=f(e,["toolConfig"]);s!==void 0&&X!=null&&p(s,["toolConfig"],X);const de=f(e,["labels"]);s!==void 0&&de!=null&&p(s,["labels"],de);const V=f(e,["cachedContent"]);s!==void 0&&V!=null&&p(s,["cachedContent"],Dr(t,V));const Z=f(e,["responseModalities"]);Z!=null&&p(o,["responseModalities"],Z);const K=f(e,["mediaResolution"]);K!=null&&p(o,["mediaResolution"],K);const F=f(e,["speechConfig"]);F!=null&&p(o,["speechConfig"],qy(Am(F)));const le=f(e,["audioTimestamp"]);le!=null&&p(o,["audioTimestamp"],le);const he=f(e,["thinkingConfig"]);he!=null&&p(o,["thinkingConfig"],he);const re=f(e,["imageConfig"]);if(re!=null&&p(o,["imageConfig"],EE(re)),f(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return o}function Pv(t,e){const s={},o=f(e,["model"]);o!=null&&p(s,["_url","model"],xt(t,o));const i=f(e,["contents"]);if(i!=null){let u=ks(i);Array.isArray(u)&&(u=u.map(m=>ud(m))),p(s,["contents"],u)}const c=f(e,["config"]);return c!=null&&p(s,["generationConfig"],ZC(t,c,s)),s}function Lv(t,e){const s={},o=f(e,["model"]);o!=null&&p(s,["_url","model"],xt(t,o));const i=f(e,["contents"]);if(i!=null){let u=ks(i);Array.isArray(u)&&(u=u.map(m=>m)),p(s,["contents"],u)}const c=f(e,["config"]);return c!=null&&p(s,["generationConfig"],eE(t,c,s)),s}function zv(t){const e={},s=f(t,["sdkHttpResponse"]);s!=null&&p(e,["sdkHttpResponse"],s);const o=f(t,["candidates"]);if(o!=null){let h=o;Array.isArray(h)&&(h=h.map(x=>wC(x))),p(e,["candidates"],h)}const i=f(t,["modelVersion"]);i!=null&&p(e,["modelVersion"],i);const c=f(t,["promptFeedback"]);c!=null&&p(e,["promptFeedback"],c);const u=f(t,["responseId"]);u!=null&&p(e,["responseId"],u);const m=f(t,["usageMetadata"]);return m!=null&&p(e,["usageMetadata"],m),e}function Gv(t){const e={},s=f(t,["sdkHttpResponse"]);s!=null&&p(e,["sdkHttpResponse"],s);const o=f(t,["candidates"]);if(o!=null){let x=o;Array.isArray(x)&&(x=x.map(v=>v)),p(e,["candidates"],x)}const i=f(t,["createTime"]);i!=null&&p(e,["createTime"],i);const c=f(t,["modelVersion"]);c!=null&&p(e,["modelVersion"],c);const u=f(t,["promptFeedback"]);u!=null&&p(e,["promptFeedback"],u);const m=f(t,["responseId"]);m!=null&&p(e,["responseId"],m);const h=f(t,["usageMetadata"]);return h!=null&&p(e,["usageMetadata"],h),e}function tE(t,e){const s={};if(f(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(f(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const o=f(t,["numberOfImages"]);e!==void 0&&o!=null&&p(e,["parameters","sampleCount"],o);const i=f(t,["aspectRatio"]);e!==void 0&&i!=null&&p(e,["parameters","aspectRatio"],i);const c=f(t,["guidanceScale"]);if(e!==void 0&&c!=null&&p(e,["parameters","guidanceScale"],c),f(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const u=f(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&p(e,["parameters","safetySetting"],u);const m=f(t,["personGeneration"]);e!==void 0&&m!=null&&p(e,["parameters","personGeneration"],m);const h=f(t,["includeSafetyAttributes"]);e!==void 0&&h!=null&&p(e,["parameters","includeSafetyAttributes"],h);const x=f(t,["includeRaiReason"]);e!==void 0&&x!=null&&p(e,["parameters","includeRaiReason"],x);const v=f(t,["language"]);e!==void 0&&v!=null&&p(e,["parameters","language"],v);const b=f(t,["outputMimeType"]);e!==void 0&&b!=null&&p(e,["parameters","outputOptions","mimeType"],b);const N=f(t,["outputCompressionQuality"]);if(e!==void 0&&N!=null&&p(e,["parameters","outputOptions","compressionQuality"],N),f(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(f(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const T=f(t,["imageSize"]);if(e!==void 0&&T!=null&&p(e,["parameters","sampleImageSize"],T),f(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return s}function nE(t,e){const s={},o=f(t,["outputGcsUri"]);e!==void 0&&o!=null&&p(e,["parameters","storageUri"],o);const i=f(t,["negativePrompt"]);e!==void 0&&i!=null&&p(e,["parameters","negativePrompt"],i);const c=f(t,["numberOfImages"]);e!==void 0&&c!=null&&p(e,["parameters","sampleCount"],c);const u=f(t,["aspectRatio"]);e!==void 0&&u!=null&&p(e,["parameters","aspectRatio"],u);const m=f(t,["guidanceScale"]);e!==void 0&&m!=null&&p(e,["parameters","guidanceScale"],m);const h=f(t,["seed"]);e!==void 0&&h!=null&&p(e,["parameters","seed"],h);const x=f(t,["safetyFilterLevel"]);e!==void 0&&x!=null&&p(e,["parameters","safetySetting"],x);const v=f(t,["personGeneration"]);e!==void 0&&v!=null&&p(e,["parameters","personGeneration"],v);const b=f(t,["includeSafetyAttributes"]);e!==void 0&&b!=null&&p(e,["parameters","includeSafetyAttributes"],b);const N=f(t,["includeRaiReason"]);e!==void 0&&N!=null&&p(e,["parameters","includeRaiReason"],N);const T=f(t,["language"]);e!==void 0&&T!=null&&p(e,["parameters","language"],T);const _=f(t,["outputMimeType"]);e!==void 0&&_!=null&&p(e,["parameters","outputOptions","mimeType"],_);const I=f(t,["outputCompressionQuality"]);e!==void 0&&I!=null&&p(e,["parameters","outputOptions","compressionQuality"],I);const E=f(t,["addWatermark"]);e!==void 0&&E!=null&&p(e,["parameters","addWatermark"],E);const D=f(t,["labels"]);e!==void 0&&D!=null&&p(e,["labels"],D);const z=f(t,["imageSize"]);e!==void 0&&z!=null&&p(e,["parameters","sampleImageSize"],z);const A=f(t,["enhancePrompt"]);return e!==void 0&&A!=null&&p(e,["parameters","enhancePrompt"],A),s}function sE(t,e){const s={},o=f(e,["model"]);o!=null&&p(s,["_url","model"],xt(t,o));const i=f(e,["prompt"]);i!=null&&p(s,["instances[0]","prompt"],i);const c=f(e,["config"]);return c!=null&&tE(c,s),s}function rE(t,e){const s={},o=f(e,["model"]);o!=null&&p(s,["_url","model"],xt(t,o));const i=f(e,["prompt"]);i!=null&&p(s,["instances[0]","prompt"],i);const c=f(e,["config"]);return c!=null&&nE(c,s),s}function aE(t){const e={},s=f(t,["sdkHttpResponse"]);s!=null&&p(e,["sdkHttpResponse"],s);const o=f(t,["predictions"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(u=>gE(u))),p(e,["generatedImages"],c)}const i=f(t,["positivePromptSafetyAttributes"]);return i!=null&&p(e,["positivePromptSafetyAttributes"],Hy(i)),e}function oE(t){const e={},s=f(t,["sdkHttpResponse"]);s!=null&&p(e,["sdkHttpResponse"],s);const o=f(t,["predictions"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(u=>fd(u))),p(e,["generatedImages"],c)}const i=f(t,["positivePromptSafetyAttributes"]);return i!=null&&p(e,["positivePromptSafetyAttributes"],Oy(i)),e}function iE(t,e){const s={},o=f(t,["numberOfVideos"]);if(e!==void 0&&o!=null&&p(e,["parameters","sampleCount"],o),f(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(f(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=f(t,["durationSeconds"]);if(e!==void 0&&i!=null&&p(e,["parameters","durationSeconds"],i),f(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const c=f(t,["aspectRatio"]);e!==void 0&&c!=null&&p(e,["parameters","aspectRatio"],c);const u=f(t,["resolution"]);e!==void 0&&u!=null&&p(e,["parameters","resolution"],u);const m=f(t,["personGeneration"]);if(e!==void 0&&m!=null&&p(e,["parameters","personGeneration"],m),f(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const h=f(t,["negativePrompt"]);e!==void 0&&h!=null&&p(e,["parameters","negativePrompt"],h);const x=f(t,["enhancePrompt"]);if(e!==void 0&&x!=null&&p(e,["parameters","enhancePrompt"],x),f(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const v=f(t,["lastFrame"]);e!==void 0&&v!=null&&p(e,["instances[0]","lastFrame"],md(v));const b=f(t,["referenceImages"]);if(e!==void 0&&b!=null){let N=b;Array.isArray(N)&&(N=N.map(T=>c1(T))),p(e,["instances[0]","referenceImages"],N)}if(f(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(f(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return s}function lE(t,e){const s={},o=f(t,["numberOfVideos"]);e!==void 0&&o!=null&&p(e,["parameters","sampleCount"],o);const i=f(t,["outputGcsUri"]);e!==void 0&&i!=null&&p(e,["parameters","storageUri"],i);const c=f(t,["fps"]);e!==void 0&&c!=null&&p(e,["parameters","fps"],c);const u=f(t,["durationSeconds"]);e!==void 0&&u!=null&&p(e,["parameters","durationSeconds"],u);const m=f(t,["seed"]);e!==void 0&&m!=null&&p(e,["parameters","seed"],m);const h=f(t,["aspectRatio"]);e!==void 0&&h!=null&&p(e,["parameters","aspectRatio"],h);const x=f(t,["resolution"]);e!==void 0&&x!=null&&p(e,["parameters","resolution"],x);const v=f(t,["personGeneration"]);e!==void 0&&v!=null&&p(e,["parameters","personGeneration"],v);const b=f(t,["pubsubTopic"]);e!==void 0&&b!=null&&p(e,["parameters","pubsubTopic"],b);const N=f(t,["negativePrompt"]);e!==void 0&&N!=null&&p(e,["parameters","negativePrompt"],N);const T=f(t,["enhancePrompt"]);e!==void 0&&T!=null&&p(e,["parameters","enhancePrompt"],T);const _=f(t,["generateAudio"]);e!==void 0&&_!=null&&p(e,["parameters","generateAudio"],_);const I=f(t,["lastFrame"]);e!==void 0&&I!=null&&p(e,["instances[0]","lastFrame"],Bs(I));const E=f(t,["referenceImages"]);if(e!==void 0&&E!=null){let A=E;Array.isArray(A)&&(A=A.map(M=>d1(M))),p(e,["instances[0]","referenceImages"],A)}const D=f(t,["mask"]);e!==void 0&&D!=null&&p(e,["instances[0]","mask"],l1(D));const z=f(t,["compressionQuality"]);return e!==void 0&&z!=null&&p(e,["parameters","compressionQuality"],z),s}function cE(t){const e={},s=f(t,["name"]);s!=null&&p(e,["name"],s);const o=f(t,["metadata"]);o!=null&&p(e,["metadata"],o);const i=f(t,["done"]);i!=null&&p(e,["done"],i);const c=f(t,["error"]);c!=null&&p(e,["error"],c);const u=f(t,["response","generateVideoResponse"]);return u!=null&&p(e,["response"],mE(u)),e}function dE(t){const e={},s=f(t,["name"]);s!=null&&p(e,["name"],s);const o=f(t,["metadata"]);o!=null&&p(e,["metadata"],o);const i=f(t,["done"]);i!=null&&p(e,["done"],i);const c=f(t,["error"]);c!=null&&p(e,["error"],c);const u=f(t,["response"]);return u!=null&&p(e,["response"],pE(u)),e}function uE(t,e){const s={},o=f(e,["model"]);o!=null&&p(s,["_url","model"],xt(t,o));const i=f(e,["prompt"]);i!=null&&p(s,["instances[0]","prompt"],i);const c=f(e,["image"]);c!=null&&p(s,["instances[0]","image"],md(c));const u=f(e,["video"]);u!=null&&p(s,["instances[0]","video"],Vy(u));const m=f(e,["source"]);m!=null&&hE(m,s);const h=f(e,["config"]);return h!=null&&iE(h,s),s}function fE(t,e){const s={},o=f(e,["model"]);o!=null&&p(s,["_url","model"],xt(t,o));const i=f(e,["prompt"]);i!=null&&p(s,["instances[0]","prompt"],i);const c=f(e,["image"]);c!=null&&p(s,["instances[0]","image"],Bs(c));const u=f(e,["video"]);u!=null&&p(s,["instances[0]","video"],By(u));const m=f(e,["source"]);m!=null&&xE(m,s);const h=f(e,["config"]);return h!=null&&lE(h,s),s}function mE(t){const e={},s=f(t,["generatedSamples"]);if(s!=null){let c=s;Array.isArray(c)&&(c=c.map(u=>yE(u))),p(e,["generatedVideos"],c)}const o=f(t,["raiMediaFilteredCount"]);o!=null&&p(e,["raiMediaFilteredCount"],o);const i=f(t,["raiMediaFilteredReasons"]);return i!=null&&p(e,["raiMediaFilteredReasons"],i),e}function pE(t){const e={},s=f(t,["videos"]);if(s!=null){let c=s;Array.isArray(c)&&(c=c.map(u=>bE(u))),p(e,["generatedVideos"],c)}const o=f(t,["raiMediaFilteredCount"]);o!=null&&p(e,["raiMediaFilteredCount"],o);const i=f(t,["raiMediaFilteredReasons"]);return i!=null&&p(e,["raiMediaFilteredReasons"],i),e}function hE(t,e){const s={},o=f(t,["prompt"]);e!==void 0&&o!=null&&p(e,["instances[0]","prompt"],o);const i=f(t,["image"]);e!==void 0&&i!=null&&p(e,["instances[0]","image"],md(i));const c=f(t,["video"]);return e!==void 0&&c!=null&&p(e,["instances[0]","video"],Vy(c)),s}function xE(t,e){const s={},o=f(t,["prompt"]);e!==void 0&&o!=null&&p(e,["instances[0]","prompt"],o);const i=f(t,["image"]);e!==void 0&&i!=null&&p(e,["instances[0]","image"],Bs(i));const c=f(t,["video"]);return e!==void 0&&c!=null&&p(e,["instances[0]","video"],By(c)),s}function gE(t){const e={},s=f(t,["_self"]);s!=null&&p(e,["image"],_E(s));const o=f(t,["raiFilteredReason"]);o!=null&&p(e,["raiFilteredReason"],o);const i=f(t,["_self"]);return i!=null&&p(e,["safetyAttributes"],Hy(i)),e}function fd(t){const e={},s=f(t,["_self"]);s!=null&&p(e,["image"],Gy(s));const o=f(t,["raiFilteredReason"]);o!=null&&p(e,["raiFilteredReason"],o);const i=f(t,["_self"]);i!=null&&p(e,["safetyAttributes"],Oy(i));const c=f(t,["prompt"]);return c!=null&&p(e,["enhancedPrompt"],c),e}function vE(t){const e={},s=f(t,["_self"]);s!=null&&p(e,["mask"],Gy(s));const o=f(t,["labels"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(c=>c)),p(e,["labels"],i)}return e}function yE(t){const e={},s=f(t,["video"]);return s!=null&&p(e,["video"],o1(s)),e}function bE(t){const e={},s=f(t,["_self"]);return s!=null&&p(e,["video"],i1(s)),e}function NE(t){const e={},s=f(t,["modelSelectionConfig"]);s!=null&&p(e,["modelConfig"],s);const o=f(t,["responseJsonSchema"]);o!=null&&p(e,["responseJsonSchema"],o);const i=f(t,["audioTimestamp"]);i!=null&&p(e,["audioTimestamp"],i);const c=f(t,["candidateCount"]);c!=null&&p(e,["candidateCount"],c);const u=f(t,["enableAffectiveDialog"]);u!=null&&p(e,["enableAffectiveDialog"],u);const m=f(t,["frequencyPenalty"]);m!=null&&p(e,["frequencyPenalty"],m);const h=f(t,["logprobs"]);h!=null&&p(e,["logprobs"],h);const x=f(t,["maxOutputTokens"]);x!=null&&p(e,["maxOutputTokens"],x);const v=f(t,["mediaResolution"]);v!=null&&p(e,["mediaResolution"],v);const b=f(t,["presencePenalty"]);b!=null&&p(e,["presencePenalty"],b);const N=f(t,["responseLogprobs"]);N!=null&&p(e,["responseLogprobs"],N);const T=f(t,["responseMimeType"]);T!=null&&p(e,["responseMimeType"],T);const _=f(t,["responseModalities"]);_!=null&&p(e,["responseModalities"],_);const I=f(t,["responseSchema"]);I!=null&&p(e,["responseSchema"],I);const E=f(t,["routingConfig"]);E!=null&&p(e,["routingConfig"],E);const D=f(t,["seed"]);D!=null&&p(e,["seed"],D);const z=f(t,["speechConfig"]);z!=null&&p(e,["speechConfig"],qy(z));const A=f(t,["stopSequences"]);A!=null&&p(e,["stopSequences"],A);const M=f(t,["temperature"]);M!=null&&p(e,["temperature"],M);const B=f(t,["thinkingConfig"]);B!=null&&p(e,["thinkingConfig"],B);const L=f(t,["topK"]);L!=null&&p(e,["topK"],L);const X=f(t,["topP"]);if(X!=null&&p(e,["topP"],X),f(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function wE(t,e){const s={},o=f(e,["model"]);return o!=null&&p(s,["_url","name"],xt(t,o)),s}function SE(t,e){const s={},o=f(e,["model"]);return o!=null&&p(s,["_url","name"],xt(t,o)),s}function jE(t){const e={};if(f(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const s=f(t,["enableWidget"]);return s!=null&&p(e,["enableWidget"],s),e}function TE(t){const e={};if(f(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const s=f(t,["timeRangeFilter"]);return s!=null&&p(e,["timeRangeFilter"],s),e}function CE(t){const e={},s=f(t,["aspectRatio"]);s!=null&&p(e,["aspectRatio"],s);const o=f(t,["imageSize"]);if(o!=null&&p(e,["imageSize"],o),f(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(f(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function EE(t){const e={},s=f(t,["aspectRatio"]);s!=null&&p(e,["aspectRatio"],s);const o=f(t,["imageSize"]);o!=null&&p(e,["imageSize"],o);const i=f(t,["outputMimeType"]);i!=null&&p(e,["imageOutputOptions","mimeType"],i);const c=f(t,["outputCompressionQuality"]);return c!=null&&p(e,["imageOutputOptions","compressionQuality"],c),e}function _E(t){const e={},s=f(t,["bytesBase64Encoded"]);s!=null&&p(e,["imageBytes"],Na(s));const o=f(t,["mimeType"]);return o!=null&&p(e,["mimeType"],o),e}function Gy(t){const e={},s=f(t,["gcsUri"]);s!=null&&p(e,["gcsUri"],s);const o=f(t,["bytesBase64Encoded"]);o!=null&&p(e,["imageBytes"],Na(o));const i=f(t,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function md(t){const e={};if(f(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const s=f(t,["imageBytes"]);s!=null&&p(e,["bytesBase64Encoded"],Na(s));const o=f(t,["mimeType"]);return o!=null&&p(e,["mimeType"],o),e}function Bs(t){const e={},s=f(t,["gcsUri"]);s!=null&&p(e,["gcsUri"],s);const o=f(t,["imageBytes"]);o!=null&&p(e,["bytesBase64Encoded"],Na(o));const i=f(t,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function AE(t,e,s){const o={},i=f(e,["pageSize"]);s!==void 0&&i!=null&&p(s,["_query","pageSize"],i);const c=f(e,["pageToken"]);s!==void 0&&c!=null&&p(s,["_query","pageToken"],c);const u=f(e,["filter"]);s!==void 0&&u!=null&&p(s,["_query","filter"],u);const m=f(e,["queryBase"]);return s!==void 0&&m!=null&&p(s,["_url","models_url"],Iy(t,m)),o}function kE(t,e,s){const o={},i=f(e,["pageSize"]);s!==void 0&&i!=null&&p(s,["_query","pageSize"],i);const c=f(e,["pageToken"]);s!==void 0&&c!=null&&p(s,["_query","pageToken"],c);const u=f(e,["filter"]);s!==void 0&&u!=null&&p(s,["_query","filter"],u);const m=f(e,["queryBase"]);return s!==void 0&&m!=null&&p(s,["_url","models_url"],Iy(t,m)),o}function IE(t,e){const s={},o=f(e,["config"]);return o!=null&&AE(t,o,s),s}function ME(t,e){const s={},o=f(e,["config"]);return o!=null&&kE(t,o,s),s}function RE(t){const e={},s=f(t,["sdkHttpResponse"]);s!=null&&p(e,["sdkHttpResponse"],s);const o=f(t,["nextPageToken"]);o!=null&&p(e,["nextPageToken"],o);const i=f(t,["_self"]);if(i!=null){let c=My(i);Array.isArray(c)&&(c=c.map(u=>Jf(u))),p(e,["models"],c)}return e}function DE(t){const e={},s=f(t,["sdkHttpResponse"]);s!=null&&p(e,["sdkHttpResponse"],s);const o=f(t,["nextPageToken"]);o!=null&&p(e,["nextPageToken"],o);const i=f(t,["_self"]);if(i!=null){let c=My(i);Array.isArray(c)&&(c=c.map(u=>Xf(u))),p(e,["models"],c)}return e}function UE(t){const e={},s=f(t,["maskMode"]);s!=null&&p(e,["maskMode"],s);const o=f(t,["segmentationClasses"]);o!=null&&p(e,["maskClasses"],o);const i=f(t,["maskDilation"]);return i!=null&&p(e,["dilation"],i),e}function Jf(t){const e={},s=f(t,["name"]);s!=null&&p(e,["name"],s);const o=f(t,["displayName"]);o!=null&&p(e,["displayName"],o);const i=f(t,["description"]);i!=null&&p(e,["description"],i);const c=f(t,["version"]);c!=null&&p(e,["version"],c);const u=f(t,["_self"]);u!=null&&p(e,["tunedModelInfo"],WE(u));const m=f(t,["inputTokenLimit"]);m!=null&&p(e,["inputTokenLimit"],m);const h=f(t,["outputTokenLimit"]);h!=null&&p(e,["outputTokenLimit"],h);const x=f(t,["supportedGenerationMethods"]);x!=null&&p(e,["supportedActions"],x);const v=f(t,["temperature"]);v!=null&&p(e,["temperature"],v);const b=f(t,["maxTemperature"]);b!=null&&p(e,["maxTemperature"],b);const N=f(t,["topP"]);N!=null&&p(e,["topP"],N);const T=f(t,["topK"]);T!=null&&p(e,["topK"],T);const _=f(t,["thinking"]);return _!=null&&p(e,["thinking"],_),e}function Xf(t){const e={},s=f(t,["name"]);s!=null&&p(e,["name"],s);const o=f(t,["displayName"]);o!=null&&p(e,["displayName"],o);const i=f(t,["description"]);i!=null&&p(e,["description"],i);const c=f(t,["versionId"]);c!=null&&p(e,["version"],c);const u=f(t,["deployedModels"]);if(u!=null){let b=u;Array.isArray(b)&&(b=b.map(N=>JC(N))),p(e,["endpoints"],b)}const m=f(t,["labels"]);m!=null&&p(e,["labels"],m);const h=f(t,["_self"]);h!=null&&p(e,["tunedModelInfo"],QE(h));const x=f(t,["defaultCheckpointId"]);x!=null&&p(e,["defaultCheckpointId"],x);const v=f(t,["checkpoints"]);if(v!=null){let b=v;Array.isArray(b)&&(b=b.map(N=>N)),p(e,["checkpoints"],b)}return e}function PE(t){const e={},s=f(t,["mediaResolution"]);s!=null&&p(e,["mediaResolution"],s);const o=f(t,["codeExecutionResult"]);o!=null&&p(e,["codeExecutionResult"],o);const i=f(t,["executableCode"]);i!=null&&p(e,["executableCode"],i);const c=f(t,["fileData"]);c!=null&&p(e,["fileData"],XC(c));const u=f(t,["functionCall"]);u!=null&&p(e,["functionCall"],KC(u));const m=f(t,["functionResponse"]);m!=null&&p(e,["functionResponse"],m);const h=f(t,["inlineData"]);h!=null&&p(e,["inlineData"],NC(h));const x=f(t,["text"]);x!=null&&p(e,["text"],x);const v=f(t,["thought"]);v!=null&&p(e,["thought"],v);const b=f(t,["thoughtSignature"]);b!=null&&p(e,["thoughtSignature"],b);const N=f(t,["videoMetadata"]);return N!=null&&p(e,["videoMetadata"],N),e}function LE(t){const e={},s=f(t,["productImage"]);return s!=null&&p(e,["image"],Bs(s)),e}function zE(t,e){const s={},o=f(t,["numberOfImages"]);e!==void 0&&o!=null&&p(e,["parameters","sampleCount"],o);const i=f(t,["baseSteps"]);e!==void 0&&i!=null&&p(e,["parameters","baseSteps"],i);const c=f(t,["outputGcsUri"]);e!==void 0&&c!=null&&p(e,["parameters","storageUri"],c);const u=f(t,["seed"]);e!==void 0&&u!=null&&p(e,["parameters","seed"],u);const m=f(t,["safetyFilterLevel"]);e!==void 0&&m!=null&&p(e,["parameters","safetySetting"],m);const h=f(t,["personGeneration"]);e!==void 0&&h!=null&&p(e,["parameters","personGeneration"],h);const x=f(t,["addWatermark"]);e!==void 0&&x!=null&&p(e,["parameters","addWatermark"],x);const v=f(t,["outputMimeType"]);e!==void 0&&v!=null&&p(e,["parameters","outputOptions","mimeType"],v);const b=f(t,["outputCompressionQuality"]);e!==void 0&&b!=null&&p(e,["parameters","outputOptions","compressionQuality"],b);const N=f(t,["enhancePrompt"]);e!==void 0&&N!=null&&p(e,["parameters","enhancePrompt"],N);const T=f(t,["labels"]);return e!==void 0&&T!=null&&p(e,["labels"],T),s}function GE(t,e){const s={},o=f(e,["model"]);o!=null&&p(s,["_url","model"],xt(t,o));const i=f(e,["source"]);i!=null&&OE(i,s);const c=f(e,["config"]);return c!=null&&zE(c,s),s}function HE(t){const e={},s=f(t,["predictions"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(i=>fd(i))),p(e,["generatedImages"],o)}return e}function OE(t,e){const s={},o=f(t,["prompt"]);e!==void 0&&o!=null&&p(e,["instances[0]","prompt"],o);const i=f(t,["personImage"]);e!==void 0&&i!=null&&p(e,["instances[0]","personImage","image"],Bs(i));const c=f(t,["productImages"]);if(e!==void 0&&c!=null){let u=c;Array.isArray(u)&&(u=u.map(m=>LE(m))),p(e,["instances[0]","productImages"],u)}return s}function qE(t){const e={},s=f(t,["referenceImage"]);s!=null&&p(e,["referenceImage"],Bs(s));const o=f(t,["referenceId"]);o!=null&&p(e,["referenceId"],o);const i=f(t,["referenceType"]);i!=null&&p(e,["referenceType"],i);const c=f(t,["maskImageConfig"]);c!=null&&p(e,["maskImageConfig"],UE(c));const u=f(t,["controlImageConfig"]);u!=null&&p(e,["controlImageConfig"],_C(u));const m=f(t,["styleImageConfig"]);m!=null&&p(e,["styleImageConfig"],m);const h=f(t,["subjectImageConfig"]);return h!=null&&p(e,["subjectImageConfig"],h),e}function Hy(t){const e={},s=f(t,["safetyAttributes","categories"]);s!=null&&p(e,["categories"],s);const o=f(t,["safetyAttributes","scores"]);o!=null&&p(e,["scores"],o);const i=f(t,["contentType"]);return i!=null&&p(e,["contentType"],i),e}function Oy(t){const e={},s=f(t,["safetyAttributes","categories"]);s!=null&&p(e,["categories"],s);const o=f(t,["safetyAttributes","scores"]);o!=null&&p(e,["scores"],o);const i=f(t,["contentType"]);return i!=null&&p(e,["contentType"],i),e}function FE(t){const e={},s=f(t,["category"]);if(s!=null&&p(e,["category"],s),f(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const o=f(t,["threshold"]);return o!=null&&p(e,["threshold"],o),e}function VE(t){const e={},s=f(t,["image"]);return s!=null&&p(e,["image"],Bs(s)),e}function BE(t,e){const s={},o=f(t,["mode"]);e!==void 0&&o!=null&&p(e,["parameters","mode"],o);const i=f(t,["maxPredictions"]);e!==void 0&&i!=null&&p(e,["parameters","maxPredictions"],i);const c=f(t,["confidenceThreshold"]);e!==void 0&&c!=null&&p(e,["parameters","confidenceThreshold"],c);const u=f(t,["maskDilation"]);e!==void 0&&u!=null&&p(e,["parameters","maskDilation"],u);const m=f(t,["binaryColorThreshold"]);e!==void 0&&m!=null&&p(e,["parameters","binaryColorThreshold"],m);const h=f(t,["labels"]);return e!==void 0&&h!=null&&p(e,["labels"],h),s}function $E(t,e){const s={},o=f(e,["model"]);o!=null&&p(s,["_url","model"],xt(t,o));const i=f(e,["source"]);i!=null&&JE(i,s);const c=f(e,["config"]);return c!=null&&BE(c,s),s}function YE(t){const e={},s=f(t,["predictions"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(i=>vE(i))),p(e,["generatedMasks"],o)}return e}function JE(t,e){const s={},o=f(t,["prompt"]);e!==void 0&&o!=null&&p(e,["instances[0]","prompt"],o);const i=f(t,["image"]);e!==void 0&&i!=null&&p(e,["instances[0]","image"],Bs(i));const c=f(t,["scribbleImage"]);return e!==void 0&&c!=null&&p(e,["instances[0]","scribble"],VE(c)),s}function qy(t){const e={},s=f(t,["voiceConfig"]);s!=null&&p(e,["voiceConfig"],s);const o=f(t,["languageCode"]);if(o!=null&&p(e,["languageCode"],o),f(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function XE(t){const e={},s=f(t,["functionCallingConfig"]);s!=null&&p(e,["functionCallingConfig"],WC(s));const o=f(t,["retrievalConfig"]);return o!=null&&p(e,["retrievalConfig"],o),e}function KE(t){const e={},s=f(t,["functionDeclarations"]);if(s!=null){let v=s;Array.isArray(v)&&(v=v.map(b=>b)),p(e,["functionDeclarations"],v)}if(f(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=f(t,["googleSearchRetrieval"]);o!=null&&p(e,["googleSearchRetrieval"],o);const i=f(t,["computerUse"]);i!=null&&p(e,["computerUse"],i);const c=f(t,["fileSearch"]);c!=null&&p(e,["fileSearch"],c);const u=f(t,["codeExecution"]);if(u!=null&&p(e,["codeExecution"],u),f(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const m=f(t,["googleMaps"]);m!=null&&p(e,["googleMaps"],jE(m));const h=f(t,["googleSearch"]);h!=null&&p(e,["googleSearch"],TE(h));const x=f(t,["urlContext"]);return x!=null&&p(e,["urlContext"],x),e}function Fy(t){const e={},s=f(t,["functionDeclarations"]);if(s!=null){let b=s;Array.isArray(b)&&(b=b.map(N=>QC(N))),p(e,["functionDeclarations"],b)}const o=f(t,["retrieval"]);o!=null&&p(e,["retrieval"],o);const i=f(t,["googleSearchRetrieval"]);i!=null&&p(e,["googleSearchRetrieval"],i);const c=f(t,["computerUse"]);if(c!=null&&p(e,["computerUse"],c),f(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const u=f(t,["codeExecution"]);u!=null&&p(e,["codeExecution"],u);const m=f(t,["enterpriseWebSearch"]);m!=null&&p(e,["enterpriseWebSearch"],m);const h=f(t,["googleMaps"]);h!=null&&p(e,["googleMaps"],h);const x=f(t,["googleSearch"]);x!=null&&p(e,["googleSearch"],x);const v=f(t,["urlContext"]);return v!=null&&p(e,["urlContext"],v),e}function WE(t){const e={},s=f(t,["baseModel"]);s!=null&&p(e,["baseModel"],s);const o=f(t,["createTime"]);o!=null&&p(e,["createTime"],o);const i=f(t,["updateTime"]);return i!=null&&p(e,["updateTime"],i),e}function QE(t){const e={},s=f(t,["labels","google-vertex-llm-tuning-base-model-id"]);s!=null&&p(e,["baseModel"],s);const o=f(t,["createTime"]);o!=null&&p(e,["createTime"],o);const i=f(t,["updateTime"]);return i!=null&&p(e,["updateTime"],i),e}function ZE(t,e){const s={},o=f(t,["displayName"]);e!==void 0&&o!=null&&p(e,["displayName"],o);const i=f(t,["description"]);e!==void 0&&i!=null&&p(e,["description"],i);const c=f(t,["defaultCheckpointId"]);return e!==void 0&&c!=null&&p(e,["defaultCheckpointId"],c),s}function e1(t,e){const s={},o=f(t,["displayName"]);e!==void 0&&o!=null&&p(e,["displayName"],o);const i=f(t,["description"]);e!==void 0&&i!=null&&p(e,["description"],i);const c=f(t,["defaultCheckpointId"]);return e!==void 0&&c!=null&&p(e,["defaultCheckpointId"],c),s}function t1(t,e){const s={},o=f(e,["model"]);o!=null&&p(s,["_url","name"],xt(t,o));const i=f(e,["config"]);return i!=null&&ZE(i,s),s}function n1(t,e){const s={},o=f(e,["model"]);o!=null&&p(s,["_url","model"],xt(t,o));const i=f(e,["config"]);return i!=null&&e1(i,s),s}function s1(t,e){const s={},o=f(t,["outputGcsUri"]);e!==void 0&&o!=null&&p(e,["parameters","storageUri"],o);const i=f(t,["safetyFilterLevel"]);e!==void 0&&i!=null&&p(e,["parameters","safetySetting"],i);const c=f(t,["personGeneration"]);e!==void 0&&c!=null&&p(e,["parameters","personGeneration"],c);const u=f(t,["includeRaiReason"]);e!==void 0&&u!=null&&p(e,["parameters","includeRaiReason"],u);const m=f(t,["outputMimeType"]);e!==void 0&&m!=null&&p(e,["parameters","outputOptions","mimeType"],m);const h=f(t,["outputCompressionQuality"]);e!==void 0&&h!=null&&p(e,["parameters","outputOptions","compressionQuality"],h);const x=f(t,["enhanceInputImage"]);e!==void 0&&x!=null&&p(e,["parameters","upscaleConfig","enhanceInputImage"],x);const v=f(t,["imagePreservationFactor"]);e!==void 0&&v!=null&&p(e,["parameters","upscaleConfig","imagePreservationFactor"],v);const b=f(t,["labels"]);e!==void 0&&b!=null&&p(e,["labels"],b);const N=f(t,["numberOfImages"]);e!==void 0&&N!=null&&p(e,["parameters","sampleCount"],N);const T=f(t,["mode"]);return e!==void 0&&T!=null&&p(e,["parameters","mode"],T),s}function r1(t,e){const s={},o=f(e,["model"]);o!=null&&p(s,["_url","model"],xt(t,o));const i=f(e,["image"]);i!=null&&p(s,["instances[0]","image"],Bs(i));const c=f(e,["upscaleFactor"]);c!=null&&p(s,["parameters","upscaleConfig","upscaleFactor"],c);const u=f(e,["config"]);return u!=null&&s1(u,s),s}function a1(t){const e={},s=f(t,["sdkHttpResponse"]);s!=null&&p(e,["sdkHttpResponse"],s);const o=f(t,["predictions"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(c=>fd(c))),p(e,["generatedImages"],i)}return e}function o1(t){const e={},s=f(t,["uri"]);s!=null&&p(e,["uri"],s);const o=f(t,["encodedVideo"]);o!=null&&p(e,["videoBytes"],Na(o));const i=f(t,["encoding"]);return i!=null&&p(e,["mimeType"],i),e}function i1(t){const e={},s=f(t,["gcsUri"]);s!=null&&p(e,["uri"],s);const o=f(t,["bytesBase64Encoded"]);o!=null&&p(e,["videoBytes"],Na(o));const i=f(t,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}function l1(t){const e={},s=f(t,["image"]);s!=null&&p(e,["_self"],Bs(s));const o=f(t,["maskMode"]);return o!=null&&p(e,["maskMode"],o),e}function c1(t){const e={},s=f(t,["image"]);s!=null&&p(e,["image"],md(s));const o=f(t,["referenceType"]);return o!=null&&p(e,["referenceType"],o),e}function d1(t){const e={},s=f(t,["image"]);s!=null&&p(e,["image"],Bs(s));const o=f(t,["referenceType"]);return o!=null&&p(e,["referenceType"],o),e}function Vy(t){const e={},s=f(t,["uri"]);s!=null&&p(e,["uri"],s);const o=f(t,["videoBytes"]);o!=null&&p(e,["encodedVideo"],Na(o));const i=f(t,["mimeType"]);return i!=null&&p(e,["encoding"],i),e}function By(t){const e={},s=f(t,["uri"]);s!=null&&p(e,["gcsUri"],s);const o=f(t,["videoBytes"]);o!=null&&p(e,["bytesBase64Encoded"],Na(o));const i=f(t,["mimeType"]);return i!=null&&p(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function u1(t,e){const s={},o=f(t,["displayName"]);return e!==void 0&&o!=null&&p(e,["displayName"],o),s}function f1(t){const e={},s=f(t,["config"]);return s!=null&&u1(s,e),e}function m1(t,e){const s={},o=f(t,["force"]);return e!==void 0&&o!=null&&p(e,["_query","force"],o),s}function p1(t){const e={},s=f(t,["name"]);s!=null&&p(e,["_url","name"],s);const o=f(t,["config"]);return o!=null&&m1(o,e),e}function h1(t){const e={},s=f(t,["name"]);return s!=null&&p(e,["_url","name"],s),e}function x1(t,e){const s={},o=f(t,["customMetadata"]);if(e!==void 0&&o!=null){let c=o;Array.isArray(c)&&(c=c.map(u=>u)),p(e,["customMetadata"],c)}const i=f(t,["chunkingConfig"]);return e!==void 0&&i!=null&&p(e,["chunkingConfig"],i),s}function g1(t){const e={},s=f(t,["name"]);s!=null&&p(e,["name"],s);const o=f(t,["metadata"]);o!=null&&p(e,["metadata"],o);const i=f(t,["done"]);i!=null&&p(e,["done"],i);const c=f(t,["error"]);c!=null&&p(e,["error"],c);const u=f(t,["response"]);return u!=null&&p(e,["response"],y1(u)),e}function v1(t){const e={},s=f(t,["fileSearchStoreName"]);s!=null&&p(e,["_url","file_search_store_name"],s);const o=f(t,["fileName"]);o!=null&&p(e,["fileName"],o);const i=f(t,["config"]);return i!=null&&x1(i,e),e}function y1(t){const e={},s=f(t,["sdkHttpResponse"]);s!=null&&p(e,["sdkHttpResponse"],s);const o=f(t,["parent"]);o!=null&&p(e,["parent"],o);const i=f(t,["documentName"]);return i!=null&&p(e,["documentName"],i),e}function b1(t,e){const s={},o=f(t,["pageSize"]);e!==void 0&&o!=null&&p(e,["_query","pageSize"],o);const i=f(t,["pageToken"]);return e!==void 0&&i!=null&&p(e,["_query","pageToken"],i),s}function N1(t){const e={},s=f(t,["config"]);return s!=null&&b1(s,e),e}function w1(t){const e={},s=f(t,["sdkHttpResponse"]);s!=null&&p(e,["sdkHttpResponse"],s);const o=f(t,["nextPageToken"]);o!=null&&p(e,["nextPageToken"],o);const i=f(t,["fileSearchStores"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(u=>u)),p(e,["fileSearchStores"],c)}return e}function $y(t,e){const s={},o=f(t,["mimeType"]);e!==void 0&&o!=null&&p(e,["mimeType"],o);const i=f(t,["displayName"]);e!==void 0&&i!=null&&p(e,["displayName"],i);const c=f(t,["customMetadata"]);if(e!==void 0&&c!=null){let m=c;Array.isArray(m)&&(m=m.map(h=>h)),p(e,["customMetadata"],m)}const u=f(t,["chunkingConfig"]);return e!==void 0&&u!=null&&p(e,["chunkingConfig"],u),s}function S1(t){const e={},s=f(t,["fileSearchStoreName"]);s!=null&&p(e,["_url","file_search_store_name"],s);const o=f(t,["config"]);return o!=null&&$y(o,e),e}function j1(t){const e={},s=f(t,["sdkHttpResponse"]);return s!=null&&p(e,["sdkHttpResponse"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const T1="Content-Type",C1="X-Server-Timeout",E1="User-Agent",Kf="x-goog-api-client",_1="1.33.0",A1=`google-genai-sdk/${_1}`,k1="v1beta1",I1="v1beta";class M1{constructor(e){var s,o;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(s=this.clientOptions.apiVersion)!==null&&s!==void 0?s:k1,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(o=this.clientOptions.apiVersion)!==null&&o!==void 0?o:I1,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const o=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&o.push(e.apiVersion),o.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),s=new URL(e);return s.protocol=s.protocol=="http:"?"ws":"wss",s.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,s,o){const i=[this.getRequestUrlInternal(s)];return o&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let s=this.clientOptions.httpOptions;e.httpOptions&&(s=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const o=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,s,o);if(e.queryParams)for(const[u,m]of Object.entries(e.queryParams))i.searchParams.append(u,String(m));let c={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else c.body=e.body;return c=await this.includeExtraHttpOptionsToRequestInit(c,s,i.toString(),e.abortSignal),this.unaryApiCall(i,c,e.httpMethod)}patchHttpOptions(e,s){const o=JSON.parse(JSON.stringify(e));for(const[i,c]of Object.entries(s))typeof c=="object"?o[i]=Object.assign(Object.assign({},o[i]),c):c!==void 0&&(o[i]=c);return o}async requestStream(e){let s=this.clientOptions.httpOptions;e.httpOptions&&(s=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const o=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,s,o);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let c={};return c.body=e.body,c=await this.includeExtraHttpOptionsToRequestInit(c,s,i.toString(),e.abortSignal),this.streamApiCall(i,c,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,s,o,i){if(s&&s.timeout||i){const c=new AbortController,u=c.signal;if(s.timeout&&(s==null?void 0:s.timeout)>0){const m=setTimeout(()=>c.abort(),s.timeout);m&&typeof m.unref=="function"&&m.unref()}i&&i.addEventListener("abort",()=>{c.abort()}),e.signal=u}return s&&s.extraBody!==null&&R1(e,s.extraBody),e.headers=await this.getHeadersInternal(s,o),e}async unaryApiCall(e,s,o){return this.apiCall(e.toString(),Object.assign(Object.assign({},s),{method:o})).then(async i=>(await Hv(i),new Bf(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,s,o){return this.apiCall(e.toString(),Object.assign(Object.assign({},s),{method:o})).then(async i=>(await Hv(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){return Os(this,arguments,function*(){var o;const i=(o=e==null?void 0:e.body)===null||o===void 0?void 0:o.getReader(),c=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let u="";const m="data:",h=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:x,value:v}=yield Ye(i.read());if(x){if(u.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const b=c.decode(v,{stream:!0});try{const _=JSON.parse(b);if("error"in _){const I=JSON.parse(JSON.stringify(_.error)),E=I.status,D=I.code,z=`got status: ${E}. ${JSON.stringify(_)}`;if(D>=400&&D<600)throw new dd({message:z,status:D})}}catch(_){if(_.name==="ApiError")throw _}u+=b;let N=-1,T=0;for(;;){N=-1,T=0;for(const E of h){const D=u.indexOf(E);D!==-1&&(N===-1||D<N)&&(N=D,T=E.length)}if(N===-1)break;const _=u.substring(0,N);u=u.substring(N+T);const I=_.trim();if(I.startsWith(m)){const E=I.substring(m.length).trim();try{const D=new Response(E,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Ye(new Bf(D))}catch(D){throw new Error(`exception parsing stream chunk ${E}. ${D}`)}}}}}finally{i.releaseLock()}})}async apiCall(e,s){return fetch(e,s).catch(o=>{throw new Error(`exception ${o} sending request`)})}getDefaultHeaders(){const e={},s=A1+" "+this.clientOptions.userAgentExtra;return e[E1]=s,e[Kf]=s,e[T1]="application/json",e}async getHeadersInternal(e,s){const o=new Headers;if(e&&e.headers){for(const[i,c]of Object.entries(e.headers))o.append(i,c);e.timeout&&e.timeout>0&&o.append(C1,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(o,s),o}getFileName(e){var s;let o="";return typeof e=="string"&&(o=e.replace(/[/\\]+$/,""),o=(s=o.split(/[/\\]/).pop())!==null&&s!==void 0?s:""),o}async uploadFile(e,s){var o;const i={};s!=null&&(i.mimeType=s.mimeType,i.name=s.name,i.displayName=s.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const c=this.clientOptions.uploader,u=await c.stat(e);i.sizeBytes=String(u.size);const m=(o=s==null?void 0:s.mimeType)!==null&&o!==void 0?o:u.type;if(m===void 0||m==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=m;const h={file:i},x=this.getFileName(e),v=ke("upload/v1beta/files",h._url),b=await this.fetchUploadUrl(v,i.sizeBytes,i.mimeType,x,h,s==null?void 0:s.httpOptions);return c.upload(e,b,this)}async uploadFileToFileSearchStore(e,s,o){var i;const c=this.clientOptions.uploader,u=await c.stat(s),m=String(u.size),h=(i=o==null?void 0:o.mimeType)!==null&&i!==void 0?i:u.type;if(h===void 0||h==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const x=`upload/v1beta/${e}:uploadToFileSearchStore`,v=this.getFileName(s),b={};o!=null&&$y(o,b);const N=await this.fetchUploadUrl(x,m,h,v,b,o==null?void 0:o.httpOptions);return c.uploadToFileSearchStore(s,N,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,s,o,i,c,u){var m;let h={};u?h=u:h={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${s}`,"X-Goog-Upload-Header-Content-Type":`${o}`},i?{"X-Goog-Upload-File-Name":i}:{})};const x=await this.request({path:e,body:JSON.stringify(c),httpMethod:"POST",httpOptions:h});if(!x||!(x!=null&&x.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const v=(m=x==null?void 0:x.headers)===null||m===void 0?void 0:m["x-goog-upload-url"];if(v===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return v}}async function Hv(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const s=t.status;let o;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?o=await t.json():o={error:{message:await t.text(),code:t.status,status:t.statusText}};const i=JSON.stringify(o);throw s>=400&&s<600?new dd({message:i,status:s}):new Error(i)}}function R1(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let s={};if(typeof t.body=="string"&&t.body.length>0)try{const c=JSON.parse(t.body);if(typeof c=="object"&&c!==null&&!Array.isArray(c))s=c;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function o(c,u){const m=Object.assign({},c);for(const h in u)if(Object.prototype.hasOwnProperty.call(u,h)){const x=u[h],v=m[h];x&&typeof x=="object"&&!Array.isArray(x)&&v&&typeof v=="object"&&!Array.isArray(v)?m[h]=o(v,x):(v&&x&&typeof v!=typeof x&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${h}". Original type: ${typeof v}, New type: ${typeof x}. Overwriting.`),m[h]=x)}return m}const i=o(s,e);t.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const D1="mcp_used/unknown";let U1=!1;function Yy(t){for(const e of t)if(P1(e)||typeof e=="object"&&"inputSchema"in e)return!0;return U1}function Jy(t){var e;const s=(e=t[Kf])!==null&&e!==void 0?e:"";t[Kf]=(s+` ${D1}`).trimStart()}function P1(t){return t!==null&&typeof t=="object"&&t instanceof Im}function L1(t){return Os(this,arguments,function*(s,o=100){let i,c=0;for(;c<o;){const u=yield Ye(s.listTools({cursor:i}));for(const m of u.tools)yield yield Ye(m),c++;if(!u.nextCursor)break;i=u.nextCursor}})}class Im{constructor(e=[],s){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=s}static create(e,s){return new Im(e,s)}async initialize(){var e,s,o,i;if(this.mcpTools.length>0)return;const c={},u=[];for(const v of this.mcpClients)try{for(var m=!0,h=(s=void 0,qs(L1(v))),x;x=await h.next(),e=x.done,!e;m=!0){i=x.value,m=!1;const b=i;u.push(b);const N=b.name;if(c[N])throw new Error(`Duplicate function name ${N} found in MCP tools. Please ensure function names are unique.`);c[N]=v}}catch(b){s={error:b}}finally{try{!m&&!e&&(o=h.return)&&await o.call(h)}finally{if(s)throw s.error}}this.mcpTools=u,this.functionNameToMcpClient=c}async tool(){return await this.initialize(),hj(this.mcpTools,this.config)}async callTool(e){await this.initialize();const s=[];for(const o of e)if(o.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[o.name];let c;this.config.timeout&&(c={timeout:this.config.timeout});const u=await i.callTool({name:o.name,arguments:o.args},void 0,c);s.push({functionResponse:{name:o.name,response:u.isError?{error:u}:u}})}return s}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function z1(t,e,s){const o=new ij;let i;s.data instanceof Blob?i=JSON.parse(await s.data.text()):i=JSON.parse(s.data),Object.assign(o,i),e(o)}class G1{constructor(e,s,o){this.apiClient=e,this.auth=s,this.webSocketFactory=o}async connect(e){var s,o;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),c=this.apiClient.getApiVersion(),u=q1(this.apiClient.getDefaultHeaders()),m=this.apiClient.getApiKey(),h=`${i}/ws/google.ai.generativelanguage.${c}.GenerativeService.BidiGenerateMusic?key=${m}`;let x=()=>{};const v=new Promise(A=>{x=A}),b=e.callbacks,N=function(){x({})},T=this.apiClient,_={onopen:N,onmessage:A=>{z1(T,b.onmessage,A)},onerror:(s=b==null?void 0:b.onerror)!==null&&s!==void 0?s:function(A){},onclose:(o=b==null?void 0:b.onclose)!==null&&o!==void 0?o:function(A){}},I=this.webSocketFactory.create(h,O1(u),_);I.connect(),await v;const z={setup:{model:xt(this.apiClient,e.model)}};return I.send(JSON.stringify(z)),new H1(I,this.apiClient)}}class H1{constructor(e,s){this.conn=e,this.apiClient=s}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const s=fC(e);this.conn.send(JSON.stringify({clientContent:s}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const s=uC(e);this.conn.send(JSON.stringify(s))}sendPlaybackControl(e){const s={playbackControl:e};this.conn.send(JSON.stringify(s))}play(){this.sendPlaybackControl(Jo.PLAY)}pause(){this.sendPlaybackControl(Jo.PAUSE)}stop(){this.sendPlaybackControl(Jo.STOP)}resetContext(){this.sendPlaybackControl(Jo.RESET_CONTEXT)}close(){this.conn.close()}}function O1(t){const e={};return t.forEach((s,o)=>{e[o]=s}),e}function q1(t){const e=new Headers;for(const[s,o]of Object.entries(t))e.append(s,o);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const F1="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function V1(t,e,s){const o=new oj;let i;s.data instanceof Blob?i=await s.data.text():s.data instanceof ArrayBuffer?i=new TextDecoder().decode(s.data):i=s.data;const c=JSON.parse(i);if(t.isVertexAI()){const u=hC(c);Object.assign(o,u)}else Object.assign(o,c);e(o)}class B1{constructor(e,s,o){this.apiClient=e,this.auth=s,this.webSocketFactory=o,this.music=new G1(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var s,o,i,c,u,m;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const h=this.apiClient.getWebsocketBaseUrl(),x=this.apiClient.getApiVersion();let v;const b=this.apiClient.getHeaders();e.config&&e.config.tools&&Yy(e.config.tools)&&Jy(b);const N=X1(b);if(this.apiClient.isVertexAI())v=`${h}/ws/google.cloud.aiplatform.${x}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(N,v);else{const V=this.apiClient.getApiKey();let Z="BidiGenerateContent",K="key";V!=null&&V.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),x!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),Z="BidiGenerateContentConstrained",K="access_token"),v=`${h}/ws/google.ai.generativelanguage.${x}.GenerativeService.${Z}?${K}=${V}`}let T=()=>{};const _=new Promise(V=>{T=V}),I=e.callbacks,E=function(){var V;(V=I==null?void 0:I.onopen)===null||V===void 0||V.call(I),T({})},D=this.apiClient,z={onopen:E,onmessage:V=>{V1(D,I.onmessage,V)},onerror:(s=I==null?void 0:I.onerror)!==null&&s!==void 0?s:function(V){},onclose:(o=I==null?void 0:I.onclose)!==null&&o!==void 0?o:function(V){}},A=this.webSocketFactory.create(v,J1(N),z);A.connect(),await _;let M=xt(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&M.startsWith("publishers/")){const V=this.apiClient.getProject(),Z=this.apiClient.getLocation();M=`projects/${V}/locations/${Z}/`+M}let B={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Wc.AUDIO]}:e.config.responseModalities=[Wc.AUDIO]),!((c=e.config)===null||c===void 0)&&c.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const L=(m=(u=e.config)===null||u===void 0?void 0:u.tools)!==null&&m!==void 0?m:[],X=[];for(const V of L)if(this.isCallableTool(V)){const Z=V;X.push(await Z.tool())}else X.push(V);X.length>0&&(e.config.tools=X);const de={model:M,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?B=dC(this.apiClient,de):B=cC(this.apiClient,de),delete B.config,A.send(JSON.stringify(B)),new Y1(A,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const $1={turnComplete:!0};class Y1{constructor(e,s){this.conn=e,this.apiClient=s}tLiveClientContent(e,s){if(s.turns!==null&&s.turns!==void 0){let o=[];try{o=ks(s.turns),e.isVertexAI()||(o=o.map(i=>ud(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof s.turns}'`)}return{clientContent:{turns:o,turnComplete:s.turnComplete}}}return{clientContent:{turnComplete:s.turnComplete}}}tLiveClienttToolResponse(e,s){let o=[];if(s.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(s.functionResponses)?o=s.functionResponses:o=[s.functionResponses],o.length===0)throw new Error("functionResponses is required.");for(const c of o){if(typeof c!="object"||c===null||!("name"in c)||!("response"in c))throw new Error(`Could not parse function response, type '${typeof c}'.`);if(!e.isVertexAI()&&!("id"in c))throw new Error(F1)}return{toolResponse:{functionResponses:o}}}sendClientContent(e){e=Object.assign(Object.assign({},$1),e);const s=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(s))}sendRealtimeInput(e){let s={};this.apiClient.isVertexAI()?s={realtimeInput:pC(e)}:s={realtimeInput:mC(e)},this.conn.send(JSON.stringify(s))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const s=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(s))}close(){this.conn.close()}}function J1(t){const e={};return t.forEach((s,o)=>{e[o]=s}),e}function X1(t){const e=new Headers;for(const[s,o]of Object.entries(t))e.append(s,o);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ov=10;function qv(t){var e,s,o;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const u of(s=t==null?void 0:t.tools)!==null&&s!==void 0?s:[])if(Zo(u)){i=!0;break}if(!i)return!0;const c=(o=t==null?void 0:t.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls;return c&&(c<0||!Number.isInteger(c))||c==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",c),!0):!1}function Zo(t){return"callTool"in t&&typeof t.callTool=="function"}function K1(t){var e,s,o;return(o=(s=(e=t.config)===null||e===void 0?void 0:e.tools)===null||s===void 0?void 0:s.some(i=>Zo(i)))!==null&&o!==void 0?o:!1}function Fv(t){var e;const s=[];return!((e=t==null?void 0:t.config)===null||e===void 0)&&e.tools&&t.config.tools.forEach((o,i)=>{if(Zo(o))return;const c=o;c.functionDeclarations&&c.functionDeclarations.length>0&&s.push(i)}),s}function Vv(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class W1 extends Rr{constructor(e){super(),this.apiClient=e,this.generateContent=async s=>{var o,i,c,u,m;const h=await this.processParamsMaybeAddMcpUsage(s);if(this.maybeMoveToResponseJsonSchem(s),!K1(s)||qv(s.config))return await this.generateContentInternal(h);const x=Fv(s);if(x.length>0){const I=x.map(E=>`tools[${E}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${I}.`)}let v,b;const N=ks(h.contents),T=(c=(i=(o=h.config)===null||o===void 0?void 0:o.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&c!==void 0?c:Ov;let _=0;for(;_<T&&(v=await this.generateContentInternal(h),!(!v.functionCalls||v.functionCalls.length===0));){const I=v.candidates[0].content,E=[];for(const D of(m=(u=s.config)===null||u===void 0?void 0:u.tools)!==null&&m!==void 0?m:[])if(Zo(D)){const A=await D.callTool(v.functionCalls);E.push(...A)}_++,b={role:"user",parts:E},h.contents=ks(h.contents),h.contents.push(I),h.contents.push(b),Vv(h.config)&&(N.push(I),N.push(b))}return Vv(h.config)&&(v.automaticFunctionCallingHistory=N),v},this.generateContentStream=async s=>{var o,i,c,u,m;if(this.maybeMoveToResponseJsonSchem(s),qv(s.config)){const b=await this.processParamsMaybeAddMcpUsage(s);return await this.generateContentStreamInternal(b)}const h=Fv(s);if(h.length>0){const b=h.map(N=>`tools[${N}]`).join(", ");throw new Error(`Incompatible tools found at ${b}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const x=(c=(i=(o=s==null?void 0:s.config)===null||o===void 0?void 0:o.toolConfig)===null||i===void 0?void 0:i.functionCallingConfig)===null||c===void 0?void 0:c.streamFunctionCallArguments,v=(m=(u=s==null?void 0:s.config)===null||u===void 0?void 0:u.automaticFunctionCalling)===null||m===void 0?void 0:m.disable;if(x&&!v)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(s)},this.generateImages=async s=>await this.generateImagesInternal(s).then(o=>{var i;let c;const u=[];if(o!=null&&o.generatedImages)for(const h of o.generatedImages)h&&(h!=null&&h.safetyAttributes)&&((i=h==null?void 0:h.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?c=h==null?void 0:h.safetyAttributes:u.push(h);let m;return c?m={generatedImages:u,positivePromptSafetyAttributes:c,sdkHttpResponse:o.sdkHttpResponse}:m={generatedImages:u,sdkHttpResponse:o.sdkHttpResponse},m}),this.list=async s=>{var o;const u={config:Object.assign(Object.assign({},{queryBase:!0}),s==null?void 0:s.config)};if(this.apiClient.isVertexAI()&&!u.config.queryBase){if(!((o=u.config)===null||o===void 0)&&o.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");u.config.filter="labels.tune-type:*"}return new ao(Mr.PAGED_ITEM_MODELS,m=>this.listInternal(m),await this.listInternal(u),u)},this.editImage=async s=>{const o={model:s.model,prompt:s.prompt,referenceImages:[],config:s.config};return s.referenceImages&&s.referenceImages&&(o.referenceImages=s.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(o)},this.upscaleImage=async s=>{let o={numberOfImages:1,mode:"upscale"};s.config&&(o=Object.assign(Object.assign({},o),s.config));const i={model:s.model,image:s.image,upscaleFactor:s.upscaleFactor,config:o};return await this.upscaleImageInternal(i)},this.generateVideos=async s=>{var o,i,c,u,m,h;if((s.prompt||s.image||s.video)&&s.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((o=s.video)===null||o===void 0)&&o.uri&&(!((i=s.video)===null||i===void 0)&&i.videoBytes)?s.video={uri:s.video.uri,mimeType:s.video.mimeType}:!((u=(c=s.source)===null||c===void 0?void 0:c.video)===null||u===void 0)&&u.uri&&(!((h=(m=s.source)===null||m===void 0?void 0:m.video)===null||h===void 0)&&h.videoBytes)&&(s.source.video={uri:s.source.video.uri,mimeType:s.source.video.mimeType})),await this.generateVideosInternal(s)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var s,o,i;const c=(s=e.config)===null||s===void 0?void 0:s.tools;if(!c)return e;const u=await Promise.all(c.map(async h=>Zo(h)?await h.tool():h)),m={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:u})};if(m.config.tools=u,e.config&&e.config.tools&&Yy(e.config.tools)){const h=(i=(o=e.config.httpOptions)===null||o===void 0?void 0:o.headers)!==null&&i!==void 0?i:{};let x=Object.assign({},h);Object.keys(x).length===0&&(x=this.apiClient.getDefaultHeaders()),Jy(x),m.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:x})}return m}async initAfcToolsMap(e){var s,o,i;const c=new Map;for(const u of(o=(s=e.config)===null||s===void 0?void 0:s.tools)!==null&&o!==void 0?o:[])if(Zo(u)){const m=u,h=await m.tool();for(const x of(i=h.functionDeclarations)!==null&&i!==void 0?i:[]){if(!x.name)throw new Error("Function declaration name is required.");if(c.has(x.name))throw new Error(`Duplicate tool declaration name: ${x.name}`);c.set(x.name,m)}}return c}async processAfcStream(e){var s,o,i;const c=(i=(o=(s=e.config)===null||s===void 0?void 0:s.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls)!==null&&i!==void 0?i:Ov;let u=!1,m=0;const h=await this.initAfcToolsMap(e);return(function(x,v,b){return Os(this,arguments,function*(){for(var N,T,_,I,E,D;m<c;){u&&(m++,u=!1);const B=yield Ye(x.processParamsMaybeAddMcpUsage(b)),L=yield Ye(x.generateContentStreamInternal(B)),X=[],de=[];try{for(var z=!0,A=(T=void 0,qs(L)),M;M=yield Ye(A.next()),N=M.done,!N;z=!0){I=M.value,z=!1;const V=I;if(yield yield Ye(V),V.candidates&&(!((E=V.candidates[0])===null||E===void 0)&&E.content)){de.push(V.candidates[0].content);for(const Z of(D=V.candidates[0].content.parts)!==null&&D!==void 0?D:[])if(m<c&&Z.functionCall){if(!Z.functionCall.name)throw new Error("Function call name was not returned by the model.");if(v.has(Z.functionCall.name)){const K=yield Ye(v.get(Z.functionCall.name).callTool([Z.functionCall]));X.push(...K)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${v.keys()}, mising tool: ${Z.functionCall.name}`)}}}}catch(V){T={error:V}}finally{try{!z&&!N&&(_=A.return)&&(yield Ye(_.call(A)))}finally{if(T)throw T.error}}if(X.length>0){u=!0;const V=new tl;V.candidates=[{content:{role:"user",parts:X}}],yield yield Ye(V);const Z=[];Z.push(...de),Z.push({role:"user",parts:X});const K=ks(b.contents).concat(Z);b.contents=K}else break}})})(this,h,e)}async generateContentInternal(e){var s,o,i,c;let u,m="",h={};if(this.apiClient.isVertexAI()){const x=Lv(this.apiClient,e);return m=ke("{model}:generateContent",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(b=>{const N=b;return N.sdkHttpResponse={headers:v.headers},N})),u.then(v=>{const b=Gv(v),N=new tl;return Object.assign(N,b),N})}else{const x=Pv(this.apiClient,e);return m=ke("{model}:generateContent",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(b=>{const N=b;return N.sdkHttpResponse={headers:v.headers},N})),u.then(v=>{const b=zv(v),N=new tl;return Object.assign(N,b),N})}}async generateContentStreamInternal(e){var s,o,i,c;let u,m="",h={};if(this.apiClient.isVertexAI()){const x=Lv(this.apiClient,e);return m=ke("{model}:streamGenerateContent?alt=sse",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.requestStream({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}),u.then(function(b){return Os(this,arguments,function*(){var N,T,_,I;try{for(var E=!0,D=qs(b),z;z=yield Ye(D.next()),N=z.done,!N;E=!0){I=z.value,E=!1;const A=I,M=Gv(yield Ye(A.json()));M.sdkHttpResponse={headers:A.headers};const B=new tl;Object.assign(B,M),yield yield Ye(B)}}catch(A){T={error:A}}finally{try{!E&&!N&&(_=D.return)&&(yield Ye(_.call(D)))}finally{if(T)throw T.error}}})})}else{const x=Pv(this.apiClient,e);return m=ke("{model}:streamGenerateContent?alt=sse",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.requestStream({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}),u.then(function(b){return Os(this,arguments,function*(){var N,T,_,I;try{for(var E=!0,D=qs(b),z;z=yield Ye(D.next()),N=z.done,!N;E=!0){I=z.value,E=!1;const A=I,M=zv(yield Ye(A.json()));M.sdkHttpResponse={headers:A.headers};const B=new tl;Object.assign(B,M),yield yield Ye(B)}}catch(A){T={error:A}}finally{try{!E&&!N&&(_=D.return)&&(yield Ye(_.call(D)))}finally{if(T)throw T.error}}})})}}async embedContent(e){var s,o,i,c;let u,m="",h={};if(this.apiClient.isVertexAI()){const x=BC(this.apiClient,e);return m=ke("{model}:predict",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(b=>{const N=b;return N.sdkHttpResponse={headers:v.headers},N})),u.then(v=>{const b=YC(v),N=new yv;return Object.assign(N,b),N})}else{const x=VC(this.apiClient,e);return m=ke("{model}:batchEmbedContents",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(b=>{const N=b;return N.sdkHttpResponse={headers:v.headers},N})),u.then(v=>{const b=$C(v),N=new yv;return Object.assign(N,b),N})}}async generateImagesInternal(e){var s,o,i,c;let u,m="",h={};if(this.apiClient.isVertexAI()){const x=rE(this.apiClient,e);return m=ke("{model}:predict",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(b=>{const N=b;return N.sdkHttpResponse={headers:v.headers},N})),u.then(v=>{const b=oE(v),N=new bv;return Object.assign(N,b),N})}else{const x=sE(this.apiClient,e);return m=ke("{model}:predict",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(b=>{const N=b;return N.sdkHttpResponse={headers:v.headers},N})),u.then(v=>{const b=aE(v),N=new bv;return Object.assign(N,b),N})}}async editImageInternal(e){var s,o;let i,c="",u={};if(this.apiClient.isVertexAI()){const m=HC(this.apiClient,e);return c=ke("{model}:predict",m._url),u=m._query,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:h.headers},v})),i.then(h=>{const x=OC(h),v=new XS;return Object.assign(v,x),v})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var s,o;let i,c="",u={};if(this.apiClient.isVertexAI()){const m=r1(this.apiClient,e);return c=ke("{model}:predict",m._url),u=m._query,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:h.headers},v})),i.then(h=>{const x=a1(h),v=new KS;return Object.assign(v,x),v})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var s,o;let i,c="",u={};if(this.apiClient.isVertexAI()){const m=GE(this.apiClient,e);return c=ke("{model}:predict",m._url),u=m._query,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>{const x=HE(h),v=new WS;return Object.assign(v,x),v})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var s,o;let i,c="",u={};if(this.apiClient.isVertexAI()){const m=$E(this.apiClient,e);return c=ke("{model}:predict",m._url),u=m._query,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>{const x=YE(h),v=new QS;return Object.assign(v,x),v})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var s,o,i,c;let u,m="",h={};if(this.apiClient.isVertexAI()){const x=SE(this.apiClient,e);return m=ke("{name}",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),u.then(v=>Xf(v))}else{const x=wE(this.apiClient,e);return m=ke("{name}",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json()),u.then(v=>Jf(v))}}async listInternal(e){var s,o,i,c;let u,m="",h={};if(this.apiClient.isVertexAI()){const x=ME(this.apiClient,e);return m=ke("{models_url}",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(b=>{const N=b;return N.sdkHttpResponse={headers:v.headers},N})),u.then(v=>{const b=DE(v),N=new Nv;return Object.assign(N,b),N})}else{const x=IE(this.apiClient,e);return m=ke("{models_url}",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(b=>{const N=b;return N.sdkHttpResponse={headers:v.headers},N})),u.then(v=>{const b=RE(v),N=new Nv;return Object.assign(N,b),N})}}async update(e){var s,o,i,c;let u,m="",h={};if(this.apiClient.isVertexAI()){const x=n1(this.apiClient,e);return m=ke("{model}",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),u.then(v=>Xf(v))}else{const x=t1(this.apiClient,e);return m=ke("{name}",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json()),u.then(v=>Jf(v))}}async delete(e){var s,o,i,c;let u,m="",h={};if(this.apiClient.isVertexAI()){const x=PC(this.apiClient,e);return m=ke("{name}",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(b=>{const N=b;return N.sdkHttpResponse={headers:v.headers},N})),u.then(v=>{const b=zC(v),N=new wv;return Object.assign(N,b),N})}else{const x=UC(this.apiClient,e);return m=ke("{name}",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(b=>{const N=b;return N.sdkHttpResponse={headers:v.headers},N})),u.then(v=>{const b=LC(v),N=new wv;return Object.assign(N,b),N})}}async countTokens(e){var s,o,i,c;let u,m="",h={};if(this.apiClient.isVertexAI()){const x=MC(this.apiClient,e);return m=ke("{model}:countTokens",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(b=>{const N=b;return N.sdkHttpResponse={headers:v.headers},N})),u.then(v=>{const b=DC(v),N=new Sv;return Object.assign(N,b),N})}else{const x=IC(this.apiClient,e);return m=ke("{model}:countTokens",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(b=>{const N=b;return N.sdkHttpResponse={headers:v.headers},N})),u.then(v=>{const b=RC(v),N=new Sv;return Object.assign(N,b),N})}}async computeTokens(e){var s,o;let i,c="",u={};if(this.apiClient.isVertexAI()){const m=jC(this.apiClient,e);return c=ke("{model}:computeTokens",m._url),u=m._query,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:h.headers},v})),i.then(h=>{const x=TC(h),v=new ZS;return Object.assign(v,x),v})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var s,o,i,c;let u,m="",h={};if(this.apiClient.isVertexAI()){const x=fE(this.apiClient,e);return m=ke("{model}:predictLongRunning",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),u.then(v=>{const b=dE(v),N=new Qc;return Object.assign(N,b),N})}else{const x=uE(this.apiClient,e);return m=ke("{model}:predictLongRunning",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json()),u.then(v=>{const b=cE(v),N=new Qc;return Object.assign(N,b),N})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Q1 extends Rr{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const s=e.operation,o=e.config;if(s.name===void 0||s.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=s.name.split("/operations/")[0];let c;o&&"httpOptions"in o&&(c=o.httpOptions);const u=await this.fetchPredictVideosOperationInternal({operationName:s.name,resourceName:i,config:{httpOptions:c}});return s._fromAPIResponse({apiResponse:u,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:s.name,config:o});return s._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async get(e){const s=e.operation,o=e.config;if(s.name===void 0||s.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=s.name.split("/operations/")[0];let c;o&&"httpOptions"in o&&(c=o.httpOptions);const u=await this.fetchPredictVideosOperationInternal({operationName:s.name,resourceName:i,config:{httpOptions:c}});return s._fromAPIResponse({apiResponse:u,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:s.name,config:o});return s._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async getVideosOperationInternal(e){var s,o,i,c;let u,m="",h={};if(this.apiClient.isVertexAI()){const x=FS(e);return m=ke("{operationName}",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json()),u}else{const x=qS(e);return m=ke("{operationName}",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json()),u}}async fetchPredictVideosOperationInternal(e){var s,o;let i,c="",u={};if(this.apiClient.isVertexAI()){const m=US(e);return c=ke("{resourceName}:fetchPredictOperation",m._url),u=m._query,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Z1(t){const e={},s=f(t,["data"]);if(s!=null&&p(e,["data"],s),f(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=f(t,["mimeType"]);return o!=null&&p(e,["mimeType"],o),e}function e_(t){const e={},s=f(t,["parts"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(c=>c_(c))),p(e,["parts"],i)}const o=f(t,["role"]);return o!=null&&p(e,["role"],o),e}function t_(t,e,s){const o={},i=f(e,["expireTime"]);s!==void 0&&i!=null&&p(s,["expireTime"],i);const c=f(e,["newSessionExpireTime"]);s!==void 0&&c!=null&&p(s,["newSessionExpireTime"],c);const u=f(e,["uses"]);s!==void 0&&u!=null&&p(s,["uses"],u);const m=f(e,["liveConnectConstraints"]);s!==void 0&&m!=null&&p(s,["bidiGenerateContentSetup"],l_(t,m));const h=f(e,["lockAdditionalFields"]);return s!==void 0&&h!=null&&p(s,["fieldMask"],h),o}function n_(t,e){const s={},o=f(e,["config"]);return o!=null&&p(s,["config"],t_(t,o,s)),s}function s_(t){const e={};if(f(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=f(t,["fileUri"]);s!=null&&p(e,["fileUri"],s);const o=f(t,["mimeType"]);return o!=null&&p(e,["mimeType"],o),e}function r_(t){const e={},s=f(t,["id"]);s!=null&&p(e,["id"],s);const o=f(t,["args"]);o!=null&&p(e,["args"],o);const i=f(t,["name"]);if(i!=null&&p(e,["name"],i),f(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(f(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function a_(t){const e={};if(f(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const s=f(t,["enableWidget"]);return s!=null&&p(e,["enableWidget"],s),e}function o_(t){const e={};if(f(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(f(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const s=f(t,["timeRangeFilter"]);return s!=null&&p(e,["timeRangeFilter"],s),e}function i_(t,e){const s={},o=f(t,["generationConfig"]);e!==void 0&&o!=null&&p(e,["setup","generationConfig"],o);const i=f(t,["responseModalities"]);e!==void 0&&i!=null&&p(e,["setup","generationConfig","responseModalities"],i);const c=f(t,["temperature"]);e!==void 0&&c!=null&&p(e,["setup","generationConfig","temperature"],c);const u=f(t,["topP"]);e!==void 0&&u!=null&&p(e,["setup","generationConfig","topP"],u);const m=f(t,["topK"]);e!==void 0&&m!=null&&p(e,["setup","generationConfig","topK"],m);const h=f(t,["maxOutputTokens"]);e!==void 0&&h!=null&&p(e,["setup","generationConfig","maxOutputTokens"],h);const x=f(t,["mediaResolution"]);e!==void 0&&x!=null&&p(e,["setup","generationConfig","mediaResolution"],x);const v=f(t,["seed"]);e!==void 0&&v!=null&&p(e,["setup","generationConfig","seed"],v);const b=f(t,["speechConfig"]);e!==void 0&&b!=null&&p(e,["setup","generationConfig","speechConfig"],km(b));const N=f(t,["thinkingConfig"]);e!==void 0&&N!=null&&p(e,["setup","generationConfig","thinkingConfig"],N);const T=f(t,["enableAffectiveDialog"]);e!==void 0&&T!=null&&p(e,["setup","generationConfig","enableAffectiveDialog"],T);const _=f(t,["systemInstruction"]);e!==void 0&&_!=null&&p(e,["setup","systemInstruction"],e_(_n(_)));const I=f(t,["tools"]);if(e!==void 0&&I!=null){let L=ci(I);Array.isArray(L)&&(L=L.map(X=>u_(li(X)))),p(e,["setup","tools"],L)}const E=f(t,["sessionResumption"]);e!==void 0&&E!=null&&p(e,["setup","sessionResumption"],d_(E));const D=f(t,["inputAudioTranscription"]);e!==void 0&&D!=null&&p(e,["setup","inputAudioTranscription"],D);const z=f(t,["outputAudioTranscription"]);e!==void 0&&z!=null&&p(e,["setup","outputAudioTranscription"],z);const A=f(t,["realtimeInputConfig"]);e!==void 0&&A!=null&&p(e,["setup","realtimeInputConfig"],A);const M=f(t,["contextWindowCompression"]);e!==void 0&&M!=null&&p(e,["setup","contextWindowCompression"],M);const B=f(t,["proactivity"]);if(e!==void 0&&B!=null&&p(e,["setup","proactivity"],B),f(t,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return s}function l_(t,e){const s={},o=f(e,["model"]);o!=null&&p(s,["setup","model"],xt(t,o));const i=f(e,["config"]);return i!=null&&p(s,["config"],i_(i,s)),s}function c_(t){const e={},s=f(t,["mediaResolution"]);s!=null&&p(e,["mediaResolution"],s);const o=f(t,["codeExecutionResult"]);o!=null&&p(e,["codeExecutionResult"],o);const i=f(t,["executableCode"]);i!=null&&p(e,["executableCode"],i);const c=f(t,["fileData"]);c!=null&&p(e,["fileData"],s_(c));const u=f(t,["functionCall"]);u!=null&&p(e,["functionCall"],r_(u));const m=f(t,["functionResponse"]);m!=null&&p(e,["functionResponse"],m);const h=f(t,["inlineData"]);h!=null&&p(e,["inlineData"],Z1(h));const x=f(t,["text"]);x!=null&&p(e,["text"],x);const v=f(t,["thought"]);v!=null&&p(e,["thought"],v);const b=f(t,["thoughtSignature"]);b!=null&&p(e,["thoughtSignature"],b);const N=f(t,["videoMetadata"]);return N!=null&&p(e,["videoMetadata"],N),e}function d_(t){const e={},s=f(t,["handle"]);if(s!=null&&p(e,["handle"],s),f(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function u_(t){const e={},s=f(t,["functionDeclarations"]);if(s!=null){let v=s;Array.isArray(v)&&(v=v.map(b=>b)),p(e,["functionDeclarations"],v)}if(f(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=f(t,["googleSearchRetrieval"]);o!=null&&p(e,["googleSearchRetrieval"],o);const i=f(t,["computerUse"]);i!=null&&p(e,["computerUse"],i);const c=f(t,["fileSearch"]);c!=null&&p(e,["fileSearch"],c);const u=f(t,["codeExecution"]);if(u!=null&&p(e,["codeExecution"],u),f(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const m=f(t,["googleMaps"]);m!=null&&p(e,["googleMaps"],a_(m));const h=f(t,["googleSearch"]);h!=null&&p(e,["googleSearch"],o_(h));const x=f(t,["urlContext"]);return x!=null&&p(e,["urlContext"],x),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function f_(t){const e=[];for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)){const o=t[s];if(typeof o=="object"&&o!=null&&Object.keys(o).length>0){const i=Object.keys(o).map(c=>`${s}.${c}`);e.push(...i)}else e.push(s)}return e.join(",")}function m_(t,e){let s=null;const o=t.bidiGenerateContentSetup;if(typeof o=="object"&&o!==null&&"setup"in o){const c=o.setup;typeof c=="object"&&c!==null?(t.bidiGenerateContentSetup=c,s=c):delete t.bidiGenerateContentSetup}else o!==void 0&&delete t.bidiGenerateContentSetup;const i=t.fieldMask;if(s){const c=f_(s);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)c?t.fieldMask=c:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const u=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let m=[];i.length>0&&(m=i.map(x=>u.includes(x)?`generationConfig.${x}`:x));const h=[];c&&h.push(c),m.length>0&&h.push(...m),h.length>0?t.fieldMask=h.join(","):delete t.fieldMask}else delete t.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?t.fieldMask=i.join(","):delete t.fieldMask;return t}class p_ extends Rr{constructor(e){super(),this.apiClient=e}async create(e){var s,o;let i,c="",u={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const m=n_(this.apiClient,e);c=ke("auth_tokens",m._url),u=m._query,delete m.config,delete m._url,delete m._query;const h=m_(m,e.config);return i=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(x=>x.json()),i.then(x=>x)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function h_(t,e){const s={},o=f(t,["force"]);return e!==void 0&&o!=null&&p(e,["_query","force"],o),s}function x_(t){const e={},s=f(t,["name"]);s!=null&&p(e,["_url","name"],s);const o=f(t,["config"]);return o!=null&&h_(o,e),e}function g_(t){const e={},s=f(t,["name"]);return s!=null&&p(e,["_url","name"],s),e}function v_(t,e){const s={},o=f(t,["pageSize"]);e!==void 0&&o!=null&&p(e,["_query","pageSize"],o);const i=f(t,["pageToken"]);return e!==void 0&&i!=null&&p(e,["_query","pageToken"],i),s}function y_(t){const e={},s=f(t,["parent"]);s!=null&&p(e,["_url","parent"],s);const o=f(t,["config"]);return o!=null&&v_(o,e),e}function b_(t){const e={},s=f(t,["sdkHttpResponse"]);s!=null&&p(e,["sdkHttpResponse"],s);const o=f(t,["nextPageToken"]);o!=null&&p(e,["nextPageToken"],o);const i=f(t,["documents"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(u=>u)),p(e,["documents"],c)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class N_ extends Rr{constructor(e){super(),this.apiClient=e,this.list=async s=>new ao(Mr.PAGED_ITEM_DOCUMENTS,o=>this.listInternal({parent:s.parent,config:o.config}),await this.listInternal(s),s)}async get(e){var s,o;let i,c="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=g_(e);return c=ke("{name}",m._url),u=m._query,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>h)}}async delete(e){var s,o;let i="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=x_(e);i=ke("{name}",u._url),c=u._query,delete u._url,delete u._query,await this.apiClient.request({path:i,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(e){var s,o;let i,c="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=y_(e);return c=ke("{parent}/documents",m._url),u=m._query,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>{const x=b_(h),v=new ej;return Object.assign(v,x),v})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class w_ extends Rr{constructor(e,s=new N_(e)){super(),this.apiClient=e,this.documents=s,this.list=async(o={})=>new ao(Mr.PAGED_ITEM_FILE_SEARCH_STORES,i=>this.listInternal(i),await this.listInternal(o),o)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var s,o;let i,c="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=f1(e);return c=ke("fileSearchStores",m._url),u=m._query,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>h)}}async get(e){var s,o;let i,c="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=h1(e);return c=ke("{name}",m._url),u=m._query,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>h)}}async delete(e){var s,o;let i="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=p1(e);i=ke("{name}",u._url),c=u._query,delete u._url,delete u._query,await this.apiClient.request({path:i,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(e){var s,o;let i,c="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=N1(e);return c=ke("fileSearchStores",m._url),u=m._query,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(m),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>{const x=w1(h),v=new tj;return Object.assign(v,x),v})}}async uploadToFileSearchStoreInternal(e){var s,o;let i,c="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=S1(e);return c=ke("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",m._url),u=m._query,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>{const x=j1(h),v=new nj;return Object.assign(v,x),v})}}async importFile(e){var s,o;let i,c="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=v1(e);return c=ke("{file_search_store_name}:importFile",m._url),u=m._query,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),i.then(h=>{const x=g1(h),v=new Tm;return Object.assign(v,x),v})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Xy=function(){const{crypto:t}=globalThis;if(t!=null&&t.randomUUID)return Xy=t.randomUUID.bind(t),t.randomUUID();const e=new Uint8Array(1),s=t?()=>t.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,o=>(+o^s()&15>>+o/4).toString(16))};const S_=()=>Xy();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Wf(t){return typeof t=="object"&&t!==null&&("name"in t&&t.name==="AbortError"||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}const Qf=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null){try{if(Object.prototype.toString.call(t)==="[object Error]"){const e=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(e.stack=t.stack),t.cause&&!e.cause&&(e.cause=t.cause),t.name&&(e.name=t.name),e}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Rs extends Error{}class Rn extends Rs{constructor(e,s,o,i){super(`${Rn.makeMessage(e,s,o)}`),this.status=e,this.headers=i,this.error=s}static makeMessage(e,s,o){const i=s!=null&&s.message?typeof s.message=="string"?s.message:JSON.stringify(s.message):s?JSON.stringify(s):o;return e&&i?`${e} ${i}`:e?`${e} status code (no body)`:i||"(no status code or body)"}static generate(e,s,o,i){if(!e||!i)return new pd({message:o,cause:Qf(s)});const c=s;return e===400?new Wy(e,c,o,i):e===401?new Qy(e,c,o,i):e===403?new Zy(e,c,o,i):e===404?new eb(e,c,o,i):e===409?new tb(e,c,o,i):e===422?new nb(e,c,o,i):e===429?new sb(e,c,o,i):e>=500?new rb(e,c,o,i):new Rn(e,c,o,i)}}class Zf extends Rn{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class pd extends Rn{constructor({message:e,cause:s}){super(void 0,void 0,e||"Connection error.",void 0),s&&(this.cause=s)}}class Ky extends pd{constructor({message:e}={}){super({message:e??"Request timed out."})}}class Wy extends Rn{}class Qy extends Rn{}class Zy extends Rn{}class eb extends Rn{}class tb extends Rn{}class nb extends Rn{}class sb extends Rn{}class rb extends Rn{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const j_=/^[a-z][a-z0-9+.-]*:/i,T_=t=>j_.test(t);let em=t=>(em=Array.isArray,em(t));const C_=em;let E_=C_;const Bv=E_;function __(t){if(!t)return!0;for(const e in t)return!1;return!0}function A_(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const k_=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new Rs(`${t} must be an integer`);if(e<0)throw new Rs(`${t} must be a positive integer`);return e},I_=t=>{try{return JSON.parse(t)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const M_=t=>new Promise(e=>setTimeout(e,t));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Yo="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function R_(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const D_=()=>{var t,e,s,o,i;const c=R_();if(c==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Yo,"X-Stainless-OS":Yv(Deno.build.os),"X-Stainless-Arch":$v(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(t=Deno.version)===null||t===void 0?void 0:t.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Yo,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(c==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Yo,"X-Stainless-OS":Yv((s=globalThis.process.platform)!==null&&s!==void 0?s:"unknown"),"X-Stainless-Arch":$v((o=globalThis.process.arch)!==null&&o!==void 0?o:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(i=globalThis.process.version)!==null&&i!==void 0?i:"unknown"};const u=U_();return u?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Yo,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${u.browser}`,"X-Stainless-Runtime-Version":u.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Yo,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function U_(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:s}of t){const o=s.exec(navigator.userAgent);if(o){const i=o[1]||0,c=o[2]||0,u=o[3]||0;return{browser:e,version:`${i}.${c}.${u}`}}}return null}const $v=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",Yv=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let Mc;const P_=()=>Mc??(Mc=D_());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function L_(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function ab(...t){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...t)}function z_(t){let e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return ab({start(){},async pull(s){const{done:o,value:i}=await e.next();o?s.close():s.enqueue(i)},async cancel(){var s;await((s=e.return)===null||s===void 0?void 0:s.call(e))}})}function ob(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const s=await e.read();return s!=null&&s.done&&e.releaseLock(),s}catch(s){throw e.releaseLock(),s}},async return(){const s=e.cancel();return e.releaseLock(),await s,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function G_(t){var e,s;if(t===null||typeof t!="object")return;if(t[Symbol.asyncIterator]){await((s=(e=t[Symbol.asyncIterator]()).return)===null||s===void 0?void 0:s.call(e));return}const o=t.getReader(),i=o.cancel();o.releaseLock(),await i}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const H_=({headers:t,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ib=()=>{var t;if(typeof File>"u"){const{process:e}=globalThis,s=typeof((t=e==null?void 0:e.versions)===null||t===void 0?void 0:t.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(s?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Tf(t,e,s){return ib(),new File(t,e??"unknown_file",s)}function O_(t){return(typeof t=="object"&&t!==null&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}const q_=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const lb=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",F_=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&lb(t),V_=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function";async function B_(t,e,s){if(ib(),t=await t,F_(t))return t instanceof File?t:Tf([await t.arrayBuffer()],t.name);if(V_(t)){const i=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()),Tf(await tm(i),e,s)}const o=await tm(t);if(e||(e=O_(t)),!(s!=null&&s.type)){const i=o.find(c=>typeof c=="object"&&"type"in c&&c.type);typeof i=="string"&&(s=Object.assign(Object.assign({},s),{type:i}))}return Tf(o,e,s)}async function tm(t){var e,s,o,i,c;let u=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)u.push(t);else if(lb(t))u.push(t instanceof Blob?t:await t.arrayBuffer());else if(q_(t))try{for(var m=!0,h=qs(t),x;x=await h.next(),e=x.done,!e;m=!0){i=x.value,m=!1;const v=i;u.push(...await tm(v))}}catch(v){s={error:v}}finally{try{!m&&!e&&(o=h.return)&&await o.call(h)}finally{if(s)throw s.error}}else{const v=(c=t==null?void 0:t.constructor)===null||c===void 0?void 0:c.name;throw new Error(`Unexpected data type: ${typeof t}${v?`; constructor: ${v}`:""}${$_(t)}`)}return u}function $_(t){return typeof t!="object"||t===null?"":`; props: [${Object.getOwnPropertyNames(t).map(s=>`"${s}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class cb{constructor(e){this._client=e}}cb._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function db(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const Jv=Object.freeze(Object.create(null)),Y_=(t=db)=>(function(s,...o){if(s.length===1)return s[0];let i=!1;const c=[],u=s.reduce((v,b,N)=>{var T,_,I;/[?#]/.test(b)&&(i=!0);const E=o[N];let D=(i?encodeURIComponent:t)(""+E);return N!==o.length&&(E==null||typeof E=="object"&&E.toString===((I=Object.getPrototypeOf((_=Object.getPrototypeOf((T=E.hasOwnProperty)!==null&&T!==void 0?T:Jv))!==null&&_!==void 0?_:Jv))===null||I===void 0?void 0:I.toString))&&(D=E+"",c.push({start:v.length+b.length,length:D.length,error:`Value of type ${Object.prototype.toString.call(E).slice(8,-1)} is not a valid path parameter`})),v+b+(N===o.length?"":D)},""),m=u.split(/[?#]/,1)[0],h=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let x;for(;(x=h.exec(m))!==null;)c.push({start:x.index,length:x[0].length,error:`Value "${x[0]}" can't be safely passed as a path parameter`});if(c.sort((v,b)=>v.start-b.start),c.length>0){let v=0;const b=c.reduce((N,T)=>{const _=" ".repeat(T.start-v),I="^".repeat(T.length);return v=T.start+T.length,N+_+I},"");throw new Rs(`Path parameters result in path with invalid segments:
${c.map(N=>N.error).join(`
`)}
${u}
${b}`)}return u}),Rc=Y_(db);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ub extends cb{create(e,s){var o;const{api_version:i=this._client.apiVersion}=e,c=ed(e,["api_version"]);if("model"in c&&"agent_config"in c)throw new Rs("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in c&&"generation_config"in c)throw new Rs("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(Rc`/${i}/interactions`,Object.assign(Object.assign({body:c},s),{stream:(o=e.stream)!==null&&o!==void 0?o:!1}))}delete(e,s={},o){const{api_version:i=this._client.apiVersion}=s??{};return this._client.delete(Rc`/${i}/interactions/${e}`,o)}cancel(e,s={},o){const{api_version:i=this._client.apiVersion}=s??{};return this._client.post(Rc`/${i}/interactions/${e}/cancel`,o)}get(e,s={},o){var i;const c=s??{},{api_version:u=this._client.apiVersion}=c,m=ed(c,["api_version"]);return this._client.get(Rc`/${u}/interactions/${e}`,Object.assign(Object.assign({query:m},o),{stream:(i=s==null?void 0:s.stream)!==null&&i!==void 0?i:!1}))}}ub._key=Object.freeze(["interactions"]);class fb extends ub{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function J_(t){let e=0;for(const i of t)e+=i.length;const s=new Uint8Array(e);let o=0;for(const i of t)s.set(i,o),o+=i.length;return s}let Dc;function Mm(t){let e;return(Dc??(e=new globalThis.TextEncoder,Dc=e.encode.bind(e)))(t)}let Uc;function Xv(t){let e;return(Uc??(e=new globalThis.TextDecoder,Uc=e.decode.bind(e)))(t)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class hd{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const s=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?Mm(e):e;this.buffer=J_([this.buffer,s]);const o=[];let i;for(;(i=X_(this.buffer,this.carriageReturnIndex))!=null;){if(i.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=i.index;continue}if(this.carriageReturnIndex!=null&&(i.index!==this.carriageReturnIndex+1||i.carriage)){o.push(Xv(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const c=this.carriageReturnIndex!==null?i.preceding-1:i.preceding,u=Xv(this.buffer.subarray(0,c));o.push(u),this.buffer=this.buffer.subarray(i.index),this.carriageReturnIndex=null}return o}flush(){return this.buffer.length?this.decode(`
`):[]}}hd.NEWLINE_CHARS=new Set([`
`,"\r"]);hd.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function X_(t,e){for(let i=e??0;i<t.length;i++){if(t[i]===10)return{preceding:i,index:i+1,carriage:!1};if(t[i]===13)return{preceding:i,index:i+1,carriage:!0}}return null}function K_(t){for(let o=0;o<t.length-1;o++){if(t[o]===10&&t[o+1]===10||t[o]===13&&t[o+1]===13)return o+2;if(t[o]===13&&t[o+1]===10&&o+3<t.length&&t[o+2]===13&&t[o+3]===10)return o+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const td={off:0,error:200,warn:300,info:400,debug:500},Kv=(t,e,s)=>{if(t){if(A_(td,t))return t;In(s).warn(`${e} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys(td))}`)}};function cl(){}function Pc(t,e,s){return!e||td[t]>td[s]?cl:e[t].bind(e)}const W_={error:cl,warn:cl,info:cl,debug:cl};let Wv=new WeakMap;function In(t){var e;const s=t.logger,o=(e=t.logLevel)!==null&&e!==void 0?e:"off";if(!s)return W_;const i=Wv.get(s);if(i&&i[0]===o)return i[1];const c={error:Pc("error",s,o),warn:Pc("warn",s,o),info:Pc("info",s,o),debug:Pc("debug",s,o)};return Wv.set(s,[o,c]),c}const Ya=t=>(t.options&&(t.options=Object.assign({},t.options),delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([e,s])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":s]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Xo{constructor(e,s,o){this.iterator=e,this.controller=s,this.client=o}static fromSSEResponse(e,s,o){let i=!1;const c=o?In(o):console;function u(){return Os(this,arguments,function*(){var h,x,v,b;if(i)throw new Rs("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let N=!1;try{try{for(var T=!0,_=qs(Q_(e,s)),I;I=yield Ye(_.next()),h=I.done,!h;T=!0){b=I.value,T=!1;const E=b;if(!N)if(E.data.startsWith("[DONE]")){N=!0;continue}else try{yield yield Ye(JSON.parse(E.data))}catch(D){throw c.error("Could not parse message into JSON:",E.data),c.error("From chunk:",E.raw),D}}}catch(E){x={error:E}}finally{try{!T&&!h&&(v=_.return)&&(yield Ye(v.call(_)))}finally{if(x)throw x.error}}N=!0}catch(E){if(Wf(E))return yield Ye(void 0);throw E}finally{N||s.abort()}})}return new Xo(u,s,o)}static fromReadableStream(e,s,o){let i=!1;function c(){return Os(this,arguments,function*(){var h,x,v,b;const N=new hd,T=ob(e);try{for(var _=!0,I=qs(T),E;E=yield Ye(I.next()),h=E.done,!h;_=!0){b=E.value,_=!1;const D=b;for(const z of N.decode(D))yield yield Ye(z)}}catch(D){x={error:D}}finally{try{!_&&!h&&(v=I.return)&&(yield Ye(v.call(I)))}finally{if(x)throw x.error}}for(const D of N.flush())yield yield Ye(D)})}function u(){return Os(this,arguments,function*(){var h,x,v,b;if(i)throw new Rs("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let N=!1;try{try{for(var T=!0,_=qs(c()),I;I=yield Ye(_.next()),h=I.done,!h;T=!0){b=I.value,T=!1;const E=b;N||E&&(yield yield Ye(JSON.parse(E)))}}catch(E){x={error:E}}finally{try{!T&&!h&&(v=_.return)&&(yield Ye(v.call(_)))}finally{if(x)throw x.error}}N=!0}catch(E){if(Wf(E))return yield Ye(void 0);throw E}finally{N||s.abort()}})}return new Xo(u,s,o)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],s=[],o=this.iterator(),i=c=>({next:()=>{if(c.length===0){const u=o.next();e.push(u),s.push(u)}return c.shift()}});return[new Xo(()=>i(e),this.controller,this.client),new Xo(()=>i(s),this.controller,this.client)]}toReadableStream(){const e=this;let s;return ab({async start(){s=e[Symbol.asyncIterator]()},async pull(o){try{const{value:i,done:c}=await s.next();if(c)return o.close();const u=Mm(JSON.stringify(i)+`
`);o.enqueue(u)}catch(i){o.error(i)}},async cancel(){var o;await((o=s.return)===null||o===void 0?void 0:o.call(s))}})}}function Q_(t,e){return Os(this,arguments,function*(){var o,i,c,u;if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new Rs("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new Rs("Attempted to iterate over a response with no body");const m=new eA,h=new hd,x=ob(t.body);try{for(var v=!0,b=qs(Z_(x)),N;N=yield Ye(b.next()),o=N.done,!o;v=!0){u=N.value,v=!1;const T=u;for(const _ of h.decode(T)){const I=m.decode(_);I&&(yield yield Ye(I))}}}catch(T){i={error:T}}finally{try{!v&&!o&&(c=b.return)&&(yield Ye(c.call(b)))}finally{if(i)throw i.error}}for(const T of h.flush()){const _=m.decode(T);_&&(yield yield Ye(_))}})}function Z_(t){return Os(this,arguments,function*(){var s,o,i,c;let u=new Uint8Array;try{for(var m=!0,h=qs(t),x;x=yield Ye(h.next()),s=x.done,!s;m=!0){c=x.value,m=!1;const v=c;if(v==null)continue;const b=v instanceof ArrayBuffer?new Uint8Array(v):typeof v=="string"?Mm(v):v;let N=new Uint8Array(u.length+b.length);N.set(u),N.set(b,u.length),u=N;let T;for(;(T=K_(u))!==-1;)yield yield Ye(u.slice(0,T)),u=u.slice(T)}}catch(v){o={error:v}}finally{try{!m&&!s&&(i=h.return)&&(yield Ye(i.call(h)))}finally{if(o)throw o.error}}u.length>0&&(yield yield Ye(u))})}class eA{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const c={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],c}if(this.chunks.push(e),e.startsWith(":"))return null;let[s,o,i]=tA(e,":");return i.startsWith(" ")&&(i=i.substring(1)),s==="event"?this.event=i:s==="data"&&this.data.push(i),null}}function tA(t,e){const s=t.indexOf(e);return s!==-1?[t.substring(0,s),e,t.substring(s+e.length)]:[t,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function nA(t,e){const{response:s,requestLogID:o,retryOfRequestLogID:i,startTime:c}=e,u=await(async()=>{var m;if(e.options.stream)return In(t).debug("response",s.status,s.url,s.headers,s.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(s,e.controller,t):Xo.fromSSEResponse(s,e.controller,t);if(s.status===204)return null;if(e.options.__binaryResponse)return s;const h=s.headers.get("content-type"),x=(m=h==null?void 0:h.split(";")[0])===null||m===void 0?void 0:m.trim();return(x==null?void 0:x.includes("application/json"))||(x==null?void 0:x.endsWith("+json"))?await s.json():await s.text()})();return In(t).debug(`[${o}] response parsed`,Ya({retryOfRequestLogID:i,url:s.url,status:s.status,body:u,durationMs:Date.now()-c})),u}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Rm extends Promise{constructor(e,s,o=nA){super(i=>{i(null)}),this.responsePromise=s,this.parseResponse=o,this.client=e}_thenUnwrap(e){return new Rm(this.client,this.responsePromise,async(s,o)=>e(await this.parseResponse(s,o),o))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,s]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:s}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,s){return this.parse().then(e,s)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const mb=Symbol("brand.privateNullableHeaders");function*sA(t){if(!t)return;if(mb in t){const{values:o,nulls:i}=t;yield*o.entries();for(const c of i)yield[c,null];return}let e=!1,s;t instanceof Headers?s=t.entries():Bv(t)?s=t:(e=!0,s=Object.entries(t??{}));for(let o of s){const i=o[0];if(typeof i!="string")throw new TypeError("expected header name to be a string");const c=Bv(o[1])?o[1]:[o[1]];let u=!1;for(const m of c)m!==void 0&&(e&&!u&&(u=!0,yield[i,null]),yield[i,m])}}const Cf=t=>{const e=new Headers,s=new Set;for(const o of t){const i=new Set;for(const[c,u]of sA(o)){const m=c.toLowerCase();i.has(m)||(e.delete(c),i.add(m)),u===null?(e.delete(c),s.add(m)):(e.append(c,u),s.delete(m))}}return{[mb]:!0,values:e,nulls:s}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ef=t=>{var e,s,o,i,c,u;if(typeof globalThis.process<"u")return(o=(s=(e=AS)===null||e===void 0?void 0:e[t])===null||s===void 0?void 0:s.trim())!==null&&o!==void 0?o:void 0;if(typeof globalThis.Deno<"u")return(u=(c=(i=globalThis.Deno.env)===null||i===void 0?void 0:i.get)===null||c===void 0?void 0:c.call(i,t))===null||u===void 0?void 0:u.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var pb;class xd{constructor(e){var s,o,i,c,u,m,h,x=e===void 0?{}:e,{baseURL:v=Ef("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:b=(s=Ef("GEMINI_API_KEY"))!==null&&s!==void 0?s:null,apiVersion:N="v1beta"}=x,T=ed(x,["baseURL","apiKey","apiVersion"]);const _=Object.assign(Object.assign({apiKey:b,apiVersion:N},T),{baseURL:v||"https://generativelanguage.googleapis.com"});this.baseURL=_.baseURL,this.timeout=(o=_.timeout)!==null&&o!==void 0?o:xd.DEFAULT_TIMEOUT,this.logger=(i=_.logger)!==null&&i!==void 0?i:console;const I="warn";this.logLevel=I,this.logLevel=(u=(c=Kv(_.logLevel,"ClientOptions.logLevel",this))!==null&&c!==void 0?c:Kv(Ef("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&u!==void 0?u:I,this.fetchOptions=_.fetchOptions,this.maxRetries=(m=_.maxRetries)!==null&&m!==void 0?m:2,this.fetch=(h=_.fetch)!==null&&h!==void 0?h:L_(),this.encoder=H_,this._options=_,this.apiKey=b,this.apiVersion=N}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:s}){if(!(this.apiKey&&e.get("x-goog-api-key"))&&!s.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){if(this.apiKey!=null)return Cf([{"x-goog-api-key":this.apiKey}])}stringifyQuery(e){return Object.entries(e).filter(([s,o])=>typeof o<"u").map(([s,o])=>{if(typeof o=="string"||typeof o=="number"||typeof o=="boolean")return`${encodeURIComponent(s)}=${encodeURIComponent(o)}`;if(o===null)return`${encodeURIComponent(s)}=`;throw new Rs(`Cannot stringify type ${typeof o}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${Yo}`}defaultIdempotencyKey(){return`stainless-node-retry-${S_()}`}makeStatusError(e,s,o,i){return Rn.generate(e,s,o,i)}buildURL(e,s,o){const i=!this.baseURLOverridden()&&o||this.baseURL,c=T_(e)?new URL(e):new URL(i+(i.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),u=this.defaultQuery();return __(u)||(s=Object.assign(Object.assign({},u),s)),typeof s=="object"&&s&&!Array.isArray(s)&&(c.search=this.stringifyQuery(s)),c.toString()}async prepareOptions(e){}async prepareRequest(e,{url:s,options:o}){}get(e,s){return this.methodRequest("get",e,s)}post(e,s){return this.methodRequest("post",e,s)}patch(e,s){return this.methodRequest("patch",e,s)}put(e,s){return this.methodRequest("put",e,s)}delete(e,s){return this.methodRequest("delete",e,s)}methodRequest(e,s,o){return this.request(Promise.resolve(o).then(i=>Object.assign({method:e,path:s},i)))}request(e,s=null){return new Rm(this,this.makeRequest(e,s,void 0))}async makeRequest(e,s,o){var i,c,u;const m=await e,h=(i=m.maxRetries)!==null&&i!==void 0?i:this.maxRetries;s==null&&(s=h),await this.prepareOptions(m);const{req:x,url:v,timeout:b}=await this.buildRequest(m,{retryCount:h-s});await this.prepareRequest(x,{url:v,options:m});const N="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),T=o===void 0?"":`, retryOf: ${o}`,_=Date.now();if(In(this).debug(`[${N}] sending request`,Ya({retryOfRequestLogID:o,method:m.method,url:v,options:m,headers:x.headers})),!((c=m.signal)===null||c===void 0)&&c.aborted)throw new Zf;const I=new AbortController,E=await this.fetchWithTimeout(v,x,b,I).catch(Qf),D=Date.now();if(E instanceof globalThis.Error){const A=`retrying, ${s} attempts remaining`;if(!((u=m.signal)===null||u===void 0)&&u.aborted)throw new Zf;const M=Wf(E)||/timed? ?out/i.test(String(E)+("cause"in E?String(E.cause):""));if(s)return In(this).info(`[${N}] connection ${M?"timed out":"failed"} - ${A}`),In(this).debug(`[${N}] connection ${M?"timed out":"failed"} (${A})`,Ya({retryOfRequestLogID:o,url:v,durationMs:D-_,message:E.message})),this.retryRequest(m,s,o??N);throw In(this).info(`[${N}] connection ${M?"timed out":"failed"} - error; no more retries left`),In(this).debug(`[${N}] connection ${M?"timed out":"failed"} (error; no more retries left)`,Ya({retryOfRequestLogID:o,url:v,durationMs:D-_,message:E.message})),M?new Ky:new pd({cause:E})}const z=`[${N}${T}] ${x.method} ${v} ${E.ok?"succeeded":"failed"} with status ${E.status} in ${D-_}ms`;if(!E.ok){const A=await this.shouldRetry(E);if(s&&A){const V=`retrying, ${s} attempts remaining`;return await G_(E.body),In(this).info(`${z} - ${V}`),In(this).debug(`[${N}] response error (${V})`,Ya({retryOfRequestLogID:o,url:E.url,status:E.status,headers:E.headers,durationMs:D-_})),this.retryRequest(m,s,o??N,E.headers)}const M=A?"error; no more retries left":"error; not retryable";In(this).info(`${z} - ${M}`);const B=await E.text().catch(V=>Qf(V).message),L=I_(B),X=L?void 0:B;throw In(this).debug(`[${N}] response error (${M})`,Ya({retryOfRequestLogID:o,url:E.url,status:E.status,headers:E.headers,message:X,durationMs:Date.now()-_})),this.makeStatusError(E.status,L,X,E.headers)}return In(this).info(z),In(this).debug(`[${N}] response start`,Ya({retryOfRequestLogID:o,url:E.url,status:E.status,headers:E.headers,durationMs:D-_})),{response:E,options:m,controller:I,requestLogID:N,retryOfRequestLogID:o,startTime:_}}async fetchWithTimeout(e,s,o,i){const c=s||{},{signal:u,method:m}=c,h=ed(c,["signal","method"]);u&&u.addEventListener("abort",()=>i.abort());const x=setTimeout(()=>i.abort(),o),v=globalThis.ReadableStream&&h.body instanceof globalThis.ReadableStream||typeof h.body=="object"&&h.body!==null&&Symbol.asyncIterator in h.body,b=Object.assign(Object.assign(Object.assign({signal:i.signal},v?{duplex:"half"}:{}),{method:"GET"}),h);m&&(b.method=m.toUpperCase());try{return await this.fetch.call(void 0,e,b)}finally{clearTimeout(x)}}async shouldRetry(e){const s=e.headers.get("x-should-retry");return s==="true"?!0:s==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,s,o,i){var c;let u;const m=i==null?void 0:i.get("retry-after-ms");if(m){const x=parseFloat(m);Number.isNaN(x)||(u=x)}const h=i==null?void 0:i.get("retry-after");if(h&&!u){const x=parseFloat(h);Number.isNaN(x)?u=Date.parse(h)-Date.now():u=x*1e3}if(!(u&&0<=u&&u<60*1e3)){const x=(c=e.maxRetries)!==null&&c!==void 0?c:this.maxRetries;u=this.calculateDefaultRetryTimeoutMillis(s,x)}return await M_(u),this.makeRequest(e,s-1,o)}calculateDefaultRetryTimeoutMillis(e,s){const c=s-e,u=Math.min(.5*Math.pow(2,c),8),m=1-Math.random()*.25;return u*m*1e3}async buildRequest(e,{retryCount:s=0}={}){var o,i,c;const u=Object.assign({},e),{method:m,path:h,query:x,defaultBaseURL:v}=u,b=this.buildURL(h,x,v);"timeout"in u&&k_("timeout",u.timeout),u.timeout=(o=u.timeout)!==null&&o!==void 0?o:this.timeout;const{bodyHeaders:N,body:T}=this.buildBody({options:u}),_=await this.buildHeaders({options:e,method:m,bodyHeaders:N,retryCount:s});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:m,headers:_},u.signal&&{signal:u.signal}),globalThis.ReadableStream&&T instanceof globalThis.ReadableStream&&{duplex:"half"}),T&&{body:T}),(i=this.fetchOptions)!==null&&i!==void 0?i:{}),(c=u.fetchOptions)!==null&&c!==void 0?c:{}),url:b,timeout:u.timeout}}async buildHeaders({options:e,method:s,bodyHeaders:o,retryCount:i}){let c={};this.idempotencyHeader&&s!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),c[this.idempotencyHeader]=e.idempotencyKey);const u=Cf([c,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(i)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),P_()),await this.authHeaders(e),this._options.defaultHeaders,o,e.headers]);return this.validateHeaders(u),u.values}buildBody({options:{body:e,headers:s}}){if(!e)return{bodyHeaders:void 0,body:void 0};const o=Cf([s]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&o.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:z_(e)}:this.encoder({body:e,headers:o})}}xd.DEFAULT_TIMEOUT=6e4;class bn extends xd{constructor(){super(...arguments),this.interactions=new fb(this)}}pb=bn;bn.GeminiNextGenAPIClient=pb;bn.GeminiNextGenAPIClientError=Rs;bn.APIError=Rn;bn.APIConnectionError=pd;bn.APIConnectionTimeoutError=Ky;bn.APIUserAbortError=Zf;bn.NotFoundError=eb;bn.ConflictError=tb;bn.RateLimitError=sb;bn.BadRequestError=Wy;bn.AuthenticationError=Qy;bn.InternalServerError=rb;bn.PermissionDeniedError=Zy;bn.UnprocessableEntityError=nb;bn.toFile=B_;bn.Interactions=fb;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rA(t,e){const s={},o=f(t,["name"]);return o!=null&&p(s,["_url","name"],o),s}function aA(t,e){const s={},o=f(t,["name"]);return o!=null&&p(s,["_url","name"],o),s}function oA(t,e){const s={},o=f(t,["sdkHttpResponse"]);return o!=null&&p(s,["sdkHttpResponse"],o),s}function iA(t,e){const s={},o=f(t,["sdkHttpResponse"]);return o!=null&&p(s,["sdkHttpResponse"],o),s}function lA(t,e,s){const o={};if(f(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=f(t,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&p(e,["displayName"],i),f(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const c=f(t,["epochCount"]);e!==void 0&&c!=null&&p(e,["tuningTask","hyperparameters","epochCount"],c);const u=f(t,["learningRateMultiplier"]);if(u!=null&&p(o,["tuningTask","hyperparameters","learningRateMultiplier"],u),f(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(f(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(f(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const m=f(t,["batchSize"]);e!==void 0&&m!=null&&p(e,["tuningTask","hyperparameters","batchSize"],m);const h=f(t,["learningRate"]);if(e!==void 0&&h!=null&&p(e,["tuningTask","hyperparameters","learningRate"],h),f(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(f(t,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return o}function cA(t,e,s){const o={};let i=f(s,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const T=f(t,["validationDataset"]);e!==void 0&&T!=null&&p(e,["supervisedTuningSpec"],Qv(T))}else if(i==="PREFERENCE_TUNING"){const T=f(t,["validationDataset"]);e!==void 0&&T!=null&&p(e,["preferenceOptimizationSpec"],Qv(T))}const c=f(t,["tunedModelDisplayName"]);e!==void 0&&c!=null&&p(e,["tunedModelDisplayName"],c);const u=f(t,["description"]);e!==void 0&&u!=null&&p(e,["description"],u);let m=f(s,["config","method"]);if(m===void 0&&(m="SUPERVISED_FINE_TUNING"),m==="SUPERVISED_FINE_TUNING"){const T=f(t,["epochCount"]);e!==void 0&&T!=null&&p(e,["supervisedTuningSpec","hyperParameters","epochCount"],T)}else if(m==="PREFERENCE_TUNING"){const T=f(t,["epochCount"]);e!==void 0&&T!=null&&p(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],T)}let h=f(s,["config","method"]);if(h===void 0&&(h="SUPERVISED_FINE_TUNING"),h==="SUPERVISED_FINE_TUNING"){const T=f(t,["learningRateMultiplier"]);e!==void 0&&T!=null&&p(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],T)}else if(h==="PREFERENCE_TUNING"){const T=f(t,["learningRateMultiplier"]);e!==void 0&&T!=null&&p(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],T)}let x=f(s,["config","method"]);if(x===void 0&&(x="SUPERVISED_FINE_TUNING"),x==="SUPERVISED_FINE_TUNING"){const T=f(t,["exportLastCheckpointOnly"]);e!==void 0&&T!=null&&p(e,["supervisedTuningSpec","exportLastCheckpointOnly"],T)}else if(x==="PREFERENCE_TUNING"){const T=f(t,["exportLastCheckpointOnly"]);e!==void 0&&T!=null&&p(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],T)}let v=f(s,["config","method"]);if(v===void 0&&(v="SUPERVISED_FINE_TUNING"),v==="SUPERVISED_FINE_TUNING"){const T=f(t,["adapterSize"]);e!==void 0&&T!=null&&p(e,["supervisedTuningSpec","hyperParameters","adapterSize"],T)}else if(v==="PREFERENCE_TUNING"){const T=f(t,["adapterSize"]);e!==void 0&&T!=null&&p(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],T)}if(f(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(f(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const b=f(t,["labels"]);e!==void 0&&b!=null&&p(e,["labels"],b);const N=f(t,["beta"]);return e!==void 0&&N!=null&&p(e,["preferenceOptimizationSpec","hyperParameters","beta"],N),o}function dA(t,e){const s={},o=f(t,["baseModel"]);o!=null&&p(s,["baseModel"],o);const i=f(t,["preTunedModel"]);i!=null&&p(s,["preTunedModel"],i);const c=f(t,["trainingDataset"]);c!=null&&NA(c);const u=f(t,["config"]);return u!=null&&lA(u,s),s}function uA(t,e){const s={},o=f(t,["baseModel"]);o!=null&&p(s,["baseModel"],o);const i=f(t,["preTunedModel"]);i!=null&&p(s,["preTunedModel"],i);const c=f(t,["trainingDataset"]);c!=null&&wA(c,s,e);const u=f(t,["config"]);return u!=null&&cA(u,s,e),s}function fA(t,e){const s={},o=f(t,["name"]);return o!=null&&p(s,["_url","name"],o),s}function mA(t,e){const s={},o=f(t,["name"]);return o!=null&&p(s,["_url","name"],o),s}function pA(t,e,s){const o={},i=f(t,["pageSize"]);e!==void 0&&i!=null&&p(e,["_query","pageSize"],i);const c=f(t,["pageToken"]);e!==void 0&&c!=null&&p(e,["_query","pageToken"],c);const u=f(t,["filter"]);return e!==void 0&&u!=null&&p(e,["_query","filter"],u),o}function hA(t,e,s){const o={},i=f(t,["pageSize"]);e!==void 0&&i!=null&&p(e,["_query","pageSize"],i);const c=f(t,["pageToken"]);e!==void 0&&c!=null&&p(e,["_query","pageToken"],c);const u=f(t,["filter"]);return e!==void 0&&u!=null&&p(e,["_query","filter"],u),o}function xA(t,e){const s={},o=f(t,["config"]);return o!=null&&pA(o,s),s}function gA(t,e){const s={},o=f(t,["config"]);return o!=null&&hA(o,s),s}function vA(t,e){const s={},o=f(t,["sdkHttpResponse"]);o!=null&&p(s,["sdkHttpResponse"],o);const i=f(t,["nextPageToken"]);i!=null&&p(s,["nextPageToken"],i);const c=f(t,["tunedModels"]);if(c!=null){let u=c;Array.isArray(u)&&(u=u.map(m=>hb(m))),p(s,["tuningJobs"],u)}return s}function yA(t,e){const s={},o=f(t,["sdkHttpResponse"]);o!=null&&p(s,["sdkHttpResponse"],o);const i=f(t,["nextPageToken"]);i!=null&&p(s,["nextPageToken"],i);const c=f(t,["tuningJobs"]);if(c!=null){let u=c;Array.isArray(u)&&(u=u.map(m=>nm(m))),p(s,["tuningJobs"],u)}return s}function bA(t,e){const s={},o=f(t,["name"]);o!=null&&p(s,["model"],o);const i=f(t,["name"]);return i!=null&&p(s,["endpoint"],i),s}function NA(t,e){const s={};if(f(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(f(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const o=f(t,["examples"]);if(o!=null){let i=o;Array.isArray(i)&&(i=i.map(c=>c)),p(s,["examples","examples"],i)}return s}function wA(t,e,s){const o={};let i=f(s,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const u=f(t,["gcsUri"]);e!==void 0&&u!=null&&p(e,["supervisedTuningSpec","trainingDatasetUri"],u)}else if(i==="PREFERENCE_TUNING"){const u=f(t,["gcsUri"]);e!==void 0&&u!=null&&p(e,["preferenceOptimizationSpec","trainingDatasetUri"],u)}let c=f(s,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const u=f(t,["vertexDatasetResource"]);e!==void 0&&u!=null&&p(e,["supervisedTuningSpec","trainingDatasetUri"],u)}else if(c==="PREFERENCE_TUNING"){const u=f(t,["vertexDatasetResource"]);e!==void 0&&u!=null&&p(e,["preferenceOptimizationSpec","trainingDatasetUri"],u)}if(f(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return o}function hb(t,e){const s={},o=f(t,["sdkHttpResponse"]);o!=null&&p(s,["sdkHttpResponse"],o);const i=f(t,["name"]);i!=null&&p(s,["name"],i);const c=f(t,["state"]);c!=null&&p(s,["state"],Ay(c));const u=f(t,["createTime"]);u!=null&&p(s,["createTime"],u);const m=f(t,["tuningTask","startTime"]);m!=null&&p(s,["startTime"],m);const h=f(t,["tuningTask","completeTime"]);h!=null&&p(s,["endTime"],h);const x=f(t,["updateTime"]);x!=null&&p(s,["updateTime"],x);const v=f(t,["description"]);v!=null&&p(s,["description"],v);const b=f(t,["baseModel"]);b!=null&&p(s,["baseModel"],b);const N=f(t,["_self"]);return N!=null&&p(s,["tunedModel"],bA(N)),s}function nm(t,e){const s={},o=f(t,["sdkHttpResponse"]);o!=null&&p(s,["sdkHttpResponse"],o);const i=f(t,["name"]);i!=null&&p(s,["name"],i);const c=f(t,["state"]);c!=null&&p(s,["state"],Ay(c));const u=f(t,["createTime"]);u!=null&&p(s,["createTime"],u);const m=f(t,["startTime"]);m!=null&&p(s,["startTime"],m);const h=f(t,["endTime"]);h!=null&&p(s,["endTime"],h);const x=f(t,["updateTime"]);x!=null&&p(s,["updateTime"],x);const v=f(t,["error"]);v!=null&&p(s,["error"],v);const b=f(t,["description"]);b!=null&&p(s,["description"],b);const N=f(t,["baseModel"]);N!=null&&p(s,["baseModel"],N);const T=f(t,["tunedModel"]);T!=null&&p(s,["tunedModel"],T);const _=f(t,["preTunedModel"]);_!=null&&p(s,["preTunedModel"],_);const I=f(t,["supervisedTuningSpec"]);I!=null&&p(s,["supervisedTuningSpec"],I);const E=f(t,["preferenceOptimizationSpec"]);E!=null&&p(s,["preferenceOptimizationSpec"],E);const D=f(t,["tuningDataStats"]);D!=null&&p(s,["tuningDataStats"],D);const z=f(t,["encryptionSpec"]);z!=null&&p(s,["encryptionSpec"],z);const A=f(t,["partnerModelTuningSpec"]);A!=null&&p(s,["partnerModelTuningSpec"],A);const M=f(t,["customBaseModel"]);M!=null&&p(s,["customBaseModel"],M);const B=f(t,["experiment"]);B!=null&&p(s,["experiment"],B);const L=f(t,["labels"]);L!=null&&p(s,["labels"],L);const X=f(t,["outputUri"]);X!=null&&p(s,["outputUri"],X);const de=f(t,["pipelineJob"]);de!=null&&p(s,["pipelineJob"],de);const V=f(t,["serviceAccount"]);V!=null&&p(s,["serviceAccount"],V);const Z=f(t,["tunedModelDisplayName"]);Z!=null&&p(s,["tunedModelDisplayName"],Z);const K=f(t,["veoTuningSpec"]);return K!=null&&p(s,["veoTuningSpec"],K),s}function SA(t,e){const s={},o=f(t,["sdkHttpResponse"]);o!=null&&p(s,["sdkHttpResponse"],o);const i=f(t,["name"]);i!=null&&p(s,["name"],i);const c=f(t,["metadata"]);c!=null&&p(s,["metadata"],c);const u=f(t,["done"]);u!=null&&p(s,["done"],u);const m=f(t,["error"]);return m!=null&&p(s,["error"],m),s}function Qv(t,e){const s={},o=f(t,["gcsUri"]);o!=null&&p(s,["validationDatasetUri"],o);const i=f(t,["vertexDatasetResource"]);return i!=null&&p(s,["validationDatasetUri"],i),s}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class jA extends Rr{constructor(e){super(),this.apiClient=e,this.list=async(s={})=>new ao(Mr.PAGED_ITEM_TUNING_JOBS,o=>this.listInternal(o),await this.listInternal(s),s),this.get=async s=>await this.getInternal(s),this.tune=async s=>{var o;if(this.apiClient.isVertexAI())if(s.baseModel.startsWith("projects/")){const i={tunedModelName:s.baseModel};!((o=s.config)===null||o===void 0)&&o.preTunedModelCheckpointId&&(i.checkpointId=s.config.preTunedModelCheckpointId);const c=Object.assign(Object.assign({},s),{preTunedModel:i});return c.baseModel=void 0,await this.tuneInternal(c)}else{const i=Object.assign({},s);return await this.tuneInternal(i)}else{const i=Object.assign({},s),c=await this.tuneMldevInternal(i);let u="";return c.metadata!==void 0&&c.metadata.tunedModel!==void 0?u=c.metadata.tunedModel:c.name!==void 0&&c.name.includes("/operations/")&&(u=c.name.split("/operations/")[0]),{name:u,state:Vf.JOB_STATE_QUEUED}}}}async getInternal(e){var s,o,i,c;let u,m="",h={};if(this.apiClient.isVertexAI()){const x=mA(e);return m=ke("{name}",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(b=>{const N=b;return N.sdkHttpResponse={headers:v.headers},N})),u.then(v=>nm(v))}else{const x=fA(e);return m=ke("{name}",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(b=>{const N=b;return N.sdkHttpResponse={headers:v.headers},N})),u.then(v=>hb(v))}}async listInternal(e){var s,o,i,c;let u,m="",h={};if(this.apiClient.isVertexAI()){const x=gA(e);return m=ke("tuningJobs",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(b=>{const N=b;return N.sdkHttpResponse={headers:v.headers},N})),u.then(v=>{const b=yA(v),N=new jv;return Object.assign(N,b),N})}else{const x=xA(e);return m=ke("tunedModels",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(b=>{const N=b;return N.sdkHttpResponse={headers:v.headers},N})),u.then(v=>{const b=vA(v),N=new jv;return Object.assign(N,b),N})}}async cancel(e){var s,o,i,c;let u,m="",h={};if(this.apiClient.isVertexAI()){const x=aA(e);return m=ke("{name}:cancel",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(v=>v.json().then(b=>{const N=b;return N.sdkHttpResponse={headers:v.headers},N})),u.then(v=>{const b=iA(v),N=new Tv;return Object.assign(N,b),N})}else{const x=rA(e);return m=ke("{name}:cancel",x._url),h=x._query,delete x._url,delete x._query,u=this.apiClient.request({path:m,queryParams:h,body:JSON.stringify(x),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(c=e.config)===null||c===void 0?void 0:c.abortSignal}).then(v=>v.json().then(b=>{const N=b;return N.sdkHttpResponse={headers:v.headers},N})),u.then(v=>{const b=oA(v),N=new Tv;return Object.assign(N,b),N})}}async tuneInternal(e){var s,o;let i,c="",u={};if(this.apiClient.isVertexAI()){const m=uA(e,e);return c=ke("tuningJobs",m._url),u=m._query,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:h.headers},v})),i.then(h=>nm(h))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var s,o;let i,c="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const m=dA(e);return c=ke("tunedModels",m._url),u=m._query,delete m._url,delete m._query,i=this.apiClient.request({path:c,queryParams:u,body:JSON.stringify(m),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:h.headers},v})),i.then(h=>SA(h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class TA{async download(e,s){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const CA=1024*1024*8,EA=3,_A=1e3,AA=2,nd="x-goog-upload-status";async function kA(t,e,s){var o;const i=await xb(t,e,s),c=await(i==null?void 0:i.json());if(((o=i==null?void 0:i.headers)===null||o===void 0?void 0:o[nd])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return c.file}async function IA(t,e,s){var o;const i=await xb(t,e,s),c=await(i==null?void 0:i.json());if(((o=i==null?void 0:i.headers)===null||o===void 0?void 0:o[nd])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const u=Sy(c),m=new Cm;return Object.assign(m,u),m}async function xb(t,e,s){var o,i;let c=0,u=0,m=new Bf(new Response),h="upload";for(c=t.size;u<c;){const x=Math.min(CA,c-u),v=t.slice(u,u+x);u+x>=c&&(h+=", finalize");let b=0,N=_A;for(;b<EA&&(m=await s.request({path:"",body:v,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":h,"X-Goog-Upload-Offset":String(u),"Content-Length":String(x)}}}),!(!((o=m==null?void 0:m.headers)===null||o===void 0)&&o[nd]));)b++,await RA(N),N=N*AA;if(u+=x,((i=m==null?void 0:m.headers)===null||i===void 0?void 0:i[nd])!=="active")break;if(c<=u)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return m}async function MA(t){return{size:t.size,type:t.type}}function RA(t){return new Promise(e=>setTimeout(e,t))}class DA{async upload(e,s,o){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await kA(e,s,o)}async uploadToFileSearchStore(e,s,o){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await IA(e,s,o)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await MA(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class UA{create(e,s,o){return new PA(e,s,o)}}class PA{constructor(e,s,o){this.url=e,this.headers=s,this.callbacks=o}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Zv="x-goog-api-key";class LA{constructor(e){this.apiKey=e}async addAuthHeaders(e,s){if(e.get(Zv)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(Zv,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const zA="gl-node/";class gb{get interactions(){if(this._interactions!==void 0)return this._interactions;if(console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions."),this.vertexai)throw new Error("This version of the GenAI SDK does not support Vertex AI API for interactions.");const e=this.httpOptions;e!=null&&e.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const s=new bn({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e==null?void 0:e.timeout});return this._interactions=s.interactions,this._interactions}constructor(e){var s;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(s=e.vertexai)!==null&&s!==void 0?s:!1,this.apiKey=e.apiKey;const o=RS(e.httpOptions,e.vertexai,void 0,void 0);o&&(e.httpOptions?e.httpOptions.baseUrl=o:e.httpOptions={baseUrl:o}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const i=new LA(this.apiKey);this.apiClient=new M1({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:zA+"web",uploader:new DA,downloader:new TA}),this.models=new W1(this.apiClient),this.live=new B1(this.apiClient,i,new UA),this.batches=new lT(this.apiClient),this.chats=new FT(this.models,this.apiClient),this.caches=new HT(this.apiClient),this.files=new ZT(this.apiClient),this.operations=new Q1(this.apiClient),this.authTokens=new p_(this.apiClient),this.tunings=new jA(this.apiClient),this.fileSearchStores=new w_(this.apiClient)}}const GA=t=>{const e=t.trim().toLowerCase(),o=["what","when","where","who","why","how","which","can","is","are","do","does","should","will","would"].some(u=>e.startsWith(u+" ")),i=e.includes("?"),c=e.split(/\s+/).length;return(o||i)&&c>=3},HA=async(t,e)=>{var i,c;if(!t||t.trim().length<2)return[];const s=t.toLowerCase().trim(),o=[];try{const[u,m]=await Promise.all([bl(e),vm(e)]);for(const h of u){const x=h.title.toLowerCase().includes(s),v=(i=h.description)==null?void 0:i.toLowerCase().includes(s);(x||v)&&o.push({type:"project",id:h.id,title:h.title,description:h.description,relevance:x?2:1})}for(const h of m){const x=h.title.toLowerCase().includes(s),v=(c=h.description)==null?void 0:c.toLowerCase().includes(s);if(x||v){const b=u.find(N=>N.id===h.projectId);o.push({type:"task",id:h.id,title:h.title,description:h.description,projectId:h.projectId,projectTitle:b==null?void 0:b.title,relevance:x?2:1})}}return o.sort((h,x)=>(x.relevance||0)-(h.relevance||0)),o.slice(0,10)}catch(u){return console.error("Search error:",u),[]}},OA=(t,e)=>{let s=`Current Projects:
`;for(const o of t){s+=`- ${o.title} (Status: ${o.status}, Priority: ${o.priority||"Medium"}`,o.dueDate&&(s+=`, Due: ${o.dueDate}`),s+=`)
`,o.description&&(s+=`  Description: ${o.description}
`);const i=e.filter(c=>c.projectId===o.id);i.length>0&&(s+=`  Tasks (${i.length}):
`,i.slice(0,5).forEach(c=>{s+=`    - ${c.title} (${c.status||"Open"}, Priority: ${c.priority||"Medium"}`,c.isCompleted&&(s+=", Completed"),s+=`)
`}),i.length>5&&(s+=`    ... and ${i.length-5} more tasks
`))}return s},qA=async(t,e)=>{var i;const s=xe.currentUser;if(!s)throw new Error("User not authenticated");const o=await vl(s.uid);if(o&&o.tokensUsed>=o.tokenLimit)throw new Error(`AI token limit reached (${o.tokensUsed.toLocaleString()} / ${o.tokenLimit.toLocaleString()}). Limit resets monthly.`);try{const[c,u]=await Promise.all([bl(e),vm(e)]),m=OA(c,u),h=typeof import.meta<"u"&&"AIzaSyBEjImj8VDlfi4WK5R9iQkj0J4Nqzi-AA8"||"AIzaSyBEjImj8VDlfi4WK5R9iQkj0J4Nqzi-AA8",x=new gb({apiKey:h}),v={type:Ve.OBJECT,properties:{answer:{type:Ve.STRING},relevantProjects:{type:Ve.ARRAY,items:{type:Ve.STRING}},relevantTasks:{type:Ve.ARRAY,items:{type:Ve.STRING}},confidence:{type:Ve.STRING,enum:["Low","Medium","High"]}},required:["answer","relevantProjects","relevantTasks","confidence"]},b=`You are a project management assistant. Answer the following question based on the project context provided.
        
Context:
${m}

Question: ${t}

Provide a helpful, concise answer (2-3 sentences max). Include IDs of relevant projects and tasks in your response.
If you reference specific projects or tasks, use their exact titles.
Rate your confidence in the answer as Low, Medium, or High.`,N=await x.models.generateContent({model:"gemini-2.0-flash-exp",contents:b,config:{responseMimeType:"application/json",responseSchema:v,temperature:.4}}),T=((i=N.usageMetadata)==null?void 0:i.totalTokenCount)||0;T>0&&await mm(s.uid,T);const _=JSON.parse(N.text||"{}"),I=c.filter(D=>_.answer.toLowerCase().includes(D.title.toLowerCase())).map(D=>D.id).slice(0,3),E=u.filter(D=>_.answer.toLowerCase().includes(D.title.toLowerCase())).map(D=>D.id).slice(0,3);return{answer:_.answer||"I couldn't find relevant information to answer your question.",relevantProjects:I.length>0?I:_.relevantProjects||[],relevantTasks:E.length>0?E:_.relevantTasks||[],confidence:_.confidence||"Low"}}catch(c){throw console.error("AI Search Error:",c),c}},FA=()=>{const[t,e]=w.useState(""),[s,o]=w.useState(!1),[i,c]=w.useState(!1),[u,m]=w.useState([]),[h,x]=w.useState(null),[v,b]=w.useState(!1),[N,T]=w.useState(!1),[_,I]=w.useState(null),[E,D]=w.useState(-1),z=dn(),A=w.useRef(null),M=w.useRef(null),B=w.useRef(null);w.useEffect(()=>{const F=le=>{var he;(le.metaKey||le.ctrlKey)&&le.key==="k"&&(le.preventDefault(),(he=M.current)==null||he.focus())};return document.addEventListener("keydown",F),()=>document.removeEventListener("keydown",F)},[]),w.useEffect(()=>{const F=le=>{A.current&&!A.current.contains(le.target)&&(o(!1),c(!1))};return document.addEventListener("mousedown",F),()=>document.removeEventListener("mousedown",F)},[]),w.useEffect(()=>{if(B.current&&clearTimeout(B.current),!t.trim()){m([]),x(null),I(null),o(!1);return}return b(!0),B.current=setTimeout(async()=>{try{const F=await HA(t);m(F),o(!0),D(-1)}catch(F){console.error("Search error:",F)}finally{b(!1)}},200),()=>{B.current&&clearTimeout(B.current)}},[t]);const L=async()=>{if(t.trim()){T(!0),I(null),x(null),o(!0);try{const F=await qA(t);x(F.answer)}catch(F){console.error("AI Search error:",F),I(F.message||"AI Search failed")}finally{T(!1)}}},X=F=>{var he,re;if(!t.trim()&&F.key==="Escape"){o(!1),(he=M.current)==null||he.blur();return}if(F.key==="Enter"){if(F.preventDefault(),E>=0&&E<u.length){de(u[E]);return}L();return}if(!s){t.trim()&&(F.key==="ArrowDown"||F.key==="ArrowUp")&&o(!0);return}const le=u.length;F.key==="ArrowDown"?(F.preventDefault(),le>0&&D(q=>{const H=q+1;return H>=le?0:H})):F.key==="ArrowUp"?(F.preventDefault(),le>0&&D(q=>{const H=q-1;return H<0?le-1:H})):F.key==="Escape"&&(o(!1),(re=M.current)==null||re.blur())},de=F=>{var le;F&&(F.type==="project"?z(`/project/${F.id}`):F.type==="task"&&z(`/project/${F.projectId}/tasks/${F.id}`),e(""),o(!1),(le=M.current)==null||le.blur())},V=u.filter(F=>F.type==="project"),Z=u.filter(F=>F.type==="task"),K=GA(t);return r.jsxs("div",{ref:A,className:"relative z-50 h-[42px] w-full sm:w-64",children:[r.jsxs("div",{onClick:()=>{var F;return(F=M.current)==null?void 0:F.focus()},className:`
                    absolute top-0 right-0
                    group flex items-center gap-3 rounded-full px-4 py-2.5 
                    transition-all duration-300 ease-out
                    bg-[var(--color-surface-bg)] 
                    border border-[var(--color-surface-border)]
                    ${i||s?"w-full sm:w-96 ring-2 ring-indigo-500/20 border-indigo-500/50 shadow-lg shadow-indigo-500/10":"w-full sm:w-64"}
                `,children:[r.jsx("span",{className:`
                    material-symbols-outlined text-[20px] transition-colors duration-300
                    ${i||s?"text-indigo-500":"text-[var(--color-text-subtle)] group-hover:text-[var(--color-text-muted)]"}
                `,children:"search"}),r.jsx("input",{ref:M,className:"flex-1 bg-transparent border-none outline-none ring-0 focus:ring-0 focus:outline-none focus:border-none p-0 text-sm text-[var(--color-text-main)] placeholder-[var(--color-text-subtle)]",placeholder:"Search or ask AI...",value:t,onChange:F=>e(F.target.value),onKeyDown:X,onFocus:()=>{c(!0),t.trim()&&o(!0)},onBlur:()=>c(!1)}),r.jsx("div",{className:"flex items-center gap-2",children:t?r.jsx("button",{onClick:F=>{var le;F.stopPropagation(),e(""),m([]),x(null),(le=M.current)==null||le.focus()},className:"p-0.5 rounded-full hover:bg-[var(--color-surface-hover)] text-[var(--color-text-muted)] transition-colors",children:r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"close"})}):r.jsxs("div",{className:`
                            hidden sm:flex items-center gap-0.5 px-1.5 py-0.5 rounded border border-[var(--color-surface-border)] bg-[var(--color-surface-bg-offset)]
                            text-[10px] font-medium text-[var(--color-text-subtle)] transition-opacity duration-200
                            ${i?"opacity-0":"opacity-100"}
                        `,children:[r.jsx("span",{className:"text-xs",children:""}),r.jsx("span",{children:"K"})]})})]}),s&&r.jsxs("div",{className:"absolute top-12 mt-1 right-0 w-full sm:w-[500px] max-h-[70vh] overflow-y-auto rounded-2xl shadow-2xl ring-1 ring-black/5 dark:ring-white/10 bg-[var(--color-surface-card)] animate-in fade-in slide-in-from-top-2 duration-200",children:[t.trim()&&!h&&!N&&r.jsx("div",{onClick:L,className:`
                                mx-2 mt-2 px-3 py-3 rounded-xl cursor-pointer group transition-colors
                                ${E===-1?"bg-indigo-50 dark:bg-indigo-500/10":"hover:bg-[var(--color-surface-hover)]"}
                            `,children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:`
                                    p-2 rounded-lg bg-white dark:bg-indigo-500/20 shadow-sm transition-transform group-hover:scale-110
                                    ${K?"text-indigo-600 dark:text-indigo-400":"text-[var(--color-text-muted)]"}
                                `,children:r.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"auto_awesome"})}),r.jsxs("div",{className:"flex-1",children:[r.jsxs("p",{className:"text-sm font-medium text-[var(--color-text-main)]",children:["Ask AI: ",r.jsxs("span",{className:"text-[var(--color-text-muted)] font-normal",children:['"',t,'"']})]}),r.jsxs("p",{className:"text-xs text-[var(--color-text-subtle)] mt-0.5",children:["Press ",r.jsx("kbd",{className:"font-sans font-semibold text-[var(--color-text-main)]",children:"Enter"})," to generate answer"]})]}),r.jsx("span",{className:"material-symbols-outlined text-[var(--color-text-subtle)] group-hover:text-indigo-500 transition-colors",children:"arrow_forward"})]})}),N&&r.jsxs("div",{className:"p-6 text-center border-b border-[var(--color-surface-border)]",children:[r.jsxs("div",{className:"inline-flex items-center gap-2 mb-2",children:[r.jsx("span",{className:"material-symbols-outlined text-xl animate-spin text-indigo-500",children:"spark mode"}),r.jsx("span",{className:"text-sm font-medium text-indigo-600 dark:text-indigo-400",children:"Thinking..."})]}),r.jsx("p",{className:"text-xs text-[var(--color-text-subtle)]",children:"Analyzing project data to answer your question"})]}),_&&r.jsx("div",{className:"p-4 mx-2 mt-2 bg-red-50 dark:bg-red-900/20 border border-red-100 dark:border-red-800 rounded-xl",children:r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("span",{className:"material-symbols-outlined text-red-500 text-[20px]",children:"error"}),r.jsxs("div",{className:"flex-1",children:[r.jsx("p",{className:"text-sm font-medium text-red-700 dark:text-red-400",children:"Couldn't generate answer"}),r.jsx("p",{className:"text-xs text-red-600 dark:text-red-400/80 mt-1",children:_})]})]})}),h&&r.jsxs("div",{className:"p-4 bg-indigo-50/50 dark:bg-indigo-900/10 border-b border-[var(--color-surface-border)]",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[r.jsx("span",{className:"material-symbols-outlined text-[18px] text-indigo-500",children:"auto_awesome"}),r.jsx("span",{className:"text-xs font-bold text-indigo-600 dark:text-indigo-400 uppercase tracking-wider",children:"AI Insight"})]}),r.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none",children:r.jsx("p",{className:"text-sm text-[var(--color-text-main)] leading-relaxed whitespace-pre-wrap",children:h})})]}),r.jsxs("div",{className:"py-2",children:[!v&&u.length===0&&t.trim()&&!h&&!N&&r.jsxs("div",{className:"px-4 py-8 text-center text-[var(--color-text-muted)]",children:[r.jsx("span",{className:"material-symbols-outlined text-4xl mb-2 opacity-50",children:"search_off"}),r.jsxs("p",{className:"text-sm",children:['No tasks or projects found matching "',t,'"']})]}),V.length>0&&r.jsxs("div",{className:"mb-2",children:[r.jsx("div",{className:"px-4 py-1.5",children:r.jsx("span",{className:"text-[10px] font-bold text-[var(--color-text-muted)] uppercase tracking-wider",children:"Projects"})}),V.map((F,le)=>{le===E&&u[le].type;const he=u.indexOf(F);return r.jsxs("button",{onClick:()=>de(F),onMouseEnter:()=>D(he),className:`
                                                w-full text-left px-4 py-2 flex items-center gap-3 transition-colors
                                                ${E===he?"bg-[var(--color-surface-hover)] border-l-2 border-indigo-500":"border-l-2 border-transparent"}
                                            `,children:[r.jsx("div",{className:"p-1.5 rounded-lg bg-blue-50 dark:bg-blue-500/20 text-blue-600 dark:text-blue-400 shrink-0",children:r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"folder"})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"text-sm font-medium text-[var(--color-text-main)] truncate",children:F.title}),F.description&&r.jsx("p",{className:"text-xs text-[var(--color-text-muted)] truncate",children:F.description})]})]},F.id)})]}),Z.length>0&&r.jsxs("div",{children:[r.jsx("div",{className:"px-4 py-1.5 border-t border-[var(--color-surface-border)] mt-1 pt-3",children:r.jsx("span",{className:"text-[10px] font-bold text-[var(--color-text-muted)] uppercase tracking-wider",children:"Tasks"})}),Z.map((F,le)=>{const he=u.indexOf(F);return r.jsxs("button",{onClick:()=>de(F),onMouseEnter:()=>D(he),className:`
                                                w-full text-left px-4 py-2 flex items-center gap-3 transition-colors
                                                ${E===he?"bg-[var(--color-surface-hover)] border-l-2 border-emerald-500":"border-l-2 border-transparent"}
                                            `,children:[r.jsx("div",{className:"p-1.5 rounded-lg bg-emerald-50 dark:bg-emerald-500/20 text-emerald-600 dark:text-emerald-400 shrink-0",children:r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"task_alt"})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"text-sm font-medium text-[var(--color-text-main)] truncate",children:F.title}),r.jsxs("p",{className:"text-xs text-[var(--color-text-muted)] truncate",children:["in ",r.jsx("span",{className:"text-[var(--color-text-main)]",children:F.projectTitle})]})]})]},F.id)})]})]}),r.jsx("div",{className:"px-3 py-2 bg-[var(--color-surface-bg-offset)] border-t border-[var(--color-surface-border)] flex items-center justify-between",children:r.jsxs("div",{className:"flex gap-3",children:[r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx("kbd",{className:"h-5 px-1.5 rounded bg-[var(--color-surface-card)] border border-[var(--color-surface-border)] text-[10px] text-[var(--color-text-muted)] font-sans",children:""}),r.jsx("span",{className:"text-[10px] text-[var(--color-text-muted)]",children:"Navigate"})]}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx("kbd",{className:"h-5 px-1.5 rounded bg-[var(--color-surface-card)] border border-[var(--color-surface-border)] text-[10px] text-[var(--color-text-muted)] font-sans",children:"Enter"}),r.jsx("span",{className:"text-[10px] text-[var(--color-text-muted)]",children:"Select / Ask AI"})]}),r.jsxs("div",{className:"flex items-center gap-1.5",children:[r.jsx("kbd",{className:"h-5 px-1.5 rounded bg-[var(--color-surface-card)] border border-[var(--color-surface-border)] text-[10px] text-[var(--color-text-muted)] font-sans",children:"Esc"}),r.jsx("span",{className:"text-[10px] text-[var(--color-text-muted)]",children:"Close"})]})]})})]})]})},Ne=({children:t,variant:e="primary",size:s="md",className:o="",isLoading:i,icon:c,disabled:u,...m})=>{const h="inline-flex items-center justify-center font-medium rounded-xl transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-primary/50 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer";let x="";e==="primary"?x="bg-[var(--color-primary)] text-[var(--color-primary-text)] hover:opacity-90 shadow-md transform active:scale-95":e==="secondary"?x="bg-[var(--color-surface-card)] text-[var(--color-text-main)] border border-[var(--color-surface-border)] hover:bg-[var(--color-surface-hover)]":e==="ghost"?x="bg-transparent text-[var(--color-text-muted)] hover:bg-[var(--color-surface-hover)] hover:text-[var(--color-text-main)]":e==="danger"&&(x="bg-red-50 text-red-600 border border-red-100 hover:bg-red-100");let v="";return s==="sm"&&(v="text-xs px-3 py-1.5 gap-1.5 h-8"),s==="md"&&(v="text-sm px-4 py-2 gap-2 h-10"),s==="lg"&&(v="text-base px-6 py-3 gap-3 h-12"),s==="icon"&&(v="p-2 w-10 h-10 justify-center"),r.jsxs("button",{className:`${h} ${x} ${v} ${o}`,disabled:i||u,style:{backgroundColor:e==="primary"?"var(--color-primary)":void 0,color:e==="primary"?"var(--color-primary-text)":void 0,borderColor:e==="primary"?"transparent":void 0},...m,children:[i&&r.jsx("span",{className:"material-symbols-outlined animate-spin text-lg",children:"progress_activity"}),!i&&c&&r.jsx("span",{className:"flex items-center",children:c}),!i&&t]})},gd=w.createContext(void 0),VA=({children:t})=>{const[e,s]=w.useState({show:!1,message:"",type:"info"}),[o,i]=w.useState({show:!1,title:"",message:"",resolve:null}),c=w.useCallback((x,v="info")=>{s({show:!0,message:x,type:v}),setTimeout(()=>{s(b=>({...b,show:!1}))},8e3)},[]),u=w.useCallback(()=>{s(x=>({...x,show:!1}))},[]),m=w.useCallback((x,v)=>new Promise(b=>{i({show:!0,title:x,message:v,resolve:b})}),[]),h=w.useCallback(x=>{o.resolve&&o.resolve(x),i({show:!1,title:"",message:"",resolve:null})},[o]);return r.jsx(gd.Provider,{value:{showToast:c,confirm:m,toast:e,closeToast:u,confirmation:o,closeConfirmation:h},children:t})},vd=()=>{const t=w.useContext(gd);if(!t)throw new Error("useToast must be used within a UIProvider");return{showToast:t.showToast,showError:e=>t.showToast(e,"error"),showSuccess:e=>t.showToast(e,"success"),showInfo:e=>t.showToast(e,"info")}},BA=()=>{const t=w.useContext(gd);if(!t)throw new Error("useConfirm must be used within a UIProvider");return t.confirm},vb=()=>{const t=w.useContext(gd);if(!t)throw new Error("useUIState must be used within a UIProvider");return t},$A=()=>{const[t,e]=w.useState([]),[s,o]=w.useState(!1),[i,c]=w.useState(!0),u=w.useRef(null),m=dn(),{showToast:h}=vd(),x=xe.currentUser,v=t.filter(E=>!E.read).length;w.useEffect(()=>{if(!x){c(!1);return}const E=uS(x.uid,D=>{e(D),c(!1)});return()=>E()},[x]),w.useEffect(()=>{const E=D=>{u.current&&!u.current.contains(D.target)&&o(!1)};return s&&document.addEventListener("mousedown",E),()=>{document.removeEventListener("mousedown",E)}},[s]);const b=async E=>{E.read||await fS(E.id);let D="";E.taskId&&E.projectId?D=`/project/${E.projectId}/tasks/${E.taskId}`:E.issueId&&E.projectId?D=`/project/${E.projectId}/issues/${E.issueId}`:E.projectId&&(D=`/project/${E.projectId}`),D&&(m(D),o(!1))},N=async()=>{x&&await mS(x.uid)},T=E=>{if(!E)return"";const D=E.toDate?E.toDate():new Date(E),A=new Date().getTime()-D.getTime(),M=Math.floor(A/6e4),B=Math.floor(A/36e5),L=Math.floor(A/864e5);return M<1?"Just now":M<60?`${M}m ago`:B<24?`${B}h ago`:L<7?`${L}d ago`:D.toLocaleDateString()},_=E=>{switch(E){case"task_assigned":case"subtask_assigned":return"task_alt";case"issue_assigned":return"bug_report";case"comment_added":case"comment_mention":return"comment";case"project_invite":case"project_shared":case"project_join_request":case"project_join_request_accepted":return"folder_shared";case"project_join_request_denied":return"block";default:return"notifications"}},I=async(E,D,z)=>{if(E.stopPropagation(),!(!D.projectId||!D.actorId))try{await vy(D.id,D.projectId,D.actorId,z,D.tenantId)}catch(A){console.error(A),h(`Failed to respond: ${A instanceof Error?A.message:"Unknown error"}`,"error")}};return r.jsxs("div",{className:"relative",ref:u,children:[r.jsxs("button",{onClick:()=>o(!s),className:"size-9 rounded-full hover:bg-[var(--color-surface-hover)] flex items-center justify-center text-[var(--color-text-muted)] transition-colors relative",children:[r.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"notifications"}),v>0&&r.jsx("span",{className:"absolute top-2 right-2 size-2 bg-red-500 rounded-full border-2 border-white"})]}),s&&r.jsxs("div",{className:"absolute right-0 mt-2 w-80 sm:w-96 bg-[var(--color-surface-card)] border border-[var(--color-surface-border)] rounded-xl shadow-2xl overflow-hidden z-50 animate-fade-in",children:[r.jsx("div",{className:"px-4 py-3 border-b border-[var(--color-surface-border)] bg-[var(--color-surface-bg)]",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("h3",{className:"text-sm font-semibold text-[var(--color-text)]",children:["Notifications",v>0&&r.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs bg-blue-500 text-white rounded-full",children:v})]}),v>0&&r.jsx("button",{onClick:N,className:"text-xs text-blue-500 hover:text-blue-600 transition-colors",children:"Mark all read"})]})}),r.jsx("div",{className:"max-h-[400px] overflow-y-auto",children:i?r.jsx("div",{className:"flex items-center justify-center py-8",children:r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):t.length===0?r.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[r.jsx("span",{className:"material-symbols-outlined text-[48px] text-[var(--color-text-muted)] opacity-50",children:"notifications_off"}),r.jsx("p",{className:"text-sm text-[var(--color-text-muted)] mt-2",children:"No notifications yet"})]}):r.jsx("div",{className:"divide-y divide-[var(--color-surface-border)]",children:t.slice(0,20).map(E=>r.jsx("div",{role:"button",tabIndex:0,onClick:()=>b(E),className:`w-full text-left px-4 py-3 hover:bg-[var(--color-surface-hover)] transition-colors cursor-pointer ${E.read?"":"bg-blue-50/50 dark:bg-blue-900/10"}`,children:r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ${E.read?"bg-[var(--color-surface-bg)] text-[var(--color-text-muted)]":"bg-blue-500 text-white"}`,children:r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:_(E.type)})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:`text-sm ${E.read?"text-[var(--color-text)]":"font-semibold text-[var(--color-text)]"}`,children:E.title}),r.jsx("p",{className:"text-xs text-[var(--color-text-muted)] mt-0.5 line-clamp-2",children:E.message}),E.type==="project_join_request"&&!E.read&&r.jsxs("div",{className:"flex items-center gap-2 mt-3 mb-1",children:[r.jsx(Ne,{size:"xs",variant:"primary",onClick:D=>I(D,E,!0),className:"bg-emerald-500 hover:bg-emerald-600 border-emerald-500 text-white min-w-[70px]",children:"Accept"}),r.jsx(Ne,{size:"xs",variant:"utility",onClick:D=>I(D,E,!1),className:"hover:bg-rose-50 hover:text-rose-600 dark:hover:bg-rose-900/20 border-transparent min-w-[70px]",children:"Deny"})]}),r.jsx("p",{className:"text-xs text-[var(--color-text-muted)] mt-1",children:T(E.createdAt)})]}),!E.read&&r.jsx("div",{className:"flex-shrink-0 w-2 h-2 bg-blue-500 rounded-full mt-2"})]})},E.id))})}),t.length>0&&r.jsx("div",{className:"px-4 py-2 border-t border-[var(--color-surface-border)] bg-[var(--color-surface-bg)]",children:r.jsx("button",{className:"text-xs text-blue-500 hover:text-blue-600 transition-colors w-full text-center",children:"View all notifications"})})]})]})},YA=()=>{const{id:t}=Yn(),e=ai(),s=w.useMemo(()=>{const B=e.pathname.match(/\/project\/([^/]+)/);return B?B[1]:null},[e.pathname]),o=t||s,[i,c]=w.useState(!1),[u,m]=w.useState(null),[h,x]=w.useState(0),[v,b]=w.useState(0),[N,T]=w.useState(0),[_,I]=w.useState(!1),[E,D]=w.useState([]),[z,A]=w.useState(null);xe==null||xe.currentUser,dn(),w.useEffect(()=>{c(!1),I(!1),A(null)},[e.pathname]),w.useEffect(()=>{if(!o){m(null);return}let B=!0,L,X,de,V;return $t(o).then(async Z=>{if(!B||!Z){B&&m(null);return}const K=Z.tenantId;L=bm(o,F=>{B&&m(F)},K),X=ii(o,F=>{if(B){const le=F.filter(he=>!he.isCompleted&&he.status!=="Done");x(le.length)}},K),de=Nm(o,F=>{B&&b(F.length)},K),V=wl(o,F=>{if(B){const le=F.filter(he=>he.status!=="Resolved"&&he.status!=="Closed");T(le.length)}},K)}).catch(Z=>{console.warn("Failed to load project data",Z)}),()=>{B=!1,L&&L(),X&&X(),de&&de(),V&&V()}},[o]);const M=w.useMemo(()=>{const B=e.pathname,L=[];if(B==="/"||B==="/dashboard")return[];const X=B.split("/").filter(Boolean);if(X[0]==="projects")L.push({label:"Projects",to:"/projects"});else if(X[0]==="project"&&X[1]){L.push({label:"Projects",to:"/projects"});const de=(u==null?void 0:u.title)||"Loading...";if(L.push({label:de,to:`/project/${X[1]}`}),X[2]){const V=X[2];switch(V){case"tasks":L.push({label:"Tasks",to:`/project/${X[1]}/tasks`}),X[3]&&L.push({label:z||"Task Details"});break;case"ideas":L.push({label:"Ideas",to:`/project/${X[1]}/ideas`});break;case"issues":L.push({label:"Issues",to:`/project/${X[1]}/issues`});break;case"activity":L.push({label:"Activity",to:`/project/${X[1]}/activity`});break;default:L.push({label:V.charAt(0).toUpperCase()+V.slice(1)})}}}else X[0]==="tasks"?L.push({label:"My Tasks"}):X[0]==="brainstorm"?L.push({label:"AI Studio"}):X[0]==="team"?L.push({label:"Team"}):X[0]==="calendar"?L.push({label:"Calendar"}):X[0]==="settings"?L.push({label:"Settings"}):X[0]==="create"?L.push({label:"New Project"}):X[0]==="profile"&&L.push({label:"Profile"});return L.map((de,V)=>{if(V===L.length-1){const{to:Z,...K}=de;return K}return de})},[e.pathname,u,z]);return r.jsxs("div",{className:"flex h-screen w-full bg-[var(--color-surface-bg)] overflow-hidden",children:[r.jsx("div",{className:"hidden md:flex flex-shrink-0 h-full",children:r.jsx(bg,{workspace:o?{projectId:o,projectTitle:u==null?void 0:u.title,tasksCount:h,ideasCount:v,issuesCount:N,modules:u==null?void 0:u.modules,externalResources:u==null?void 0:u.externalResources}:void 0})}),i&&r.jsxs("div",{className:"fixed inset-0 z-50 md:hidden flex",children:[r.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm transition-opacity",onClick:()=>c(!1)}),r.jsx("div",{className:"relative w-4/5 max-w-xs h-full bg-[var(--color-surface-card)] shadow-2xl animate-fade-in-left",children:r.jsx(bg,{isDrawer:!0,onClose:()=>c(!1),workspace:o?{projectId:o,projectTitle:u==null?void 0:u.title,tasksCount:h,ideasCount:v,issuesCount:N,modules:u==null?void 0:u.modules,externalResources:u==null?void 0:u.externalResources}:void 0})})]}),r.jsxs("div",{className:"flex-1 flex flex-col min-w-0 h-full relative",children:[r.jsxs("header",{className:"flex items-center justify-between px-4 py-3 border-b border-[var(--color-surface-border)] bg-[var(--color-surface-card)]/80 backdrop-blur-md sticky top-0 z-30",children:[r.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[r.jsx("button",{onClick:()=>c(!0),className:"md:hidden p-2 rounded-lg text-[var(--color-text-muted)] hover:bg-[var(--color-surface-hover)] shrink-0",children:r.jsx("span",{className:"material-symbols-outlined",children:"menu"})}),r.jsx("div",{className:"flex-1 min-w-0",children:r.jsx(_S,{items:M})})]}),r.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[r.jsx("div",{className:"hidden sm:block",children:r.jsx(FA,{})}),r.jsx($A,{})]})]}),r.jsx("main",{className:"flex-1 overflow-y-auto w-full p-4 sm:p-6 lg:p-8",children:r.jsx("div",{className:"max-w-7xl mx-auto h-full",children:r.jsx(Gw,{context:{setTaskTitle:A}})})})]})]})},st=nr.forwardRef(({label:t,error:e,icon:s,className:o="",...i},c)=>r.jsxs("div",{className:"flex flex-col gap-1.5 w-full",children:[t&&r.jsx("label",{className:"text-xs font-semibold text-[var(--color-text-muted)] uppercase tracking-wider ml-1",children:t}),r.jsxs("div",{className:"relative group",children:[s&&r.jsx("div",{className:"absolute left-3 inset-y-0 flex items-center justify-center text-[var(--color-text-subtle)] pointer-events-none group-focus-within:text-[var(--color-primary)] transition-colors",children:r.jsx("span",{className:"material-symbols-outlined text-[20px] leading-none",children:s})}),r.jsx("input",{ref:c,className:`
                            w-full 
                            bg-[var(--color-surface-bg)] 
                            border 
                            text-[var(--color-text-main)] 
                            rounded-xl 
                            py-2.5 
                            ${s?"pl-10":"pl-3"} 
                            pr-3 
                            text-sm 
                            placeholder-[var(--color-text-subtle)] 
                            transition-all 
                            focus:outline-none 
                            focus:ring-0
                            focus:ring-offset-0
                            ${e?"border-[var(--color-error)]":"border-[var(--color-surface-border)]"}
                            ${o}
                        `,...i})]}),e&&r.jsx("span",{className:"text-xs text-[var(--color-error)] ml-1",children:e})]}));st.displayName="Input";const An=nr.forwardRef(({label:t,error:e,className:s="",...o},i)=>r.jsxs("div",{className:"flex flex-col gap-1.5 w-full",children:[t&&r.jsx("label",{className:"text-xs font-semibold text-[var(--color-text-muted)] uppercase tracking-wider ml-1",children:t}),r.jsx("textarea",{ref:i,className:`
                        w-full 
                        bg-[var(--color-surface-bg)] 
                        border 
                        text-[var(--color-text-main)] 
                        rounded-xl 
                        py-2.5 
                        px-3
                        text-sm 
                        placeholder-[var(--color-text-subtle)] 
                        transition-all 
                        focus:outline-none 
                        focus:ring-0
                        focus:ring-offset-0
                        resize-y
                        min-h-[100px]
                        ${e?"border-[var(--color-error)]":"border-[var(--color-surface-border)]"}
                        ${s}
                    `,...o}),e&&r.jsx("span",{className:"text-xs text-[var(--color-error)] ml-1",children:e})]}));An.displayName="Textarea";const JA=({isOpen:t,onClose:e,projectId:s,initialDescription:o="",initialTitle:i=""})=>{const[c,u]=w.useState(i),[m,h]=w.useState(o),[x,v]=w.useState(!1);w.useEffect(()=>{t&&(u(i||""),h(o||""))},[t]);const b=async N=>{N.preventDefault(),v(!0);try{await ym(s,{title:c,description:m}),e()}catch(T){console.error(T)}finally{v(!1)}};return t?sr.createPortal(r.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-fade-in",onClick:e,children:r.jsxs("div",{className:"w-full max-w-2xl bg-[var(--color-surface-card)] rounded-xl shadow-2xl animate-scale-up border border-[var(--color-surface-border)] flex flex-col max-h-[90vh] overflow-y-auto",onClick:N=>N.stopPropagation(),children:[r.jsxs("div",{className:"p-4 border-b border-[var(--color-surface-border)] flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-bold text-[var(--color-text-main)]",children:"Report Issue"}),r.jsx("p",{className:"text-sm text-[var(--color-text-muted)] mt-1",children:"Create a new issue in the project."})]}),r.jsx(Ne,{variant:"ghost",onClick:e,size:"sm",children:"Close"})]}),r.jsxs("form",{onSubmit:b,className:"p-6",children:[r.jsxs("div",{className:"flex flex-col gap-6",children:[r.jsx(st,{label:"Title",value:c,onChange:N=>u(N.target.value),placeholder:"Issue title",required:!0,className:"text-lg font-medium"}),r.jsxs("div",{className:"flex flex-col gap-1.5",children:[r.jsx("label",{className:"text-xs font-bold uppercase tracking-wider text-[var(--color-text-muted)] ml-1",children:"Description"}),r.jsx(An,{value:m,onChange:N=>h(N.target.value),placeholder:"Describe the issue...",rows:8,className:"min-h-[200px]"})]})]}),r.jsxs("div",{className:"flex justify-end gap-2 mt-8 pt-4 border-t border-[var(--color-surface-border)]",children:[r.jsx(Ne,{type:"button",variant:"ghost",onClick:e,disabled:x,children:"Cancel"}),r.jsx(Ne,{type:"submit",isLoading:x,disabled:!c.trim(),children:"Create Issue"})]})]})]})}),document.body):null},XA=()=>{const{toast:t,closeToast:e}=vb(),[s,o]=w.useState(!1),[i,c]=w.useState(!1),[u,m]=w.useState(!1),[h,x]=w.useState("");if(w.useEffect(()=>{if(t.show)o(!0),c(!1);else{const T=setTimeout(()=>o(!1),300);return()=>clearTimeout(T)}},[t.show]),!s&&!t.show&&!u)return null;const v=t.type==="error"?"bg-red-500":t.type==="success"?"bg-green-600":"bg-blue-600",b=()=>{navigator.clipboard.writeText(t.message),c(!0),setTimeout(()=>c(!1),2e3)},N=()=>{x(t.message),m(!0)};return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:`
                 fixed bottom-8 left-1/2 transform -translate-x-1/2 z-[100]
                 flex items-center gap-3 px-4 py-3 rounded-xl shadow-2xl
                 text-white font-medium max-w-xl w-full
                 transition-all duration-300 ease-out
                 ${t.show?"translate-y-0 opacity-100 scale-100 pointer-events-auto":"translate-y-4 opacity-0 scale-95 pointer-events-none"}
                 ${v}
            `,children:[r.jsx("span",{className:"material-symbols-outlined text-[20px] shrink-0",children:t.type==="error"?"error":t.type==="success"?"check_circle":"info"}),r.jsx("div",{className:`flex-1 text-sm ${t.type==="error"?"font-mono":""} break-all`,children:t.message}),t.type==="error"&&r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:N,className:"p-1.5 hover:bg-white/20 rounded-lg transition-colors shrink-0 flex items-center justify-center",title:"Open Issue",children:r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"bug_report"})}),r.jsx("button",{onClick:b,className:"p-1.5 hover:bg-white/20 rounded-lg transition-colors shrink-0 flex items-center justify-center",title:i?"Copied!":"Copy Error",children:r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:i?"check":"content_copy"})})]}),r.jsx("button",{onClick:e,className:"p-1 bg-white/20 hover:bg-white/30 rounded-full transition-colors shrink-0",children:r.jsx("span",{className:"material-symbols-outlined text-[14px] block",children:"close"})})]}),r.jsx(JA,{isOpen:u,onClose:()=>m(!1),projectId:"ogZ8Pyz8pwEQtv8I64nu",initialTitle:"Bug Report",initialDescription:h})]})},KA=()=>{const{confirmation:t,closeConfirmation:e}=vb(),[s,o]=w.useState(!1);return w.useEffect(()=>{if(t.show)o(!0);else{const i=setTimeout(()=>o(!1),200);return()=>clearTimeout(i)}},[t.show]),!s&&!t.show?null:r.jsxs("div",{className:`
             fixed inset-0 z-[100] flex items-center justify-center p-4
             transition-opacity duration-200
             ${t.show?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}
        `,children:[r.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>e(!1)}),r.jsxs("div",{className:`
                 bg-[var(--color-surface-card)] rounded-2xl shadow-2xl 
                 max-w-sm w-full p-6 relative border border-[var(--color-surface-border)]
                 transform transition-all duration-300
                 ${t.show?"scale-100 translate-y-0":"scale-95 translate-y-4"}
            `,children:[r.jsx("h3",{className:"text-xl font-bold mb-2 text-[var(--color-text-main)]",children:t.title}),r.jsx("p",{className:"text-[var(--color-text-muted)] text-sm mb-6 leading-relaxed",children:t.message}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx(Ne,{variant:"secondary",onClick:()=>e(!1),className:"flex-1",children:"Cancel"}),r.jsx(Ne,{variant:"primary",onClick:()=>e(!0),className:"flex-1",children:"Confirm"})]})]})]})},Be=({children:t,className:e="",padding:s="md",hoverable:o=!1,...i})=>{let c="";return s==="sm"&&(c="p-3"),s==="md"&&(c="p-5"),s==="lg"&&(c="p-8"),r.jsx("div",{className:`
                bg-[var(--color-surface-card)] 
                border border-[var(--color-surface-border)] 
                rounded-[var(--radius-lg)] 
                shadow-sm 
                ${o?"hover:shadow-md transition-shadow duration-200 cursor-pointer":""} 
                ${c} 
                ${e}
            `,style:{backgroundColor:"var(--color-surface-card)",borderColor:"var(--color-surface-border)"},...i,children:t})},Tn=({children:t,variant:e="default",size:s="md",className:o=""})=>{let i="";e==="default"?i="bg-[var(--color-surface-hover)] text-[var(--color-text-muted)] border-[var(--color-surface-border)]":e==="primary"?i="bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-300 border-indigo-100 dark:border-indigo-800":e==="secondary"?i="bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 border-slate-200 dark:border-slate-700":e==="success"?i="bg-emerald-50 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-300 border-emerald-100 dark:border-emerald-800":e==="warning"?i="bg-amber-50 dark:bg-amber-900/30 text-amber-700 dark:text-amber-300 border-amber-100 dark:border-amber-800":e==="error"?i="bg-rose-50 dark:bg-rose-900/30 text-rose-600 dark:text-rose-300 border-rose-100 dark:border-rose-800":e==="outline"&&(i="bg-transparent text-[var(--color-text-subtle)] border-[var(--color-surface-border)]");const c=s==="sm"?"px-1.5 py-0 text-[10px]":"px-2.5 py-0.5 text-[11px]";return r.jsx("span",{className:`
                inline-flex items-center 
                ${c}
                rounded-full 
                font-bold uppercase tracking-wider 
                border 
                ${i} 
                ${o}
            `,children:t})},WA=({data:t,width:e=200,height:s=60,color:o="var(--color-primary)",fill:i=!1})=>{if(t.length<2)return null;const c=Math.max(...t),u=Math.min(...t),m=c-u||1,h=t.map((x,v)=>{const b=v/(t.length-1)*e,N=s-(x-u)/m*s;return`${b},${N}`}).join(" ");return r.jsxs("svg",{width:"100%",height:s,viewBox:`0 0 ${e} ${s}`,preserveAspectRatio:"none",className:"overflow-visible",children:[i&&r.jsx("path",{d:`M 0,${s} L ${h} L ${e},${s} Z`,fill:o,fillOpacity:"0.1",stroke:"none"}),r.jsx("polyline",{points:h,fill:"none",stroke:o,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",vectorEffect:"non-scaling-stroke"})]})},yb=({data:t,size:e=160,thickness:s=20})=>{const o=t.reduce((m,h)=>m+h.value,0),i=(e-s)/2,c=e/2;let u=0;return o===0?r.jsxs("div",{className:"relative flex items-center justify-center",style:{width:e,height:e},children:[r.jsx("div",{className:"w-full h-full rounded-full border-[10px] border-[var(--color-surface-border)] opacity-30"}),r.jsx("span",{className:"absolute text-xs text-[var(--color-text-muted)]",children:"No data"})]}):r.jsx("svg",{wwidth:e,height:e,viewBox:`0 0 ${e} ${e}`,className:"transform -rotate-90",children:t.map((m,h)=>{const x=m.value/o*360,v=2*Math.PI*i,b=`${x/360*v} ${v}`,N=-(u/360*v),T=r.jsx("circle",{cx:c,cy:c,r:i,fill:"transparent",stroke:m.color,strokeWidth:s,strokeDasharray:b,strokeDashoffset:N,className:"transition-all duration-500 ease-out"},h);return u+=x,T})})},dl=t=>{if(!t)return null;if(t instanceof Date)return t;if(typeof t=="number"||typeof t=="string"){const e=new Date(t);return Number.isNaN(e.getTime())?null:e}if(typeof t.toDate=="function"){const e=t.toDate();return e instanceof Date?e:null}return null},QA=t=>{const e=dl(t);return e?e.toLocaleDateString(void 0,{month:"short",day:"numeric"}):""},ZA=({projectId:t})=>{const[e,s]=w.useState([]);return w.useEffect(()=>{(async()=>{try{const i=await yl(t);s(i)}catch(i){console.error("Failed to fetch project members",i)}})()},[t]),e.length===0?null:r.jsxs("div",{className:"flex items-center -space-x-2",children:[e.slice(0,3).map((o,i)=>r.jsx("div",{className:"size-7 rounded-full border-2 border-[var(--color-surface-paper)] overflow-hidden bg-[var(--color-surface-hover)] shadow-sm",title:o.displayName||"Member",children:o.photoURL?r.jsx("img",{src:o.photoURL,alt:"",className:"w-full h-full object-cover"}):r.jsx("div",{className:"w-full h-full flex items-center justify-center text-[10px] font-bold text-[var(--color-text-muted)]",children:(o.displayName||o.email||"?").charAt(0).toUpperCase()})},o.id)),e.length>3&&r.jsxs("div",{className:"size-7 rounded-full border-2 border-[var(--color-surface-paper)] bg-[var(--color-surface-hover)] flex items-center justify-center text-[10px] font-bold text-[var(--color-text-muted)] shadow-sm",children:["+",e.length-3]})]})},ek=()=>{const[t,e]=w.useState("there"),[s,o]=w.useState("Hello"),[i,c]=w.useState({activeProjects:0,completedProjects:0,openTasks:0,ideas:0}),[u,m]=w.useState([]),[h,x]=w.useState([]),[v,b]=w.useState([]),[N,T]=w.useState([]),[_,I]=w.useState([]),[E,D]=w.useState([]),[z,A]=w.useState(()=>{const k=localStorage.getItem("dashboard_calendar_view");return k==="week"||k==="month"?k:"month"}),[M,B]=w.useState(new Date),[L,X]=w.useState(!0),[de,V]=w.useState(null),Z=w.useRef(null),[K,F]=w.useState(""),[le,he]=w.useState(!1),re=k=>{k=new Date(Date.UTC(k.getFullYear(),k.getMonth(),k.getDate())),k.setUTCDate(k.getUTCDate()+4-(k.getUTCDay()||7));const Q=new Date(Date.UTC(k.getUTCFullYear(),0,1));return Math.ceil(((k.getTime()-Q.getTime())/864e5+1)/7)},q=(k,Q=7)=>{const ne=Array.from({length:Q},(Ce,Te)=>({label:Te,value:0})),se=Date.now(),Se=1440*60*1e3;return k.forEach(Ce=>{const Te=Le(Ce.createdAt)||se,Ge=Math.floor((se-Te)/Se);Ge>=0&&Ge<Q&&(ne[Q-Ge-1].value+=1)}),ne};w.useEffect(()=>{(async()=>{var Q,ne,se,Se,Ce;try{try{const Te=await gm(),Ge=await xm().catch(Mt=>(console.error("Shared projects load failed (likely missing index)",Mt),[])),et=[...Te];Ge.forEach(Mt=>{et.find(Ln=>Ln.id===Mt.id)||et.push(Mt)});const tt=await si(),gt=await Xc(),bt=await wm();m(et),b(tt),T(gt),I(bt);const gn=await z0((Q=xe.currentUser)==null?void 0:Q.uid,6);if(D(gn),(ne=xe.currentUser)!=null&&ne.uid){const Mt=await Mn(xe.currentUser.uid);if((Se=(se=Mt==null?void 0:Mt.preferences)==null?void 0:se.dashboard)!=null&&Se.calendarView){const Ln=Mt.preferences.dashboard.calendarView;A(Ln),localStorage.setItem("dashboard_calendar_view",Ln)}}c({activeProjects:et.filter(Mt=>Mt.status==="Active").length,completedProjects:et.filter(Mt=>Mt.status==="Completed").length,openTasks:tt.filter(Mt=>!Mt.isCompleted).length,ideas:gt.length});const sn=[...et].filter(Mt=>Mt.status!=="On Hold"&&Mt.status!=="Planning").sort((Mt,Ln)=>Le(Ln.createdAt)-Le(Mt.createdAt));x(sn.slice(0,4)),(Ce=xe.currentUser)!=null&&Ce.displayName&&e(xe.currentUser.displayName.split(" ")[0]);const fn=new Date().getHours();fn<12?o("Good morning"):fn<18?o("Good afternoon"):o("Good evening")}catch(Te){console.error("Dashboard load failed",Te)}finally{X(!1)}}catch(Te){console.error(Te),X(!1)}})()},[]);const H=w.useMemo(()=>q(v),[v]),R=w.useMemo(()=>q(N),[N]),ue=w.useMemo(()=>q(_),[_]),Y=w.useMemo(()=>u.some(k=>{var Q;return(Q=k.modules)==null?void 0:Q.includes("issues")}),[u]),ye=w.useMemo(()=>{const k=u.filter(Se=>Se.status==="Active").length,Q=u.filter(Se=>Se.status==="Completed").length,ne=u.filter(Se=>Se.status==="Planning").length,se=u.filter(Se=>Se.status==="On Hold").length;return[{name:"Active",value:k,color:"#6366f1"},{name:"Completed",value:Q,color:"#10b981"},{name:"Planning",value:ne,color:"#f59e0b"},{name:"On Hold",value:se,color:"#94a3b8"}].filter(Se=>Se.value>0)},[u]),je=w.useMemo(()=>{const k=v.filter(Se=>!Se.isCompleted&&Se.priority==="Urgent").length,Q=v.filter(Se=>!Se.isCompleted&&Se.priority==="High").length,ne=v.filter(Se=>!Se.isCompleted&&Se.priority==="Medium").length,se=v.filter(Se=>!Se.isCompleted&&Se.priority==="Low").length;return[{name:"Urgent",value:k,color:"#ef4444"},{name:"High",value:Q,color:"#f97316"},{name:"Medium",value:ne,color:"#3b82f6"},{name:"Low",value:se,color:"#94a3b8"}].filter(Se=>Se.value>0)},[v]),J=w.useMemo(()=>{const k=i.activeProjects,Q=i.completedProjects,ne=Math.max(0,u.length-k-Q),se=k+Q+ne||1;return{activePct:Math.round(k/se*100),completedPct:Math.round(Q/se*100),otherPct:Math.max(0,100-Math.round(k/se*100)-Math.round(Q/se*100))}},[i,u.length]),we=w.useMemo(()=>{const k=[];return v.slice(0,10).forEach(ne=>{var se,Se;ne.createdAt&&k.push({id:`syn-task-c-${ne.id}`,type:"task",action:"created task",target:ne.title,user:"You",userAvatar:((se=xe.currentUser)==null?void 0:se.photoURL)||"",createdAt:ne.createdAt,projectId:ne.projectId}),ne.isCompleted&&k.push({id:`syn-task-d-${ne.id}`,type:"task",action:"completed task",target:ne.title,user:"You",userAvatar:((Se=xe.currentUser)==null?void 0:Se.photoURL)||"",createdAt:ne.createdAt,projectId:ne.projectId})}),N.slice(0,10).forEach(ne=>{var se;ne.createdAt&&k.push({id:`syn-idea-${ne.id}`,type:"idea",action:"captured idea",target:ne.title,user:"You",userAvatar:((se=xe.currentUser)==null?void 0:se.photoURL)||"",createdAt:ne.createdAt,projectId:ne.projectId})}),[...E,...k].sort((ne,se)=>Le(se.createdAt)-Le(ne.createdAt)).slice(0,6)},[E,v,N]),be=w.useMemo(()=>{const k=new Map;return u.forEach(Q=>k.set(Q.id,Q.title)),k},[u]),me=w.useMemo(()=>v.filter(Q=>!Q.isCompleted).sort((Q,ne)=>{var Ce,Te;const se=((Ce=dl(Q.dueDate))==null?void 0:Ce.getTime())??Number.POSITIVE_INFINITY,Se=((Te=dl(ne.dueDate))==null?void 0:Te.getTime())??Number.POSITIVE_INFINITY;return se!==Se?se-Se:Le(ne.createdAt)-Le(Q.createdAt)}).slice(0,5),[v]),Ae=w.useMemo(()=>{const k=Date.now(),Q=4320*60*1e3;return v.filter(ne=>!ne.isCompleted).filter(ne=>{const se=dl(ne.dueDate);return se?se.getTime()<=k+Q:!1}).length},[v]),De=w.useMemo(()=>R.reduce((k,Q)=>k+Q.value,0),[R]);w.useMemo(()=>N.slice(0,3),[N]);const Ee=720,ut=240,He={top:20,right:20,bottom:30,left:40},Vt=Ee-He.left-He.right,Et=ut-He.top-He.bottom,Xe=Math.max(H.length,R.length,Y?ue.length:0),Jt=w.useMemo(()=>Math.max(...H.map(k=>k.value),...R.map(k=>k.value),Y?Math.max(...ue.map(k=>k.value)):0,1),[H,R,ue,Y]),ft=k=>{if(!k.length)return"";const Q=Jt||1,ne=Vt/(Math.max(k.length,Xe)-1||1),se=k.map((Ce,Te)=>({x:He.left+Te*ne,y:He.top+Et-Ce.value/Q*Et}));if(se.length<2)return"";let Se=`M ${se[0].x} ${se[0].y}`;for(let Ce=0;Ce<se.length-1;Ce++){const Te=se[Ce],Ge=se[Ce+1],et=Te.x+(Ge.x-Te.x)*.5,tt=Te.y,gt=Te.x+(Ge.x-Te.x)*.5,bt=Ge.y;Se+=` C ${et} ${tt}, ${gt} ${bt}, ${Ge.x} ${Ge.y}`}return Se},Pt=async()=>{var Q;const k=z==="month"?"week":"month";A(k),localStorage.setItem("dashboard_calendar_view",k),B(new Date),(Q=xe.currentUser)!=null&&Q.uid&&await ni(xe.currentUser.uid,{"preferences.dashboard.calendarView":k})},Nt=()=>{const k=new Date(M);z==="month"?k.setMonth(k.getMonth()-1):k.setDate(k.getDate()-7),B(k)},zt=()=>{const k=new Date(M);z==="month"?k.setMonth(k.getMonth()+1):k.setDate(k.getDate()+7),B(k)},_t=k=>{if(!Z.current||Xe<=1)return;const Q=Z.current.getBoundingClientRect(),ne=Q.width/Ee,se=(k.clientX-Q.left)/ne-He.left;if(se<0||se>Vt)return;const Se=Vt/(Xe-1),Ce=Math.max(0,Math.min(Xe-1,Math.round(se/Se)));V(Ce)},un=k=>{const Q=Xe-k-1;return new Date(Date.now()-Q*24*60*60*1e3).toLocaleDateString(void 0,{month:"short",day:"numeric"})},P=[{key:"active",label:"Active Projects",value:i.activeProjects,icon:"folder_open",series:H,color:"#6366f1",caption:`${u.length} total tracked`},{key:"completed",label:"Completed",value:i.completedProjects,icon:"check_circle",series:R,color:"#10b981",caption:`${J.completedPct}% completion rate`},{key:"tasks",label:"Open Tasks",value:i.openTasks,icon:"check_box",series:H,color:"#f59e0b",caption:`${Ae} due soon`},{key:"ideas",label:"Ideas Captured",value:i.ideas,icon:"lightbulb",series:R,color:"#3b82f6",caption:`${De} this week`}];return L?r.jsx("div",{className:"flex items-center justify-center p-12",children:r.jsx("span",{className:"material-symbols-outlined text-[var(--color-text-subtle)] animate-spin text-3xl",children:"rotate_right"})}):r.jsxs("div",{className:"space-y-6 pb-12 fade-in",children:[r.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-gradient-to-r from-indigo-600 to-violet-600 dark:from-indigo-900 dark:to-violet-900 p-8 text-white shadow-xl mb-6",children:[r.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row justify-between items-start md:items-center gap-6",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2 text-indigo-100 text-sm font-medium mb-2",children:[r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"calendar_today"}),new Date().toLocaleDateString(void 0,{weekday:"long",month:"long",day:"numeric"})]}),r.jsxs("h1",{className:"text-3xl md:text-4xl font-bold mb-3 tracking-tight",children:[s,", ",t]}),r.jsxs("p",{className:"text-indigo-100 text-lg max-w-xl leading-relaxed",children:["You have ",r.jsxs("strong",{className:"text-white font-semibold",children:[i.activeProjects," active projects"]})," and ",r.jsxs("strong",{className:"text-white font-semibold",children:[Ae," tasks"]})," due soon."]})]}),r.jsx("div",{className:"flex gap-3 shrink-0",children:r.jsx(nt,{to:"/create",children:r.jsx(Ne,{variant:"secondary",className:"bg-white/10 hover:bg-white/20 text-white border-0 backdrop-blur-sm shadow-lg",icon:r.jsx("span",{className:"material-symbols-outlined",children:"add"}),children:"New Project"})})})]}),r.jsx("div",{className:"absolute top-0 right-0 -mr-16 -mt-16 w-64 h-64 rounded-full bg-white/10 blur-3xl pointer-events-none"}),r.jsx("div",{className:"absolute bottom-0 left-0 -ml-16 -mb-16 w-40 h-40 rounded-full bg-black/10 blur-2xl pointer-events-none"})]}),r.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-4 gap-6",children:[r.jsxs("div",{className:"xl:col-span-3 space-y-6",children:[r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:P.map(k=>r.jsx(Be,{padding:"md",className:"relative overflow-hidden group hover:shadow-lg transition-all border-l-4",style:{borderLeftColor:k.color},children:r.jsxs("div",{className:"flex flex-col h-full justify-between",children:[r.jsxs("div",{className:"flex justify-between items-start mb-2",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-[var(--color-text-muted)] uppercase tracking-wide",children:k.label}),r.jsx("h3",{className:"text-3xl font-bold mt-1 text-[var(--color-text-main)]",children:k.value})]}),r.jsx("div",{className:"p-2 rounded-lg bg-opacity-10",style:{backgroundColor:`${k.color}20`,color:k.color},children:r.jsx("span",{className:"material-symbols-outlined",children:k.icon})})]}),r.jsxs("div",{className:"mt-4",children:[r.jsx(WA,{data:k.series.map(Q=>Q.value),width:140,height:30,color:k.color,fill:!0}),r.jsx("p",{className:"text-xs text-[var(--color-text-subtle)] mt-2 font-medium",children:k.caption})]})]})},k.key))}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[r.jsxs(Be,{className:"lg:col-span-2",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"h4",children:"Activity Trends"}),r.jsx("p",{className:"text-xs text-[var(--color-text-muted)]",children:"7-day performance"})]}),r.jsxs("div",{className:"flex items-center gap-4 text-xs font-medium",children:[r.jsxs("span",{className:"flex items-center gap-1.5",children:[r.jsx("span",{className:"size-2 rounded-full bg-amber-500"})," Tasks"]}),r.jsxs("span",{className:"flex items-center gap-1.5",children:[r.jsx("span",{className:"size-2 rounded-full bg-blue-500"})," Ideas"]}),Y&&r.jsxs("span",{className:"flex items-center gap-1.5",children:[r.jsx("span",{className:"size-2 rounded-full bg-rose-500"})," Issues"]})]})]}),r.jsx("div",{className:"w-full relative aspect-[2/1] bg-[var(--color-surface-bg)] rounded-xl border border-[var(--color-surface-border)] overflow-hidden",children:r.jsxs("svg",{ref:Z,viewBox:`0 0 ${Ee} ${ut}`,className:"w-full h-full",onMouseMove:_t,onMouseLeave:()=>V(null),preserveAspectRatio:"none",children:[r.jsxs("defs",{children:[r.jsxs("linearGradient",{id:"tasksGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[r.jsx("stop",{offset:"0%",stopColor:"#f59e0b",stopOpacity:"0.2"}),r.jsx("stop",{offset:"100%",stopColor:"#f59e0b",stopOpacity:"0"})]}),r.jsxs("linearGradient",{id:"ideasGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[r.jsx("stop",{offset:"0%",stopColor:"#3b82f6",stopOpacity:"0.2"}),r.jsx("stop",{offset:"100%",stopColor:"#3b82f6",stopOpacity:"0"})]})]}),r.jsxs("g",{children:[[0,.25,.5,.75,1].map(k=>{const Q=He.top+Et*k,ne=Math.round(Jt*(1-k));return r.jsxs("g",{children:[r.jsx("line",{x1:He.left,x2:He.left+Vt,y1:Q,y2:Q,stroke:"rgba(0,0,0,0.05)"}),r.jsx("text",{x:He.left-8,y:Q+3,textAnchor:"end",fontSize:"10",fill:"var(--color-text-subtle)",children:ne})]},k)}),Xe>1&&Array.from({length:Xe}).map((k,Q)=>{if(Xe>7&&Q%2!==0)return null;const ne=Vt/(Xe-1||1),se=He.left+Q*ne;return r.jsxs("g",{children:[r.jsx("line",{x1:se,x2:se,y1:He.top,y2:He.top+Et,stroke:"rgba(0,0,0,0.03)"}),r.jsx("text",{x:se,y:He.top+Et+20,textAnchor:"middle",fontSize:"10",fill:"#9ca3af",children:un(Q)})]},Q)})]}),r.jsx("path",{d:`${ft(H)} L${He.left+Vt},${He.top+Et} L${He.left},${He.top+Et} Z`,fill:"url(#tasksGradient)"}),r.jsx("path",{d:`${ft(R)} L${He.left+Vt},${He.top+Et} L${He.left},${He.top+Et} Z`,fill:"url(#ideasGradient)"}),r.jsx("path",{d:ft(R),stroke:"#3b82f6",strokeWidth:"3",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"}),Y&&r.jsx("path",{d:ft(ue),stroke:"#f43f5e",strokeWidth:"3",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"}),r.jsx("path",{d:ft(H),stroke:"#f59e0b",strokeWidth:"3",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"}),de!==null&&(()=>{var et,tt,gt;const k=Vt/(Xe-1||1),Q=He.left+de*k,ne=((et=H[de])==null?void 0:et.value)??0,se=((tt=R[de])==null?void 0:tt.value)??0,Se=Y?((gt=ue[de])==null?void 0:gt.value)??0:0,Ce=He.top+Et-ne/Jt*Et,Te=He.top+Et-se/Jt*Et,Ge=He.top+Et-Se/Jt*Et;return r.jsxs("g",{children:[r.jsx("line",{x1:Q,x2:Q,y1:He.top,y2:He.top+Et,stroke:"currentColor",className:"text-gray-400",strokeDasharray:"4 4"}),r.jsx("circle",{cx:Q,cy:Te,r:5,className:"fill-blue-500 stroke-white",strokeWidth:2}),Y&&r.jsx("circle",{cx:Q,cy:Ge,r:5,className:"fill-rose-500 stroke-white",strokeWidth:2}),r.jsx("circle",{cx:Q,cy:Ce,r:5,className:"fill-amber-500 stroke-white",strokeWidth:2}),r.jsx("rect",{x:Q+10,y:He.top,width:"100",height:Y?"65":"50",rx:"4",fill:"var(--color-surface-paper)",stroke:"var(--color-surface-border)"}),r.jsxs("text",{x:Q+20,y:He.top+15,fontSize:"10",fill:"var(--color-text-main)",children:["Tasks: ",ne]}),r.jsxs("text",{x:Q+20,y:He.top+30,fontSize:"10",fill:"var(--color-text-main)",children:["Ideas: ",se]}),Y&&r.jsxs("text",{x:Q+20,y:He.top+45,fontSize:"10",fill:"var(--color-text-main)",children:["Issues: ",Se]})]})})()]})})]}),r.jsxs(Be,{padding:"md",className:"flex flex-col items-center justify-center lg:col-span-1",children:[r.jsxs("div",{className:"relative flex items-center justify-center mb-6",children:[r.jsx(yb,{data:ye,size:140,thickness:12}),r.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center pointer-events-none",children:[r.jsx("span",{className:"text-2xl font-bold text-[var(--color-text-main)]",children:u.length}),r.jsx("span",{className:"text-xs text-[var(--color-text-muted)] uppercase",children:"Projects"})]})]}),r.jsxs("div",{className:"w-full space-y-2",children:[r.jsx("h3",{className:"h4 text-center mb-4",children:"Status"}),ye.map(k=>r.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg hover:bg-[var(--color-surface-hover)] transition-colors text-sm",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"size-2.5 rounded-full",style:{backgroundColor:k.color}}),r.jsx("span",{className:"font-medium text-[var(--color-text-main)]",children:k.name})]}),r.jsx("span",{className:"font-bold text-[var(--color-text-main)]",children:k.value})]},k.name)),ye.length===0&&r.jsx("p",{className:"text-sm text-[var(--color-text-muted)] text-center",children:"No active projects."})]})]}),r.jsxs("div",{className:"lg:col-span-3 grid grid-cols-1 lg:grid-cols-2 gap-4",children:[r.jsxs(Be,{padding:"md",className:"flex flex-col justify-between",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h3",{className:"h4",children:"Workload"}),r.jsxs("span",{className:"text-xs text-[var(--color-text-muted)]",children:[v.filter(k=>!k.isCompleted).length," pending"]})]}),r.jsxs("div",{className:"space-y-4",children:[je.map(k=>r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex justify-between text-xs font-semibold",children:[r.jsx("span",{style:{color:k.color},children:k.name}),r.jsx("span",{className:"text-[var(--color-text-subtle)]",children:k.value})]}),r.jsx("div",{className:"h-2 w-full bg-[var(--color-surface-bg)] rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full rounded-full transition-all duration-700 ease-out",style:{width:`${k.value/(v.filter(Q=>!Q.isCompleted).length||1)*100}%`,backgroundColor:k.color}})})]},k.name)),je.length===0&&r.jsx("p",{className:"text-sm text-[var(--color-text-muted)] text-center py-4",children:"No pending tasks."})]}),r.jsx("div",{className:"mt-4 pt-4 border-t border-[var(--color-surface-border)] flex justify-end",children:r.jsxs(nt,{to:"/tasks",className:"text-sm font-bold text-[var(--color-primary)] hover:text-indigo-700 transition-colors flex items-center gap-1 group",children:["Manage Tasks ",r.jsx("span",{className:"material-symbols-outlined text-[16px] group-hover:translate-x-1 transition-transform",children:"arrow_forward"})]})})]}),r.jsxs(Be,{padding:"md",className:"flex flex-col",children:[r.jsx("h3",{className:"h4 mb-4",children:"Upcoming Deadlines"}),r.jsxs("div",{className:"flex-1 space-y-0 divide-y divide-[var(--color-surface-border)] -mx-2 px-2",children:[me.slice(0,4).map(k=>{const Q=k.priority==="Urgent"?"text-red-500":k.priority==="High"?"text-orange-500":"text-blue-500",ne=dl(k.dueDate),se=ne&&ne.getTime()<Date.now();return r.jsx(nt,{to:`/project/${k.projectId}/tasks/${k.id}`,className:"block py-3 first:pt-2 last:pb-2 hover:bg-[var(--color-surface-hover)] -mx-2 px-4 rounded-lg transition-colors group",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"min-w-0 flex-1 pr-3",children:[r.jsx("p",{className:"text-sm font-medium text-[var(--color-text-main)] truncate group-hover:text-[var(--color-primary)] transition-colors",children:k.title}),r.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[r.jsx("span",{className:`text-[10px] font-bold uppercase tracking-wider ${Q}`,children:k.priority}),ne&&r.jsx("span",{className:`text-[10px] ${se?"text-red-500 font-bold":"text-[var(--color-text-muted)]"}`,children:ne.toLocaleDateString(void 0,{month:"short",day:"numeric"})})]})]}),r.jsx("span",{className:"material-symbols-outlined text-[18px] text-[var(--color-text-subtle)] opacity-0 group-hover:opacity-100 transition-opacity -translate-x-2 group-hover:translate-x-0",children:"chevron_right"})]})},k.id)}),me.length===0&&r.jsx("div",{className:"py-8 text-center text-sm text-[var(--color-text-muted)]",children:"No upcoming tasks."})]})]})]}),r.jsxs("div",{className:"lg:col-span-3",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"p-2 bg-indigo-100 dark:bg-indigo-900/30 rounded-lg text-indigo-600 dark:text-indigo-400",children:r.jsx("span",{className:"material-symbols-outlined",children:"folder_open"})}),r.jsx("h3",{className:"h3",children:"Active Projects"})]}),r.jsxs(nt,{to:"/projects",className:"text-sm font-bold text-[var(--color-primary)] hover:text-indigo-700 transition-colors flex items-center gap-1 group",children:["View All ",r.jsx("span",{className:"material-symbols-outlined text-[18px] group-hover:translate-x-1 transition-transform",children:"arrow_forward"})]})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.length===0?r.jsxs("div",{className:"col-span-3 p-12 text-center text-[var(--color-text-subtle)] border-2 border-dashed border-[var(--color-surface-border)] rounded-2xl bg-[var(--color-surface-bg)]/50",children:[r.jsx("div",{className:"mb-4 inline-flex p-4 rounded-full bg-[var(--color-surface-hover)]",children:r.jsx("span",{className:"material-symbols-outlined text-4xl opacity-50",children:"post_add"})}),r.jsx("p",{className:"text-lg font-medium",children:"No projects yet"}),r.jsx("p",{className:"text-sm mt-1",children:"Create your first project to get started."})]}):h.slice(0,3).map(k=>{const Q=v.filter(gt=>gt.projectId===k.id),ne=Q.filter(gt=>gt.isCompleted).length,se=Q.length,Se=se>0?Math.round(ne/se*100):k.progress||0,Ce=k.status==="Brainstorming"||k.status==="Planning",Te=k.status==="Completed";let Ge="folder",et="text-indigo-600 dark:text-indigo-400 bg-indigo-50 dark:bg-indigo-500/10 border-indigo-100 dark:border-indigo-500/20",tt="bg-indigo-500";return Ce?(Ge="lightbulb",et="text-amber-600 dark:text-amber-400 bg-amber-50 dark:bg-amber-500/10 border-amber-100 dark:border-amber-500/20",tt="bg-amber-500"):Te&&(Ge="check_circle",et="text-emerald-600 dark:text-emerald-400 bg-emerald-50 dark:bg-emerald-500/10 border-emerald-100 dark:border-emerald-500/20",tt="bg-emerald-500"),r.jsx(nt,{to:`/project/${k.id}`,className:"group block h-full",children:r.jsxs(Be,{padding:"none",hoverable:!0,className:"h-full flex flex-col relative overflow-hidden transition-all duration-300 group-hover:shadow-2xl border-[var(--color-surface-border)] hover:border-[var(--color-primary)]/50 bg-[var(--color-surface-paper)]",children:[r.jsxs("div",{className:"h-28 w-full relative overflow-hidden bg-gray-100 dark:bg-gray-800",children:[k.coverImage?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[var(--color-surface-paper)]/90 via-transparent to-transparent z-10"}),r.jsx("img",{src:k.coverImage,className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-105",alt:""})]}):r.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-500/20 to-purple-500/20"}),r.jsx("div",{className:"absolute top-3 right-3 z-20",children:r.jsx(Tn,{variant:Te?"success":Ce?"secondary":"primary",className:"backdrop-blur-md bg-white/90 dark:bg-black/50 shadow-sm border-0",children:k.status})})]}),r.jsxs("div",{className:"px-5 pb-5 flex flex-col flex-1 relative z-20",children:[r.jsx("div",{className:"-mt-8 mb-3",children:k.squareIcon?r.jsx("div",{className:"size-14 rounded-2xl overflow-hidden border-4 border-[var(--color-surface-paper)] bg-white shadow-md",children:r.jsx("img",{src:k.squareIcon,alt:"",className:"w-full h-full object-cover"})}):r.jsx("div",{className:`size-14 rounded-2xl flex items-center justify-center border-4 border-[var(--color-surface-paper)] shadow-md ${et} bg-[var(--color-surface-paper)]`,children:r.jsx("span",{className:"material-symbols-outlined text-2xl",children:Ge})})}),r.jsxs("div",{className:"flex-1 space-y-1 mb-4",children:[r.jsx("h3",{className:"text-lg font-bold text-[var(--color-text-main)] group-hover:text-[var(--color-primary)] transition-colors line-clamp-1",children:k.title}),k.description&&r.jsx("p",{className:"text-xs text-[var(--color-text-muted)] line-clamp-2 leading-relaxed",children:k.description})]}),r.jsxs("div",{className:"space-y-2 mb-4",children:[r.jsxs("div",{className:"flex items-center justify-between text-[10px] font-bold text-[var(--color-text-subtle)] uppercase tracking-wider",children:[r.jsx("span",{children:"Progress"}),r.jsxs("span",{children:[Se,"%"]})]}),r.jsx("div",{className:"w-full bg-[var(--color-surface-border)] rounded-full h-1.5 overflow-hidden",children:r.jsx("div",{className:`h-full rounded-full transition-all duration-700 ease-out ${tt}`,style:{width:`${Se}%`}})})]}),r.jsxs("div",{className:"flex items-center justify-between mt-auto pt-4 border-t border-[var(--color-surface-border)]",children:[r.jsx(ZA,{projectId:k.id}),r.jsx("span",{className:"material-symbols-outlined text-[var(--color-text-subtle)] group-hover:text-[var(--color-primary)] group-hover:translate-x-1 transition-all",children:"arrow_forward"})]})]})]})},k.id)})})]})]})]}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs(Be,{padding:"md",children:[r.jsx("div",{className:"flex flex-col gap-3 mb-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("h3",{className:"font-bold text-base text-[var(--color-text-main)]",children:[M.toLocaleDateString("en-US",{month:"long",year:"numeric"}),r.jsx("span",{className:"ml-2 text-[10px] text-[var(--color-text-subtle)] font-normal bg-[var(--color-surface-hover)] px-1.5 py-0.5 rounded-full",children:z==="month"?r.jsxs(r.Fragment,{children:["W",re(new Date(M.getFullYear(),M.getMonth(),1)),"-",re(new Date(M.getFullYear(),M.getMonth()+1,0))]}):r.jsxs(r.Fragment,{children:["W",re(M)]})})]}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx("button",{onClick:Nt,className:"p-1 hover:bg-[var(--color-surface-hover)] rounded-md text-[var(--color-text-subtle)]",children:r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"chevron_left"})}),r.jsx("button",{onClick:zt,className:"p-1 hover:bg-[var(--color-surface-hover)] rounded-md text-[var(--color-text-subtle)]",children:r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"chevron_right"})})]})]})}),r.jsx("div",{className:"grid grid-cols-7 gap-1 text-center mb-2",children:["M","T","W","T","F","S","S"].map(k=>r.jsx("div",{className:"text-[10px] font-semibold text-[var(--color-text-subtle)] uppercase",children:k},k))}),r.jsx("div",{className:"grid grid-cols-7 gap-1 text-center",children:(()=>{const k=new Date;M.getDate();let Q=[];if(z==="month"){const ne=new Date(M.getFullYear(),M.getMonth()+1,0).getDate(),Se=(new Date(M.getFullYear(),M.getMonth(),1).getDay()||7)-1;for(let Ce=0;Ce<Se;Ce++)Q.push(r.jsx("div",{},`empty-${Ce}`));for(let Ce=1;Ce<=ne;Ce++){const Ge=new Date(M.getFullYear(),M.getMonth(),Ce).toDateString()===k.toDateString();Q.push(r.jsx("div",{className:`size-8 mx-auto flex items-center justify-center text-xs rounded-full cursor-pointer transition-colors ${Ge?"bg-emerald-500 text-white font-bold shadow-md":"text-[var(--color-text-main)] hover:bg-[var(--color-surface-hover)]"}`,children:Ce},Ce))}}else{const ne=M.getDay()||7,se=new Date(M);se.setDate(M.getDate()-ne+1);for(let Se=0;Se<7;Se++){const Ce=new Date(se);Ce.setDate(se.getDate()+Se);const Te=Ce.getDate(),Ge=Ce.toDateString()===k.toDateString();Q.push(r.jsx("div",{className:`size-8 mx-auto flex items-center justify-center text-xs rounded-full cursor-pointer transition-colors ${Ge?"bg-emerald-500 text-white font-bold shadow-md":"text-[var(--color-text-main)] hover:bg-[var(--color-surface-hover)]"}`,children:Te},`week-${Se}`))}}return Q})()}),r.jsxs("div",{className:"flex p-0.5 bg-[var(--color-surface-hover)] rounded-md mt-2",children:[r.jsx("button",{onClick:()=>z!=="month"&&Pt(),className:`flex-1 py-[5px] text-[9px] font-bold uppercase tracking-wider rounded transition-all ${z==="month"?"bg-[var(--color-surface-paper)] text-[var(--color-text-main)] shadow-sm":"text-[var(--color-text-subtle)] hover:text-[var(--color-text-main)]"}`,children:"Month"}),r.jsx("button",{onClick:()=>z!=="week"&&Pt(),className:`flex-1 py-[5px] text-[9px] font-bold uppercase tracking-wider rounded transition-all ${z==="week"?"bg-[var(--color-surface-paper)] text-[var(--color-text-main)] shadow-sm":"text-[var(--color-text-subtle)] hover:text-[var(--color-text-main)]"}`,children:"Week"})]})]}),r.jsxs(Be,{padding:"none",className:"max-h-[400px] flex flex-col",children:[r.jsxs("div",{className:"p-4 border-b border-[var(--color-surface-border)] flex justify-between items-center",children:[r.jsx("h3",{className:"h5",children:"Live Activity"}),r.jsxs("span",{className:"relative flex h-2 w-2",children:[r.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"}),r.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-emerald-500"})]})]}),r.jsx("div",{className:"overflow-y-auto p-2 space-y-1",children:we.length===0?r.jsx("div",{className:"p-8 text-center text-sm text-[var(--color-text-subtle)]",children:"No recent activity"}):we.map(k=>r.jsxs("div",{className:"flex items-start gap-3 p-2.5 rounded-lg hover:bg-[var(--color-surface-hover)] transition-colors group",children:[r.jsx("div",{className:"mt-0.5",children:k.userAvatar?r.jsx("img",{src:k.userAvatar,alt:"",className:"size-8 rounded-full border border-[var(--color-surface-border)] object-cover"}):r.jsx("div",{className:"size-8 rounded-full bg-indigo-100 dark:bg-indigo-900/50 flex items-center justify-center text-xs font-bold text-indigo-600 dark:text-indigo-400 border border-indigo-200 dark:border-indigo-800",children:(k.user||"U").charAt(0)})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("p",{className:"text-sm text-[var(--color-text-main)] leading-snug",children:[r.jsx("span",{className:"font-semibold",children:k.user})," ",r.jsx("span",{className:"text-[var(--color-text-muted)]",children:k.action||"performed action on"})," ",r.jsx("br",{}),r.jsx("span",{className:"font-medium text-[var(--color-text-main)] group-hover:text-[var(--color-primary)] transition-colors",children:k.target})]}),r.jsx("p",{className:"text-[10px] text-[var(--color-text-subtle)] mt-1",children:k.createdAt?new Date(Le(k.createdAt)).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"Just now"})]})]},k.id))})]}),r.jsxs(Be,{padding:"md",className:"flex flex-col border-l-4 border-l-rose-500",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h3",{className:"h5 text-rose-600 dark:text-rose-400",children:"Attention Needed"}),r.jsx("span",{className:"material-symbols-outlined text-rose-500 text-[20px]",children:"warning"})]}),r.jsx("div",{className:"flex-1 overflow-y-auto pr-1 space-y-3",children:(()=>{const k=v.filter(se=>se.status==="Blocked"),Q=v.filter(se=>se.priority==="Urgent"&&!se.isCompleted),ne=[...k,...Q].slice(0,5);return ne.length===0?r.jsxs("div",{className:"flex flex-col items-center justify-center text-center py-4 opacity-70",children:[r.jsx("span",{className:"material-symbols-outlined text-3xl text-emerald-500 mb-2",children:"check_circle"}),r.jsx("p",{className:"text-xs text-[var(--color-text-muted)]",children:"All clear!"})]}):ne.map(se=>r.jsxs(nt,{to:`/project/${se.projectId}/tasks/${se.id}`,className:"block p-3 rounded-lg bg-rose-50 dark:bg-rose-900/10 border border-rose-100 dark:border-rose-900/30 hover:shadow-sm transition-shadow",children:[r.jsx("p",{className:"text-[10px] font-bold text-rose-700 dark:text-rose-300 mb-0.5 uppercase",children:se.status==="Blocked"?"BLOCKED":"URGENT"}),r.jsx("p",{className:"text-sm font-medium text-[var(--color-text-main)] line-clamp-2",children:se.title})]},se.id))})()})]}),r.jsxs(Be,{padding:"md",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h3",{className:"h5",children:"Recently Added"}),r.jsx(nt,{to:"/tasks",className:"text-xs font-bold text-[var(--color-primary)] hover:underline",children:"View All"})]}),r.jsxs("div",{className:"space-y-3",children:[v.sort((k,Q)=>(Le(Q.createdAt)||0)-(Le(k.createdAt)||0)).slice(0,5).map(k=>r.jsxs(nt,{to:`/project/${k.projectId}/tasks/${k.id}`,className:"flex items-start gap-3 group",children:[r.jsx("div",{className:`mt-1 size-2 rounded-full flex-shrink-0 ${k.priority==="Urgent"?"bg-red-500":k.priority==="High"?"bg-orange-500":"bg-blue-500"}`}),r.jsxs("div",{className:"min-w-0 flex-1",children:[r.jsx("p",{className:"text-sm font-medium text-[var(--color-text-main)] line-clamp-1 group-hover:text-[var(--color-primary)] transition-colors",children:k.title}),r.jsx("p",{className:"text-xs text-[var(--color-text-muted)]",children:QA(new Date(Le(k.createdAt)))})]})]},k.id)),v.length===0&&r.jsx("p",{className:"text-sm text-[var(--color-text-muted)] text-center py-4",children:"No recent tasks."})]})]}),Y&&_.length>0&&r.jsxs(Be,{padding:"none",children:[r.jsx("div",{className:"p-4 border-b border-[var(--color-surface-border)] flex justify-between items-center",children:r.jsx("h3",{className:"h5",children:"Recent Issues"})}),r.jsx("div",{className:"divide-y divide-[var(--color-surface-border)]",children:_.slice(0,4).map(k=>r.jsx("div",{className:"p-3",children:r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsx("span",{className:`material-symbols-outlined text-[18px] ${k.status==="Resolved"?"text-emerald-500":"text-rose-500"}`,children:k.status==="Resolved"?"check_circle":"error"}),r.jsxs("div",{className:"min-w-0",children:[r.jsx("p",{className:"text-sm font-medium truncate text-[var(--color-text-main)]",children:k.title}),r.jsx("p",{className:"text-xs text-[var(--color-text-muted)] truncate",children:be.get(k.projectId)||"Unknown Project"})]})]})},k.id))})]})]})]})]})},xn=nr.forwardRef(({label:t,error:e,icon:s,className:o="",children:i,...c},u)=>r.jsxs("div",{className:"flex flex-col gap-1.5 w-full",children:[t&&r.jsx("label",{className:"text-xs font-semibold text-[var(--color-text-muted)] uppercase tracking-wider ml-1",children:t}),r.jsxs("div",{className:"relative group",children:[s&&r.jsx("div",{className:"absolute left-3 inset-y-0 flex items-center justify-center text-[var(--color-text-subtle)] pointer-events-none group-focus-within:text-[var(--color-primary)] transition-colors",children:r.jsx("span",{className:"material-symbols-outlined text-[20px] leading-none",children:s})}),r.jsx("select",{ref:u,className:`
                            w-full 
                            bg-[var(--color-surface-bg)] 
                            border 
                            text-[var(--color-text-main)] 
                            rounded-xl 
                            py-2.5 
                            ${s?"pl-10":"pl-3"} 
                            pr-8 
                            text-sm 
                            placeholder-[var(--color-text-subtle)] 
                            transition-all 
                            focus:outline-none 
                            focus:ring-0
                            focus:ring-offset-0
                            appearance-none
                            ${e?"border-[var(--color-error)]":"border-[var(--color-surface-border)]"}
                            ${o}
                        `,...c,children:i}),r.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-[var(--color-text-subtle)]",children:r.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"expand_more"})})]}),e&&r.jsx("span",{className:"text-xs text-[var(--color-error)] ml-1",children:e})]}));xn.displayName="Select";const bb={Owner:{canEdit:!0,canDelete:!0,canInvite:!0,canManageTasks:!0,canManageIdeas:!0,canManageIssues:!0,canComment:!0,canView:!0},Editor:{canEdit:!1,canDelete:!1,canInvite:!1,canManageTasks:!0,canManageIdeas:!0,canManageIssues:!0,canComment:!0,canView:!0},Viewer:{canEdit:!1,canDelete:!1,canInvite:!1,canManageTasks:!1,canManageIdeas:!1,canManageIssues:!1,canComment:!0,canView:!0}},tk={Owner:{canManageWorkspace:!0,canManageMembers:!0,canManageGroups:!0,canCreateProjects:!0,canDeleteProjects:!0,canViewAllProjects:!0},Admin:{canManageWorkspace:!1,canManageMembers:!0,canManageGroups:!0,canCreateProjects:!0,canDeleteProjects:!0,canViewAllProjects:!0},Member:{canManageWorkspace:!1,canManageMembers:!1,canManageGroups:!1,canCreateProjects:!0,canDeleteProjects:!1,canViewAllProjects:!1},Guest:{canManageWorkspace:!1,canManageMembers:!1,canManageGroups:!1,canCreateProjects:!1,canDeleteProjects:!1,canViewAllProjects:!1}};function Dm(t,e){if(!t||!e)return null;if(t.ownerId===e)return"Owner";if(!t.members||t.members.length===0)return null;for(const s of t.members)if(typeof s=="string"){if(s===e)return"Editor"}else if(s.userId===e)return s.role||"Editor";return null}function nk(t,e,s){const o=Dm(t,e);return o?bb[o][s]:!1}function sk(t,e){const s=Dm(t,e);return s?bb[s]:{canEdit:!1,canDelete:!1,canInvite:!1,canManageTasks:!1,canManageIdeas:!1,canManageIssues:!1,canComment:!1,canView:!1}}function rk(t=[],e){if(!e)return"None";const s=t.find(i=>i.uid===e);if(!s)return"None";const o=s.role;return o==="Editor"?"Member":o==="Viewer"?"Guest":s.role}const Um=()=>{const[t,e]=w.useState([]),[s,o]=w.useState(!0),i=Ar(),c=xe.currentUser;w.useEffect(()=>{if(!i){o(!1);return}const b=ba(N=>{e(N),o(!1)},i);return()=>b()},[i]);const u=w.useMemo(()=>!c||!i?"None":c.uid===i?"Owner":rk(t,c.uid),[c,i,t]),m=w.useMemo(()=>u==="None"?{canManageWorkspace:!1,canManageMembers:!1,canManageGroups:!1,canCreateProjects:!1,canDeleteProjects:!1,canViewAllProjects:!1}:tk[u],[u]);return{role:u,capabilities:m,can:b=>m[b],isOwner:u==="Owner",isAdmin:u==="Admin",loading:s,members:t}},Pm=({projectId:t})=>{const[e,s]=w.useState([]);return w.useEffect(()=>{(async()=>{try{const c=(await yl(t)).map(m=>Mn(m)),u=await Promise.all(c);s(u.filter(m=>!!m))}catch(i){console.error("Failed to fetch project members",i)}})()},[t]),e.length===0?null:r.jsxs("div",{className:"flex items-center -space-x-2",children:[e.slice(0,3).map((o,i)=>r.jsx("div",{className:"size-7 rounded-full border-2 border-[var(--color-surface-paper)] overflow-hidden bg-[var(--color-surface-hover)] shadow-sm",title:o.displayName||"Member",children:o.photoURL?r.jsx("img",{src:o.photoURL,alt:"",className:"w-full h-full object-cover"}):r.jsx("div",{className:"w-full h-full flex items-center justify-center text-[10px] font-bold text-[var(--color-text-muted)]",children:(o.displayName||"?").charAt(0).toUpperCase()})},o.id)),e.length>3&&r.jsxs("div",{className:"size-7 rounded-full border-2 border-[var(--color-surface-paper)] bg-[var(--color-surface-hover)] flex items-center justify-center text-[10px] font-bold text-[var(--color-text-muted)] shadow-sm",children:["+",e.length-3]})]})},ak=({project:t})=>{const e=dn(),[s,o]=w.useState([]),i=t.status==="Brainstorming"||t.status==="Planning",c=t.status==="Completed";w.useEffect(()=>ii(t.id,o,t.tenantId),[t.id,t.tenantId]);const u=w.useMemo(()=>{if(s.length===0)return t.progress||0;const v=s.filter(b=>b.isCompleted||b.status==="Done").length;return Math.round(v/s.length*100)},[s,t.progress]);let m="folder",h="text-indigo-600 dark:text-indigo-400 bg-indigo-50 dark:bg-indigo-500/10 border-indigo-100 dark:border-indigo-500/20",x="bg-indigo-500";return i?(m="lightbulb",h="text-amber-600 dark:text-amber-400 bg-amber-50 dark:bg-amber-500/10 border-amber-100 dark:border-amber-500/20",x="bg-amber-500"):c&&(m="check_circle",h="text-emerald-600 dark:text-emerald-400 bg-emerald-50 dark:bg-emerald-500/10 border-emerald-100 dark:border-emerald-500/20",x="bg-emerald-500"),r.jsx("div",{onClick:()=>e(`/project/${t.id}`),className:"cursor-pointer h-full group",children:r.jsxs(Be,{padding:"none",hoverable:!0,className:"h-full flex flex-col relative overflow-hidden transition-all duration-300 group-hover:shadow-2xl border-[var(--color-surface-border)] hover:border-[var(--color-primary)]/50",children:[t.coverImage&&r.jsxs("div",{className:"h-32 w-full relative overflow-hidden",children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[var(--color-surface-paper)] via-[var(--color-surface-paper)]/20 to-transparent z-10"}),r.jsx("img",{src:t.coverImage,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110",alt:""})]}),r.jsxs("div",{className:`p-5 flex flex-col flex-1 gap-4 ${t.coverImage?"-mt-10 relative z-20":""}`,children:[r.jsxs("div",{className:"flex justify-between items-start",children:[t.squareIcon?r.jsx("div",{className:"size-12 rounded-2xl overflow-hidden border-2 border-[var(--color-surface-paper)] bg-white shadow-lg",children:r.jsx("img",{src:t.squareIcon,alt:"",className:"w-full h-full object-cover"})}):r.jsx("div",{className:`size-12 rounded-2xl flex items-center justify-center border-2 border-[var(--color-surface-paper)] shadow-lg ${h}`,children:r.jsx("span",{className:"material-symbols-outlined text-2xl",children:m})}),r.jsx("div",{className:"pt-1",children:r.jsx(Tn,{variant:c?"success":i?"secondary":"primary",className:"backdrop-blur-md bg-opacity-80",children:t.status})})]}),r.jsxs("div",{className:"flex-1 space-y-2",children:[r.jsx("h3",{className:"text-xl font-bold text-[var(--color-text-main)] group-hover:text-[var(--color-primary)] transition-colors line-clamp-1 leading-tight",children:t.title}),r.jsx("p",{className:"text-sm text-[var(--color-text-muted)] line-clamp-2 leading-relaxed min-h-[2.8rem]",children:t.description||"No description provided."})]}),r.jsxs("div",{className:"space-y-3 pt-2",children:[r.jsxs("div",{className:"flex items-center justify-between text-xs font-bold text-[var(--color-text-subtle)] uppercase tracking-wider",children:[r.jsxs("span",{children:[u,"% PROGRESS"]}),t.dueDate&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"material-symbols-outlined text-xs",children:"calendar_today"}),new Date(t.dueDate).toLocaleDateString(void 0,{month:"short",day:"numeric"})]})]}),r.jsx("div",{className:"w-full bg-[var(--color-surface-border)] rounded-full h-2 overflow-hidden shadow-inner",children:r.jsx("div",{className:`h-full rounded-full transition-all duration-700 ease-out relative ${x}`,style:{width:`${u}%`}})})]})]}),r.jsxs("div",{className:"px-5 py-4 border-t border-[var(--color-surface-border)] bg-[var(--color-surface-bg)]/50 backdrop-blur-sm flex items-center justify-between mt-auto",children:[r.jsx(Pm,{projectId:t.id}),r.jsxs("div",{className:"text-sm font-bold text-[var(--color-text-main)] group-hover:text-[var(--color-primary)] flex items-center gap-2 transition-all group-hover:gap-3",children:["View ",r.jsx("span",{className:"material-symbols-outlined text-lg",children:"arrow_forward"})]})]})]})})},ok=({project:t})=>{const e=dn(),[s,o]=w.useState([]),i=t.status==="Brainstorming"||t.status==="Planning",c=t.status==="Completed";w.useEffect(()=>ii(t.id,o,t.tenantId),[t.id,t.tenantId]);const u=w.useMemo(()=>{if(s.length===0)return t.progress||0;const h=s.filter(x=>x.isCompleted||x.status==="Done").length;return Math.round(h/s.length*100)},[s,t.progress]);let m="from-indigo-500 to-indigo-600";return i?m="from-amber-400 to-amber-600":c&&(m="from-emerald-400 to-emerald-600"),r.jsx(Be,{onClick:()=>e(`/project/${t.id}`),className:"relative overflow-hidden cursor-pointer group hover:shadow-2xl transition-all duration-500 border-none p-0 bg-transparent",children:r.jsxs("div",{className:"relative h-64 md:h-80 w-full rounded-3xl overflow-hidden shadow-2xl",children:[t.coverImage?r.jsx("img",{src:t.coverImage,className:"absolute inset-0 w-full h-full object-cover transition-transform duration-700 group-hover:scale-105 blur-[2px]",alt:""}):r.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-500 animate-gradient-xy"}),r.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/95 via-black/70 to-black/40 backdrop-blur-[2px]"}),r.jsxs("div",{className:"absolute bottom-0 left-0 p-6 md:p-10 w-full space-y-4",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(Tn,{variant:"primary",className:"bg-white/20 backdrop-blur-xl border-white/30 text-white uppercase tracking-widest text-[10px] font-black",children:"Featured Project"}),r.jsx(Tn,{variant:c?"success":i?"secondary":"primary",className:"bg-white/10 backdrop-blur-md border-white/20 text-white",children:t.status})]}),r.jsxs("div",{className:"max-w-2xl space-y-2",children:[r.jsx("h2",{className:"text-3xl md:text-5xl font-black text-white leading-tight drop-shadow-lg",children:t.title}),r.jsx("p",{className:"text-white/80 text-sm md:text-base line-clamp-2 md:line-clamp-3 leading-relaxed font-medium",children:t.description||"No description provided."})]}),r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-6 pt-2",children:[r.jsxs("div",{className:"flex-1 space-y-2 max-w-xs",children:[r.jsxs("div",{className:"flex justify-between text-xs font-black text-white/70 uppercase tracking-widest",children:[r.jsx("span",{children:"Completion"}),r.jsxs("span",{children:[u,"%"]})]}),r.jsx("div",{className:"h-2.5 w-full bg-white/20 rounded-full overflow-hidden backdrop-blur-md",children:r.jsx("div",{className:`h-full bg-gradient-to-r ${m} transition-all duration-1000 ease-out`,style:{width:`${u}%`}})})]}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx(Pm,{projectId:t.id}),r.jsxs("div",{className:"h-10 px-6 rounded-xl bg-white text-black font-bold flex items-center justify-center gap-2 transition-all hover:bg-white/90 active:scale-95 shadow-lg",children:["Open Project ",r.jsx("span",{className:"material-symbols-outlined text-lg transition-transform group-hover:translate-x-1",children:"arrow_right_alt"})]})]})]})]})]})})},ik=()=>{const[t,e]=w.useState([]),[s,o]=w.useState(!0),[i,c]=w.useState(!0),[u,m]=w.useState("all"),[h,x]=w.useState(""),[v,b]=w.useState("recent"),N=xe.currentUser,{can:T}=Um();w.useEffect(()=>{(async()=>{try{const M=await bl();e(M)}catch(M){console.error("Failed to fetch projects",M)}finally{o(!1)}})()},[]);const{myProjects:_,otherProjects:I}=w.useMemo(()=>{if(!N)return{myProjects:[],otherProjects:[]};const A=[],M=[];return t.forEach(B=>{B.ownerId===N.uid||(B.memberIds||[]).includes(N.uid)?A.push(B):M.push(B)}),{myProjects:A,otherProjects:M}},[t,N]),E=w.useMemo(()=>{const A=h.trim().toLowerCase(),M=L=>u==="active"?L.status==="Active":u==="planning"?L.status==="Brainstorming"||L.status==="Planning":u==="completed"?L.status==="Completed":!0,B=L=>A?[L.title,L.description].some(X=>(X||"").toLowerCase().includes(A)):!0;return[..._].filter(L=>M(L)&&B(L)).sort((L,X)=>{if(v==="progress")return(X.progress||0)-(L.progress||0);if(v==="due"){const de=L.dueDate?new Date(L.dueDate).getTime():Number.POSITIVE_INFINITY,V=X.dueDate?new Date(X.dueDate).getTime():Number.POSITIVE_INFINITY;return de-V}return Le(X.createdAt)-Le(L.createdAt)})},[_,u,h,v]),D=w.useMemo(()=>{if(_.length===0)return null;const A=_.filter(M=>M.status==="Active");return A.length>0?A.sort((M,B)=>(B.progress||0)-(M.progress||0))[0]:_[0]},[_]),z={all:_.length,active:_.filter(A=>A.status==="Active").length,planning:_.filter(A=>A.status==="Brainstorming"||A.status==="Planning").length,completed:_.filter(A=>A.status==="Completed").length};return s?r.jsx("div",{className:"flex items-center justify-center p-12",children:r.jsx("span",{className:"material-symbols-outlined text-[var(--color-text-subtle)] animate-spin text-3xl",children:"rotate_right"})}):r.jsxs("div",{className:"max-w-7xl mx-auto flex flex-col gap-10 pb-20 p-4 md:p-8 animate-fade-in",children:[r.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-6",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center gap-2 text-indigo-500 font-black tracking-widest text-xs uppercase",children:[r.jsx("span",{className:"h-px w-8 bg-indigo-500/30"}),"Workspace"]}),r.jsx("h1",{className:"text-4xl md:text-5xl font-black text-[var(--color-text-main)] tracking-tight",children:"Your Initiatives"}),r.jsxs("p",{className:"text-[var(--color-text-muted)] text-base font-medium max-w-lg",children:["You have ",r.jsxs("span",{className:"text-[var(--color-text-main)] font-bold",children:[z.active," active"]})," projects in progress. Keep up the great work!"]})]}),T("canCreateProjects")&&r.jsx(nt,{to:"/create",children:r.jsx(Ne,{size:"lg",className:"h-14 px-8 rounded-2xl shadow-xl shadow-indigo-500/20 bg-indigo-600 hover:bg-indigo-700 text-white border-none font-bold text-lg group transition-all",icon:r.jsx("span",{className:"material-symbols-outlined group-hover:rotate-90 transition-transform",children:"add"}),children:"Create Project"})})]}),D&&u==="all"&&!h&&r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsx("h3",{className:"text-xs font-black uppercase tracking-[0.2em] text-[var(--color-text-subtle)]",children:"Focus of the day"})}),r.jsx(ok,{project:D})]}),i&&D&&r.jsxs("div",{className:"bg-gradient-to-br from-indigo-500/10 via-purple-500/5 to-transparent border border-indigo-500/10 rounded-2xl p-5 flex items-start gap-4 relative overflow-hidden backdrop-blur-sm group",children:[r.jsx("div",{className:"absolute top-0 right-0 p-8 transform translate-x-1/2 -translate-y-1/2 bg-indigo-500/10 blur-3xl rounded-full"}),r.jsx("div",{className:"size-10 rounded-xl bg-indigo-500/20 flex items-center justify-center text-indigo-600 flex-shrink-0",children:r.jsx("span",{className:"material-symbols-outlined animate-pulse",children:"auto_awesome"})}),r.jsx("div",{className:"flex-1 pr-10",children:r.jsxs("p",{className:"text-sm text-indigo-900 dark:text-indigo-100 leading-relaxed",children:[r.jsx("span",{className:"font-black text-indigo-600 dark:text-indigo-400 mr-1 uppercase text-xs tracking-wider",children:"Gemini:"}),"Based on your activity, we suggest reviewing milestones for ",r.jsxs("span",{className:"font-bold underline decoration-indigo-300",children:['"',D.title,'"']})," today."]})}),r.jsx("button",{onClick:()=>c(!1),className:"absolute top-4 right-4 text-indigo-400 hover:text-indigo-700 transition-colors",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"close"})})]}),r.jsxs("div",{className:"flex flex-col gap-8",children:[r.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-6 pb-2 border-b border-[var(--color-surface-border)]/50",children:[r.jsx("div",{className:"flex items-center gap-2 overflow-x-auto no-scrollbar pb-1",children:["all","active","planning","completed"].map(A=>r.jsxs("button",{onClick:()=>m(A),className:`
                                    px-6 py-2.5 rounded-xl text-sm font-black transition-all capitalize whitespace-nowrap flex items-center gap-2
                                    ${u===A?"bg-[var(--color-text-main)] text-[var(--color-surface-paper)] shadow-lg shadow-black/5 transform scale-105":"text-[var(--color-text-muted)] hover:text-[var(--color-text-main)] hover:bg-[var(--color-surface-hover)]"}
                                `,children:[A,r.jsx("span",{className:`text-[10px] py-0.5 px-2 rounded-full font-bold ${u===A?"bg-white/20":"bg-[var(--color-surface-border)]"}`,children:A==="planning"?z.planning:z[A]})]},A))}),r.jsxs("div",{className:"flex items-center gap-4 w-full lg:w-auto",children:[r.jsx(st,{value:h,onChange:A=>x(A.target.value),placeholder:"Search your projects...",className:"w-full",icon:"search"}),r.jsxs(xn,{value:v,onChange:A=>b(A.target.value),className:"w-full lg:w-40",children:[r.jsx("option",{value:"recent",children:"RECENT"}),r.jsx("option",{value:"due",children:"DUE DATE"}),r.jsx("option",{value:"progress",children:"PROGRESS"})]})]})]}),E.length===0?r.jsxs("div",{className:"text-center py-20 border-2 border-dashed border-[var(--color-surface-border)] rounded-xl",children:[r.jsx("span",{className:"material-symbols-outlined text-4xl text-[var(--color-text-subtle)] mb-4",children:"folder_off"}),r.jsx("h3",{className:"text-lg font-bold text-[var(--color-text-main)]",children:"No projects found"}),r.jsx("p",{className:"text-[var(--color-text-muted)] mb-4",children:"Create your first project to get started."}),T("canCreateProjects")&&r.jsx(nt,{to:"/create",children:r.jsx(Ne,{variant:"outline",children:"Create Project"})})]}):r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:E.map(A=>r.jsx(ak,{project:A},A.id))})]}),I.length>0&&r.jsxs("div",{className:"pt-10 space-y-6",children:[r.jsx("div",{className:"flex items-center justify-between border-b border-[var(--color-surface-border)] pb-4",children:r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-[var(--color-text-main)]",children:"Other Workspace Projects"}),r.jsx("p",{className:"text-sm text-[var(--color-text-muted)]",children:"Projects in this workspace that you are not a member of."})]})}),r.jsx("div",{className:"bg-[var(--color-surface-card)] rounded-xl border border-[var(--color-surface-border)] overflow-hidden",children:r.jsxs("table",{className:"w-full text-left",children:[r.jsx("thead",{className:"bg-[var(--color-surface-hover)] text-xs text-[var(--color-text-subtle)] uppercase tracking-wider font-semibold border-b border-[var(--color-surface-border)]",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-4",children:"Project"}),r.jsx("th",{className:"px-6 py-4",children:"Status"}),r.jsx("th",{className:"px-6 py-4",children:"Members"}),r.jsx("th",{className:"px-6 py-4",children:"Created"}),r.jsx("th",{className:"px-6 py-4"})]})}),r.jsx("tbody",{className:"divide-y divide-[var(--color-surface-border)]",children:I.map(A=>r.jsxs("tr",{className:"hover:bg-[var(--color-surface-hover)] transition-colors group",children:[r.jsx("td",{className:"px-6 py-4",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"size-10 rounded-lg flex items-center justify-center bg-indigo-50 dark:bg-indigo-500/10 text-indigo-600 dark:text-indigo-400",children:A.squareIcon?r.jsx("img",{src:A.squareIcon,alt:"",className:"w-full h-full object-cover rounded-lg"}):r.jsx("span",{className:"material-symbols-outlined",children:"folder"})}),r.jsxs("div",{children:[r.jsx("div",{className:"font-bold text-[var(--color-text-main)]",children:A.title}),r.jsx("div",{className:"text-xs text-[var(--color-text-muted)] line-clamp-1 max-w-xs",children:A.description})]})]})}),r.jsx("td",{className:"px-6 py-4",children:r.jsx(Tn,{variant:A.status==="Active"?"success":"secondary",size:"sm",children:A.status})}),r.jsx("td",{className:"px-6 py-4",children:r.jsx(Pm,{projectId:A.id})}),r.jsx("td",{className:"px-6 py-4 text-sm text-[var(--color-text-muted)]",children:new Date(Le(A.createdAt)).toLocaleDateString()}),r.jsx("td",{className:"px-6 py-4 text-right",children:r.jsx(Ne,{variant:"ghost",size:"sm",onClick:()=>window.location.href=`/project/${A.id}`,icon:r.jsx("span",{className:"material-symbols-outlined",children:"visibility"}),children:"View"})})]},A.id))})]})})]})]})},lk=()=>{const[t,e]=w.useState([]),[s,o]=w.useState([]),[i,c]=w.useState(!0),u=xe.currentUser,[m,h]=w.useState("open"),[x,v]=w.useState("all"),[b,N]=w.useState("all"),[T,_]=w.useState("me"),[I,E]=w.useState(""),[D,z]=w.useState("dueDate"),[A,M]=w.useState("asc"),[B,L]=w.useState(""),[X,de]=w.useState(""),[V,Z]=w.useState(!1),K=dn();w.useEffect(()=>{(async()=>{try{const[R,ue]=await Promise.all([si(),gm()]);e(R),o(ue),ue.length&&!X&&de(ue[0].id)}catch(R){console.error("Failed to fetch tasks",R)}finally{c(!1)}})()},[]);const F=async(H,R,ue)=>{H.stopPropagation(),e(Y=>Y.map(ye=>ye.id===R?{...ye,isCompleted:!ue}:ye)),await Nl(R,ue)},le=async H=>{if(H.preventDefault(),!(!B.trim()||!X)){Z(!0);try{await xa(X,B.trim(),void 0,void 0,"Medium",{status:"Open"});const R=await si();e(R),L("")}catch(R){console.error(R)}finally{Z(!1)}}},he=w.useMemo(()=>{const H=s.map(R=>[R.id,R.title]);return Object.fromEntries(H)},[s]),re=w.useMemo(()=>{const H=new Date,R=new Date(H.getFullYear(),H.getMonth(),H.getDate()).getTime(),ue=R+864e5,Y=t.filter(be=>{if(be.isCompleted||!be.dueDate)return!1;const me=new Date(be.dueDate).getTime();return me>=R&&me<ue}).length,ye=t.filter(be=>be.isCompleted||!be.dueDate?!1:new Date(be.dueDate).getTime()<R).length,je=t.filter(be=>!be.isCompleted&&(be.priority==="High"||be.priority==="Urgent")).length,J=new Set(t.filter(be=>!be.isCompleted).map(be=>be.projectId)).size,we=t.filter(be=>be.isCompleted).length;return{dueToday:Y,overdue:ye,highPriority:je,activeProjects:J,completedTotal:we}},[t]),q=w.useMemo(()=>{let H=t;return H=H.filter(R=>!(m==="open"&&R.isCompleted||m==="completed"&&!R.isCompleted||x!=="all"&&R.priority!==x||b!=="all"&&R.projectId!==b||T==="me"&&u&&!(R.assigneeId===u.uid||R.assigneeIds&&R.assigneeIds.includes(u.uid))||I&&!R.title.toLowerCase().includes(I.toLowerCase()))),H.sort((R,ue)=>{let Y,ye;if(D==="dueDate")Y=R.dueDate?new Date(R.dueDate).getTime():Number.POSITIVE_INFINITY,ye=ue.dueDate?new Date(ue.dueDate).getTime():Number.POSITIVE_INFINITY;else if(D==="priority"){const je={Urgent:4,High:3,Medium:2,Low:1};Y=je[R.priority||"Medium"]||0,ye=je[ue.priority||"Medium"]||0}else Y=Le(R.createdAt),ye=Le(ue.createdAt);return Y<ye?A==="asc"?-1:1:Y>ye?A==="asc"?1:-1:0}),H},[t,m,x,b,T,I,D,A,u]);return i?r.jsx("div",{className:"flex items-center justify-center p-12",children:r.jsx("span",{className:"material-symbols-outlined text-[var(--color-text-subtle)] animate-spin text-3xl",children:"rotate_right"})}):r.jsxs("div",{className:"flex flex-col gap-8 fade-in max-w-6xl mx-auto pb-12",children:[r.jsxs("div",{className:"flex flex-col gap-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-[var(--color-text-main)] mb-1",children:"My Focus"}),r.jsxs("p",{className:"text-[var(--color-text-muted)] text-lg",children:["You have ",r.jsxs("span",{className:"text-[var(--color-text-main)] font-semibold",children:[re.dueToday," tasks"]})," due today and ",r.jsxs("span",{className:"text-rose-500 font-semibold",children:[re.overdue," overdue"]}),"."]})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[r.jsxs(Be,{padding:"md",className:"flex flex-col gap-1 border-l-4 border-l-rose-500",children:[r.jsx("span",{className:"text-xs font-bold text-[var(--color-text-subtle)] uppercase tracking-wider",children:"Attention Needed"}),r.jsxs("div",{className:"flex items-baseline gap-2",children:[r.jsx("span",{className:"text-3xl font-bold text-[var(--color-text-main)]",children:re.overdue+re.dueToday}),r.jsx("span",{className:"text-sm text-[var(--color-text-muted)]",children:"due soon"})]})]}),r.jsxs(Be,{padding:"md",className:"flex flex-col gap-1 border-l-4 border-l-amber-500",children:[r.jsx("span",{className:"text-xs font-bold text-[var(--color-text-subtle)] uppercase tracking-wider",children:"High Priority"}),r.jsxs("div",{className:"flex items-baseline gap-2",children:[r.jsx("span",{className:"text-3xl font-bold text-[var(--color-text-main)]",children:re.highPriority}),r.jsx("span",{className:"text-sm text-[var(--color-text-muted)]",children:"critical tasks"})]})]}),r.jsxs(Be,{padding:"md",className:"flex flex-col gap-1 border-l-4 border-l-indigo-500",children:[r.jsx("span",{className:"text-xs font-bold text-[var(--color-text-subtle)] uppercase tracking-wider",children:"Active Projects"}),r.jsxs("div",{className:"flex items-baseline gap-2",children:[r.jsx("span",{className:"text-3xl font-bold text-[var(--color-text-main)]",children:re.activeProjects}),r.jsx("span",{className:"text-sm text-[var(--color-text-muted)]",children:"in progress"})]})]}),r.jsxs(Be,{padding:"md",className:"flex flex-col gap-1 border-l-4 border-l-emerald-500",children:[r.jsx("span",{className:"text-xs font-bold text-[var(--color-text-subtle)] uppercase tracking-wider",children:"Total Completed"}),r.jsxs("div",{className:"flex items-baseline gap-2",children:[r.jsx("span",{className:"text-3xl font-bold text-[var(--color-text-main)]",children:re.completedTotal}),r.jsx("span",{className:"text-sm text-[var(--color-text-muted)]",children:"all time"})]})]})]})]}),r.jsxs("div",{className:"flex flex-col gap-4",children:[r.jsxs("div",{className:"sticky -top-4 sm:-top-6 lg:-top-8 z-40 bg-[var(--color-surface-bg)] py-4 border-b border-[var(--color-surface-border)] shadow-sm flex flex-col lg:flex-row gap-4 justify-between items-center transition-all -mx-4 sm:-mx-6 lg:-mx-8 px-4 sm:px-6 lg:px-8",children:[r.jsx("div",{className:"flex bg-[var(--color-surface-hover)] p-1 rounded-xl w-full lg:w-auto",children:["open","completed","all"].map(H=>r.jsx("button",{onClick:()=>h(H),className:`
                                    flex-1 lg:flex-none px-6 py-2 rounded-lg text-sm font-semibold capitalize transition-all
                                    ${m===H?"bg-[var(--color-surface-paper)] text-[var(--color-text-main)] shadow-sm scale-100":"text-[var(--color-text-muted)] hover:text-[var(--color-text-main)] hover:bg-black/5 dark:hover:bg-white/5"}
                                `,children:H},H))}),r.jsxs("div",{className:"flex items-center gap-3 w-full lg:w-auto overflow-x-auto pb-1 lg:pb-0 no-scrollbar",children:[r.jsxs("div",{className:"relative group min-w-[200px] flex-1 lg:flex-none",children:[r.jsx("input",{type:"text",value:I,onChange:H=>E(H.target.value),placeholder:"Search tasks...",className:"w-full bg-[var(--color-surface-bg)] border-none ring-1 ring-[var(--color-surface-border)] focus:ring-2 focus:ring-[var(--color-primary)] rounded-xl pl-10 pr-4 py-2 text-sm transition-all"}),r.jsx("span",{className:"material-symbols-outlined absolute left-3 top-2 text-[var(--color-text-muted)] group-focus-within:text-[var(--color-primary)] transition-colors",children:"search"})]}),r.jsx("div",{className:"h-8 w-px bg-[var(--color-surface-border)] mx-1 shrink-0"}),r.jsxs(xn,{value:T,onChange:H=>_(H.target.value),className:"w-[150px] shrink-0",size:"sm",children:[r.jsx("option",{value:"me",children:"Assigned to Me"}),r.jsx("option",{value:"all",children:"Everything"})]}),r.jsxs(xn,{value:b,onChange:H=>N(H.target.value),className:"w-[140px] shrink-0",size:"sm",children:[r.jsx("option",{value:"all",children:"All Projects"}),s.map(H=>r.jsx("option",{value:H.id,children:H.title},H.id))]}),r.jsxs(xn,{value:x,onChange:H=>v(H.target.value),className:"w-[130px] shrink-0",size:"sm",children:[r.jsx("option",{value:"all",children:"Any Priority"}),r.jsx("option",{value:"Urgent",children:"Urgent"}),r.jsx("option",{value:"High",children:"High"}),r.jsx("option",{value:"Medium",children:"Medium"}),r.jsx("option",{value:"Low",children:"Low"})]}),r.jsx("button",{onClick:()=>M(H=>H==="asc"?"desc":"asc"),className:"size-9 flex items-center justify-center rounded-lg bg-[var(--color-surface-bg)] border border-[var(--color-surface-border)] hover:bg-[var(--color-surface-hover)] transition-colors shrink-0",title:"Sort Direction",children:r.jsx("span",{className:"material-symbols-outlined text-[18px] text-[var(--color-text-main)]",children:A==="asc"?"arrow_upward":"arrow_downward"})})]})]}),m!=="completed"&&r.jsxs("div",{className:"bg-[var(--color-surface-paper)] border border-[var(--color-surface-border)] rounded-xl p-2 flex gap-3 shadow-sm transition-all",children:[r.jsx("div",{className:"flex-1",children:r.jsx("input",{type:"text",value:B,onChange:H=>L(H.target.value),placeholder:"Add a new task...",className:"w-full bg-transparent border-none focus:ring-0 p-2 text-sm text-[var(--color-text-main)] placeholder-[var(--color-text-muted)]",onKeyDown:H=>H.key==="Enter"&&le(H)})}),r.jsx("div",{className:"w-40 border-l border-[var(--color-surface-border)] pl-3",children:r.jsxs("select",{value:X,onChange:H=>de(H.target.value),className:"w-full h-full bg-transparent border-none focus:ring-0 text-sm text-[var(--color-text-subtle)] cursor-pointer",children:[r.jsx("option",{value:"",disabled:!0,children:"Select Project"}),s.map(H=>r.jsx("option",{value:H.id,children:H.title},H.id))]})}),r.jsx(Ne,{size:"sm",variant:"primary",disabled:!B||!X,onClick:le,isLoading:V,className:"shrink-0",children:r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"add"})})]}),r.jsx("div",{className:"flex flex-col gap-3",children:q.length===0?r.jsxs("div",{className:"py-20 text-center flex flex-col items-center justify-center",children:[r.jsx("div",{className:"bg-[var(--color-surface-hover)] p-6 rounded-full mb-4 animate-pulse",children:r.jsx("span",{className:"material-symbols-outlined text-4xl text-[var(--color-text-subtle)]",children:"check"})}),r.jsx("h3",{className:"text-xl font-bold text-[var(--color-text-main)] mb-2",children:"All Caught Up!"}),r.jsx("p",{className:"text-[var(--color-text-muted)] max-w-sm mx-auto",children:"No tasks found matching your current filters. Enjoy your free time or create a new task."})]}):q.map(H=>r.jsxs("div",{onClick:()=>K(`/project/${H.projectId}/tasks/${H.id}`),className:"group bg-[var(--color-surface-paper)] hover:bg-[var(--color-surface-hover)] border border-[var(--color-surface-border)] rounded-xl p-4 flex items-center gap-4 cursor-pointer transition-all shadow-sm hover:shadow-md relative overflow-hidden",children:[r.jsx("button",{onClick:R=>F(R,H.id,H.isCompleted),className:`
                                        flex-shrink-0 size-6 rounded-lg border-2 flex items-center justify-center transition-all duration-300 z-10
                                        ${H.isCompleted?"bg-green-500 border-green-500 text-white shadow-sm shadow-green-500/20 scale-105":"border-[var(--color-text-subtle)]/30 text-transparent hover:border-green-500 hover:text-green-500/20 bg-transparent"}
                                    `,children:r.jsx("span",{className:"material-symbols-outlined text-[16px] font-bold",children:"check"})}),r.jsxs("div",{className:"flex-1 min-w-0 z-10",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[H.projectId&&r.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-0.5 rounded-md bg-[var(--color-surface-bg)] border border-[var(--color-surface-border)] text-[10px] font-semibold text-[var(--color-text-muted)] uppercase tracking-wide cursor-pointer hover:text-[var(--color-primary)] transition-colors max-w-[150px] truncate",onClick:R=>{R.stopPropagation(),K(`/project/${H.projectId}`)},children:[r.jsx("span",{className:"size-1.5 rounded-full bg-[var(--color-primary)] shrink-0"}),r.jsx("span",{className:"truncate",children:he[H.projectId]})]}),H.priority==="Urgent"&&r.jsx(Tn,{size:"sm",variant:"danger",className:"animate-pulse",children:"Urgent"})]}),r.jsx("h3",{className:`text-base font-semibold leading-snug transition-all ${H.isCompleted?"text-[var(--color-text-muted)] line-through decoration-2 decoration-[var(--color-surface-border)]":"text-[var(--color-text-main)] group-hover:text-[var(--color-primary)]"}`,children:H.title}),r.jsxs("div",{className:"flex flex-wrap items-center gap-4 mt-2 text-xs text-[var(--color-text-muted)]",children:[H.dueDate&&r.jsxs("div",{className:`flex items-center gap-1 font-medium ${new Date(H.dueDate)<new Date&&!H.isCompleted?"text-rose-500":""}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"event"}),new Date(H.dueDate).toLocaleDateString(void 0,{weekday:"short",month:"short",day:"numeric"})]}),H.priority!=="Urgent"&&H.priority&&r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("span",{className:`size-1.5 rounded-full ${H.priority==="High"?"bg-amber-500":"bg-slate-300"}`}),H.priority," Priority"]}),H.status&&r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"material-symbols-outlined text-[14px] opacity-70",children:"sync"}),H.status]})]})]}),r.jsxs("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-2 z-10",children:[r.jsx("span",{className:"text-xs font-semibold text-[var(--color-primary)]",children:"Open"}),r.jsx("div",{className:"size-8 rounded-full bg-[var(--color-primary)]/10 flex items-center justify-center text-[var(--color-primary)]",children:r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"arrow_forward"})})]}),r.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-32 bg-gradient-to-l from-white dark:from-[#1C1C1E] to-transparent opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none"})]},H.id))})]})]})},oo=async t=>{var u;const e=xe.currentUser;if(!e)throw new Error("User not authenticated");const s=await vl(e.uid);if(s&&s.tokensUsed>=s.tokenLimit)throw new Error(`AI token limit reached (${s.tokensUsed.toLocaleString()} / ${s.tokenLimit.toLocaleString()}). Limit resets monthly.`);const o=io(),i=await t(o),c=((u=i.usageMetadata)==null?void 0:u.totalTokenCount)||0;return c>0&&await mm(e.uid,c),i},io=()=>{const t=typeof import.meta<"u"&&"AIzaSyBEjImj8VDlfi4WK5R9iQkj0J4Nqzi-AA8"||"AIzaSyBEjImj8VDlfi4WK5R9iQkj0J4Nqzi-AA8";return new gb({apiKey:t})},ck=async t=>{try{const e=io(),s={type:Ve.ARRAY,items:{type:Ve.OBJECT,properties:{title:{type:Ve.STRING},description:{type:Ve.STRING},type:{type:Ve.STRING}},required:["title","description","type"]}},o=await oo(c=>c.models.generateContent({model:"gemini-2.5-flash",contents:`Generate 4-6 specific, actionable project ideas based on this goal: "${t}". 
            Keep descriptions concise (under 20 words).`,config:{responseMimeType:"application/json",responseSchema:s,temperature:.7}})),i=JSON.parse(o.text||"[]");if(!Array.isArray(i)||i.length===0)throw new Error("Gemini returned no ideas");return i.map((c,u)=>({id:`gen-${Date.now()}-${u}`,title:c.title,description:c.description,type:c.type,votes:Math.floor(Math.random()*10),comments:Math.floor(Math.random()*5),generated:!0}))}catch(e){throw console.error("Gemini Brainstorm Error:",e),e}},dk=async(t,e)=>{try{return(await oo(o=>o.models.generateContent({model:"gemini-2.5-flash",contents:`Write a professional, concise (1-2 sentences) project description for a project named "${t}". 
            Context: ${e||"A general software or business initiative."}.`}))).text||""}catch(s){throw console.error("Gemini Description Error:",s),s}},uk=async()=>"Gemini is analyzing your latest project activity. Generate a report to get tailored guidance.",fk=async(t,e)=>{try{const s=io(),o=e.filter(m=>!m.isCompleted),i=e.filter(m=>m.isCompleted),c=`
        You are a project analyst. Create a concise status report (bullet points) for the project "${t.title}".
        Description: ${t.description||"No description provided"}.
        Status: ${t.status}. Priority: ${t.priority||"Medium"}.
        Due date: ${t.dueDate||"Not set"}; Start date: ${t.startDate||"Not set"}.
        Open tasks (${o.length}): ${o.map(m=>m.title).join("; ")||"None"}.
        Completed tasks (${i.length}): ${i.slice(0,5).map(m=>m.title).join("; ")}.
        Assess whether the due date seems realistic given open tasks; explicitly say if it is at risk or on track and why.
        Keep it under 180 words. Provide a short risk/next steps section.
        `;return(await oo(m=>m.models.generateContent({model:"gemini-2.5-flash",contents:c,config:{temperature:.4}}))).text||"Report unavailable."}catch(s){throw console.error("Gemini Report Error:",s),s}},mk=async(t,e)=>{try{const s=io(),o={type:Ve.ARRAY,items:{type:Ve.OBJECT,properties:{title:{type:Ve.STRING},description:{type:Ve.STRING},type:{type:Ve.STRING}},required:["title","description","type"]}},i=`
        Suggest 4-6 ideas to advance the project "${t.title}".
        Description: ${t.description||"No description."}
        Current status: ${t.status}; priority: ${t.priority||"Medium"}; due: ${t.dueDate||"Not set"}.
        Open tasks: ${e.filter(m=>!m.isCompleted).map(m=>m.title).join("; ")||"None"}.
        Balance quick wins and impactful improvements. Keep descriptions under 18 words.
        `,c=await oo(m=>m.models.generateContent({model:"gemini-2.5-flash",contents:i,config:{responseMimeType:"application/json",responseSchema:o,temperature:.6}})),u=JSON.parse(c.text||"[]");if(!Array.isArray(u)||u.length===0)throw new Error("Gemini returned no ideas");return u.map((m,h)=>({id:`gen-${Date.now()}-${h}`,title:m.title,description:m.description,type:m.type,votes:0,comments:0,generated:!0}))}catch(s){throw console.error("Gemini Project Ideas Error:",s),s}},pk=async(t,e)=>{if(!e.length)return[];try{const s=io(),o={type:Ve.ARRAY,items:{type:Ve.OBJECT,properties:{group:{type:Ve.STRING},reason:{type:Ve.STRING},ideaIds:{type:Ve.ARRAY,items:{type:Ve.STRING}}},required:["group","ideaIds"]}},i=e.map(m=>`- ${m.id}: ${m.title}  ${m.description||"No description"}`).join(`
`),c=await oo(m=>m.models.generateContent({model:"gemini-2.5-flash",contents:`You are an AI mind-mapping assistant. Group the provided project ideas into 3-6 concise branches with short names (1-2 words).
Project: "${t.title}".
Ideas (id: title  description):
${i}
Return JSON only. Each object must include:
- group: the group name you propose (keep it short, eg. "UI", "Architecture", "Growth Ops")
- ideaIds: an array of idea ids from above that belong in that group
- reason: optional one-line rationale`,config:{responseMimeType:"application/json",responseSchema:o,temperature:.5}})),u=JSON.parse(c.text||"[]");return(Array.isArray(u)?u:[]).map((m,h)=>({group:m.group||`Group ${h+1}`,reason:m.reason||"",ideaIds:Array.isArray(m.ideaIds)?m.ideaIds:[]}))}catch(s){return console.error("Gemini Mindmap Grouping Error:",s),[]}},hk=async t=>{try{const e=io(),s={type:Ve.OBJECT,properties:{title:{type:Ve.STRING},description:{type:Ve.STRING},targetAudience:{type:Ve.STRING},milestones:{type:Ve.ARRAY,items:{type:Ve.OBJECT,properties:{title:{type:Ve.STRING},description:{type:Ve.STRING}},required:["title","description"]}},initialTasks:{type:Ve.ARRAY,items:{type:Ve.OBJECT,properties:{title:{type:Ve.STRING},priority:{type:Ve.STRING,enum:["Low","Medium","High"]}},required:["title","priority"]}},suggestedTechStack:{type:Ve.ARRAY,items:{type:Ve.STRING}}},required:["title","description","targetAudience","milestones","initialTasks"]},o=await oo(c=>c.models.generateContent({model:"gemini-2.0-flash",contents:`Create a comprehensive project blueprint for this idea: "${t}". 
            Flesh out the name, a compelling description, identify the target audience, 
            plan 3-5 major milestones, and list 5-8 initial setup and development tasks.`,config:{responseMimeType:"application/json",responseSchema:s,temperature:.8}}));return{...JSON.parse(o.text||"{}"),id:`blueprint-${Date.now()}`,createdAt:new Date}}catch(e){throw console.error("Gemini Blueprint Error:",e),e}},xk=async t=>{try{const e=io(),s={type:Ve.ARRAY,items:{type:Ve.OBJECT,properties:{risk:{type:Ve.STRING},impact:{type:Ve.STRING,enum:["Low","Medium","High"]},probability:{type:Ve.STRING,enum:["Low","Medium","High"]},mitigation:{type:Ve.STRING}},required:["risk","impact","probability","mitigation"]}},o=await oo(i=>i.models.generateContent({model:"gemini-2.0-flash",contents:`Analyze the potential project risks for this project description: "${t}". 
            Identify 4-6 specific risks, assess their impact and probability, and suggest a practical mitigation strategy for each.`,config:{responseMimeType:"application/json",responseSchema:s,temperature:.6}}));return JSON.parse(o.text||"[]")}catch(e){throw console.error("Gemini Risk Analysis Error:",e),e}},gk=()=>r.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-ink p-8 md:p-12 mb-10 border border-white/5",children:[r.jsx("div",{className:"absolute top-0 right-0 -translate-y-1/2 translate-x-1/2 w-96 h-96 bg-primary/20 rounded-full blur-[120px] pointer-events-none"}),r.jsx("div",{className:"absolute bottom-0 left-0 translate-y-1/2 -translate-x-1/2 w-64 h-64 bg-indigo-500/10 rounded-full blur-[80px] pointer-events-none"}),r.jsxs("div",{className:"relative z-10 max-w-2xl",children:[r.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/5 border border-white/10 text-white/80 text-xs font-bold uppercase tracking-wider mb-6",children:[r.jsx("span",{className:"material-symbols-outlined text-[14px] text-indigo-400",children:"auto_awesome"}),"ProjectFlow AI Studio"]}),r.jsxs("h1",{className:"text-4xl md:text-5xl lg:text-6xl font-display font-bold text-white mb-6 leading-tight",children:["From Spark to ",r.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 via-white to-indigo-400 animate-gradient-xy",children:"Blueprint"}),"."]}),r.jsx("p",{className:"text-white/60 text-lg md:text-xl leading-relaxed mb-0",children:"Harness the power of Gemini 2.0 to architect projects, map out risks, and brainstorm breakthrough ideas in seconds."})]}),r.jsx("div",{className:"hidden lg:block absolute right-12 top-1/2 -translate-y-1/2 opacity-20",children:r.jsx("span",{className:"material-symbols-outlined text-[180px] text-white select-none",children:"architecture"})})]}),vk=({tool:t,title:e,description:s,icon:o,active:i,onClick:c,color:u})=>r.jsxs("button",{onClick:c,className:`
                flex flex-col text-left p-6 rounded-2xl transition-all duration-300 border-2
                ${i?"bg-white shadow-lift border-ink dark:bg-zinc-900 dark:border-white":"bg-white/50 border-transparent hover:border-ink/20 dark:bg-zinc-800/50 hover:dark:border-white/20"}
            `,children:[r.jsx("div",{className:`
                w-12 h-12 rounded-xl flex items-center justify-center mb-6 
                transition-transform duration-300 group-hover:scale-110
                ${i?"bg-ink text-white dark:bg-white dark:text-ink":`bg-${u}-100 text-${u}-600 dark:bg-${u}-900/30 dark:text-${u}-400`}
            `,children:r.jsx("span",{className:"material-symbols-outlined text-[28px]",children:o})}),r.jsx("h3",{className:`text-lg font-display font-bold mb-2 ${i?"text-ink dark:text-white":"text-ink/80 dark:text-white/80"}`,children:e}),r.jsx("p",{className:`text-sm leading-relaxed ${i?"text-muted":"text-muted/70"}`,children:s}),i&&r.jsxs("div",{className:"mt-6 flex items-center gap-2 text-xs font-bold text-ink dark:text-white animate-fade-in",children:[r.jsx("span",{children:"Active Tool"}),r.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500 animate-pulse"})]})]}),yk=({blueprint:t,onConvert:e,isConverting:s})=>r.jsxs("div",{className:"space-y-8 animate-fade-in",children:[r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx("span",{className:"text-xs font-bold text-indigo-500 uppercase tracking-widest",children:"Project Concept"}),r.jsx("h2",{className:"text-3xl font-display font-bold text-ink dark:text-white",children:t.title})]}),r.jsxs("button",{onClick:()=>e(t),disabled:s,className:"btn-primary px-8 py-3 rounded-xl flex items-center justify-center gap-2 group whitespace-nowrap",children:[r.jsx("span",{className:`material-symbols-outlined transition-transform ${s?"animate-spin":"group-hover:translate-x-1"}`,children:s?"autorenew":"rocket_launch"}),r.jsx("span",{children:s?"Launching...":"Convert to Live Project"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[r.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[r.jsxs("div",{className:"app-panel p-6 space-y-4",children:[r.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-indigo-500",children:"description"}),"Strategic Vision"]}),r.jsx("p",{className:"text-muted leading-relaxed",children:t.description}),r.jsxs("div",{className:"pt-4 border-t border-line dark:border-white/5",children:[r.jsx("h4",{className:"text-sm font-bold text-ink/60 dark:text-white/60 mb-2 uppercase tracking-tight",children:"Target Audience"}),r.jsx("p",{className:"text-sm text-muted",children:t.targetAudience})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-indigo-500",children:"flag"}),"Milestones"]}),r.jsx("div",{className:"space-y-4",children:t.milestones.map((o,i)=>r.jsxs("div",{className:"relative pl-8 pb-4 last:pb-0 border-l-2 border-indigo-100 dark:border-indigo-900/30 ml-3",children:[r.jsx("div",{className:"absolute left-[-9px] top-0 w-4 h-4 rounded-full bg-indigo-500 border-4 border-white dark:border-zinc-900 shadow-sm"}),r.jsx("h4",{className:"font-bold text-ink dark:text-white",children:o.title}),r.jsx("p",{className:"text-sm text-muted",children:o.description})]},i))})]})]}),r.jsxs("div",{className:"space-y-8",children:[r.jsxs("div",{className:"app-panel p-6 space-y-4 bg-zinc-50 dark:bg-white/5 border-dashed",children:[r.jsx("h4",{className:"text-sm font-bold flex items-center gap-2 uppercase tracking-widest text-ink/40 dark:text-white/40",children:"Build Backlog"}),r.jsx("div",{className:"space-y-3",children:t.initialTasks.map((o,i)=>r.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-white dark:bg-zinc-800 border border-line dark:border-white/5 shadow-sm",children:[r.jsx("span",{className:`w-2 h-2 rounded-full ${o.priority==="High"?"bg-rose-500":o.priority==="Medium"?"bg-amber-500":"bg-emerald-500"}`}),r.jsx("span",{className:"text-xs font-medium text-ink dark:text-white flex-1",children:o.title})]},i))})]}),t.suggestedTechStack&&r.jsxs("div",{className:"app-panel p-6 space-y-4",children:[r.jsx("h4",{className:"text-sm font-bold uppercase tracking-widest text-ink/40 dark:text-white/40",children:"Suggested Stack"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:t.suggestedTechStack.map((o,i)=>r.jsx("span",{className:"px-3 py-1 rounded-full bg-indigo-50 dark:bg-indigo-900/20 text-indigo-600 dark:text-indigo-400 text-xs font-bold border border-indigo-100 dark:border-indigo-900/30",children:o},i))})]})]})]})]}),bk=({risks:t})=>r.jsxs("div",{className:"space-y-6 animate-fade-in",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx("span",{className:"text-xs font-bold text-rose-500 uppercase tracking-widest",children:"Risk Assessment"}),r.jsx("h2",{className:"text-3xl font-display font-bold text-ink dark:text-white",children:"Risk Scout Report"}),r.jsx("p",{className:"text-muted",children:"Proactive analysis of potential roadblocks and mitigation strategies."})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map((e,s)=>r.jsxs("div",{className:"app-panel p-6 space-y-4 hover:border-rose-200 dark:hover:border-rose-900/30 transition-colors duration-300",children:[r.jsxs("div",{className:"flex items-start justify-between gap-4",children:[r.jsx("h4",{className:"font-bold text-lg text-ink dark:text-white leading-tight",children:e.risk}),r.jsxs("div",{className:"flex flex-col items-end gap-1",children:[r.jsxs("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-tight ${e.impact==="High"?"bg-rose-100 text-rose-700 dark:bg-rose-900/30 dark:text-rose-400":e.impact==="Medium"?"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400":"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400"}`,children:["Impact: ",e.impact]}),r.jsxs("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-tight ${e.probability==="High"?"bg-rose-100 text-rose-700 dark:bg-rose-900/30 dark:text-rose-400":e.probability==="Medium"?"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400":"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400"}`,children:["Prop: ",e.probability]})]})]}),r.jsxs("div",{className:"pt-4 border-t border-line dark:border-white/5",children:[r.jsxs("h5",{className:"text-xs font-bold text-emerald-600 dark:text-emerald-400 uppercase tracking-widest mb-2 flex items-center gap-1",children:[r.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"shield"}),"Mitigation Strategy"]}),r.jsx("p",{className:"text-sm text-muted leading-relaxed",children:e.mitigation})]})]},s))})]}),e0=[{id:"Architect",title:"Project Architect",description:"Turn a rough seed into a full project blueprint with milestones and tasks.",icon:"architecture",color:"indigo",placeholder:'Describe your project goal (e.g. "A marketplace for vintage cameras")....'},{id:"Brainstormer",title:"Idea Engine",description:"Generate specific, actionable ideas and features for any objective.",icon:"lightbulb",color:"amber",placeholder:'What are we brainstorming today? (e.g. "Features for a productivity app")....'},{id:"RiskScout",title:"Risk Scout",description:"Identify potential roadblocks and get strategic mitigation plans.",icon:"shield",color:"rose",placeholder:"Paste your project concept here for risk analysis..."}],Nk=()=>{var V;const{showToast:t}=vd(),[e,s]=w.useState("Architect"),[o,i]=w.useState(""),[c,u]=w.useState(!1),[m,h]=w.useState(!1),[x,v]=w.useState(null),[b,N]=w.useState([]),[T,_]=w.useState([]),[I,E]=w.useState([]),[D,z]=w.useState(!0),[A,M]=w.useState(null),B=async()=>{const Z=xe.currentUser;if(Z){const K=await vl(Z.uid);M(K)}};w.useEffect(()=>{B()},[]),w.useEffect(()=>{(async()=>{try{const K=await Xc();E(K)}catch(K){console.error(K)}finally{z(!1)}})()},[]);const L=async()=>{if(o.trim()){u(!0),e==="Architect"&&v(null),e==="Brainstormer"&&N([]),e==="RiskScout"&&_([]);try{if(e==="Architect"){const Z=await hk(o);v(Z)}else if(e==="Brainstormer"){const Z=await ck(o);N(Z);for(const F of Z)await Za(F);const K=await Xc();E(K)}else if(e==="RiskScout"){const Z=await xk(o);_(Z)}t(`Studio: ${e} analysis complete`,"success"),B()}catch(Z){console.error(Z),t(Z instanceof Error?Z.message:"Generation failed","error")}finally{u(!1)}}},X=async Z=>{h(!0);try{const K=await hm({title:Z.title,description:Z.description,status:"Planning",priority:"Medium"});for(const F of Z.initialTasks)await xa(K,F.title,void 0,void 0,F.priority,{category:["AI Generated","Setup"]});for(const F of Z.milestones)await xa(K,`Milestone: ${F.title}`,void 0,void 0,"High",{description:F.description,category:["Milestone"]});t(`Success! "${Z.title}" is now live.`,"success"),v(null),i("")}catch(K){console.error(K),t("Failed to convert blueprint to project.","error")}finally{h(!1)}},de=((V=e0.find(Z=>Z.id===e))==null?void 0:V.placeholder)||"...";return r.jsxs("div",{className:"max-w-[1200px] mx-auto px-4 md:px-6 lg:px-10 py-6 md:py-10 animate-fade-up space-y-12",children:[r.jsx(gk,{}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-5",children:e0.map(Z=>r.jsx(vk,{tool:Z.id,title:Z.title,description:Z.description,icon:Z.icon,color:Z.color,active:e===Z.id,onClick:()=>s(Z.id)},Z.id))}),r.jsxs("div",{className:"app-panel p-6 md:p-8 space-y-6 bg-white dark:bg-zinc-900 shadow-soft",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center bg-indigo-500 text-white",children:r.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"terminal"})}),r.jsx("h3",{className:"text-xl font-display font-bold text-ink dark:text-white",children:"Studio Input"})]}),A&&r.jsxs("div",{className:"flex items-center justify-between p-3 px-4 bg-zinc-50 dark:bg-white/5 rounded-xl border border-line dark:border-white/5",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted",children:[r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"token"}),r.jsx("span",{children:"AI Credit usage this month"})]}),r.jsxs("div",{className:"flex flex-col items-end",children:[r.jsxs("span",{className:"text-sm font-bold text-ink dark:text-white",children:[A.tokensUsed.toLocaleString()," / ",A.tokenLimit.toLocaleString()]}),r.jsx("div",{className:"w-32 h-1.5 bg-zinc-200 dark:bg-zinc-700 rounded-full mt-1 overflow-hidden",children:r.jsx("div",{className:`h-full rounded-full ${A.tokensUsed>=A.tokenLimit*.9?"bg-rose-500":"bg-indigo-500"}`,style:{width:`${Math.min(100,A.tokensUsed/A.tokenLimit*100)}%`}})})]})]}),r.jsx(An,{value:o,onChange:Z=>i(Z.target.value),className:"w-full p-6 text-lg",placeholder:de,rows:6}),r.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted",children:[r.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"info"}),r.jsx("span",{children:"Specific prompts yield better results. Try focusing on your unique value prop."})]}),r.jsxs("button",{onClick:L,disabled:c||!o.trim(),className:"w-full md:w-auto inline-flex items-center justify-center gap-3 px-10 py-4 btn-primary rounded-xl text-base font-bold shadow-lift disabled:opacity-50 transition-all active:scale-95",children:[r.jsx("span",{className:`material-symbols-outlined text-[22px] ${c?"animate-spin":""}`,children:c?"autorenew":"auto_awesome"}),r.jsx("span",{children:c?"Synthesizing...":`Run ${e}`})]})]})]}),(x||b.length>0||T.length>0)&&r.jsxs("div",{className:"pt-12 border-t border-line dark:border-white/5 space-y-10",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:"material-symbols-outlined text-indigo-500",children:"output"}),r.jsx("h3",{className:"text-2xl font-display font-bold",children:"Studio Results"})]}),e==="Architect"&&x&&r.jsx(yk,{blueprint:x,onConvert:X,isConverting:m}),e==="Brainstormer"&&b.length>0&&r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5 animate-fade-in",children:b.map(Z=>r.jsxs("div",{className:"app-card group relative flex flex-col p-6 hover:translate-y-[-4px] transition-transform duration-300",children:[r.jsxs("div",{className:"flex justify-between items-start mb-4",children:[r.jsx("span",{className:"app-tag bg-amber-50 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400 border-none px-3",children:Z.type}),r.jsx("span",{className:"material-symbols-outlined text-indigo-400",children:"auto_awesome"})]}),r.jsx("h4",{className:"text-ink dark:text-white text-lg font-display font-bold mb-3 leading-tight font-display",children:Z.title}),r.jsx("p",{className:"text-muted text-sm leading-relaxed flex-1",children:Z.description})]},Z.id))}),e==="RiskScout"&&T.length>0&&r.jsx(bk,{risks:T})]}),r.jsxs("div",{className:"pt-12 border-t border-line dark:border-white/5 space-y-6",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsxs("h3",{className:"text-xl font-display font-bold flex items-center gap-3 text-ink dark:text-white",children:[r.jsx("span",{className:"material-symbols-outlined text-muted",children:"history"}),"Brainstorming Archive"]})}),D?r.jsx("div",{className:"flex justify-center py-12",children:r.jsx("span",{className:"material-symbols-outlined animate-spin text-ink/20",children:"progress_activity"})}):I.length===0?r.jsx("div",{className:"text-center py-12 bg-zinc-50 dark:bg-white/5 rounded-3xl border border-dashed",children:r.jsx("p",{className:"text-muted",children:"No recent ideas found. Start by running a studio tool!"})}):r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 opacity-70",children:I.slice(0,8).map(Z=>r.jsxs("div",{className:"p-4 rounded-xl border border-line dark:border-white/5 bg-white/50 dark:bg-zinc-800/50",children:[r.jsx("h4",{className:"text-sm font-bold truncate mb-1",children:Z.title}),r.jsx("p",{className:"text-xs text-muted line-clamp-2",children:Z.description})]},Z.id))})]})]})},wk=()=>r.jsxs("div",{className:"max-w-4xl mx-auto flex flex-col gap-8 pb-10 p-8 animate-fade-up",children:[r.jsxs("div",{className:"text-center space-y-2",children:[r.jsx("h1",{className:"h2 text-[var(--color-text-main)]",children:"Start a New Project"}),r.jsx("p",{className:"text-[var(--color-text-muted)]",children:"Choose how you want to begin your new initiative."})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsx(nt,{to:"/create/form",className:"group",children:r.jsxs(Be,{hoverable:!0,className:"h-full flex flex-col items-center text-center p-8 gap-4 border-2 border-transparent hover:border-[var(--color-primary-light)]",children:[r.jsx("div",{className:"size-16 rounded-2xl bg-indigo-50 text-indigo-600 flex items-center justify-center group-hover:scale-110 transition-transform",children:r.jsx("span",{className:"material-symbols-outlined text-3xl",children:"edit_document"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"h3 mb-2 text-[var(--color-text-main)]",children:"From Scratch"}),r.jsx("p",{className:"text-sm text-[var(--color-text-muted)] leading-relaxed",children:"Define your project goals, timeline, and details manually. Best for specific, well-defined projects."})]})]})}),r.jsx(nt,{to:"/brainstorm",className:"group",children:r.jsxs(Be,{hoverable:!0,className:"h-full flex flex-col items-center text-center p-8 gap-4 border-2 border-transparent hover:border-amber-300",children:[r.jsx("div",{className:"size-16 rounded-2xl bg-amber-50 text-amber-600 flex items-center justify-center group-hover:scale-110 transition-transform",children:r.jsx("span",{className:"material-symbols-outlined text-3xl",children:"lightbulb"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"h3 mb-2 text-[var(--color-text-main)]",children:"AI Brainstorm"}),r.jsx("p",{className:"text-sm text-[var(--color-text-muted)] leading-relaxed",children:"Not sure where to start? Let Gemini AI help you structure your project idea and suggest tasks."})]})]})})]}),r.jsx("div",{className:"text-center",children:r.jsx(nt,{to:"/projects",className:"text-sm font-bold text-[var(--color-text-muted)] hover:text-[var(--color-text-main)]",children:"Cancel"})})]});var sm=function(t,e){return sm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,o){s.__proto__=o}||function(s,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(s[i]=o[i])},sm(t,e)};function Sk(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");sm(t,e);function s(){this.constructor=t}t.prototype=e===null?Object.create(e):(s.prototype=e.prototype,new s)}var yn=function(){return yn=Object.assign||function(e){for(var s,o=1,i=arguments.length;o<i;o++){s=arguments[o];for(var c in s)Object.prototype.hasOwnProperty.call(s,c)&&(e[c]=s[c])}return e},yn.apply(this,arguments)};var _f,t0;function jk(){if(t0)return _f;t0=1;var t=!1,e,s,o,i,c,u,m,h,x,v,b,N,T,_,I;function E(){if(!t){t=!0;var z=navigator.userAgent,A=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(z),M=/(Mac OS X)|(Windows)|(Linux)/.exec(z);if(N=/\b(iPhone|iP[ao]d)/.exec(z),T=/\b(iP[ao]d)/.exec(z),v=/Android/i.exec(z),_=/FBAN\/\w+;/i.exec(z),I=/Mobile/i.exec(z),b=!!/Win64/.exec(z),A){e=A[1]?parseFloat(A[1]):A[5]?parseFloat(A[5]):NaN,e&&document&&document.documentMode&&(e=document.documentMode);var B=/(?:Trident\/(\d+.\d+))/.exec(z);u=B?parseFloat(B[1])+4:e,s=A[2]?parseFloat(A[2]):NaN,o=A[3]?parseFloat(A[3]):NaN,i=A[4]?parseFloat(A[4]):NaN,i?(A=/(?:Chrome\/(\d+\.\d+))/.exec(z),c=A&&A[1]?parseFloat(A[1]):NaN):c=NaN}else e=s=o=c=i=NaN;if(M){if(M[1]){var L=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(z);m=L?parseFloat(L[1].replace("_",".")):!0}else m=!1;h=!!M[2],x=!!M[3]}else m=h=x=!1}}var D={ie:function(){return E()||e},ieCompatibilityMode:function(){return E()||u>e},ie64:function(){return D.ie()&&b},firefox:function(){return E()||s},opera:function(){return E()||o},webkit:function(){return E()||i},safari:function(){return D.webkit()},chrome:function(){return E()||c},windows:function(){return E()||h},osx:function(){return E()||m},linux:function(){return E()||x},iphone:function(){return E()||N},mobile:function(){return E()||N||T||v||I},nativeApp:function(){return E()||_},android:function(){return E()||v},ipad:function(){return E()||T}};return _f=D,_f}var Af,n0;function Tk(){if(n0)return Af;n0=1;var t=!!(typeof window<"u"&&window.document&&window.document.createElement),e={canUseDOM:t,canUseWorkers:typeof Worker<"u",canUseEventListeners:t&&!!(window.addEventListener||window.attachEvent),canUseViewport:t&&!!window.screen,isInWorker:!t};return Af=e,Af}var kf,s0;function Ck(){if(s0)return kf;s0=1;var t=Tk(),e;t.canUseDOM&&(e=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);/**
 * Checks if an event is supported in the current execution environment.
 *
 * NOTE: This will not work correctly for non-generic events such as `change`,
 * `reset`, `load`, `error`, and `select`.
 *
 * Borrows from Modernizr.
 *
 * @param {string} eventNameSuffix Event name, e.g. "click".
 * @param {?boolean} capture Check if the capture phase is supported.
 * @return {boolean} True if the event is supported.
 * @internal
 * @license Modernizr 3.0.0pre (Custom Build) | MIT
 */function s(o,i){if(!t.canUseDOM||i&&!("addEventListener"in document))return!1;var c="on"+o,u=c in document;if(!u){var m=document.createElement("div");m.setAttribute(c,"return;"),u=typeof m[c]=="function"}return!u&&e&&o==="wheel"&&(u=document.implementation.hasFeature("Events.wheel","3.0")),u}return kf=s,kf}var If,r0;function Ek(){if(r0)return If;r0=1;var t=jk(),e=Ck(),s=10,o=40,i=800;function c(u){var m=0,h=0,x=0,v=0;return"detail"in u&&(h=u.detail),"wheelDelta"in u&&(h=-u.wheelDelta/120),"wheelDeltaY"in u&&(h=-u.wheelDeltaY/120),"wheelDeltaX"in u&&(m=-u.wheelDeltaX/120),"axis"in u&&u.axis===u.HORIZONTAL_AXIS&&(m=h,h=0),x=m*s,v=h*s,"deltaY"in u&&(v=u.deltaY),"deltaX"in u&&(x=u.deltaX),(x||v)&&u.deltaMode&&(u.deltaMode==1?(x*=o,v*=o):(x*=i,v*=i)),x&&!m&&(m=x<1?-1:1),v&&!h&&(h=v<1?-1:1),{spinX:m,spinY:h,pixelX:x,pixelY:v}}return c.getEventType=function(){return t.firefox()?"DOMMouseScroll":e("wheel")?"wheel":"mousewheel"},If=c,If}var Mf,a0;function _k(){return a0||(a0=1,Mf=Ek()),Mf}var Ak=_k();const kk=Vw(Ak);function Ik(t,e,s,o,i,c){c===void 0&&(c=0);var u=ri(t,e,c),m=u.width,h=u.height,x=Math.min(m,s),v=Math.min(h,o);return x>v*i?{width:v*i,height:v}:{width:x,height:x/i}}function Mk(t){return t.width>t.height?t.width/t.naturalWidth:t.height/t.naturalHeight}function nl(t,e,s,o,i){i===void 0&&(i=0);var c=ri(e.width,e.height,i),u=c.width,m=c.height;return{x:o0(t.x,u,s.width,o),y:o0(t.y,m,s.height,o)}}function o0(t,e,s,o){var i=e*o/2-s/2;return yd(t,-i,i)}function i0(t,e){return Math.sqrt(Math.pow(t.y-e.y,2)+Math.pow(t.x-e.x,2))}function l0(t,e){return Math.atan2(e.y-t.y,e.x-t.x)*180/Math.PI}function Rk(t,e,s,o,i,c,u){c===void 0&&(c=0),u===void 0&&(u=!0);var m=u?Dk:Uk,h=ri(e.width,e.height,c),x=ri(e.naturalWidth,e.naturalHeight,c),v={x:m(100,((h.width-s.width/i)/2-t.x/i)/h.width*100),y:m(100,((h.height-s.height/i)/2-t.y/i)/h.height*100),width:m(100,s.width/h.width*100/i),height:m(100,s.height/h.height*100/i)},b=Math.round(m(x.width,v.width*x.width/100)),N=Math.round(m(x.height,v.height*x.height/100)),T=x.width>=x.height*o,_=T?{width:Math.round(N*o),height:N}:{width:b,height:Math.round(b/o)},I=yn(yn({},_),{x:Math.round(m(x.width-_.width,v.x*x.width/100)),y:Math.round(m(x.height-_.height,v.y*x.height/100))});return{croppedAreaPercentages:v,croppedAreaPixels:I}}function Dk(t,e){return Math.min(t,Math.max(0,e))}function Uk(t,e){return e}function Pk(t,e,s,o,i,c){var u=ri(e.width,e.height,s),m=yd(o.width/u.width*(100/t.width),i,c),h={x:m*u.width/2-o.width/2-u.width*m*(t.x/100),y:m*u.height/2-o.height/2-u.height*m*(t.y/100)};return{crop:h,zoom:m}}function Lk(t,e,s){var o=Mk(e);return s.height>s.width?s.height/(t.height*o):s.width/(t.width*o)}function zk(t,e,s,o,i,c){s===void 0&&(s=0);var u=ri(e.naturalWidth,e.naturalHeight,s),m=yd(Lk(t,e,o),i,c),h=o.height>o.width?o.height/t.height:o.width/t.width,x={x:((u.width-t.width)/2-t.x)*h,y:((u.height-t.height)/2-t.y)*h};return{crop:x,zoom:m}}function c0(t,e){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}function Gk(t){return t*Math.PI/180}function ri(t,e,s){var o=Gk(s);return{width:Math.abs(Math.cos(o)*t)+Math.abs(Math.sin(o)*e),height:Math.abs(Math.sin(o)*t)+Math.abs(Math.cos(o)*e)}}function yd(t,e,s){return Math.min(Math.max(t,e),s)}function Lc(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.filter(function(s){return typeof s=="string"&&s.length>0}).join(" ").trim()}var Hk=`.reactEasyCrop_Container {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: hidden;
  user-select: none;
  touch-action: none;
  cursor: move;
  display: flex;
  justify-content: center;
  align-items: center;
}

.reactEasyCrop_Image,
.reactEasyCrop_Video {
  will-change: transform; /* this improves performances and prevent painting issues on iOS Chrome */
}

.reactEasyCrop_Contain {
  max-width: 100%;
  max-height: 100%;
  margin: auto;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
}
.reactEasyCrop_Cover_Horizontal {
  width: 100%;
  height: auto;
}
.reactEasyCrop_Cover_Vertical {
  width: auto;
  height: 100%;
}

.reactEasyCrop_CropArea {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  border: 1px solid rgba(255, 255, 255, 0.5);
  box-sizing: border-box;
  box-shadow: 0 0 0 9999em;
  color: rgba(0, 0, 0, 0.5);
  overflow: hidden;
}

.reactEasyCrop_CropAreaRound {
  border-radius: 50%;
}

.reactEasyCrop_CropAreaGrid::before {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 0;
  bottom: 0;
  left: 33.33%;
  right: 33.33%;
  border-top: 0;
  border-bottom: 0;
}

.reactEasyCrop_CropAreaGrid::after {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 33.33%;
  bottom: 33.33%;
  left: 0;
  right: 0;
  border-left: 0;
  border-right: 0;
}
`,Ok=1,qk=3,Fk=1,Nb=(function(t){Sk(e,t);function e(){var s=t!==null&&t.apply(this,arguments)||this;return s.cropperRef=w.createRef(),s.imageRef=w.createRef(),s.videoRef=w.createRef(),s.containerPosition={x:0,y:0},s.containerRef=null,s.styleRef=null,s.containerRect=null,s.mediaSize={width:0,height:0,naturalWidth:0,naturalHeight:0},s.dragStartPosition={x:0,y:0},s.dragStartCrop={x:0,y:0},s.gestureZoomStart=0,s.gestureRotationStart=0,s.isTouching=!1,s.lastPinchDistance=0,s.lastPinchRotation=0,s.rafDragTimeout=null,s.rafPinchTimeout=null,s.wheelTimer=null,s.currentDoc=typeof document<"u"?document:null,s.currentWindow=typeof window<"u"?window:null,s.resizeObserver=null,s.previousCropSize=null,s.isInitialized=!1,s.state={cropSize:null,hasWheelJustStarted:!1,mediaObjectFit:void 0},s.initResizeObserver=function(){if(!(typeof window.ResizeObserver>"u"||!s.containerRef)){var o=!0;s.resizeObserver=new window.ResizeObserver(function(i){if(o){o=!1;return}s.computeSizes()}),s.resizeObserver.observe(s.containerRef)}},s.preventZoomSafari=function(o){return o.preventDefault()},s.cleanEvents=function(){s.currentDoc&&(s.currentDoc.removeEventListener("mousemove",s.onMouseMove),s.currentDoc.removeEventListener("mouseup",s.onDragStopped),s.currentDoc.removeEventListener("touchmove",s.onTouchMove),s.currentDoc.removeEventListener("touchend",s.onDragStopped),s.currentDoc.removeEventListener("gesturechange",s.onGestureChange),s.currentDoc.removeEventListener("gestureend",s.onGestureEnd),s.currentDoc.removeEventListener("scroll",s.onScroll))},s.clearScrollEvent=function(){s.containerRef&&s.containerRef.removeEventListener("wheel",s.onWheel),s.wheelTimer&&clearTimeout(s.wheelTimer)},s.onMediaLoad=function(){var o=s.computeSizes();o&&(s.previousCropSize=o,s.emitCropData(),s.setInitialCrop(o),s.isInitialized=!0),s.props.onMediaLoaded&&s.props.onMediaLoaded(s.mediaSize)},s.setInitialCrop=function(o){if(s.props.initialCroppedAreaPercentages){var i=Pk(s.props.initialCroppedAreaPercentages,s.mediaSize,s.props.rotation,o,s.props.minZoom,s.props.maxZoom),c=i.crop,u=i.zoom;s.props.onCropChange(c),s.props.onZoomChange&&s.props.onZoomChange(u)}else if(s.props.initialCroppedAreaPixels){var m=zk(s.props.initialCroppedAreaPixels,s.mediaSize,s.props.rotation,o,s.props.minZoom,s.props.maxZoom),c=m.crop,u=m.zoom;s.props.onCropChange(c),s.props.onZoomChange&&s.props.onZoomChange(u)}},s.computeSizes=function(){var o,i,c,u,m,h,x=s.imageRef.current||s.videoRef.current;if(x&&s.containerRef){s.containerRect=s.containerRef.getBoundingClientRect(),s.saveContainerPosition();var v=s.containerRect.width/s.containerRect.height,b=((o=s.imageRef.current)===null||o===void 0?void 0:o.naturalWidth)||((i=s.videoRef.current)===null||i===void 0?void 0:i.videoWidth)||0,N=((c=s.imageRef.current)===null||c===void 0?void 0:c.naturalHeight)||((u=s.videoRef.current)===null||u===void 0?void 0:u.videoHeight)||0,T=x.offsetWidth<b||x.offsetHeight<N,_=b/N,I=void 0;if(T)switch(s.state.mediaObjectFit){default:case"contain":I=v>_?{width:s.containerRect.height*_,height:s.containerRect.height}:{width:s.containerRect.width,height:s.containerRect.width/_};break;case"horizontal-cover":I={width:s.containerRect.width,height:s.containerRect.width/_};break;case"vertical-cover":I={width:s.containerRect.height*_,height:s.containerRect.height};break}else I={width:x.offsetWidth,height:x.offsetHeight};s.mediaSize=yn(yn({},I),{naturalWidth:b,naturalHeight:N}),s.props.setMediaSize&&s.props.setMediaSize(s.mediaSize);var E=s.props.cropSize?s.props.cropSize:Ik(s.mediaSize.width,s.mediaSize.height,s.containerRect.width,s.containerRect.height,s.props.aspect,s.props.rotation);return(((m=s.state.cropSize)===null||m===void 0?void 0:m.height)!==E.height||((h=s.state.cropSize)===null||h===void 0?void 0:h.width)!==E.width)&&s.props.onCropSizeChange&&s.props.onCropSizeChange(E),s.setState({cropSize:E},s.recomputeCropPosition),s.props.setCropSize&&s.props.setCropSize(E),E}},s.saveContainerPosition=function(){if(s.containerRef){var o=s.containerRef.getBoundingClientRect();s.containerPosition={x:o.left,y:o.top}}},s.onMouseDown=function(o){s.currentDoc&&(o.preventDefault(),s.currentDoc.addEventListener("mousemove",s.onMouseMove),s.currentDoc.addEventListener("mouseup",s.onDragStopped),s.saveContainerPosition(),s.onDragStart(e.getMousePoint(o)))},s.onMouseMove=function(o){return s.onDrag(e.getMousePoint(o))},s.onScroll=function(o){s.currentDoc&&(o.preventDefault(),s.saveContainerPosition())},s.onTouchStart=function(o){s.currentDoc&&(s.isTouching=!0,!(s.props.onTouchRequest&&!s.props.onTouchRequest(o))&&(s.currentDoc.addEventListener("touchmove",s.onTouchMove,{passive:!1}),s.currentDoc.addEventListener("touchend",s.onDragStopped),s.saveContainerPosition(),o.touches.length===2?s.onPinchStart(o):o.touches.length===1&&s.onDragStart(e.getTouchPoint(o.touches[0]))))},s.onTouchMove=function(o){o.preventDefault(),o.touches.length===2?s.onPinchMove(o):o.touches.length===1&&s.onDrag(e.getTouchPoint(o.touches[0]))},s.onGestureStart=function(o){s.currentDoc&&(o.preventDefault(),s.currentDoc.addEventListener("gesturechange",s.onGestureChange),s.currentDoc.addEventListener("gestureend",s.onGestureEnd),s.gestureZoomStart=s.props.zoom,s.gestureRotationStart=s.props.rotation)},s.onGestureChange=function(o){if(o.preventDefault(),!s.isTouching){var i=e.getMousePoint(o),c=s.gestureZoomStart-1+o.scale;if(s.setNewZoom(c,i,{shouldUpdatePosition:!0}),s.props.onRotationChange){var u=s.gestureRotationStart+o.rotation;s.props.onRotationChange(u)}}},s.onGestureEnd=function(o){s.cleanEvents()},s.onDragStart=function(o){var i,c,u=o.x,m=o.y;s.dragStartPosition={x:u,y:m},s.dragStartCrop=yn({},s.props.crop),(c=(i=s.props).onInteractionStart)===null||c===void 0||c.call(i)},s.onDrag=function(o){var i=o.x,c=o.y;s.currentWindow&&(s.rafDragTimeout&&s.currentWindow.cancelAnimationFrame(s.rafDragTimeout),s.rafDragTimeout=s.currentWindow.requestAnimationFrame(function(){if(s.state.cropSize&&!(i===void 0||c===void 0)){var u=i-s.dragStartPosition.x,m=c-s.dragStartPosition.y,h={x:s.dragStartCrop.x+u,y:s.dragStartCrop.y+m},x=s.props.restrictPosition?nl(h,s.mediaSize,s.state.cropSize,s.props.zoom,s.props.rotation):h;s.props.onCropChange(x)}}))},s.onDragStopped=function(){var o,i;s.isTouching=!1,s.cleanEvents(),s.emitCropData(),(i=(o=s.props).onInteractionEnd)===null||i===void 0||i.call(o)},s.onWheel=function(o){if(s.currentWindow&&!(s.props.onWheelRequest&&!s.props.onWheelRequest(o))){o.preventDefault();var i=e.getMousePoint(o),c=kk(o).pixelY,u=s.props.zoom-c*s.props.zoomSpeed/200;s.setNewZoom(u,i,{shouldUpdatePosition:!0}),s.state.hasWheelJustStarted||s.setState({hasWheelJustStarted:!0},function(){var m,h;return(h=(m=s.props).onInteractionStart)===null||h===void 0?void 0:h.call(m)}),s.wheelTimer&&clearTimeout(s.wheelTimer),s.wheelTimer=s.currentWindow.setTimeout(function(){return s.setState({hasWheelJustStarted:!1},function(){var m,h;return(h=(m=s.props).onInteractionEnd)===null||h===void 0?void 0:h.call(m)})},250)}},s.getPointOnContainer=function(o,i){var c=o.x,u=o.y;if(!s.containerRect)throw new Error("The Cropper is not mounted");return{x:s.containerRect.width/2-(c-i.x),y:s.containerRect.height/2-(u-i.y)}},s.getPointOnMedia=function(o){var i=o.x,c=o.y,u=s.props,m=u.crop,h=u.zoom;return{x:(i+m.x)/h,y:(c+m.y)/h}},s.setNewZoom=function(o,i,c){var u=c===void 0?{}:c,m=u.shouldUpdatePosition,h=m===void 0?!0:m;if(!(!s.state.cropSize||!s.props.onZoomChange)){var x=yd(o,s.props.minZoom,s.props.maxZoom);if(h){var v=s.getPointOnContainer(i,s.containerPosition),b=s.getPointOnMedia(v),N={x:b.x*x-v.x,y:b.y*x-v.y},T=s.props.restrictPosition?nl(N,s.mediaSize,s.state.cropSize,x,s.props.rotation):N;s.props.onCropChange(T)}s.props.onZoomChange(x)}},s.getCropData=function(){if(!s.state.cropSize)return null;var o=s.props.restrictPosition?nl(s.props.crop,s.mediaSize,s.state.cropSize,s.props.zoom,s.props.rotation):s.props.crop;return Rk(o,s.mediaSize,s.state.cropSize,s.getAspect(),s.props.zoom,s.props.rotation,s.props.restrictPosition)},s.emitCropData=function(){var o=s.getCropData();if(o){var i=o.croppedAreaPercentages,c=o.croppedAreaPixels;s.props.onCropComplete&&s.props.onCropComplete(i,c),s.props.onCropAreaChange&&s.props.onCropAreaChange(i,c)}},s.emitCropAreaChange=function(){var o=s.getCropData();if(o){var i=o.croppedAreaPercentages,c=o.croppedAreaPixels;s.props.onCropAreaChange&&s.props.onCropAreaChange(i,c)}},s.recomputeCropPosition=function(){var o,i;if(s.state.cropSize){var c=s.props.crop;if(s.isInitialized&&(!((o=s.previousCropSize)===null||o===void 0)&&o.width)&&(!((i=s.previousCropSize)===null||i===void 0)&&i.height)){var u=Math.abs(s.previousCropSize.width-s.state.cropSize.width)>1e-6||Math.abs(s.previousCropSize.height-s.state.cropSize.height)>1e-6;if(u){var m=s.state.cropSize.width/s.previousCropSize.width,h=s.state.cropSize.height/s.previousCropSize.height;c={x:s.props.crop.x*m,y:s.props.crop.y*h}}}var x=s.props.restrictPosition?nl(c,s.mediaSize,s.state.cropSize,s.props.zoom,s.props.rotation):c;s.previousCropSize=s.state.cropSize,s.props.onCropChange(x),s.emitCropData()}},s.onKeyDown=function(o){var i,c,u=s.props,m=u.crop,h=u.onCropChange,x=u.keyboardStep,v=u.zoom,b=u.rotation,N=x;if(s.state.cropSize){o.shiftKey&&(N*=.2);var T=yn({},m);switch(o.key){case"ArrowUp":T.y-=N,o.preventDefault();break;case"ArrowDown":T.y+=N,o.preventDefault();break;case"ArrowLeft":T.x-=N,o.preventDefault();break;case"ArrowRight":T.x+=N,o.preventDefault();break;default:return}s.props.restrictPosition&&(T=nl(T,s.mediaSize,s.state.cropSize,v,b)),o.repeat||(c=(i=s.props).onInteractionStart)===null||c===void 0||c.call(i),h(T)}},s.onKeyUp=function(o){var i,c;switch(o.key){case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":o.preventDefault();break;default:return}s.emitCropData(),(c=(i=s.props).onInteractionEnd)===null||c===void 0||c.call(i)},s}return e.prototype.componentDidMount=function(){!this.currentDoc||!this.currentWindow||(this.containerRef&&(this.containerRef.ownerDocument&&(this.currentDoc=this.containerRef.ownerDocument),this.currentDoc.defaultView&&(this.currentWindow=this.currentDoc.defaultView),this.initResizeObserver(),typeof window.ResizeObserver>"u"&&this.currentWindow.addEventListener("resize",this.computeSizes),this.props.zoomWithScroll&&this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}),this.containerRef.addEventListener("gesturestart",this.onGestureStart)),this.currentDoc.addEventListener("scroll",this.onScroll),this.props.disableAutomaticStylesInjection||(this.styleRef=this.currentDoc.createElement("style"),this.styleRef.setAttribute("type","text/css"),this.props.nonce&&this.styleRef.setAttribute("nonce",this.props.nonce),this.styleRef.innerHTML=Hk,this.currentDoc.head.appendChild(this.styleRef)),this.imageRef.current&&this.imageRef.current.complete&&this.onMediaLoad(),this.props.setImageRef&&this.props.setImageRef(this.imageRef),this.props.setVideoRef&&this.props.setVideoRef(this.videoRef),this.props.setCropperRef&&this.props.setCropperRef(this.cropperRef))},e.prototype.componentWillUnmount=function(){var s,o;!this.currentDoc||!this.currentWindow||(typeof window.ResizeObserver>"u"&&this.currentWindow.removeEventListener("resize",this.computeSizes),(s=this.resizeObserver)===null||s===void 0||s.disconnect(),this.containerRef&&this.containerRef.removeEventListener("gesturestart",this.preventZoomSafari),this.styleRef&&((o=this.styleRef.parentNode)===null||o===void 0||o.removeChild(this.styleRef)),this.cleanEvents(),this.props.zoomWithScroll&&this.clearScrollEvent())},e.prototype.componentDidUpdate=function(s){var o,i,c,u,m,h,x,v,b;s.rotation!==this.props.rotation?(this.computeSizes(),this.recomputeCropPosition()):s.aspect!==this.props.aspect?this.computeSizes():s.objectFit!==this.props.objectFit?this.computeSizes():s.zoom!==this.props.zoom?this.recomputeCropPosition():((o=s.cropSize)===null||o===void 0?void 0:o.height)!==((i=this.props.cropSize)===null||i===void 0?void 0:i.height)||((c=s.cropSize)===null||c===void 0?void 0:c.width)!==((u=this.props.cropSize)===null||u===void 0?void 0:u.width)?this.computeSizes():(((m=s.crop)===null||m===void 0?void 0:m.x)!==((h=this.props.crop)===null||h===void 0?void 0:h.x)||((x=s.crop)===null||x===void 0?void 0:x.y)!==((v=this.props.crop)===null||v===void 0?void 0:v.y))&&this.emitCropAreaChange(),s.zoomWithScroll!==this.props.zoomWithScroll&&this.containerRef&&(this.props.zoomWithScroll?this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}):this.clearScrollEvent()),s.video!==this.props.video&&((b=this.videoRef.current)===null||b===void 0||b.load());var N=this.getObjectFit();N!==this.state.mediaObjectFit&&this.setState({mediaObjectFit:N},this.computeSizes)},e.prototype.getAspect=function(){var s=this.props,o=s.cropSize,i=s.aspect;return o?o.width/o.height:i},e.prototype.getObjectFit=function(){var s,o,i,c;if(this.props.objectFit==="cover"){var u=this.imageRef.current||this.videoRef.current;if(u&&this.containerRef){this.containerRect=this.containerRef.getBoundingClientRect();var m=this.containerRect.width/this.containerRect.height,h=((s=this.imageRef.current)===null||s===void 0?void 0:s.naturalWidth)||((o=this.videoRef.current)===null||o===void 0?void 0:o.videoWidth)||0,x=((i=this.imageRef.current)===null||i===void 0?void 0:i.naturalHeight)||((c=this.videoRef.current)===null||c===void 0?void 0:c.videoHeight)||0,v=h/x;return v<m?"horizontal-cover":"vertical-cover"}return"horizontal-cover"}return this.props.objectFit},e.prototype.onPinchStart=function(s){var o=e.getTouchPoint(s.touches[0]),i=e.getTouchPoint(s.touches[1]);this.lastPinchDistance=i0(o,i),this.lastPinchRotation=l0(o,i),this.onDragStart(c0(o,i))},e.prototype.onPinchMove=function(s){var o=this;if(!(!this.currentDoc||!this.currentWindow)){var i=e.getTouchPoint(s.touches[0]),c=e.getTouchPoint(s.touches[1]),u=c0(i,c);this.onDrag(u),this.rafPinchTimeout&&this.currentWindow.cancelAnimationFrame(this.rafPinchTimeout),this.rafPinchTimeout=this.currentWindow.requestAnimationFrame(function(){var m=i0(i,c),h=o.props.zoom*(m/o.lastPinchDistance);o.setNewZoom(h,u,{shouldUpdatePosition:!1}),o.lastPinchDistance=m;var x=l0(i,c),v=o.props.rotation+(x-o.lastPinchRotation);o.props.onRotationChange&&o.props.onRotationChange(v),o.lastPinchRotation=x})}},e.prototype.render=function(){var s=this,o,i=this.props,c=i.image,u=i.video,m=i.mediaProps,h=i.cropperProps,x=i.transform,v=i.crop,b=v.x,N=v.y,T=i.rotation,_=i.zoom,I=i.cropShape,E=i.showGrid,D=i.roundCropAreaPixels,z=i.style,A=z.containerStyle,M=z.cropAreaStyle,B=z.mediaStyle,L=i.classes,X=L.containerClassName,de=L.cropAreaClassName,V=L.mediaClassName,Z=(o=this.state.mediaObjectFit)!==null&&o!==void 0?o:this.getObjectFit();return w.createElement("div",{onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,ref:function(F){return s.containerRef=F},"data-testid":"container",style:A,className:Lc("reactEasyCrop_Container",X)},c?w.createElement("img",yn({alt:"",className:Lc("reactEasyCrop_Image",Z==="contain"&&"reactEasyCrop_Contain",Z==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",Z==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",V)},m,{src:c,ref:this.imageRef,style:yn(yn({},B),{transform:x||"translate(".concat(b,"px, ").concat(N,"px) rotate(").concat(T,"deg) scale(").concat(_,")")}),onLoad:this.onMediaLoad})):u&&w.createElement("video",yn({autoPlay:!0,playsInline:!0,loop:!0,muted:!0,className:Lc("reactEasyCrop_Video",Z==="contain"&&"reactEasyCrop_Contain",Z==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",Z==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",V)},m,{ref:this.videoRef,onLoadedMetadata:this.onMediaLoad,style:yn(yn({},B),{transform:x||"translate(".concat(b,"px, ").concat(N,"px) rotate(").concat(T,"deg) scale(").concat(_,")")}),controls:!1}),(Array.isArray(u)?u:[{src:u}]).map(function(K){return w.createElement("source",yn({key:K.src},K))})),this.state.cropSize&&w.createElement("div",yn({ref:this.cropperRef,style:yn(yn({},M),{width:D?Math.round(this.state.cropSize.width):this.state.cropSize.width,height:D?Math.round(this.state.cropSize.height):this.state.cropSize.height}),tabIndex:0,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,"data-testid":"cropper",className:Lc("reactEasyCrop_CropArea",I==="round"&&"reactEasyCrop_CropAreaRound",E&&"reactEasyCrop_CropAreaGrid",de)},h)))},e.defaultProps={zoom:1,rotation:0,aspect:4/3,maxZoom:qk,minZoom:Ok,cropShape:"rect",objectFit:"contain",showGrid:!0,style:{},classes:{},mediaProps:{},cropperProps:{},zoomSpeed:1,restrictPosition:!0,zoomWithScroll:!0,keyboardStep:Fk},e.getMousePoint=function(s){return{x:Number(s.clientX),y:Number(s.clientY)}},e.getTouchPoint=function(s){return{x:Number(s.clientX),y:Number(s.clientY)}},e})(w.Component);const _r=({isOpen:t,onClose:e,title:s,children:o,footer:i,size:c="md",className:u=""})=>{const m=w.useRef(null);if(w.useEffect(()=>{const x=v=>{v.key==="Escape"&&e()};return t&&(document.addEventListener("keydown",x),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",x),document.body.style.overflow=""}},[t,e]),!t)return null;const h={sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"};return sr.createPortal(r.jsxs("div",{className:`fixed inset-0 flex items-center justify-center p-4 sm:p-6 ${u||"z-50"}`,children:[r.jsx("div",{ref:m,className:"absolute inset-0 bg-black/40 backdrop-blur-sm transition-opacity",onClick:e,"aria-hidden":"true"}),r.jsxs("div",{className:`
                relative w-full ${h[c]} bg-[var(--color-surface-card)] rounded-xl shadow-xl 
                border border-[var(--color-surface-border)] flex flex-col max-h-[90vh] animate-in fade-in zoom-in-95 duration-200
            `,children:[r.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-[var(--color-surface-border)]",children:[r.jsx("h2",{className:"text-lg font-bold text-[var(--color-text-main)]",children:s}),r.jsx("button",{onClick:e,className:"p-1 rounded-full text-[var(--color-text-muted)] hover:bg-[var(--color-surface-hover)] hover:text-[var(--color-text-main)] transition-colors",children:r.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"close"})})]}),r.jsx("div",{className:"p-6 overflow-y-auto",children:o}),i&&r.jsx("div",{className:"flex items-center justify-end gap-3 px-6 py-4 border-t border-[var(--color-surface-border)] bg-[var(--color-surface-bg)] rounded-b-xl",children:i})]})]}),document.body)},Vk=t=>new Promise((e,s)=>{const o=new Image;o.addEventListener("load",()=>e(o)),o.addEventListener("error",i=>s(i)),o.setAttribute("crossOrigin","anonymous"),o.src=t});function wb(t){return t*Math.PI/180}function Bk(t,e,s){const o=wb(s);return{width:Math.abs(Math.cos(o)*t)+Math.abs(Math.sin(o)*e),height:Math.abs(Math.sin(o)*t)+Math.abs(Math.cos(o)*e)}}async function Sb(t,e,s=0,o={horizontal:!1,vertical:!1}){const i=await Vk(t),c=document.createElement("canvas"),u=c.getContext("2d");if(!u)return null;const m=wb(s),{width:h,height:x}=Bk(i.width,i.height,s);c.width=h,c.height=x,u.translate(h/2,x/2),u.rotate(m),u.scale(o.horizontal?-1:1,o.vertical?-1:1),u.translate(-i.width/2,-i.height/2),u.drawImage(i,0,0);const v=u.getImageData(e.x,e.y,e.width,e.height);return c.width=e.width,c.height=e.height,u.putImageData(v,0,0),new Promise((b,N)=>{c.toBlob(T=>{T?b(T):N(new Error("Canvas is empty"))},"image/jpeg")})}const jb=({imageSrc:t,aspectRatio:e,onCropComplete:s,onCancel:o,isOpen:i})=>{const[c,u]=w.useState({x:0,y:0}),[m,h]=w.useState(1),[x,v]=w.useState(null),[b,N]=w.useState(!1),T=D=>{u(D)},_=D=>{h(D)},I=w.useCallback((D,z)=>{v(z)},[]),E=async()=>{if(!(!t||!x)){N(!0);try{const D=await Sb(t,x);D&&s(D)}catch(D){console.error(D)}finally{N(!1)}}};return r.jsxs(_r,{isOpen:i,onClose:o,title:"Crop Image",size:"lg",className:"z-[60]",footer:r.jsxs(r.Fragment,{children:[r.jsx(Ne,{variant:"ghost",onClick:o,children:"Cancel"}),r.jsx(Ne,{onClick:E,loading:b,children:"Apply Crop"})]}),children:[r.jsx("div",{className:"relative w-full h-[400px] bg-black rounded-lg overflow-hidden",children:t&&r.jsx(Nb,{image:t,crop:c,zoom:m,aspect:e,onCropChange:T,onCropComplete:I,onZoomChange:_})}),r.jsxs("div",{className:"mt-4 flex items-center gap-4",children:[r.jsx("span",{className:"text-sm text-[var(--color-text-muted)]",children:"Zoom"}),r.jsx("input",{type:"range",value:m,min:1,max:3,step:.1,"aria-labelledby":"Zoom",onChange:D=>h(Number(D.target.value)),className:"w-full h-1 bg-[var(--color-surface-border)] rounded-lg appearance-none cursor-pointer accent-[var(--color-primary)]"})]})]})},$k=()=>{const t=dn(),{can:e}=Um(),[s,o]=w.useState(1),[i,c]=w.useState(""),[u,m]=w.useState(""),[h,x]=w.useState(""),[v,b]=w.useState(""),[N,T]=w.useState("Medium"),[_,I]=w.useState("Planning"),[E,D]=w.useState(["tasks","ideas","activity"]),[z,A]=w.useState([]),[M,B]=w.useState(null),[L,X]=w.useState(null),[de,V]=w.useState([]),[Z,K]=w.useState(null),[F,le]=w.useState(1),[he,re]=w.useState(null),[q,H]=w.useState(!1),[R,ue]=w.useState(!1),Y=w.useMemo(()=>h||void 0,[h]),ye=(me,Ae)=>{if(me.target.files&&me.target.files[0]){const De=me.target.files[0],Ee=new FileReader;Ee.onload=()=>{K(Ee.result),re(Ae),le(Ae==="cover"?16/9:1)},Ee.readAsDataURL(De)}me.target.value=""},je=me=>{if(me.target.files){const Ae=Array.from(me.target.files);V(De=>[...De,...Ae])}me.target.value=""},J=me=>{if(he==="cover"){const Ae=new File([me],"cover.jpg",{type:"image/jpeg"});B(Ae)}else if(he==="icon"){const Ae=new File([me],"icon.jpg",{type:"image/jpeg"});X(Ae)}we()},we=()=>{K(null),re(null)},be=async me=>{if(me.preventDefault(),!!i){ue(!0);try{await hm({title:i,description:u,startDate:h,dueDate:v,priority:N,status:_,modules:E,links:z},M||void 0,L||void 0,de.length?de:void 0),t("/projects")}catch(Ae){console.error("Error creating project:",Ae)}finally{ue(!1)}}};return e("canCreateProjects")?r.jsxs("div",{className:"max-w-5xl mx-auto flex flex-col gap-8 pb-10 p-4 animate-fade-up",children:[r.jsx(jb,{isOpen:!!Z,imageSrc:Z,aspectRatio:F,onCropComplete:J,onCancel:we}),r.jsxs("div",{className:"flex flex-col gap-2",children:[r.jsxs("nav",{className:"flex text-sm text-[var(--color-text-muted)] font-medium items-center gap-2",children:[r.jsx(nt,{to:"/projects",className:"hover:text-[var(--color-text-main)] transition-colors",children:"Projects"}),r.jsx("span",{children:"/"}),r.jsx(nt,{to:"/create",className:"hover:text-[var(--color-text-main)] transition-colors",children:"New"})]}),r.jsxs("div",{className:"flex justify-between items-end",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"h2 text-[var(--color-text-main)]",children:s===1?"Choose Template":"Project Details"}),r.jsx("p",{className:"text-[var(--color-text-muted)] text-sm",children:s===1?"Start with a pre-configured setup or customize your modules.":"Define your project goals and timeline."})]}),s===2&&r.jsxs("div",{className:"flex gap-3",children:[r.jsx(Ne,{variant:"ghost",onClick:()=>o(1),children:"Back"}),r.jsx(Ne,{onClick:be,isLoading:R,icon:r.jsx("span",{className:"material-symbols-outlined",children:"check"}),children:"Create Project"})]})]})]}),s===1&&r.jsxs("div",{className:"space-y-8",children:[r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[{id:"default",title:"Standard",desc:"Tasks, Ideas & Activity",modules:["tasks","ideas","activity"]},{id:"software",title:"Software",desc:"Tasks, Issues & Activity",modules:["tasks","issues","activity"]},{id:"creative",title:"Creative",desc:"Ideas, Mindmap & Activity",modules:["ideas","mindmap","activity"]}].map(me=>r.jsxs("div",{onClick:()=>D(me.modules),className:`
                                    cursor-pointer p-6 rounded-2xl border-2 transition-all text-center flex flex-col items-center gap-4 group
                                    ${JSON.stringify(E.sort())===JSON.stringify(me.modules.sort())?"border-[var(--color-text-main)] bg-[var(--color-surface-card)] shadow-lg":"border-[var(--color-surface-border)] bg-[var(--color-surface-card)] hover:border-[var(--color-surface-border)] hover:bg-[var(--color-surface-hover)]"}
                                `,children:[r.jsx("div",{className:`
                                    size-14 rounded-full flex items-center justify-center transition-colors
                                    ${JSON.stringify(E.sort())===JSON.stringify(me.modules.sort())?"bg-[var(--color-text-main)] text-[var(--color-surface-bg)]":"bg-[var(--color-surface-hover)] text-[var(--color-text-main)] group-hover:bg-[var(--color-surface-border)]"}
                                `,children:r.jsx("span",{className:"material-symbols-outlined text-[28px]",children:me.id==="default"?"folder_open":me.id==="software"?"terminal":"palette"})}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-bold text-lg",children:me.title}),r.jsx("p",{className:"text-sm text-[var(--color-text-muted)]",children:me.desc})]})]},me.id))}),r.jsxs(Be,{className:"p-6",children:[r.jsxs("h3",{className:"h4 flex items-center gap-2 mb-4",children:[r.jsx("span",{className:"material-symbols-outlined",children:"tune"}),"Customize Modules"]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[{id:"tasks",label:"Tasks",desc:"Manage todos and milestones"},{id:"ideas",label:"Ideas",desc:"Brainstorming and concepts"},{id:"mindmap",label:"Mindmap",desc:"Visual planning board"},{id:"activity",label:"Activity",desc:"Track project history"},{id:"issues",label:"Issues",desc:"Bug tracking and tickets"}].map(me=>r.jsxs("div",{onClick:()=>{const Ae=E.includes(me.id)?E.filter(De=>De!==me.id):[...E,me.id];D(Ae)},className:`
                                        cursor-pointer p-3 rounded-lg border transition-all flex items-center gap-3
                                        ${E.includes(me.id)?"border-[var(--color-text-main)] bg-[var(--color-surface-hover)]":"border-[var(--color-surface-border)] hover:bg-[var(--color-surface-hover)]"}
                                    `,children:[r.jsx("div",{className:`
                                        size-5 rounded border flex items-center justify-center transition-colors
                                        ${E.includes(me.id)?"bg-[var(--color-text-main)] border-[var(--color-text-main)]":"border-[var(--color-text-subtle)]"}
                                    `,children:E.includes(me.id)&&r.jsx("span",{className:"material-symbols-outlined text-[var(--color-surface-bg)] text-[14px] font-bold",children:"check"})}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-bold text-sm",children:me.label}),r.jsx("p",{className:"text-xs text-[var(--color-text-muted)]",children:me.desc})]})]},me.id))})]}),r.jsx("div",{className:"flex justify-end pt-4",children:r.jsx(Ne,{size:"lg",onClick:()=>o(2),icon:r.jsx("span",{className:"material-symbols-outlined",children:"arrow_forward"}),children:"Next Step"})})]}),s===2&&r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 animate-fade-in",children:[r.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[r.jsxs(Be,{className:"space-y-6",children:[r.jsxs("h3",{className:"h4 flex items-center gap-2 border-b border-[var(--color-surface-border)] pb-3",children:[r.jsx("span",{className:"material-symbols-outlined",children:"feed"}),"Essentials"]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx(st,{label:"Project Name",value:i,onChange:me=>c(me.target.value),placeholder:"e.g. Q4 Marketing Campaign",required:!0,autoFocus:!0}),r.jsx(An,{label:"Description",value:u,onChange:me=>m(me.target.value),placeholder:"Describe the project goals...",rows:5})]})]}),r.jsxs(Be,{className:"space-y-6",children:[r.jsxs("h3",{className:"h4 flex items-center gap-2 border-b border-[var(--color-surface-border)] pb-3",children:[r.jsx("span",{className:"material-symbols-outlined",children:"date_range"}),"Planning"]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsx(st,{label:"Start Date",type:"date",value:h,onChange:me=>x(me.target.value)}),r.jsx(st,{label:"Due Date",type:"date",value:v,min:Y,onChange:me=>b(me.target.value)}),r.jsx(xn,{label:"Priority",value:N,onChange:me=>T(me.target.value),children:["Low","Medium","High","Urgent"].map(me=>r.jsx("option",{children:me},me))}),r.jsx(xn,{label:"Status",value:_,onChange:me=>I(me.target.value),children:["Planning","Active","On Hold"].map(me=>r.jsx("option",{children:me},me))})]})]}),r.jsxs(Be,{className:"space-y-4",children:[r.jsx("h3",{className:"text-xs font-semibold text-[var(--color-text-muted)] uppercase tracking-wider ml-1 border-b border-[var(--color-surface-border)] pb-3",children:"External Links"}),r.jsxs("div",{className:"space-y-3",children:[z.map((me,Ae)=>r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("div",{className:"flex-1 space-y-1",children:[r.jsx(st,{placeholder:"Title",value:me.title,onChange:De=>{const Ee=[...z];Ee[Ae].title=De.target.value,A(Ee)},className:"w-full"}),r.jsx(st,{placeholder:"URL",value:me.url,onChange:De=>{const Ee=[...z];Ee[Ae].url=De.target.value,A(Ee)},className:"w-full"})]}),r.jsx(Ne,{variant:"ghost",size:"icon",onClick:()=>A(z.filter((De,Ee)=>Ee!==Ae)),children:r.jsx("span",{className:"material-symbols-outlined",children:"close"})})]},Ae)),r.jsx(Ne,{variant:"secondary",size:"sm",onClick:()=>A([...z,{title:"",url:""}]),icon:r.jsx("span",{className:"material-symbols-outlined",children:"add"}),children:"Add Link"})]})]})]}),r.jsx("div",{className:"space-y-6",children:r.jsxs(Be,{className:"space-y-4",children:[r.jsx("h3",{className:"text-xs font-semibold text-[var(--color-text-muted)] uppercase tracking-wider ml-1 border-b border-[var(--color-surface-border)] pb-3",children:"Assets"}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-semibold text-[var(--color-text-muted)] uppercase tracking-wider ml-1",children:"Cover Image"}),r.jsxs("label",{className:"w-full h-32 rounded-xl border-2 border-dashed border-[var(--color-surface-border)] bg-[var(--color-surface-hover)] flex flex-col items-center justify-center cursor-pointer hover:border-[var(--color-text-main)] transition-colors relative overflow-hidden group",children:[r.jsx("input",{type:"file",accept:"image/*",onChange:me=>ye(me,"cover"),className:"absolute inset-0 opacity-0 cursor-pointer z-10"}),M?r.jsxs(r.Fragment,{children:[r.jsx("img",{src:URL.createObjectURL(M),alt:"Preview",className:"w-full h-full object-cover"}),r.jsx("div",{className:"absolute top-2 right-2 z-20",children:r.jsx(Ne,{size:"icon",variant:"danger",onClick:me=>{me.preventDefault(),me.stopPropagation(),B(null)},children:r.jsx("span",{className:"material-symbols-outlined",children:"delete"})})})]}):r.jsxs("div",{className:"flex flex-col items-center text-[var(--color-text-muted)] group-hover:text-[var(--color-text-main)]",children:[r.jsx("span",{className:"material-symbols-outlined",children:"image"}),r.jsx("span",{className:"text-xs font-semibold",children:"Upload Cover"})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-semibold text-[var(--color-text-muted)] uppercase tracking-wider ml-1",children:"Icon"}),r.jsxs("label",{className:"size-20 rounded-xl border-2 border-dashed border-[var(--color-surface-border)] bg-[var(--color-surface-hover)] flex flex-col items-center justify-center cursor-pointer hover:border-[var(--color-text-main)] transition-colors relative overflow-hidden group",children:[r.jsx("input",{type:"file",accept:"image/*",onChange:me=>ye(me,"icon"),className:"absolute inset-0 opacity-0 cursor-pointer z-10"}),L?r.jsxs(r.Fragment,{children:[r.jsx("img",{src:URL.createObjectURL(L),alt:"Preview",className:"w-full h-full object-cover"}),r.jsx("div",{className:"absolute -top-1 -right-1 z-20 scale-75",children:r.jsx(Ne,{size:"icon",variant:"danger",onClick:me=>{me.preventDefault(),me.stopPropagation(),X(null)},children:r.jsx("span",{className:"material-symbols-outlined",children:"close"})})})]}):r.jsx("span",{className:"material-symbols-outlined text-[var(--color-text-muted)] group-hover:text-[var(--color-text-main)]",children:"apps"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-xs font-semibold text-[var(--color-text-muted)] uppercase tracking-wider ml-1",children:"Gallery"}),r.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[de.map((me,Ae)=>r.jsxs("div",{className:"relative aspect-video rounded-lg overflow-hidden border border-[var(--color-surface-border)] group",children:[r.jsx("img",{src:URL.createObjectURL(me),alt:"",className:"w-full h-full object-cover"}),r.jsx("div",{className:"absolute top-1 right-1",children:r.jsx(Ne,{size:"icon",variant:"danger",className:"size-6",onClick:()=>V(De=>De.filter((Ee,ut)=>ut!==Ae)),children:r.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"delete"})})})]},Ae)),r.jsxs("label",{className:"aspect-video rounded-lg border-2 border-dashed border-[var(--color-surface-border)] bg-[var(--color-surface-hover)] flex flex-col items-center justify-center cursor-pointer hover:border-[var(--color-text-main)] transition-colors text-[var(--color-text-muted)] hover:text-[var(--color-text-main)]",children:[r.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:je,className:"hidden"}),r.jsx("span",{className:"material-symbols-outlined",children:"add_photo_alternate"}),r.jsx("span",{className:"text-xs font-semibold mt-1",children:"Add Images"})]})]})]})]})})]})]}):r.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[50vh] gap-4",children:[r.jsx("span",{className:"material-symbols-outlined text-4xl text-gray-400",children:"lock"}),r.jsx("h2",{className:"text-xl font-bold",children:"Access Denied"}),r.jsx("p",{className:"text-gray-500",children:"You don't have permission to create projects."}),r.jsx(nt,{to:"/projects",children:r.jsx(Ne,{children:"Back to Projects"})})]})},Yk="modulepreload",Jk=function(t){return"/"+t},d0={},Tb=function(e,s,o){let i=Promise.resolve();if(s&&s.length>0){let u=function(x){return Promise.all(x.map(v=>Promise.resolve(v).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};document.getElementsByTagName("link");const m=document.querySelector("meta[property=csp-nonce]"),h=(m==null?void 0:m.nonce)||(m==null?void 0:m.getAttribute("nonce"));i=u(s.map(x=>{if(x=Jk(x),x in d0)return;d0[x]=!0;const v=x.endsWith(".css"),b=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${x}"]${b}`))return;const N=document.createElement("link");if(N.rel=v?"stylesheet":Yk,v||(N.as="script"),N.crossOrigin="",N.href=x,h&&N.setAttribute("nonce",h),document.head.appendChild(N),v)return new Promise((T,_)=>{N.addEventListener("load",T),N.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${x}`)))})}))}function c(u){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=u,window.dispatchEvent(m),!m.defaultPrevented)throw u}return i.then(u=>{for(const m of u||[])m.status==="rejected"&&c(m.reason);return e().catch(c)})},Cb=6048e5,Xk=864e5,Eb=6e4,_b=36e5,u0=Symbol.for("constructDateFrom");function Dn(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&u0 in t?t[u0](e):t instanceof Date?new t.constructor(e):new Date(e)}function Yt(t,e){return Dn(e||t,t)}function Ko(t,e,s){const o=Yt(t,s==null?void 0:s.in);return isNaN(e)?Dn(t,NaN):(e&&o.setDate(o.getDate()+e),o)}function Ab(t,e,s){const o=Yt(t,s==null?void 0:s.in);if(isNaN(e))return Dn(t,NaN);if(!e)return o;const i=o.getDate(),c=Dn(t,o.getTime());c.setMonth(o.getMonth()+e+1,0);const u=c.getDate();return i>=u?c:(o.setFullYear(c.getFullYear(),c.getMonth(),i),o)}function Kk(t,e){const s=Yt(t,e==null?void 0:e.in).getDay();return s===0||s===6}let Wk={};function Sl(){return Wk}function ga(t,e){var m,h,x,v;const s=Sl(),o=(e==null?void 0:e.weekStartsOn)??((h=(m=e==null?void 0:e.locale)==null?void 0:m.options)==null?void 0:h.weekStartsOn)??s.weekStartsOn??((v=(x=s.locale)==null?void 0:x.options)==null?void 0:v.weekStartsOn)??0,i=Yt(t,e==null?void 0:e.in),c=i.getDay(),u=(c<o?7:0)+c-o;return i.setDate(i.getDate()-u),i.setHours(0,0,0,0),i}function sd(t,e){return ga(t,{...e,weekStartsOn:1})}function kb(t,e){const s=Yt(t,e==null?void 0:e.in),o=s.getFullYear(),i=Dn(s,0);i.setFullYear(o+1,0,4),i.setHours(0,0,0,0);const c=sd(i),u=Dn(s,0);u.setFullYear(o,0,4),u.setHours(0,0,0,0);const m=sd(u);return s.getTime()>=c.getTime()?o+1:s.getTime()>=m.getTime()?o:o-1}function f0(t){const e=Yt(t),s=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return s.setUTCFullYear(e.getFullYear()),+t-+s}function bd(t,...e){const s=Dn.bind(null,e.find(o=>typeof o=="object"));return e.map(s)}function eo(t,e){const s=Yt(t,e==null?void 0:e.in);return s.setHours(0,0,0,0),s}function Qk(t,e,s){const[o,i]=bd(s==null?void 0:s.in,t,e),c=eo(o),u=eo(i),m=+c-f0(c),h=+u-f0(u);return Math.round((m-h)/Xk)}function Zk(t,e){const s=kb(t,e),o=Dn(t,0);return o.setFullYear(s,0,4),o.setHours(0,0,0,0),sd(o)}function eI(t){return Dn(t,Date.now())}function Wa(t,e,s){const[o,i]=bd(s==null?void 0:s.in,t,e);return+eo(o)==+eo(i)}function tI(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function hl(t){return!(!tI(t)&&typeof t!="number"||isNaN(+Yt(t)))}function rm(t,e){const s=Yt(t,e==null?void 0:e.in),o=s.getMonth();return s.setFullYear(s.getFullYear(),o+1,0),s.setHours(23,59,59,999),s}function nI(t,e){const[s,o]=bd(t,e.start,e.end);return{start:s,end:o}}function am(t,e){const{start:s,end:o}=nI(e==null?void 0:e.in,t);let i=+s>+o;const c=i?+s:+o,u=i?o:s;u.setHours(0,0,0,0);let m=1;const h=[];for(;+u<=c;)h.push(Dn(s,u)),u.setDate(u.getDate()+m),u.setHours(0,0,0,0);return i?h.reverse():h}function om(t,e){const s=Yt(t,e==null?void 0:e.in);return s.setDate(1),s.setHours(0,0,0,0),s}function sI(t,e){const s=Yt(t,e==null?void 0:e.in);return s.setFullYear(s.getFullYear(),0,1),s.setHours(0,0,0,0),s}function im(t,e){var m,h,x,v;const s=Sl(),o=(e==null?void 0:e.weekStartsOn)??((h=(m=e==null?void 0:e.locale)==null?void 0:m.options)==null?void 0:h.weekStartsOn)??s.weekStartsOn??((v=(x=s.locale)==null?void 0:x.options)==null?void 0:v.weekStartsOn)??0,i=Yt(t,e==null?void 0:e.in),c=i.getDay(),u=(c<o?-7:0)+6-(c-o);return i.setDate(i.getDate()+u),i.setHours(23,59,59,999),i}const rI={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},aI=(t,e,s)=>{let o;const i=rI[t];return typeof i=="string"?o=i:e===1?o=i.one:o=i.other.replace("{{count}}",e.toString()),s!=null&&s.addSuffix?s.comparison&&s.comparison>0?"in "+o:o+" ago":o};function Rf(t){return(e={})=>{const s=e.width?String(e.width):t.defaultWidth;return t.formats[s]||t.formats[t.defaultWidth]}}const oI={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},iI={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},lI={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},cI={date:Rf({formats:oI,defaultWidth:"full"}),time:Rf({formats:iI,defaultWidth:"full"}),dateTime:Rf({formats:lI,defaultWidth:"full"})},dI={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},uI=(t,e,s,o)=>dI[t];function sl(t){return(e,s)=>{const o=s!=null&&s.context?String(s.context):"standalone";let i;if(o==="formatting"&&t.formattingValues){const u=t.defaultFormattingWidth||t.defaultWidth,m=s!=null&&s.width?String(s.width):u;i=t.formattingValues[m]||t.formattingValues[u]}else{const u=t.defaultWidth,m=s!=null&&s.width?String(s.width):t.defaultWidth;i=t.values[m]||t.values[u]}const c=t.argumentCallback?t.argumentCallback(e):e;return i[c]}}const fI={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},mI={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},pI={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},hI={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},xI={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},gI={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},vI=(t,e)=>{const s=Number(t),o=s%100;if(o>20||o<10)switch(o%10){case 1:return s+"st";case 2:return s+"nd";case 3:return s+"rd"}return s+"th"},yI={ordinalNumber:vI,era:sl({values:fI,defaultWidth:"wide"}),quarter:sl({values:mI,defaultWidth:"wide",argumentCallback:t=>t-1}),month:sl({values:pI,defaultWidth:"wide"}),day:sl({values:hI,defaultWidth:"wide"}),dayPeriod:sl({values:xI,defaultWidth:"wide",formattingValues:gI,defaultFormattingWidth:"wide"})};function rl(t){return(e,s={})=>{const o=s.width,i=o&&t.matchPatterns[o]||t.matchPatterns[t.defaultMatchWidth],c=e.match(i);if(!c)return null;const u=c[0],m=o&&t.parsePatterns[o]||t.parsePatterns[t.defaultParseWidth],h=Array.isArray(m)?NI(m,b=>b.test(u)):bI(m,b=>b.test(u));let x;x=t.valueCallback?t.valueCallback(h):h,x=s.valueCallback?s.valueCallback(x):x;const v=e.slice(u.length);return{value:x,rest:v}}}function bI(t,e){for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&e(t[s]))return s}function NI(t,e){for(let s=0;s<t.length;s++)if(e(t[s]))return s}function wI(t){return(e,s={})=>{const o=e.match(t.matchPattern);if(!o)return null;const i=o[0],c=e.match(t.parsePattern);if(!c)return null;let u=t.valueCallback?t.valueCallback(c[0]):c[0];u=s.valueCallback?s.valueCallback(u):u;const m=e.slice(i.length);return{value:u,rest:m}}}const SI=/^(\d+)(th|st|nd|rd)?/i,jI=/\d+/i,TI={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},CI={any:[/^b/i,/^(a|c)/i]},EI={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},_I={any:[/1/i,/2/i,/3/i,/4/i]},AI={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},kI={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},II={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},MI={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},RI={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},DI={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},UI={ordinalNumber:wI({matchPattern:SI,parsePattern:jI,valueCallback:t=>parseInt(t,10)}),era:rl({matchPatterns:TI,defaultMatchWidth:"wide",parsePatterns:CI,defaultParseWidth:"any"}),quarter:rl({matchPatterns:EI,defaultMatchWidth:"wide",parsePatterns:_I,defaultParseWidth:"any",valueCallback:t=>t+1}),month:rl({matchPatterns:AI,defaultMatchWidth:"wide",parsePatterns:kI,defaultParseWidth:"any"}),day:rl({matchPatterns:II,defaultMatchWidth:"wide",parsePatterns:MI,defaultParseWidth:"any"}),dayPeriod:rl({matchPatterns:RI,defaultMatchWidth:"any",parsePatterns:DI,defaultParseWidth:"any"})},PI={code:"en-US",formatDistance:aI,formatLong:cI,formatRelative:uI,localize:yI,match:UI,options:{weekStartsOn:0,firstWeekContainsDate:1}};function LI(t,e){const s=Yt(t,e==null?void 0:e.in);return Qk(s,sI(s))+1}function zI(t,e){const s=Yt(t,e==null?void 0:e.in),o=+sd(s)-+Zk(s);return Math.round(o/Cb)+1}function Ib(t,e){var v,b,N,T;const s=Yt(t,e==null?void 0:e.in),o=s.getFullYear(),i=Sl(),c=(e==null?void 0:e.firstWeekContainsDate)??((b=(v=e==null?void 0:e.locale)==null?void 0:v.options)==null?void 0:b.firstWeekContainsDate)??i.firstWeekContainsDate??((T=(N=i.locale)==null?void 0:N.options)==null?void 0:T.firstWeekContainsDate)??1,u=Dn((e==null?void 0:e.in)||t,0);u.setFullYear(o+1,0,c),u.setHours(0,0,0,0);const m=ga(u,e),h=Dn((e==null?void 0:e.in)||t,0);h.setFullYear(o,0,c),h.setHours(0,0,0,0);const x=ga(h,e);return+s>=+m?o+1:+s>=+x?o:o-1}function GI(t,e){var m,h,x,v;const s=Sl(),o=(e==null?void 0:e.firstWeekContainsDate)??((h=(m=e==null?void 0:e.locale)==null?void 0:m.options)==null?void 0:h.firstWeekContainsDate)??s.firstWeekContainsDate??((v=(x=s.locale)==null?void 0:x.options)==null?void 0:v.firstWeekContainsDate)??1,i=Ib(t,e),c=Dn((e==null?void 0:e.in)||t,0);return c.setFullYear(i,0,o),c.setHours(0,0,0,0),ga(c,e)}function HI(t,e){const s=Yt(t,e==null?void 0:e.in),o=+ga(s,e)-+GI(s,e);return Math.round(o/Cb)+1}function Ct(t,e){const s=t<0?"-":"",o=Math.abs(t).toString().padStart(e,"0");return s+o}const fa={y(t,e){const s=t.getFullYear(),o=s>0?s:1-s;return Ct(e==="yy"?o%100:o,e.length)},M(t,e){const s=t.getMonth();return e==="M"?String(s+1):Ct(s+1,2)},d(t,e){return Ct(t.getDate(),e.length)},a(t,e){const s=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return s.toUpperCase();case"aaa":return s;case"aaaaa":return s[0];case"aaaa":default:return s==="am"?"a.m.":"p.m."}},h(t,e){return Ct(t.getHours()%12||12,e.length)},H(t,e){return Ct(t.getHours(),e.length)},m(t,e){return Ct(t.getMinutes(),e.length)},s(t,e){return Ct(t.getSeconds(),e.length)},S(t,e){const s=e.length,o=t.getMilliseconds(),i=Math.trunc(o*Math.pow(10,s-3));return Ct(i,e.length)}},Bo={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},m0={G:function(t,e,s){const o=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return s.era(o,{width:"abbreviated"});case"GGGGG":return s.era(o,{width:"narrow"});case"GGGG":default:return s.era(o,{width:"wide"})}},y:function(t,e,s){if(e==="yo"){const o=t.getFullYear(),i=o>0?o:1-o;return s.ordinalNumber(i,{unit:"year"})}return fa.y(t,e)},Y:function(t,e,s,o){const i=Ib(t,o),c=i>0?i:1-i;if(e==="YY"){const u=c%100;return Ct(u,2)}return e==="Yo"?s.ordinalNumber(c,{unit:"year"}):Ct(c,e.length)},R:function(t,e){const s=kb(t);return Ct(s,e.length)},u:function(t,e){const s=t.getFullYear();return Ct(s,e.length)},Q:function(t,e,s){const o=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(o);case"QQ":return Ct(o,2);case"Qo":return s.ordinalNumber(o,{unit:"quarter"});case"QQQ":return s.quarter(o,{width:"abbreviated",context:"formatting"});case"QQQQQ":return s.quarter(o,{width:"narrow",context:"formatting"});case"QQQQ":default:return s.quarter(o,{width:"wide",context:"formatting"})}},q:function(t,e,s){const o=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(o);case"qq":return Ct(o,2);case"qo":return s.ordinalNumber(o,{unit:"quarter"});case"qqq":return s.quarter(o,{width:"abbreviated",context:"standalone"});case"qqqqq":return s.quarter(o,{width:"narrow",context:"standalone"});case"qqqq":default:return s.quarter(o,{width:"wide",context:"standalone"})}},M:function(t,e,s){const o=t.getMonth();switch(e){case"M":case"MM":return fa.M(t,e);case"Mo":return s.ordinalNumber(o+1,{unit:"month"});case"MMM":return s.month(o,{width:"abbreviated",context:"formatting"});case"MMMMM":return s.month(o,{width:"narrow",context:"formatting"});case"MMMM":default:return s.month(o,{width:"wide",context:"formatting"})}},L:function(t,e,s){const o=t.getMonth();switch(e){case"L":return String(o+1);case"LL":return Ct(o+1,2);case"Lo":return s.ordinalNumber(o+1,{unit:"month"});case"LLL":return s.month(o,{width:"abbreviated",context:"standalone"});case"LLLLL":return s.month(o,{width:"narrow",context:"standalone"});case"LLLL":default:return s.month(o,{width:"wide",context:"standalone"})}},w:function(t,e,s,o){const i=HI(t,o);return e==="wo"?s.ordinalNumber(i,{unit:"week"}):Ct(i,e.length)},I:function(t,e,s){const o=zI(t);return e==="Io"?s.ordinalNumber(o,{unit:"week"}):Ct(o,e.length)},d:function(t,e,s){return e==="do"?s.ordinalNumber(t.getDate(),{unit:"date"}):fa.d(t,e)},D:function(t,e,s){const o=LI(t);return e==="Do"?s.ordinalNumber(o,{unit:"dayOfYear"}):Ct(o,e.length)},E:function(t,e,s){const o=t.getDay();switch(e){case"E":case"EE":case"EEE":return s.day(o,{width:"abbreviated",context:"formatting"});case"EEEEE":return s.day(o,{width:"narrow",context:"formatting"});case"EEEEEE":return s.day(o,{width:"short",context:"formatting"});case"EEEE":default:return s.day(o,{width:"wide",context:"formatting"})}},e:function(t,e,s,o){const i=t.getDay(),c=(i-o.weekStartsOn+8)%7||7;switch(e){case"e":return String(c);case"ee":return Ct(c,2);case"eo":return s.ordinalNumber(c,{unit:"day"});case"eee":return s.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return s.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return s.day(i,{width:"short",context:"formatting"});case"eeee":default:return s.day(i,{width:"wide",context:"formatting"})}},c:function(t,e,s,o){const i=t.getDay(),c=(i-o.weekStartsOn+8)%7||7;switch(e){case"c":return String(c);case"cc":return Ct(c,e.length);case"co":return s.ordinalNumber(c,{unit:"day"});case"ccc":return s.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return s.day(i,{width:"narrow",context:"standalone"});case"cccccc":return s.day(i,{width:"short",context:"standalone"});case"cccc":default:return s.day(i,{width:"wide",context:"standalone"})}},i:function(t,e,s){const o=t.getDay(),i=o===0?7:o;switch(e){case"i":return String(i);case"ii":return Ct(i,e.length);case"io":return s.ordinalNumber(i,{unit:"day"});case"iii":return s.day(o,{width:"abbreviated",context:"formatting"});case"iiiii":return s.day(o,{width:"narrow",context:"formatting"});case"iiiiii":return s.day(o,{width:"short",context:"formatting"});case"iiii":default:return s.day(o,{width:"wide",context:"formatting"})}},a:function(t,e,s){const i=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return s.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return s.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return s.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return s.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(t,e,s){const o=t.getHours();let i;switch(o===12?i=Bo.noon:o===0?i=Bo.midnight:i=o/12>=1?"pm":"am",e){case"b":case"bb":return s.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return s.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return s.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return s.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(t,e,s){const o=t.getHours();let i;switch(o>=17?i=Bo.evening:o>=12?i=Bo.afternoon:o>=4?i=Bo.morning:i=Bo.night,e){case"B":case"BB":case"BBB":return s.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return s.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return s.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(t,e,s){if(e==="ho"){let o=t.getHours()%12;return o===0&&(o=12),s.ordinalNumber(o,{unit:"hour"})}return fa.h(t,e)},H:function(t,e,s){return e==="Ho"?s.ordinalNumber(t.getHours(),{unit:"hour"}):fa.H(t,e)},K:function(t,e,s){const o=t.getHours()%12;return e==="Ko"?s.ordinalNumber(o,{unit:"hour"}):Ct(o,e.length)},k:function(t,e,s){let o=t.getHours();return o===0&&(o=24),e==="ko"?s.ordinalNumber(o,{unit:"hour"}):Ct(o,e.length)},m:function(t,e,s){return e==="mo"?s.ordinalNumber(t.getMinutes(),{unit:"minute"}):fa.m(t,e)},s:function(t,e,s){return e==="so"?s.ordinalNumber(t.getSeconds(),{unit:"second"}):fa.s(t,e)},S:function(t,e){return fa.S(t,e)},X:function(t,e,s){const o=t.getTimezoneOffset();if(o===0)return"Z";switch(e){case"X":return h0(o);case"XXXX":case"XX":return Ja(o);case"XXXXX":case"XXX":default:return Ja(o,":")}},x:function(t,e,s){const o=t.getTimezoneOffset();switch(e){case"x":return h0(o);case"xxxx":case"xx":return Ja(o);case"xxxxx":case"xxx":default:return Ja(o,":")}},O:function(t,e,s){const o=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+p0(o,":");case"OOOO":default:return"GMT"+Ja(o,":")}},z:function(t,e,s){const o=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+p0(o,":");case"zzzz":default:return"GMT"+Ja(o,":")}},t:function(t,e,s){const o=Math.trunc(+t/1e3);return Ct(o,e.length)},T:function(t,e,s){return Ct(+t,e.length)}};function p0(t,e=""){const s=t>0?"-":"+",o=Math.abs(t),i=Math.trunc(o/60),c=o%60;return c===0?s+String(i):s+String(i)+e+Ct(c,2)}function h0(t,e){return t%60===0?(t>0?"-":"+")+Ct(Math.abs(t)/60,2):Ja(t,e)}function Ja(t,e=""){const s=t>0?"-":"+",o=Math.abs(t),i=Ct(Math.trunc(o/60),2),c=Ct(o%60,2);return s+i+e+c}const x0=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},Mb=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},OI=(t,e)=>{const s=t.match(/(P+)(p+)?/)||[],o=s[1],i=s[2];if(!i)return x0(t,e);let c;switch(o){case"P":c=e.dateTime({width:"short"});break;case"PP":c=e.dateTime({width:"medium"});break;case"PPP":c=e.dateTime({width:"long"});break;case"PPPP":default:c=e.dateTime({width:"full"});break}return c.replace("{{date}}",x0(o,e)).replace("{{time}}",Mb(i,e))},qI={p:Mb,P:OI},FI=/^D+$/,VI=/^Y+$/,BI=["D","DD","YY","YYYY"];function $I(t){return FI.test(t)}function YI(t){return VI.test(t)}function JI(t,e,s){const o=XI(t,e,s);if(console.warn(o),BI.includes(t))throw new RangeError(o)}function XI(t,e,s){const o=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${o} to the input \`${s}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const KI=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,WI=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,QI=/^'([^]*?)'?$/,ZI=/''/g,eM=/[a-zA-Z]/;function $n(t,e,s){var v,b,N,T;const o=Sl(),i=o.locale??PI,c=o.firstWeekContainsDate??((b=(v=o.locale)==null?void 0:v.options)==null?void 0:b.firstWeekContainsDate)??1,u=o.weekStartsOn??((T=(N=o.locale)==null?void 0:N.options)==null?void 0:T.weekStartsOn)??0,m=Yt(t,s==null?void 0:s.in);if(!hl(m))throw new RangeError("Invalid time value");let h=e.match(WI).map(_=>{const I=_[0];if(I==="p"||I==="P"){const E=qI[I];return E(_,i.formatLong)}return _}).join("").match(KI).map(_=>{if(_==="''")return{isToken:!1,value:"'"};const I=_[0];if(I==="'")return{isToken:!1,value:tM(_)};if(m0[I])return{isToken:!0,value:_};if(I.match(eM))throw new RangeError("Format string contains an unescaped latin alphabet character `"+I+"`");return{isToken:!1,value:_}});i.localize.preprocessor&&(h=i.localize.preprocessor(m,h));const x={firstWeekContainsDate:c,weekStartsOn:u,locale:i};return h.map(_=>{if(!_.isToken)return _.value;const I=_.value;(YI(I)||$I(I))&&JI(I,e,String(t));const E=m0[I[0]];return E(m,I,i.localize,x)}).join("")}function tM(t){const e=t.match(QI);return e?e[1].replace(ZI,"'"):t}function g0(t,e){return+Yt(t)>+Yt(e)}function Df(t,e){return+Yt(t)<+Yt(e)}function Rb(t,e,s){const[o,i]=bd(s==null?void 0:s.in,t,e);return o.getFullYear()===i.getFullYear()&&o.getMonth()===i.getMonth()}function Db(t,e){return Wa(Dn(t,t),eI(t))}function zc(t,e){const s=()=>Dn(e==null?void 0:e.in,NaN),i=aM(t);let c;if(i.date){const x=oM(i.date,2);c=iM(x.restDateString,x.year)}if(!c||isNaN(+c))return s();const u=+c;let m=0,h;if(i.time&&(m=lM(i.time),isNaN(m)))return s();if(i.timezone){if(h=cM(i.timezone),isNaN(h))return s()}else{const x=new Date(u+m),v=Yt(0,e==null?void 0:e.in);return v.setFullYear(x.getUTCFullYear(),x.getUTCMonth(),x.getUTCDate()),v.setHours(x.getUTCHours(),x.getUTCMinutes(),x.getUTCSeconds(),x.getUTCMilliseconds()),v}return Yt(u+m+h,e==null?void 0:e.in)}const Gc={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},nM=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,sM=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,rM=/^([+-])(\d{2})(?::?(\d{2}))?$/;function aM(t){const e={},s=t.split(Gc.dateTimeDelimiter);let o;if(s.length>2)return e;if(/:/.test(s[0])?o=s[0]:(e.date=s[0],o=s[1],Gc.timeZoneDelimiter.test(e.date)&&(e.date=t.split(Gc.timeZoneDelimiter)[0],o=t.substr(e.date.length,t.length))),o){const i=Gc.timezone.exec(o);i?(e.time=o.replace(i[1],""),e.timezone=i[1]):e.time=o}return e}function oM(t,e){const s=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),o=t.match(s);if(!o)return{year:NaN,restDateString:""};const i=o[1]?parseInt(o[1]):null,c=o[2]?parseInt(o[2]):null;return{year:c===null?i:c*100,restDateString:t.slice((o[1]||o[2]).length)}}function iM(t,e){if(e===null)return new Date(NaN);const s=t.match(nM);if(!s)return new Date(NaN);const o=!!s[4],i=al(s[1]),c=al(s[2])-1,u=al(s[3]),m=al(s[4]),h=al(s[5])-1;if(o)return pM(e,m,h)?dM(e,m,h):new Date(NaN);{const x=new Date(0);return!fM(e,c,u)||!mM(e,i)?new Date(NaN):(x.setUTCFullYear(e,c,Math.max(i,u)),x)}}function al(t){return t?parseInt(t):1}function lM(t){const e=t.match(sM);if(!e)return NaN;const s=Uf(e[1]),o=Uf(e[2]),i=Uf(e[3]);return hM(s,o,i)?s*_b+o*Eb+i*1e3:NaN}function Uf(t){return t&&parseFloat(t.replace(",","."))||0}function cM(t){if(t==="Z")return 0;const e=t.match(rM);if(!e)return 0;const s=e[1]==="+"?-1:1,o=parseInt(e[2]),i=e[3]&&parseInt(e[3])||0;return xM(o,i)?s*(o*_b+i*Eb):NaN}function dM(t,e,s){const o=new Date(0);o.setUTCFullYear(t,0,4);const i=o.getUTCDay()||7,c=(e-1)*7+s+1-i;return o.setUTCDate(o.getUTCDate()+c),o}const uM=[31,null,31,30,31,30,31,31,30,31,30,31];function Ub(t){return t%400===0||t%4===0&&t%100!==0}function fM(t,e,s){return e>=0&&e<=11&&s>=1&&s<=(uM[e]||(Ub(t)?29:28))}function mM(t,e){return e>=1&&e<=(Ub(t)?366:365)}function pM(t,e,s){return e>=1&&e<=53&&s>=0&&s<=6}function hM(t,e,s){return t===24?e===0&&s===0:s>=0&&s<60&&e>=0&&e<60&&t>=0&&t<25}function xM(t,e){return e>=0&&e<=59}function gM(t,e,s){return Ab(t,-1,s)}const Pb=({value:t,onChange:e,placeholder:s="Select date",className:o="",align:i="left"})=>{const[c,u]=w.useState(!1),[m,h]=w.useState(new Date),x=w.useRef(null);w.useEffect(()=>{if(t){const M=zc(t);hl(M)&&h(M)}},[c]);const v=t?zc(t):void 0,b=om(m),N=rm(b),T=ga(b,{weekStartsOn:1}),_=im(N,{weekStartsOn:1}),I=am({start:T,end:_}),E=M=>{M.preventDefault(),M.stopPropagation(),h(gM(m))},D=M=>{M.preventDefault(),M.stopPropagation(),h(Ab(m,1))},z=M=>{e($n(M,"yyyy-MM-dd")),u(!1)},A=M=>{M.stopPropagation(),e(""),u(!1)};return w.useEffect(()=>{const M=B=>{x.current&&!x.current.contains(B.target)&&u(!1)};return c&&document.addEventListener("mousedown",M),()=>{document.removeEventListener("mousedown",M)}},[c]),r.jsxs("div",{className:`relative ${o}`,ref:x,children:[r.jsxs("div",{onClick:()=>u(!c),className:`
                    w-full px-3 py-2.5 rounded-xl border flex items-center justify-between cursor-pointer transition-all text-sm
                    bg-[var(--color-surface-bg)] text-[var(--color-text-main)]
                    focus:outline-none focus:ring-0 focus:ring-offset-0
                    border-[var(--color-surface-border)]
                `,children:[r.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[r.jsx("span",{className:"material-symbols-outlined text-[20px] leading-none text-[var(--color-text-subtle)] flex-shrink-0",children:"calendar_today"}),t&&hl(zc(t))?r.jsx("span",{className:"truncate",children:$n(zc(t),"MMM d, yyyy")}):r.jsx("span",{className:"text-[var(--color-text-subtle)] truncate",children:s})]}),t&&r.jsx("div",{onClick:A,className:"hover:bg-[var(--color-surface-hover)] p-0.5 rounded-full text-[var(--color-text-muted)] hover:text-[var(--color-text-main)] transition-colors flex-shrink-0 ml-1",children:r.jsx("span",{className:"material-symbols-outlined text-[16px] block",children:"close"})})]}),c&&r.jsxs("div",{className:`
                        absolute top-full mt-2 z-50 p-4 bg-[var(--color-surface-card)] rounded-xl shadow-xl border border-[var(--color-surface-border)] min-w-[280px] animate-scale-up
                        ${i==="right"?"right-0":"left-0"}
                    `,children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("button",{onClick:E,className:"p-1 hover:bg-[var(--color-surface-hover)] rounded-lg transition-colors text-[var(--color-text-main)]",children:r.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"chevron_left"})}),r.jsx("span",{className:"font-bold text-sm text-[var(--color-text-main)]",children:$n(m,"MMMM yyyy")}),r.jsx("button",{onClick:D,className:"p-1 hover:bg-[var(--color-surface-hover)] rounded-lg transition-colors text-[var(--color-text-main)]",children:r.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"chevron_right"})})]}),r.jsx("div",{className:"grid grid-cols-7 mb-2",children:["Mo","Tu","We","Th","Fr","Sa","Su"].map(M=>r.jsx("div",{className:"text-center text-xs font-bold text-[var(--color-text-muted)] uppercase tracking-wider",children:M},M))}),r.jsx("div",{className:"grid grid-cols-7 gap-1",children:I.map((M,B)=>{const L=v?Wa(M,v):!1,X=Rb(M,m),de=Db(M);return r.jsx("button",{onClick:()=>z(M),className:`
                                        h-8 w-8 rounded-lg flex items-center justify-center text-sm transition-all relative
                                        ${X?"text-[var(--color-text-main)]":"text-[var(--color-text-subtle)] opacity-40"}
                                        ${L?"bg-[var(--color-primary)] text-[var(--color-primary-text)] shadow-md font-medium":"hover:bg-[var(--color-surface-hover)]"}
                                        ${de&&!L?"text-[var(--color-primary)] font-bold border border-[var(--color-primary-fade)]":""}
                                    `,children:$n(M,"d")},M.toISOString())})}),r.jsx("div",{className:"mt-3 pt-3 border-t border-[var(--color-surface-border)] flex justify-center",children:r.jsx("button",{onClick:()=>z(new Date),className:"text-xs font-bold text-[var(--color-primary)] hover:underline",children:"Today"})})]})]})},Nd=({projectId:t,assigneeIds:e=[],onChange:s,label:o})=>{var D;const[i,c]=w.useState([]),[u,m]=w.useState({}),[h,x]=w.useState(!0),[v,b]=w.useState(!1),[N,T]=w.useState(""),_=w.useRef(null);w.useEffect(()=>{let z,A=!0;return(async()=>{var K;const B=await yl(t);xe.currentUser&&!B.includes(xe.currentUser.uid)&&B.push(xe.currentUser.uid),e.forEach(F=>{B.includes(F)||B.push(F)}),console.log("[MultiAssigneeSelector] Members:",B),A&&c(B);const{getProjectById:L,getUserProfile:X}=await Tb(async()=>{const{getProjectById:F,getUserProfile:le}=await Promise.resolve().then(()=>by);return{getProjectById:F,getUserProfile:le}},void 0),de=await L(t),V=(de==null?void 0:de.tenantId)||Ar()||((K=xe.currentUser)==null?void 0:K.uid);console.log("[MultiAssigneeSelector] Project tenantId:",V);const Z={};xe.currentUser&&(Z[xe.currentUser.uid]={displayName:xe.currentUser.displayName||"Me",photoURL:xe.currentUser.photoURL,email:xe.currentUser.email}),await Promise.all(B.map(async F=>{var le;if(F!==((le=xe.currentUser)==null?void 0:le.uid)&&!Z[F])try{if(V){const re=await X(F,V);if(re){console.log(`[MultiAssigneeSelector] Found ${F} in project tenant`),Z[F]={displayName:re.displayName||"User",photoURL:re.photoURL,email:re.email};return}}const he=await X(F,F);if(he){console.log(`[MultiAssigneeSelector] Found ${F} in personal tenant`),Z[F]={displayName:he.displayName||"User",photoURL:he.photoURL,email:he.email};return}console.log(`[MultiAssigneeSelector] No profile found for ${F}`)}catch(he){console.warn(`Failed to load profile for ${F}`,he)}})),console.log("[MultiAssigneeSelector] Final memberProfiles:",Z),A&&(m({...Z}),x(!1)),V&&(z=ba(F=>{if(!A)return;const le={...Z};F.forEach(he=>{(!le[he.id]||!le[he.id].displayName)&&(le[he.id]={displayName:he.displayName||"User",photoURL:he.photoURL,email:he.email})}),m(le)},V))})(),()=>{A=!1,z&&z()}},[t]),w.useEffect(()=>{const z=A=>{_.current&&!_.current.contains(A.target)&&b(!1)};return document.addEventListener("mousedown",z),()=>document.removeEventListener("mousedown",z)},[]);const I=z=>{const A=e.includes(z)?e.filter(M=>M!==z):[...e,z];s(A)},E=i.filter(z=>{const A=u[z];return((A==null?void 0:A.displayName)||(A==null?void 0:A.email)||"").toLowerCase().includes(N.toLowerCase())});return h?r.jsx("div",{className:"h-10 bg-gray-100 rounded animate-pulse"}):r.jsxs("div",{className:"flex flex-col gap-1 w-full",ref:_,children:[o&&r.jsx("label",{className:"text-xs font-bold text-[var(--color-text-muted)] uppercase tracking-wider ml-1",children:o}),r.jsxs("div",{className:"relative",children:[r.jsxs("div",{onClick:()=>b(!v),className:`h-10 px-3 rounded-xl border cursor-pointer transition-all flex items-center justify-between
                    bg-[var(--color-surface-bg)] text-[var(--color-text-main)]
                    ${v?"border-[var(--color-text-subtle)]":"border-[var(--color-surface-border)] hover:border-[var(--color-text-subtle)]"}
                    `,children:[e.length===0?r.jsx("span",{className:"text-sm text-[var(--color-text-subtle)]",children:"Unassigned"}):r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"flex -space-x-2 overflow-hidden",children:e.slice(0,4).map(z=>{var M;const A=u[z];return r.jsx("div",{className:"inline-block size-6 rounded-full ring-2 ring-[var(--color-surface-bg)] bg-indigo-100 text-indigo-600 flex items-center justify-center overflow-hidden",title:A==null?void 0:A.displayName,children:A!=null&&A.photoURL?r.jsx("img",{src:A.photoURL,alt:"",className:"size-full object-cover"}):r.jsx("span",{className:"text-[9px] font-bold",children:((M=A==null?void 0:A.displayName)==null?void 0:M.slice(0,1))||"U"})},z)})}),e.length>4&&r.jsxs("span",{className:"text-xs font-medium text-[var(--color-text-muted)]",children:["+",e.length-4]}),e.length>0&&e.length<=4&&r.jsx("span",{className:"text-xs text-[var(--color-text-muted)] ml-1",children:e.length===1?(D=u[e[0]])==null?void 0:D.displayName.split(" ")[0]:""})]}),r.jsx("span",{className:"material-symbols-outlined text-[20px] text-[var(--color-text-subtle)] leading-none",children:"expand_more"})]}),v&&r.jsxs("div",{className:"absolute z-50 top-full mt-2 left-0 w-full bg-[var(--color-surface-card)] border border-[var(--color-surface-border)] rounded-xl shadow-xl overflow-hidden animate-in fade-in zoom-in-95 duration-100",children:[r.jsx("div",{className:"p-2 border-b border-[var(--color-surface-border)]",children:r.jsx("div",{className:"px-2 py-1.5 bg-[var(--color-surface-bg)] rounded-lg",children:r.jsx(st,{ref:z=>{z&&z.focus({preventScroll:!0})},type:"text",className:"border-none focus:ring-0 px-0 h-auto py-1 shadow-none bg-transparent",icon:"search",placeholder:"Search members...",value:N,onChange:z=>T(z.target.value)})})}),r.jsx("div",{className:"max-h-60 overflow-y-auto p-1",children:E.length===0?r.jsx("div",{className:"px-4 py-3 text-sm text-[var(--color-text-subtle)] text-center",children:"No members found"}):E.map(z=>{var B;const A=u[z],M=e.includes(z);return r.jsxs("div",{onClick:()=>I(z),className:`flex items-center gap-3 px-3 py-2 rounded-lg cursor-pointer transition-colors ${M?"bg-[var(--color-primary)]/10":"hover:bg-[var(--color-surface-hover)]"}`,children:[r.jsx("div",{className:`size-4 rounded border flex items-center justify-center transition-colors ${M?"bg-[var(--color-primary)] border-[var(--color-primary)]":"border-[var(--color-text-muted)]"}`,children:M&&r.jsx("span",{className:"material-symbols-outlined text-[12px] text-white",children:"check"})}),r.jsx("div",{className:"size-8 rounded-full bg-gray-100 text-gray-500 flex items-center justify-center overflow-hidden flex-shrink-0",children:A!=null&&A.photoURL?r.jsx("img",{src:A.photoURL,alt:"",className:"size-full object-cover"}):r.jsx("span",{className:"text-xs font-bold",children:((B=A==null?void 0:A.displayName)==null?void 0:B.slice(0,1))||"U"})}),r.jsxs("div",{className:"flex flex-col min-w-0",children:[r.jsx("span",{className:`text-sm font-medium truncate ${M?"text-[var(--color-primary)]":"text-[var(--color-text-main)]"}`,children:A?A.displayName:"Unknown User"}),r.jsx("span",{className:"text-[10px] text-[var(--color-text-muted)] truncate",children:(A==null?void 0:A.email)||"No email"})]})]},z)})})]})]})]})},Lb=({projectId:t,tenantId:e,onClose:s,onCreated:o})=>{const[i,c]=w.useState(""),[u,m]=w.useState(""),[h,x]=w.useState("Medium"),[v,b]=w.useState([]),[N,T]=w.useState(""),[_,I]=w.useState("Open"),[E,D]=w.useState(""),[z,A]=w.useState([]),[M,B]=w.useState(!1),[L,X]=w.useState(null),[de,V]=w.useState([]),[Z,K]=w.useState([]),[F,le]=w.useState(!1);w.useEffect(()=>{(async()=>{try{const[R,ue]=await Promise.all([Of(t,e),Ir(t,e)]);V(R),K(ue)}catch(R){console.error("Failed to load data for task modal",R)}})()},[t,e]),w.useEffect(()=>{const R=ue=>{ue.key==="Escape"&&s()};return window.addEventListener("keydown",R),()=>window.removeEventListener("keydown",R)},[s]);const he=w.useMemo(()=>Array.from(new Set([...de.map(R=>R.name.trim()),...Z.flatMap(R=>(Array.isArray(R.category)?R.category:[R.category||""]).map(Y=>(Y||"").trim()))].filter(Boolean))),[de,Z]),re=w.useMemo(()=>he.filter(R=>R.toLowerCase().includes((N||"").toLowerCase())&&!v.includes(R)),[he,N,v]),q=async R=>{if(R.preventDefault(),!!i.trim()){B(!0),X(null);try{const ue=Array.from(new Set([...v,...N.trim()?[N.trim()]:[]]));await xa(t,i.trim(),u||void 0,void 0,h,{description:E,category:ue.length?ue:void 0,status:_,assigneeIds:z},e);const[Y,ye]=await Promise.all([Ir(t,e),Of(t,e)]);K(Y),V(ye),o==null||o(Y,ye),c(""),m(""),x("Medium"),b([]),T(""),I("Open"),D(""),s()}catch(ue){console.error("Failed to add task",ue),X("Failed to add task. Please try again.")}finally{B(!1)}}},H=async()=>{if(i.trim()){le(!0),X(null);try{const R=await dk(i,E||"Task details");D(R.slice(0,280))}catch(R){console.error("Failed to generate description",R),X("Could not generate a description right now.")}finally{le(!1)}}};return r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4 backdrop-blur-sm",onClick:s,children:r.jsx("div",{className:"w-full max-w-4xl max-h-[90vh] overflow-y-auto p-6 animate-fade-up bg-[var(--color-surface-card)] rounded-xl border border-[var(--color-surface-border)] shadow-2xl",onClick:R=>R.stopPropagation(),children:r.jsxs("form",{onSubmit:q,className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between gap-3 border-b border-[var(--color-surface-border)] pb-4",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-bold text-[var(--color-text-main)]",children:"New Task"}),r.jsx("p",{className:"text-sm text-[var(--color-text-muted)] mt-1",children:"Capture details, status, and categories in one place."})]}),r.jsx(Ne,{type:"button",variant:"ghost",onClick:s,size:"sm",children:"Close"})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"lg:col-span-2 flex flex-col gap-6",children:[r.jsx(st,{label:"Title",placeholder:"Add a new task...",value:i,maxLength:50,onChange:R=>c(R.target.value),autoFocus:!0,required:!0}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("label",{className:"text-sm font-bold text-[var(--color-text-main)]",children:"Description"}),r.jsx(Ne,{type:"button",onClick:H,disabled:F||!i,variant:"ghost",size:"xs",loading:F,icon:r.jsx("span",{className:"material-symbols-outlined text-sm",children:"auto_awesome"}),children:"Generate with Gemini"})]}),r.jsx(An,{value:E,onChange:R=>D(R.target.value),placeholder:"Add context, acceptance criteria, or notes",rows:4})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"text-sm font-bold text-[var(--color-text-main)]",children:"Categories"}),r.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:v.map(R=>r.jsxs("span",{className:"px-2 py-1 rounded bg-[var(--color-surface-hover)] border border-[var(--color-surface-border)] text-xs font-medium text-[var(--color-text-main)] flex items-center gap-1",children:[R,r.jsx("button",{type:"button",onClick:()=>b(ue=>ue.filter(Y=>Y!==R)),className:"hover:text-red-500",children:""})]},R))}),r.jsx(st,{value:N,onChange:R=>T(R.target.value),onKeyDown:R=>{if(R.key==="Enter"){R.preventDefault();const ue=N.trim();ue&&!v.includes(ue)&&b(Y=>[...Y,ue]),T("")}},placeholder:"Type and press Enter to add"}),r.jsxs("div",{className:"flex flex-wrap gap-2 pt-2",children:[(N?re:he).map(R=>r.jsx("button",{type:"button",onClick:()=>{v.includes(R)||b(ue=>[...ue,R]),T("")},className:`px-2 py-1 rounded text-xs border transition-colors ${v.includes(R)?"bg-[var(--color-text-main)] text-[var(--color-surface-bg)] border-[var(--color-text-main)]":"bg-transparent border-[var(--color-surface-border)] text-[var(--color-text-muted)] hover:border-[var(--color-text-main)]"}`,children:R},R)),he.length===0&&r.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:"No categories yet"})]})]})]}),r.jsxs(Be,{className:"flex flex-col gap-4 h-fit",children:[r.jsxs("div",{className:"flex flex-col gap-1.5",children:[r.jsx("label",{className:"text-xs font-bold uppercase tracking-wider text-[var(--color-text-muted)] ml-1",children:"Due Date"}),r.jsx(Pb,{value:u,onChange:m,placeholder:"Set due date",align:"right"})]}),r.jsxs(xn,{label:"Priority",value:h,onChange:R=>x(R.target.value),children:[r.jsx("option",{value:"Urgent",children:"Urgent"}),r.jsx("option",{value:"High",children:"High"}),r.jsx("option",{value:"Medium",children:"Medium"}),r.jsx("option",{value:"Low",children:"Low"})]}),r.jsxs(xn,{label:"Status",value:_,onChange:R=>I(R.target.value),children:[r.jsx("option",{value:"Backlog",children:"Backlog"}),r.jsx("option",{value:"Open",children:"Open"}),r.jsx("option",{value:"In Progress",children:"In Progress"}),r.jsx("option",{value:"On Hold",children:"On Hold"}),r.jsx("option",{value:"Blocked",children:"Blocked"}),r.jsx("option",{value:"Done",children:"Done"})]}),r.jsxs("div",{className:"flex flex-col gap-1.5",children:[r.jsx("label",{className:"text-xs font-bold uppercase tracking-wider text-[var(--color-text-muted)] ml-1",children:"Assignees"}),r.jsx(Nd,{projectId:t,assigneeIds:z,onChange:A})]}),r.jsx("div",{className:"text-xs text-[var(--color-text-muted)] mt-2",children:"Tip: Use categories and status to keep the board organized."})]})]}),r.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-[var(--color-surface-border)]",children:[L?r.jsx("span",{className:"text-sm text-rose-600",children:L}):r.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:"Press Enter in categories to create new pills or click suggestions."}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx(Ne,{variant:"ghost",onClick:s,children:"Cancel"}),r.jsx(Ne,{type:"submit",loading:M,children:"Add Task"})]})]})]})})})},vM=({user:t,children:e})=>r.jsxs("div",{className:"group relative inline-block",children:[e,r.jsxs("div",{className:"absolute bottom-full mb-2 left-1/2 -translate-x-1/2 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-100 dark:border-gray-700 p-3 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-50",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("div",{className:"size-10 rounded-full bg-gray-200 overflow-hidden shrink-0",children:t.photoURL?r.jsx("img",{src:t.photoURL,className:"w-full h-full object-cover",alt:""}):r.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-500 font-bold text-xs",children:t.displayName[0]})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-bold text-gray-900 dark:text-gray-100 leading-tight",children:t.displayName}),t.title&&r.jsx("p",{className:"text-xs font-medium text-[var(--color-primary)] mb-0.5",children:t.title}),r.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 capitalize flex items-center gap-1",children:[r.jsx("span",{className:`size-2 rounded-full ${t.isOnline?"bg-emerald-500":"bg-gray-300"}`}),t.isOnline?"Online":"Offline"]})]})]}),t.email&&r.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-gray-900/50 p-1.5 rounded break-all border border-gray-100 dark:border-gray-800 mb-2",children:t.email}),t.bio&&r.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-300 italic px-1",children:['"',t.bio,'"']}),r.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 border-8 border-transparent border-t-white dark:border-t-gray-800 drop-shadow-sm"})]})]});function Lm(t){const e=xe.currentUser;return w.useMemo(()=>{const o=e==null?void 0:e.uid,i=Dm(t,o),c=sk(t,o),u=(t==null?void 0:t.ownerId)===o;return{role:i,capabilities:c,isOwner:u,can:m=>nk(t,o,m)}},[t,e==null?void 0:e.uid])}const yM=({projectId:t,tenantId:e,onInvite:s})=>{var R;const[o,i]=w.useState(null),[c,u]=w.useState([]),[m,h]=w.useState(!0),[x,v]=w.useState({}),[b,N]=w.useState({}),[T,_]=w.useState(!1),[I,E]=w.useState(!1),[D,z]=w.useState(null),[A,M]=w.useState(null),[B,L]=w.useState(!1),{isOwner:X}=Lm(o),de=(R=xe.currentUser)==null?void 0:R.uid,V=c.some(ue=>(typeof ue=="string"?ue:ue.userId)===de)||(o==null?void 0:o.ownerId)===de,Z=async()=>{if(!(!de||!o)){_(!0);try{await gy(o.id,e),E(!0)}catch(ue){console.error(ue),alert("Failed to send join request")}finally{_(!1)}}};w.useEffect(()=>{let ue=!0;const Y=bm(t,je=>{ue&&je&&(i(je),u(je.members||[]),h(!1))},e),ye=ry(t,je=>{if(ue){const J={};je.forEach(we=>J[we.uid]=we),v(J)}},e);return()=>{ue=!1,Y(),ye()}},[t,e]),w.useEffect(()=>{(async()=>{const ye=c.map(J=>typeof J=="string"?J:J.userId).filter(J=>!x[J]&&!b[J]);if(ye.length===0)return;const je={};await Promise.all(ye.map(async J=>{try{const we=await Mn(J,e);we&&(je[J]=we)}catch(we){console.warn(`Failed to fetch profile for ${J}`,we)}})),N(J=>({...J,...je}))})()},[c,x,e]);const K=ue=>{M(ue)},F=async()=>{if(!(!A||!o)){z(A),M(null);try{await $c(o.id,A,e)}catch(ue){console.error(ue),alert("Failed to remove member")}finally{z(null)}}},le=()=>{L(!0)},he=async()=>{if(!(!o||!de)){z(de),L(!1);try{await $c(o.id,de,e)}catch(ue){console.error(ue),alert("Failed to leave project")}finally{z(null)}}},re=ue=>typeof ue=="string"?ue:ue.userId,q=ue=>typeof ue=="string"?void 0:ue.role,H=Object.keys(x).length;return r.jsxs(r.Fragment,{children:[r.jsxs(Be,{children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"h4",children:"Project Team"}),r.jsxs("p",{className:"text-xs text-[var(--color-text-muted)] mt-1",children:[c.length," member",c.length!==1?"s":"","  ",H," active"]})]}),!m&&(V?s&&r.jsxs("div",{className:"flex gap-2",children:[r.jsx(Ne,{size:"sm",variant:"ghost",onClick:s,icon:r.jsx("span",{className:"material-symbols-outlined",children:"person_add"}),children:"Invite"}),!X&&r.jsx(Ne,{size:"sm",variant:"ghost",onClick:le,className:"text-rose-500 hover:text-rose-600 hover:bg-rose-50 dark:hover:bg-rose-900/10",children:"Leave"})]}):r.jsx(Ne,{size:"sm",variant:"primary",onClick:Z,isLoading:T,disabled:I,icon:r.jsx("span",{className:"material-symbols-outlined",children:I?"check":"group_add"}),children:I?"Request Sent":"Join Project"}))]}),m?r.jsx("div",{className:"flex items-center justify-center py-8",children:r.jsx("span",{className:"material-symbols-outlined text-[var(--color-text-subtle)] animate-spin",children:"progress_activity"})}):r.jsx("div",{className:"space-y-2",children:c.length===0?r.jsx("p",{className:"text-sm text-[var(--color-text-muted)] text-center py-4",children:"No team members yet."}):c.map((ue,Y)=>{const ye=re(ue),je=q(ue),J=ye===de,we=X&&!J&&(o==null?void 0:o.ownerId)!==ye,be=x[ye],me=b[ye],Ae=!!(be!=null&&be.isOnline),De=(be==null?void 0:be.displayName)||(me==null?void 0:me.displayName)||ye,Ee=(be==null?void 0:be.photoURL)||(me==null?void 0:me.photoURL),ut={uid:ye,displayName:De===ye&&J?"You":De,photoURL:Ee,isOnline:Ae};return r.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-[var(--color-surface-hover)] transition-colors group",children:[r.jsxs("div",{className:"relative",children:[r.jsx(vM,{user:ut,children:Ee?r.jsx("img",{src:Ee,alt:De,className:`size-10 rounded-full object-cover cursor-pointer border-2 ${Ae?"border-emerald-500":"border-[var(--color-surface-border)]"}`}):r.jsx("div",{className:`size-10 rounded-full flex items-center justify-center text-white font-bold text-sm cursor-pointer border-2 ${Ae?"border-emerald-500":"border-transparent"}`,style:{backgroundColor:"var(--color-primary)"},children:(De||"?").charAt(0).toUpperCase()})}),Ae&&r.jsx("div",{className:"absolute bottom-0 right-0 size-3.5 rounded-full bg-emerald-500 border-2 border-[var(--color-surface-paper)]",title:"Online"})]}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("p",{className:"text-sm font-medium text-[var(--color-text-main)] truncate",children:J?`${De} (You)`:De}),je&&r.jsx("span",{className:`px-2 py-0.5 text-[10px] font-bold uppercase tracking-wider rounded-md ${je==="Owner"?"bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400":je==="Editor"?"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400":"bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-400"}`,children:je}),(o==null?void 0:o.ownerId)===ye&&!je&&r.jsx("span",{className:"px-2 py-0.5 text-[10px] font-bold uppercase tracking-wider rounded-md bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400",children:"Owner"})]}),r.jsx("p",{className:"text-xs text-[var(--color-text-subtle)] flex items-center gap-1",children:Ae?r.jsx("span",{className:"text-emerald-600 dark:text-emerald-400 font-medium",children:"Online now"}):r.jsx("span",{children:"Offline"})})]}),we&&r.jsx("button",{onClick:()=>K(ye),disabled:D===ye,className:"opacity-0 group-hover:opacity-100 transition-opacity p-2 rounded-full hover:bg-rose-100 dark:hover:bg-rose-900/20 text-rose-600 dark:text-rose-400 disabled:opacity-50",title:"Remove member",children:D===ye?r.jsx("span",{className:"material-symbols-outlined text-[18px] animate-spin",children:"progress_activity"}):r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"person_remove"})})]},Y)})})]}),r.jsx(_r,{isOpen:!!A,onClose:()=>M(null),title:"Remove Member",children:r.jsxs("div",{className:"space-y-4",children:[r.jsx("p",{className:"text-[var(--color-text-main)]",children:"Are you sure you want to remove this member from the project? They will lose access to all project resources."}),r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx(Ne,{variant:"ghost",onClick:()=>M(null),children:"Cancel"}),r.jsx(Ne,{variant:"primary",onClick:F,className:"bg-rose-600 hover:bg-rose-700 text-white",children:"Remove"})]})]})}),r.jsx(_r,{isOpen:B,onClose:()=>L(!1),title:"Leave Project",children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("p",{className:"text-[var(--color-text-main)]",children:["Are you sure you want to leave ",r.jsx("strong",{children:o==null?void 0:o.title}),"? You will no longer have access to this project."]}),r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx(Ne,{variant:"ghost",onClick:()=>L(!1),children:"Cancel"}),r.jsx(Ne,{variant:"primary",onClick:he,className:"bg-rose-600 hover:bg-rose-700 text-white",children:"Leave Project"})]})]})})]})},bM={Owner:{title:"Owner",description:"Full control over the project",capabilities:["Edit project settings","Delete project","Invite members","Manage all content"]},Editor:{title:"Editor",description:"Can create and manage content",capabilities:["Create/edit tasks, ideas, and issues","Add comments","Cannot edit project settings"]},Viewer:{title:"Viewer",description:"Read-only access",capabilities:["View all content","Add comments","Cannot create or edit"]}},NM={Owner:{title:"Workspace Owner",description:"Full administrative access",capabilities:["Manage billing","Delete workspace","Manage all members","Create projects"]},Admin:{title:"Admin",description:"Can manage members and projects",capabilities:["Invite members","Create projects","Manage groups","Manage settings"]},Member:{title:"Member",description:"Standard access",capabilities:["Create projects (if allowed)","View projects","Join projects"]},Guest:{title:"Guest",description:"Limited access",capabilities:["View assigned items only","Cannot create projects"]}},zb=({isOpen:t,onClose:e,onGenerateLink:s,projectTitle:o,isWorkspace:i})=>{const[c,u]=w.useState(i?"Member":"Editor"),[m,h]=w.useState(""),[x,v]=w.useState("24"),[b,N]=w.useState(""),[T,_]=w.useState(!1),[I,E]=w.useState(null),[D,z]=w.useState(!1);nr.useEffect(()=>{t&&(u(i?"Member":"Editor"),N(""),h(""),v("24"),E(null),z(!1))},[t,i]);const A=async()=>{E(null),_(!0);try{const L=m?parseInt(m):void 0,X=parseInt(x),de=await s(c,L,X);N(de)}catch(L){E(L.message||"Failed to generate invite link")}finally{_(!1)}},M=async()=>{try{await navigator.clipboard.writeText(b),z(!0),setTimeout(()=>z(!1),2e3)}catch(L){console.error("Failed to copy:",L)}},B=()=>{e()};return r.jsx(_r,{isOpen:t,onClose:B,title:`Invite to ${o}`,size:"md",footer:b?r.jsx(Ne,{onClick:B,children:"Done"}):r.jsxs(r.Fragment,{children:[r.jsx(Ne,{variant:"ghost",onClick:B,disabled:T,children:"Cancel"}),r.jsx(Ne,{onClick:A,isLoading:T,children:"Generate Invite Link"})]}),children:b?r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"bg-emerald-50 dark:bg-emerald-900/10 border border-emerald-200 dark:border-emerald-800 rounded-lg p-4 flex items-start gap-3",children:[r.jsx("span",{className:"material-symbols-outlined text-emerald-600 dark:text-emerald-400 text-2xl",children:"check_circle"}),r.jsxs("div",{className:"flex-1",children:[r.jsx("p",{className:"font-bold text-emerald-900 dark:text-emerald-100 mb-1",children:"Invite Link Created!"}),r.jsxs("p",{className:"text-sm text-emerald-800 dark:text-emerald-200",children:["Share this link to invite members as ",r.jsx("span",{className:"font-bold",children:c})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-[var(--color-text-muted)] uppercase tracking-wider mb-2",children:"Invite Link"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("div",{className:"flex-1 px-4 py-3 bg-[var(--color-surface-hover)] border border-[var(--color-surface-border)] rounded-lg font-mono text-sm text-[var(--color-text-main)] truncate",children:b}),r.jsx(Ne,{variant:"secondary",onClick:M,icon:r.jsx("span",{className:"material-symbols-outlined",children:D?"check":"content_copy"}),children:D?"Copied!":"Copy"})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-3 p-4 bg-[var(--color-surface-hover)] rounded-lg border border-[var(--color-surface-border)]",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-[var(--color-text-muted)] mb-1",children:"Role"}),r.jsx("p",{className:"font-semibold text-sm",children:c})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-[var(--color-text-muted)] mb-1",children:"Max Uses"}),r.jsx("p",{className:"font-semibold text-sm",children:m||"Unlimited"})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-[var(--color-text-muted)] mb-1",children:"Expires In"}),r.jsxs("p",{className:"font-semibold text-sm",children:[x,"h"]})]})]})]}):r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-[var(--color-text-main)] mb-3",children:"Role & Permissions"}),r.jsx("div",{className:"space-y-3",children:i?["Admin","Member","Guest"].map(L=>{const X=NM[L];return r.jsxs("label",{className:`flex items-start gap-3 p-4 rounded-xl border-2 cursor-pointer transition-all ${c===L?"border-[var(--color-primary)] bg-[var(--color-primary)]/5":"border-[var(--color-surface-border)] hover:border-[var(--color-primary)]/50 hover:bg-[var(--color-surface-hover)]"}`,children:[r.jsx("input",{type:"radio",name:"role",value:L,checked:c===L,onChange:()=>u(L),className:"mt-1 size-4 text-[var(--color-primary)] border-[var(--color-surface-border)] focus:ring-[var(--color-primary)]"}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"flex items-center gap-2 mb-1",children:r.jsx("span",{className:"font-bold text-[var(--color-text-main)]",children:X.title})}),r.jsx("p",{className:"text-sm text-[var(--color-text-muted)] mb-2",children:X.description}),r.jsx("ul",{className:"space-y-1",children:X.capabilities.map((de,V)=>r.jsxs("li",{className:"flex items-center gap-2 text-xs text-[var(--color-text-subtle)]",children:[r.jsx("span",{className:"material-symbols-outlined text-[12px] text-emerald-600 dark:text-emerald-400",children:"check_circle"}),de]},V))})]})]},L)}):["Editor","Viewer","Owner"].map(L=>{const X=bM[L];return r.jsxs("label",{className:`flex items-start gap-3 p-4 rounded-xl border-2 cursor-pointer transition-all ${c===L?"border-[var(--color-primary)] bg-[var(--color-primary)]/5":"border-[var(--color-surface-border)] hover:border-[var(--color-primary)]/50 hover:bg-[var(--color-surface-hover)]"}`,children:[r.jsx("input",{type:"radio",name:"role",value:L,checked:c===L,onChange:()=>u(L),className:"mt-1 size-4 text-[var(--color-primary)] border-[var(--color-surface-border)] focus:ring-[var(--color-primary)]"}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("span",{className:"font-bold text-[var(--color-text-main)]",children:X.title}),L==="Owner"&&r.jsx("span",{className:"px-2 py-0.5 text-xs font-bold bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400 rounded",children:"Caution"})]}),r.jsx("p",{className:"text-sm text-[var(--color-text-muted)] mb-2",children:X.description}),r.jsx("ul",{className:"space-y-1",children:X.capabilities.map((de,V)=>r.jsxs("li",{className:"flex items-center gap-2 text-xs text-[var(--color-text-subtle)]",children:[r.jsx("span",{className:"material-symbols-outlined text-[12px] text-emerald-600 dark:text-emerald-400",children:"check_circle"}),de]},V))})]})]},L)})})]}),r.jsxs("div",{className:"space-y-4 p-4 bg-[var(--color-surface-hover)] rounded-xl border border-[var(--color-surface-border)]",children:[r.jsxs("h4",{className:"text-sm font-bold text-[var(--color-text-main)] flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"settings"}),"Link Settings"]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-[var(--color-text-muted)] uppercase tracking-wider mb-2",children:"Max Uses"}),r.jsx(st,{type:"number",min:"1",placeholder:"Unlimited",value:m,onChange:L=>h(L.target.value)}),r.jsx("p",{className:"text-xs text-[var(--color-text-subtle)] mt-1",children:"Leave empty for unlimited"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-semibold text-[var(--color-text-muted)] uppercase tracking-wider mb-2",children:"Expires In (hours)"}),r.jsxs(xn,{value:x,onChange:L=>v(L.target.value),children:[r.jsx("option",{value:"1",children:"1 hour"}),r.jsx("option",{value:"6",children:"6 hours"}),r.jsx("option",{value:"24",children:"24 hours"}),r.jsx("option",{value:"72",children:"3 days"}),r.jsx("option",{value:"168",children:"7 days"}),r.jsx("option",{value:"720",children:"30 days"}),r.jsx("option",{value:"8760",children:"1 year"})]})]})]})]}),c==="Owner"&&!i&&r.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/10 border border-amber-200 dark:border-amber-800 rounded-lg p-4 flex items-start gap-3",children:[r.jsx("span",{className:"material-symbols-outlined text-amber-600 dark:text-amber-400 mt-0.5",children:"warning"}),r.jsxs("div",{className:"flex-1 text-sm text-amber-800 dark:text-amber-200",children:[r.jsx("p",{className:"font-bold mb-1",children:"Sharing Ownership"}),r.jsx("p",{children:"Anyone with this link will become an owner with full control, including the ability to delete the project or remove you."})]})]}),I&&r.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/10 border border-red-200 dark:border-red-800 rounded-lg p-3",children:I})]})})},Qa=nr.forwardRef(({label:t,className:e="",...s},o)=>r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"checkbox",ref:o,className:`
                        appearance-none
                        size-5
                        rounded-md
                        border-2
                        border-[var(--color-surface-border)]
                        bg-[var(--color-surface-bg)]
                        checked:bg-[var(--color-primary)]
                        checked:border-[var(--color-primary)]
                        focus:ring-2
                        focus:ring-[var(--color-primary)]
                        focus:ring-offset-2
                        dark:focus:ring-offset-zinc-900
                        cursor-pointer
                        transition-all
                        relative
                        after:content-['']
                        after:absolute
                        after:left-[6px]
                        after:top-[2px]
                        after:w-[5px]
                        after:h-[10px]
                        after:border-r-2
                        after:border-b-2
                        after:border-white
                        dark:after:border-zinc-900
                        after:rotate-45
                        after:opacity-0
                        checked:after:opacity-100
                        ${e}
                    `,...s}),t&&r.jsx("label",{className:"text-sm text-[var(--color-text-main)] select-none",children:t})]})),v0=t=>(t||"").replace(/\*\*/g,""),wM=(t,e)=>{const s=(e||"").toLowerCase();return t==="task"?s.includes("deleted")||s.includes("remove")?{icon:"delete",color:"text-rose-600 dark:text-rose-400",bg:"bg-rose-100 dark:bg-rose-500/10"}:s.includes("reopened")?{icon:"undo",color:"text-amber-600 dark:text-amber-400",bg:"bg-amber-100 dark:bg-amber-500/10"}:s.includes("completed")||s.includes("done")?{icon:"check_circle",color:"text-emerald-600 dark:text-emerald-400",bg:"bg-emerald-100 dark:bg-emerald-500/10"}:{icon:"add_task",color:"text-blue-600 dark:text-blue-400",bg:"bg-blue-100 dark:bg-blue-500/10"}:t==="status"?{icon:"swap_horiz",color:"text-indigo-600 dark:text-indigo-400",bg:"bg-indigo-100 dark:bg-indigo-500/10"}:t==="report"?{icon:"auto_awesome",color:"text-purple-600 dark:text-purple-400",bg:"bg-purple-100 dark:bg-purple-500/10"}:t==="comment"?{icon:"chat_bubble",color:"text-amber-600",bg:"bg-amber-100"}:t==="file"?{icon:"attach_file",color:"text-slate-600",bg:"bg-slate-100"}:t==="member"?{icon:"person_add",color:"text-emerald-600 dark:text-emerald-400",bg:"bg-emerald-100 dark:bg-emerald-500/10"}:t==="commit"?{icon:"code",color:"text-blue-600",bg:"bg-blue-100"}:t==="priority"?{icon:"priority_high",color:"text-rose-600 dark:text-rose-400",bg:"bg-rose-100 dark:bg-rose-500/10"}:{icon:"more_horiz",color:"text-slate-600 dark:text-slate-400",bg:"bg-slate-100 dark:bg-slate-700/50"}},SM=()=>{var uo,fo,zn,Ea,cr;const{id:t}=Yn(),e=dn(),[s,o]=w.useState(null),[i,c]=w.useState([]),[u,m]=w.useState(!0),[h,x]=w.useState(null),[v,b]=w.useState([]),[N,T]=w.useState([]),[_,I]=w.useState([]),[E,D]=w.useState(null),[z,A]=w.useState(!1),[M,B]=w.useState(null),[L,X]=w.useState(!1),[de,V]=w.useState(null),[Z,K]=w.useState(!0),[F,le]=w.useState(!1),[he,re]=w.useState(!1),[q,H]=w.useState(!1),[R,ue]=w.useState(!1),{can:Y,isOwner:ye}=Lm(s),[je,J]=w.useState(""),[we,be]=w.useState(""),[me,Ae]=w.useState("Active"),[De,Ee]=w.useState("Medium"),[ut,He]=w.useState(""),[Vt,Et]=w.useState(""),[Xe,Jt]=w.useState([]),[ft,Pt]=w.useState([]),[Nt,zt]=w.useState([]),[_t,un]=w.useState(null),[P,k]=w.useState(null),[Q,ne]=w.useState([]),[se,Se]=w.useState([]),[Ce,Te]=w.useState(!1),[Ge,et]=w.useState(0),[tt,gt]=w.useState(!1),[bt,gn]=w.useState(!1),[sn,fn]=w.useState(!1),[Mt,Ln]=w.useState(!1),[rr,$s]=w.useState(!1),[ar,fs]=w.useState([]),[Ur,Ys]=w.useState(!1),[lo,Jn]=w.useState(null),[En,Js]=w.useState(""),[Pr,or]=w.useState(!1),[Ds,wa]=w.useState([]),[Sa,Xn]=w.useState(!1),[Xs,ms]=w.useState(null),[mn,Bt]=w.useState(1),[wt,Kn]=w.useState(null),ir=(ae,Ie)=>{if(ae.target.files&&ae.target.files[0]){const Me=ae.target.files[0],We=new FileReader;We.onload=()=>{ms(We.result),Kn(Ie),Bt(Ie==="cover"?16/9:1)},We.readAsDataURL(Me)}ae.target.value=""},ja=ae=>{if(wt==="cover"){const Ie=new File([ae],"cover.jpg",{type:"image/jpeg"});un(Ie),gt(!1)}else if(wt==="icon"){const Ie=new File([ae],"icon.jpg",{type:"image/jpeg"});k(Ie),gn(!1)}co()},co=()=>{ms(null),Kn(null)};w.useEffect(()=>{if(!t)return;ll(t,"online");const ae=setInterval(()=>ll(t,"online"),6e4),Ie=()=>{ll(t,"offline")};return window.addEventListener("beforeunload",Ie),()=>{clearInterval(ae),ll(t,"offline"),window.removeEventListener("beforeunload",Ie)}},[t]),w.useEffect(()=>{if(!t)return;(async()=>{var Ie;D(null);try{const Me=await $t(t);if(!Me){D("Project not found."),o(null),m(!1);return}if(o(Me),J(Me.title||""),be(Me.description||""),Ae(Me.status||"Active"),Ee(Me.priority||"Medium"),He(Me.startDate||""),Et(Me.dueDate||""),Jt(Me.modules||["tasks","ideas","mindmap","activity"]),Pt(Me.links||[]),zt(Me.externalResources||[]),Se(Me.screenshots||[]),ne([]),gt(!1),gn(!1),un(null),k(null),Js(Me.githubRepo||""),or(Me.githubIssueSync||!1),xe.currentUser){const pn=await Mn(xe.currentUser.uid,Me.tenantId),_a=((Ie=Me.members)==null?void 0:Ie.some(vs=>{var Qn;return vs.userId===((Qn=xe.currentUser)==null?void 0:Qn.uid)}))||Me.ownerId===xe.currentUser.uid;if(!pn&&!_a){A(!0),m(!1);return}const gs=pn||await Mn(xe.currentUser.uid);if(Me.githubRepo){Ys(!0),Jn(null);const vs=Me.githubToken||(gs==null?void 0:gs.githubToken);gS(Me.githubRepo,vs).then(fs).catch(Qn=>Jn(Qn.message)).finally(()=>Ys(!1))}gs!=null&&gs.githubToken&&(Xn(!0),yg(gs.githubToken).then(wa).catch(vs=>console.error("Failed to fetch user repos",vs)).finally(()=>Xn(!1)))}const We=await uk();x(We);const Gn=await Hf(t);V(Gn);const Ks=ii(t,c,Me.tenantId),dr=ay(t,b,Me.tenantId),zr=Nm(t,T,Me.tenantId),ur=wl(t,I,Me.tenantId);return()=>{Ks(),dr(),zr(),ur()}}catch(Me){console.error(Me),D("Failed to load project data.")}finally{m(!1)}})()},[t]);const Ta=async()=>{if(xe.currentUser){$s(!0);try{const ae=await fm();await ni(xe.currentUser.uid,{githubToken:ae}),Xn(!0);const Ie=await yg(ae);wa(Ie)}catch(ae){console.error("Failed to link GitHub",ae)}finally{$s(!1),Xn(!1)}}};w.useEffect(()=>{if(de!=null&&de.createdAt){const ae=Le(de.createdAt),Ie=1e3*60*60*24*14;K(Date.now()-ae>Ie)}else K(!0)},[de]);const ps=async(ae,Ie)=>{s&&(c(i.map(Me=>Me.id===ae?{...Me,isCompleted:!Ie}:Me)),await Nl(ae,Ie,s.id))},Lr=async()=>{if(s){X(!0);try{const ae=await fk(s,i);B(ae),await U0(s.id,ae);const Ie=await Hf(s.id);V(Ie)}catch(ae){console.error(ae)}finally{X(!1)}}},it=async(ae,Ie)=>{var Ks;const We=`tenants/${Ar()||(s==null?void 0:s.ownerId)||((Ks=xe==null?void 0:xe.currentUser)==null?void 0:Ks.uid)||"public"}/projects/${Date.now()}_${Ie}_${ae.name}`,Gn=fl(Wo,We);return await ml(Gn,ae),pl(Gn)},hs=async()=>{if(s){fn(!0);try{const ae={title:je,description:we,status:me,priority:De,startDate:ut||null,dueDate:Vt||null,modules:Xe,links:ft,externalResources:Nt,githubRepo:En,githubIssueSync:Pr};_t?ae.coverImage=await it(_t,"cover"):tt&&(ae.coverImage=null),P?ae.squareIcon=await it(P,"icon"):bt&&(ae.squareIcon=null);const Ie=await Promise.all(Q.map(We=>it(We,"gallery")));ae.screenshots=[...se,...Ie],await D0(s.id,ae,{action:"Updated project details",target:s.title,type:"status"});const Me=await $t(s.id);Me&&o(Me),le(!1)}catch(ae){console.error(ae),D("Failed to update project.")}finally{fn(!1)}}},lr=async()=>{if(s){Ln(!0);try{await L0(s.id),e("/projects")}catch(ae){console.error(ae),D("Failed to delete project.")}finally{Ln(!1),re(!1)}}},Xt=()=>{ue(!0)};if(u)return r.jsx("div",{className:"flex items-center justify-center p-12",children:r.jsx("span",{className:"material-symbols-outlined text-[var(--color-text-subtle)] animate-spin text-3xl",children:"progress_activity"})});if(z)return r.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[60vh] text-center p-8",children:[r.jsx("div",{className:"size-24 rounded-full bg-rose-100 dark:bg-rose-900/20 flex items-center justify-center mb-6",children:r.jsx("span",{className:"material-symbols-outlined text-5xl text-rose-500",children:"lock"})}),r.jsx("h1",{className:"text-3xl font-bold text-[var(--color-text-main)] mb-2",children:"Access Denied"}),r.jsx("p",{className:"text-[var(--color-text-muted)] max-w-md mb-8",children:"You do not have permission to view this project. You are not a member of this workspace nor have you been invited to this project."}),r.jsx(nt,{to:"/projects",children:r.jsx(Ne,{variant:"primary",icon:r.jsx("span",{className:"material-symbols-outlined",children:"arrow_back"}),children:"Back to Projects"})})]});if(!s)return r.jsx("div",{className:"p-8",children:"Project not found"});const Gt=i.filter(ae=>ae.isCompleted).length,Ca=i.length>0?Math.round(Gt/i.length*100):0,qt=i.length-Gt,xs=i.filter(ae=>ae.priority==="Urgent").length,Wn=[...i].sort((ae,Ie)=>Le(Ie.createdAt)-Le(ae.createdAt)).slice(0,5);return r.jsxs("div",{className:"flex flex-col gap-6 fade-in",children:[r.jsx(jb,{isOpen:!!Xs,imageSrc:Xs,aspectRatio:mn,onCropComplete:ja,onCancel:co}),r.jsxs("div",{className:"flex flex-col gap-6",children:[r.jsxs("div",{className:"relative w-full h-48 md:h-64 rounded-xl overflow-hidden bg-[var(--color-surface-hover)] border border-[var(--color-surface-border)]",children:[s.coverImage?r.jsx("img",{src:s.coverImage,alt:"Cover",className:"w-full h-full object-cover"}):r.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-50 to-blue-50 dark:from-indigo-950/30 dark:to-blue-950/30 opacity-50"}),r.jsx("div",{className:"absolute top-4 right-4 flex gap-2",children:ye&&r.jsxs(r.Fragment,{children:[r.jsx(Ne,{variant:"secondary",size:"sm",onClick:()=>le(!0),icon:r.jsx("span",{className:"material-symbols-outlined",children:"edit"}),children:"Edit"}),r.jsx(Ne,{variant:"secondary",size:"sm",onClick:()=>re(!0),icon:r.jsx("span",{className:"material-symbols-outlined text-rose-500",children:"delete"})})]})})]}),r.jsxs("div",{className:"flex flex-col md:flex-row gap-6 md:items-start px-2",children:[r.jsx("div",{className:"relative -mt-16 md:-mt-20 shrink-0",children:r.jsx("div",{className:"size-24 md:size-32 rounded-2xl border-4 border-[var(--color-surface-paper)] bg-white shadow-md overflow-hidden flex items-center justify-center",children:s.squareIcon?r.jsx("img",{src:s.squareIcon,alt:"",className:"w-full h-full object-cover"}):r.jsx("span",{className:"text-4xl font-bold text-indigo-500",children:s.title.charAt(0)})})}),r.jsxs("div",{className:"flex-1 space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[r.jsx("h1",{className:"text-3xl font-bold text-[var(--color-text-main)]",children:s.title}),r.jsx(Tn,{variant:s.status==="Active"?"success":"primary",children:s.status}),r.jsxs(Tn,{variant:"secondary",children:[s.priority," Priority"]})]}),r.jsx("p",{className:"text-[var(--color-text-muted)] text-lg leading-relaxed max-w-3xl",children:s.description||"No description provided."})]}),r.jsxs("div",{className:"flex items-center gap-3 pt-2",children:[Y("canManageTasks")&&r.jsx(Ne,{onClick:()=>H(!0),icon:r.jsx("span",{className:"material-symbols-outlined",children:"add_task"}),children:"New Task"}),((uo=s.modules)==null?void 0:uo.includes("ideas"))&&r.jsx(nt,{to:`/project/${t}/ideas`,children:r.jsx(Ne,{variant:"secondary",icon:r.jsx("span",{className:"material-symbols-outlined",children:"lightbulb"}),children:"Ideas"})})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4",children:[r.jsxs(Be,{padding:"sm",className:"flex items-center gap-4 p-4 col-span-1 sm:col-span-2 md:col-span-2",children:[r.jsxs("div",{className:"relative size-16 shrink-0",children:[r.jsx(yb,{data:[{name:"Completed",value:Gt,color:"var(--color-success)"},{name:"Open",value:qt,color:"var(--color-surface-border)"}],size:64,thickness:8}),r.jsxs("div",{className:"absolute inset-0 flex items-center justify-center text-xs font-bold",children:[Ca,"%"]})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"text-sm font-bold text-[var(--color-text-main)]",children:"Task Progress"}),r.jsxs("p",{className:"text-xs text-[var(--color-text-muted)]",children:[Gt," of ",i.length," tasks completed"]})]})]}),[{label:"Open Tasks",value:qt,icon:"list"},{label:"Urgent",value:xs,icon:"warning",color:xs>0?"text-rose-500":void 0}].map((ae,Ie)=>r.jsxs(Be,{padding:"sm",className:"flex flex-col items-center justify-center text-center py-4",children:[r.jsx("span",{className:`material-symbols-outlined text-2xl mb-1 ${ae.color||"text-[var(--color-text-subtle)]"}`,children:ae.icon}),r.jsx("span",{className:"text-xl font-bold text-[var(--color-text-main)]",children:ae.value}),r.jsx("span",{className:"text-xs text-[var(--color-text-muted)] uppercase font-semibold",children:ae.label})]},Ie))]}),Z&&r.jsx("div",{className:"rounded-xl p-5 bg-gradient-to-r from-indigo-50 to-blue-50 dark:from-indigo-950/20 dark:to-blue-950/20 border border-indigo-100 dark:border-indigo-900/50",children:r.jsxs("div",{className:"flex items-start gap-4",children:[r.jsx("span",{className:"material-symbols-outlined text-indigo-500 text-3xl",children:"auto_awesome"}),r.jsxs("div",{className:"space-y-2 flex-1",children:[r.jsx("h3",{className:"font-bold text-indigo-900 dark:text-indigo-100",children:"AI Assistant"}),r.jsx("p",{className:"text-sm text-indigo-800 dark:text-indigo-200 leading-relaxed",children:v0(h)||"Generate a report to get tailored guidance."}),r.jsx("div",{className:"flex gap-3 pt-2",children:r.jsx(Ne,{size:"sm",variant:"primary",onClick:Lr,isLoading:L,children:de?"Update Report":"Generate Report"})})]})]})}),de&&r.jsxs("div",{className:"rounded-xl p-6 bg-white dark:bg-[var(--color-surface-card)] border border-[var(--color-surface-border)] shadow-sm",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-500/10 rounded-lg",children:r.jsx("span",{className:"material-symbols-outlined text-purple-600 dark:text-purple-400",children:"text_snippet"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-bold text-[var(--color-text-main)]",children:"Latest AI Report"}),r.jsxs("p",{className:"text-[10px] text-[var(--color-text-muted)] font-medium uppercase tracking-wider",children:["Generated ",Hc(de.createdAt),"  By ",de.userName]})]})]}),r.jsx(Ne,{size:"sm",variant:"ghost",onClick:Lr,isLoading:L,icon:r.jsx("span",{className:"material-symbols-outlined",children:"refresh"}),children:"Regenerate"})]}),r.jsx("div",{className:"text-sm text-[var(--color-text-main)] leading-relaxed whitespace-pre-wrap prose prose-sm dark:prose-invert max-w-none",children:v0(de.content)})]}),r.jsxs(Be,{children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h3",{className:"h4",children:"Recent Tasks"}),r.jsx(nt,{to:`/project/${t}/tasks`,className:"text-sm font-semibold text-[var(--color-primary)] hover:underline",children:"View All"})]}),r.jsx("div",{className:"divide-y divide-[var(--color-surface-border)]",children:Wn.length===0?r.jsx("p",{className:"text-center py-6 text-[var(--color-text-muted)]",children:"No tasks yet."}):Wn.map(ae=>r.jsxs("div",{className:"py-3 flex items-start gap-3 hover:bg-[var(--color-surface-hover)] -mx-4 px-4 transition-colors",children:[r.jsx(Qa,{checked:ae.isCompleted,onChange:()=>ps(ae.id,ae.isCompleted),className:"mt-1"}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx(nt,{to:`/project/${t}/tasks/${ae.id}`,className:`text-sm font-medium truncate block ${ae.isCompleted?"text-[var(--color-text-muted)] line-through":"text-[var(--color-text-main)]"}`,children:ae.title}),r.jsxs("div",{className:"flex gap-2 mt-1",children:[ae.priority&&r.jsx(Tn,{size:"sm",variant:"outline",children:ae.priority}),ae.dueDate&&r.jsxs("span",{className:"text-xs text-[var(--color-text-subtle)] flex items-center gap-1",children:[r.jsx("span",{className:"material-symbols-outlined text-[10px]",children:"event"})," ",new Date(ae.dueDate).toLocaleDateString()]})]})]})]},ae.id))})]}),((fo=s.modules)==null?void 0:fo.includes("issues"))&&r.jsxs(Be,{children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h3",{className:"h4",children:"Recent Issues"}),r.jsx(nt,{to:`/project/${t}/issues`,className:"text-sm font-semibold text-[var(--color-primary)] hover:underline",children:"View All"})]}),r.jsx("div",{className:"divide-y divide-[var(--color-surface-border)]",children:_.length===0?r.jsx("p",{className:"text-center py-6 text-[var(--color-text-muted)]",children:"No open issues."}):_.slice(0,5).map(ae=>r.jsxs("div",{className:"py-3 flex items-start gap-3 hover:bg-[var(--color-surface-hover)] -mx-4 px-4 transition-colors",children:[r.jsx("div",{className:`mt-1 size-2 rounded-full shrink-0 ${ae.status==="Open"?"bg-blue-500":ae.status==="In Progress"?"bg-amber-500":"bg-green-500"}`}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx(nt,{to:`/project/${t}/issues`,className:"text-sm font-medium truncate block text-[var(--color-text-main)] hover:text-[var(--color-primary)]",children:ae.title}),r.jsxs("div",{className:"flex gap-2 mt-1",children:[r.jsx(Tn,{size:"sm",variant:ae.priority==="Urgent"?"error":"secondary",children:ae.priority}),r.jsx("span",{className:"text-xs text-[var(--color-text-subtle)]",children:ae.status})]})]})]},ae.id))})]}),r.jsxs(Be,{children:[r.jsx("div",{className:"flex items-center justify-between mb-4",children:r.jsx("h3",{className:"h4",children:"Links"})}),s!=null&&s.links&&s.links.length>0?r.jsx("div",{className:"space-y-2",children:s.links.map((ae,Ie)=>r.jsxs("a",{href:ae.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-3 rounded-lg border border-[var(--color-surface-border)] hover:bg-[var(--color-surface-hover)] transition-colors group",children:[r.jsx("div",{className:"size-8 rounded-full bg-[var(--color-text-main)] text-[var(--color-surface-bg)] flex items-center justify-center shrink-0",children:r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"link"})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"font-semibold text-sm truncate group-hover:text-[var(--color-primary)] transition-colors",children:ae.title}),r.jsx("p",{className:"text-xs text-[var(--color-text-muted)] truncate",children:ae.url})]}),r.jsx("span",{className:"material-symbols-outlined text-[16px] text-[var(--color-text-subtle)]",children:"open_in_new"})]},Ie))}):r.jsx("p",{className:"text-sm text-[var(--color-text-muted)]",children:"No important links added."})]})]}),r.jsxs("div",{className:"space-y-6",children:[r.jsx(yM,{projectId:t||"",tenantId:s==null?void 0:s.tenantId,onInvite:Y("canInvite")?Xt:void 0}),r.jsxs(Be,{children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h3",{className:"h4",children:"Activity"}),r.jsx(nt,{to:`/project/${t}/activity`,className:"text-xs text-[var(--color-text-muted)] hover:text-[var(--color-primary)]",children:"View History"})]}),r.jsxs("div",{className:"space-y-6",children:[v.slice(0,5).map((ae,Ie)=>{const{icon:Me,color:We,bg:Gn}=wM(ae.type,ae.action);return r.jsxs("div",{className:"flex gap-3 relative",children:[Ie!==4&&r.jsx("div",{className:"absolute left-3.5 top-8 bottom-[-16px] w-px bg-[var(--color-surface-border)]"}),r.jsx("div",{className:`size-7 rounded-full shrink-0 flex items-center justify-center ${Gn} ${We}`,children:r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:Me})}),r.jsxs("div",{className:"space-y-1 pb-1",children:[r.jsxs("p",{className:"text-sm text-[var(--color-text-main)] leading-snug",children:[r.jsx("span",{className:"font-semibold",children:ae.user})," ",ae.action]}),r.jsx("p",{className:"text-xs text-[var(--color-text-muted)]",children:Hc(ae.createdAt)})]})]},ae.id)}),v.length===0&&r.jsx("p",{className:"text-sm text-[var(--color-text-muted)]",children:"No recent activity."})]})]}),s.githubRepo&&r.jsxs(Be,{children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-indigo-500",children:"terminal"}),r.jsx("h3",{className:"h4",children:"Latest Commits"})]}),r.jsxs("a",{href:`https://github.com/${s.githubRepo}`,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-[var(--color-text-muted)] hover:text-[var(--color-primary)] flex items-center gap-1",children:["Repo ",r.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"open_in_new"})]})]}),Ur?r.jsx("div",{className:"flex items-center justify-center py-8",children:r.jsx("span",{className:"material-symbols-outlined animate-spin text-[var(--color-text-subtle)]",children:"progress_activity"})}):lo?r.jsx("p",{className:"text-xs text-rose-500 py-4",children:lo}):ar.length===0?r.jsx("p",{className:"text-sm text-[var(--color-text-muted)] py-4 text-center",children:"No recent commits found."}):r.jsx("div",{className:"space-y-4",children:ar.map(ae=>{var Ie,Me;return r.jsxs("div",{className:"flex gap-3 relative last:mb-0",children:[r.jsx("div",{className:"size-8 rounded-lg overflow-hidden shrink-0 border border-[var(--color-surface-border)] bg-[var(--color-surface-hover)]",children:(Ie=ae.author)!=null&&Ie.avatar_url?r.jsx("img",{src:ae.author.avatar_url,alt:"",className:"w-full h-full object-cover"}):r.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-[var(--color-text-muted)]",children:ae.commit.author.name.charAt(0)})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"text-sm font-medium text-[var(--color-text-main)] truncate leading-tight",children:ae.commit.message.split(`
`)[0]}),r.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[r.jsx("span",{className:"text-[11px] text-[var(--color-text-muted)] font-semibold",children:((Me=ae.author)==null?void 0:Me.login)||ae.commit.author.name}),r.jsxs("span",{className:"text-[10px] text-[var(--color-text-subtle)]",children:[" ",Hc(new Date(ae.commit.author.date))]})]})]}),r.jsx("a",{href:ae.html_url,target:"_blank",rel:"noopener noreferrer",className:"shrink-0 p-1 text-[var(--color-text-subtle)] hover:text-[var(--color-primary)] transition-colors",children:r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"arrow_outward"})})]},ae.sha)})})]}),r.jsxs(Be,{children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("h3",{className:"h4",children:"Gallery"}),r.jsx(Ne,{size:"sm",variant:"ghost",onClick:()=>{et(0),Te(!0)},children:"View All"})]}),(zn=s==null?void 0:s.screenshots)!=null&&zn.length?r.jsx("div",{className:"grid grid-cols-2 gap-2",children:s.screenshots.slice(0,4).map((ae,Ie)=>r.jsx("div",{className:"aspect-video rounded-lg bg-[var(--color-surface-hover)] overflow-hidden border border-[var(--color-surface-border)] cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>{et(Ie),Te(!0)},children:r.jsx("img",{src:ae,alt:"",className:"w-full h-full object-cover"})},Ie))}):r.jsx("div",{className:"py-6 text-center border-2 border-dashed border-[var(--color-surface-border)] rounded-lg",children:r.jsx("p",{className:"text-xs text-[var(--color-text-muted)]",children:"No screenshots uploaded."})})]})]})]}),r.jsx(_r,{isOpen:Ce,onClose:()=>Te(!1),title:"Project Gallery",size:"xl",children:r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"aspect-video w-full bg-black rounded-xl overflow-hidden flex items-center justify-center relative group",children:(Ea=s==null?void 0:s.screenshots)!=null&&Ea[Ge]?r.jsxs(r.Fragment,{children:[r.jsx("img",{src:s.screenshots[Ge],alt:"Gallery",className:"max-w-full max-h-[70vh] object-contain"}),Ge>0&&r.jsx("button",{className:"absolute left-4 p-2 rounded-full bg-black/50 text-white hover:bg-black/70 transition-colors opacity-0 group-hover:opacity-100",onClick:ae=>{ae.stopPropagation(),et(Ge-1)},children:r.jsx("span",{className:"material-symbols-outlined",children:"chevron_left"})}),s.screenshots&&Ge<s.screenshots.length-1&&r.jsx("button",{className:"absolute right-4 p-2 rounded-full bg-black/50 text-white hover:bg-black/70 transition-colors opacity-0 group-hover:opacity-100",onClick:ae=>{ae.stopPropagation(),et(Ge+1)},children:r.jsx("span",{className:"material-symbols-outlined",children:"chevron_right"})})]}):r.jsx("p",{className:"text-white/50",children:"No Image"})}),r.jsx("div",{className:"flex gap-2 overflow-x-auto py-2",children:(cr=s==null?void 0:s.screenshots)==null?void 0:cr.map((ae,Ie)=>r.jsx("button",{onClick:()=>et(Ie),className:`shrink-0 w-20 h-14 rounded-lg overflow-hidden border-2 transition-all ${Ge===Ie?"border-[var(--color-primary)] opacity-100":"border-transparent opacity-60 hover:opacity-100"}`,children:r.jsx("img",{src:ae,alt:"",className:"w-full h-full object-cover"})},Ie))})]})}),r.jsx(_r,{isOpen:F,onClose:()=>le(!1),title:"Edit Project Details",size:"xl",footer:r.jsxs(r.Fragment,{children:[r.jsx(Ne,{variant:"ghost",onClick:()=>le(!1),children:"Cancel"}),r.jsx(Ne,{onClick:hs,isLoading:sn,children:"Save Changes"})]}),children:r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"md:col-span-2 space-y-4",children:[r.jsx(st,{label:"Project Title",value:je,onChange:ae=>J(ae.target.value),className:"w-full"}),r.jsx(An,{label:"Description",value:we,onChange:ae=>be(ae.target.value),rows:4,className:"w-full"})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs(xn,{label:"Status",value:me,onChange:ae=>Ae(ae.target.value),className:"w-full",children:[r.jsx("option",{children:"Active"}),r.jsx("option",{children:"Planning"}),r.jsx("option",{children:"Completed"}),r.jsx("option",{children:"On Hold"})]}),r.jsxs(xn,{label:"Priority",value:De,onChange:ae=>Ee(ae.target.value),className:"w-full",children:[r.jsx("option",{children:"Low"}),r.jsx("option",{children:"Medium"}),r.jsx("option",{children:"High"}),r.jsx("option",{children:"Urgent"})]}),r.jsxs("div",{className:"space-y-2 pt-2 border-t border-[var(--color-surface-border)]",children:[r.jsx("label",{className:"text-xs font-semibold text-[var(--color-text-muted)] uppercase tracking-wider ml-1",children:"Assets"}),r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsxs("label",{className:"cursor-pointer group relative flex flex-col items-center justify-center h-20 rounded-xl border border-dashed border-[var(--color-surface-border)] hover:border-[var(--color-primary)] hover:bg-[var(--color-surface-hover)] dark:bg-[var(--color-surface-hover)]/30 transition-all overflow-hidden bg-cover bg-center",style:{backgroundImage:!tt&&(_t||s.coverImage)?`url(${_t?URL.createObjectURL(_t):s.coverImage})`:"none"},children:[r.jsx("input",{type:"file",className:"absolute inset-0 opacity-0 cursor-pointer z-10",accept:"image/*",onChange:ae=>ir(ae,"cover")}),!tt&&(_t||s.coverImage)?r.jsx("div",{className:"absolute top-1 right-1 z-20",children:r.jsx(Ne,{size:"icon",variant:"danger",className:"size-6",onClick:ae=>{ae.preventDefault(),ae.stopPropagation(),un(null),gt(!0)},children:r.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"delete"})})}):r.jsxs("div",{className:`absolute inset-0 flex flex-col items-center justify-center transition-colors ${!tt&&(_t||s.coverImage)?"bg-black/50 text-white opacity-0 group-hover:opacity-100":"text-[var(--color-text-muted)] group-hover:text-[var(--color-primary)]"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"image"}),r.jsx("span",{className:"text-[10px] font-medium mt-1",children:"Change Cover"})]})]}),r.jsxs("label",{className:"cursor-pointer group relative flex flex-col items-center justify-center h-20 rounded-xl border border-dashed border-[var(--color-surface-border)] hover:border-[var(--color-primary)] hover:bg-[var(--color-surface-hover)] dark:bg-[var(--color-surface-hover)]/30 transition-all overflow-hidden bg-cover bg-center",style:{backgroundImage:!bt&&(P||s.squareIcon)?`url(${P?URL.createObjectURL(P):s.squareIcon})`:"none"},children:[r.jsx("input",{type:"file",className:"absolute inset-0 opacity-0 cursor-pointer z-10",accept:"image/*",onChange:ae=>ir(ae,"icon")}),!bt&&(P||s.squareIcon)?r.jsx("div",{className:"absolute top-1 right-1 z-20",children:r.jsx(Ne,{size:"icon",variant:"danger",className:"size-6",onClick:ae=>{ae.preventDefault(),ae.stopPropagation(),k(null),gn(!0)},children:r.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"delete"})})}):r.jsxs("div",{className:`absolute inset-0 flex flex-col items-center justify-center transition-colors ${!bt&&(P||s.squareIcon)?"bg-black/50 text-white opacity-0 group-hover:opacity-100":"text-[var(--color-text-muted)] group-hover:text-[var(--color-primary)]"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"apps"}),r.jsx("span",{className:"text-[10px] font-medium mt-1",children:"Change Icon"})]})]})]})]})]})]}),r.jsx("div",{className:"h-px bg-[var(--color-surface-border)]"}),r.jsxs("div",{className:"space-y-3",children:[r.jsx("label",{className:"text-xs font-semibold text-[var(--color-text-muted)] uppercase tracking-wider ml-1",children:"Enabled Modules"}),r.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-3",children:["tasks","ideas","mindmap","activity","issues"].map(ae=>r.jsxs("label",{className:`
                                    flex flex-col items-center justify-center gap-2 cursor-pointer p-3 rounded-xl border transition-all text-center
                                    ${Xe!=null&&Xe.includes(ae)?"border-[var(--color-primary)] bg-[var(--color-surface-hover)]":"border-[var(--color-surface-border)] hover:bg-[var(--color-surface-hover)]"}
                                `,children:[r.jsx(Qa,{checked:Xe?Xe.includes(ae):!0,onChange:Ie=>{let We=[...Xe||["tasks","ideas","mindmap","activity","issues"]];Ie.target.checked?We.includes(ae)||We.push(ae):We=We.filter(Gn=>Gn!==ae),Jt(We)},className:"hidden"}),r.jsx("div",{className:`
                                        size-8 rounded-full flex items-center justify-center transition-colors
                                        ${Xe!=null&&Xe.includes(ae)?"bg-[var(--color-primary)] text-[var(--color-primary-text)]":"bg-[var(--color-surface-border)] text-[var(--color-text-muted)]"}
                                    `,children:r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:ae==="tasks"?"check_circle":ae==="ideas"?"lightbulb":ae==="mindmap"?"hub":ae==="activity"?"history":"bug_report"})}),r.jsx("span",{className:"text-xs font-semibold capitalize",children:ae})]},ae))})]}),r.jsx("div",{className:"h-px bg-[var(--color-surface-border)]"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("label",{className:"text-xs font-semibold text-[var(--color-text-muted)] uppercase tracking-wider ml-1",children:"GitHub Integration"}),r.jsx(Tn,{variant:En?"success":"secondary",children:En?"Connected":"Disconnected"})]}),r.jsxs("div",{className:"bg-[var(--color-surface-hover)]/30 p-4 rounded-xl border border-[var(--color-surface-border)]",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsx("label",{className:"text-xs font-semibold text-[var(--color-text-muted)] ml-1",children:"Repository Selection"}),Ds.length>0?r.jsxs(xn,{value:En,onChange:ae=>Js(ae.target.value),icon:"terminal",children:[r.jsx("option",{value:"",children:"Select a repository..."}),Ds.map(ae=>r.jsx("option",{value:ae.full_name,children:ae.full_name},ae.id))]}):r.jsxs("div",{className:"flex flex-col items-center justify-center py-6 bg-[var(--color-surface-paper)] rounded-lg border border-dashed border-[var(--color-surface-border)] gap-3",children:[r.jsx("div",{className:"size-12 bg-zinc-900 rounded-xl flex items-center justify-center text-white",children:r.jsx("span",{className:"material-symbols-outlined text-2xl",children:"terminal"})}),r.jsxs("div",{className:"text-center px-4",children:[r.jsx("p",{className:"text-sm font-semibold text-[var(--color-text-main)]",children:"GitHub Connection Required"}),r.jsx("p",{className:"text-xs text-[var(--color-text-muted)] mt-1",children:"Connect your account to browse and sync with your repositories."})]}),r.jsx(Ne,{size:"sm",variant:"primary",onClick:Ta,isLoading:rr,children:"Link GitHub Account"})]}),Sa&&r.jsx("p",{className:"text-[10px] text-[var(--color-primary)] animate-pulse mt-1 ml-1",children:"Fetching your repositories..."})]}),r.jsx("div",{className:"mt-4 pt-4 border-t border-[var(--color-surface-border)]",children:r.jsxs("div",{className:"flex items-center gap-3 bg-[var(--color-surface-paper)]/50 p-3 rounded-lg border border-[var(--color-surface-border)]",children:[r.jsx(Qa,{id:"github-sync-toggle",checked:Pr,onChange:ae=>or(ae.target.checked)}),r.jsxs("label",{htmlFor:"github-sync-toggle",className:"text-sm font-medium cursor-pointer text-[var(--color-text-main)]",children:["Enable GitHub Issue Sync",r.jsx("span",{className:"block text-[10px] text-[var(--color-text-muted)] font-normal",children:"Automatically cross-post issues to the selected repository"})]})]})})]})]}),r.jsx("div",{className:"h-px bg-[var(--color-surface-border)]"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("label",{className:"text-xs font-semibold text-[var(--color-text-muted)] uppercase tracking-wider ml-1",children:"Sidebar Resources"}),r.jsx(Ne,{size:"sm",variant:"ghost",onClick:()=>zt([...Nt,{title:"",url:"",icon:"open_in_new"}]),icon:r.jsx("span",{className:"material-symbols-outlined",children:"add"}),children:"Add"})]}),r.jsxs("div",{className:"space-y-3 max-h-[200px] overflow-y-auto pr-1",children:[Nt.length===0&&r.jsx("p",{className:"text-xs text-[var(--color-text-muted)] py-2",children:"No sidebar resources."}),Nt.map((ae,Ie)=>r.jsxs("div",{className:"flex gap-2 items-start group",children:[r.jsxs("div",{className:"flex-1 space-y-1",children:[r.jsx(st,{placeholder:"Label",value:ae.title,onChange:Me=>{const We=[...Nt];We[Ie].title=Me.target.value,zt(We)}}),r.jsx(st,{placeholder:"https://...",value:ae.url,onChange:Me=>{const We=[...Nt];We[Ie].url=Me.target.value,zt(We)}})]}),r.jsx("button",{onClick:()=>zt(Nt.filter((Me,We)=>We!==Ie)),className:"text-[var(--color-text-muted)] hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity pt-2",children:r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"delete"})})]},Ie))]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("label",{className:"text-xs font-semibold text-[var(--color-text-muted)] uppercase tracking-wider ml-1",children:"Overview Links"}),r.jsx(Ne,{size:"sm",variant:"ghost",onClick:()=>Pt([...ft,{title:"",url:""}]),icon:r.jsx("span",{className:"material-symbols-outlined",children:"add"}),children:"Add"})]}),r.jsxs("div",{className:"space-y-3 max-h-[200px] overflow-y-auto pr-1",children:[ft.length===0&&r.jsx("p",{className:"text-xs text-[var(--color-text-muted)] py-2",children:"No overview links."}),ft.map((ae,Ie)=>r.jsxs("div",{className:"flex gap-2 items-start group",children:[r.jsxs("div",{className:"flex-1 space-y-1",children:[r.jsx(st,{placeholder:"Title",value:ae.title,onChange:Me=>{const We=[...ft];We[Ie].title=Me.target.value,Pt(We)}}),r.jsx(st,{placeholder:"https://...",value:ae.url,onChange:Me=>{const We=[...ft];We[Ie].url=Me.target.value,Pt(We)}})]}),r.jsx("button",{onClick:()=>Pt(ft.filter((Me,We)=>We!==Ie)),className:"text-[var(--color-text-muted)] hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity pt-2",children:r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"delete"})})]},Ie))]})]})]})]})}),r.jsx(_r,{isOpen:he,onClose:()=>re(!1),title:"Delete Project",footer:r.jsxs(r.Fragment,{children:[r.jsx(Ne,{variant:"ghost",onClick:()=>re(!1),children:"Cancel"}),r.jsx(Ne,{variant:"danger",onClick:lr,isLoading:Mt,children:"Delete Project"})]}),children:r.jsxs("p",{className:"text-sm text-[var(--color-text-muted)]",children:["Are you sure you want to delete ",r.jsx("span",{className:"font-bold text-[var(--color-text-main)]",children:s.title}),"? This action cannot be undone and will remove all associated tasks and data."]})}),q&&Y("canManageTasks")&&r.jsx(Lb,{projectId:t,tenantId:s==null?void 0:s.tenantId,onClose:()=>H(!1),onCreated:()=>{H(!1)}}),R&&s&&Y("canInvite")&&r.jsx(zb,{isOpen:R,onClose:()=>ue(!1),projectTitle:s.title,onGenerateLink:async(ae,Ie,Me)=>{const{generateInviteLink:We}=await Tb(async()=>{const{generateInviteLink:Gn}=await Promise.resolve().then(()=>by);return{generateInviteLink:Gn}},void 0);return await We(t||"",ae,Ie,Me,s.tenantId)}})]})},jM=()=>{const{id:t}=Yn(),e=dn(),[s,o]=w.useState(null),[i,c]=w.useState([]),[u,m]=w.useState(!0),[h,x]=w.useState(null),[v,b]=w.useState("active"),[N,T]=w.useState(""),[_,I]=w.useState(new Set),[E,D]=w.useState(!1),[z,A]=w.useState({}),M=ai(),{can:B}=Lm(s);w.useEffect(()=>{if(!t)return;m(!0);let V;return $t(t).then(Z=>{if(o(Z),!Z){m(!1);return}V=ii(t,K=>{c(K),m(!1)},Z.tenantId)}).catch(Z=>{console.error(Z),m(!1)}),()=>{V&&V()}},[t]),w.useEffect(()=>{(async()=>{if(i.length)try{const Z=await Promise.all(i.map(async K=>{const F=await Yc(K.id),le=F.filter(he=>he.isCompleted).length;return[K.id,{done:le,total:F.length}]}));A(Object.fromEntries(Z))}catch(Z){console.warn(Z)}})()},[i]),w.useEffect(()=>{new URLSearchParams(M.search).get("newTask")==="1"&&D(!0)},[M.search]);const L=async(V,Z)=>{B("canManageTasks")&&(c(K=>K.map(F=>F.id===V?{...F,isCompleted:!Z}:F)),await Nl(V,Z))},X=w.useMemo(()=>i.filter(V=>!(v==="active"&&V.isCompleted||v==="completed"&&!V.isCompleted||N&&!V.title.toLowerCase().includes(N.toLowerCase()))),[i,v,N]);i.filter(V=>!V.isCompleted).length,i.filter(V=>V.isCompleted).length;const de=w.useMemo(()=>{const V=i.length,Z=i.filter(re=>!re.isCompleted).length,K=i.filter(re=>re.isCompleted).length,F=i.filter(re=>re.priority==="Urgent"&&!re.isCompleted).length,le=i.filter(re=>re.priority==="High"&&!re.isCompleted).length,he=V>0?Math.round(K/V*100):0;return{total:V,open:Z,completed:K,urgent:F,high:le,progress:he}},[i]);return u?r.jsx("div",{className:"flex items-center justify-center p-12",children:r.jsx("span",{className:"material-symbols-outlined text-[var(--color-text-subtle)] animate-spin text-3xl",children:"rotate_right"})}):r.jsxs("div",{className:"flex flex-col gap-8 fade-in max-w-6xl mx-auto pb-12",children:[r.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-[var(--color-text-main)] mb-2",children:"Tasks"}),r.jsx("p",{className:"text-[var(--color-text-muted)] text-lg",children:"Manage, track, and prioritize your project work."})]}),B("canManageTasks")&&r.jsx(Ne,{onClick:()=>D(!0),icon:r.jsx("span",{className:"material-symbols-outlined",children:"add"}),variant:"primary",size:"lg",className:"shadow-lg shadow-indigo-500/20",children:"New Task"})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[r.jsxs("div",{className:"p-5 rounded-xl bg-gradient-to-br from-indigo-50 to-white dark:from-indigo-900/20 dark:to-[var(--color-surface-bg)] border border-indigo-100 dark:border-indigo-500/10 shadow-sm relative overflow-hidden group",children:[r.jsx("div",{className:"absolute right-0 top-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:r.jsx("span",{className:"material-symbols-outlined text-6xl text-indigo-500",children:"list_alt"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-semibold text-indigo-600 dark:text-indigo-400 uppercase tracking-wider mb-1",children:"Open Tasks"}),r.jsx("p",{className:"text-3xl font-bold text-[var(--color-text-main)]",children:de.open})]})]}),r.jsxs("div",{className:"p-5 rounded-xl bg-gradient-to-br from-emerald-50 to-white dark:from-emerald-900/20 dark:to-[var(--color-surface-bg)] border border-emerald-100 dark:border-emerald-500/10 shadow-sm relative overflow-hidden group",children:[r.jsx("div",{className:"absolute right-0 top-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:r.jsx("span",{className:"material-symbols-outlined text-6xl text-emerald-500",children:"check_circle"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-semibold text-emerald-600 dark:text-emerald-400 uppercase tracking-wider mb-1",children:"Completed"}),r.jsxs("div",{className:"flex items-baseline gap-2",children:[r.jsx("p",{className:"text-3xl font-bold text-[var(--color-text-main)]",children:de.completed}),r.jsxs("span",{className:"text-xs font-semibold px-2 py-0.5 rounded-full bg-emerald-100 dark:bg-emerald-500/20 text-emerald-700 dark:text-emerald-300",children:[de.progress,"%"]})]})]})]}),r.jsxs("div",{className:"p-5 rounded-xl bg-gradient-to-br from-amber-50 to-white dark:from-amber-900/20 dark:to-[var(--color-surface-bg)] border border-amber-100 dark:border-amber-500/10 shadow-sm relative overflow-hidden group",children:[r.jsx("div",{className:"absolute right-0 top-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:r.jsx("span",{className:"material-symbols-outlined text-6xl text-amber-500",children:"priority_high"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-semibold text-amber-600 dark:text-amber-400 uppercase tracking-wider mb-1",children:"High Priority"}),r.jsx("p",{className:"text-3xl font-bold text-[var(--color-text-main)]",children:de.high})]})]}),r.jsxs("div",{className:"p-5 rounded-xl bg-gradient-to-br from-rose-50 to-white dark:from-rose-900/20 dark:to-[var(--color-surface-bg)] border border-rose-100 dark:border-rose-500/10 shadow-sm relative overflow-hidden group",children:[r.jsx("div",{className:"absolute right-0 top-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:r.jsx("span",{className:"material-symbols-outlined text-6xl text-rose-500",children:"warning"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-semibold text-rose-600 dark:text-rose-400 uppercase tracking-wider mb-1",children:"Urgent"}),r.jsx("p",{className:"text-3xl font-bold text-[var(--color-text-main)]",children:de.urgent})]})]})]}),r.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4 sticky top-4 z-10 backdrop-blur-xl bg-white/50 dark:bg-black/20 p-2 rounded-2xl border border-[var(--color-surface-border)] shadow-sm",children:[r.jsx("div",{className:"flex bg-[var(--color-surface-hover)] rounded-xl p-1 w-full md:w-auto",children:["active","completed","all"].map(V=>r.jsx("button",{onClick:()=>b(V),className:`
                                flex-1 md:flex-none px-6 py-2 rounded-lg text-sm font-semibold transition-all capitalize
                                ${v===V?"bg-[var(--color-surface-paper)] text-[var(--color-text-main)] shadow-sm":"text-[var(--color-text-muted)] hover:text-[var(--color-text-main)] hover:bg-black/5 dark:hover:bg-white/5"}
                            `,children:V},V))}),r.jsxs("div",{className:"relative w-full md:w-80 group",children:[r.jsx("input",{type:"text",value:N,onChange:V=>T(V.target.value),placeholder:"Search tasks...",className:"w-full bg-[var(--color-surface-bg)] border-none ring-1 ring-[var(--color-surface-border)] focus:ring-2 focus:ring-[var(--color-primary)] rounded-xl pl-10 pr-4 py-2.5 text-sm transition-all"}),r.jsx("span",{className:"material-symbols-outlined absolute left-3 top-2.5 text-[var(--color-text-muted)] group-focus-within:text-[var(--color-primary)] transition-colors",children:"search"})]})]}),r.jsx("div",{className:"flex flex-col gap-3",children:X.length===0?r.jsxs("div",{className:"py-24 text-center flex flex-col items-center justify-center text-[var(--color-text-muted)] border-2 border-dashed border-[var(--color-surface-border)] rounded-2xl bg-[var(--color-surface-bg)]/50",children:[r.jsx("div",{className:"bg-[var(--color-surface-hover)] p-4 rounded-full mb-4",children:r.jsx("span",{className:"material-symbols-outlined text-4xl opacity-50",children:"checklist_rtl"})}),r.jsx("h3",{className:"text-lg font-semibold text-[var(--color-text-main)] mb-1",children:"No tasks found"}),r.jsx("p",{className:"max-w-xs mx-auto",children:"Try adjusting your filters or search terms, or create a new task."}),B("canManageTasks")&&r.jsx(Ne,{variant:"secondary",className:"mt-6",onClick:()=>D(!0),children:"Create Task"})]}):X.map(V=>{var Z;return r.jsxs("div",{onClick:()=>e(`/project/${t}/tasks/${V.id}`),className:"group flex items-center gap-4 p-4 rounded-xl bg-[var(--color-surface-bg)] border border-[var(--color-surface-border)] hover:shadow-md hover:bg-white dark:hover:bg-[var(--color-surface-hover)] transition-all cursor-pointer relative overflow-hidden",children:[r.jsx("button",{onClick:K=>{K.stopPropagation(),L(V.id,V.isCompleted)},disabled:!B("canManageTasks"),className:`
                                    flex-shrink-0 size-6 rounded-lg border-2 flex items-center justify-center transition-all duration-200 z-10
                                    ${B("canManageTasks")?"":"opacity-50 cursor-not-allowed"}
                                    ${V.isCompleted?"bg-green-500 border-green-500 text-white shadow-sm shadow-green-500/20":"border-[var(--color-surface-border)] hover:border-green-500 text-transparent bg-[var(--color-surface-paper)]"}
                                `,children:r.jsx("span",{className:"material-symbols-outlined text-[16px] font-bold",children:"check"})}),r.jsxs("div",{className:"flex-1 min-w-0 flex flex-col gap-1 z-10",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:`text-base font-semibold leading-tight transition-colors ${V.isCompleted?"text-[var(--color-text-muted)] line-through":"text-[var(--color-text-main)]"}`,children:V.title}),V.priority==="Urgent"&&r.jsx(Tn,{size:"sm",variant:"danger",className:"animate-pulse",children:"Urgent"})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-xs text-[var(--color-text-muted)]",children:[V.priority&&V.priority!=="Urgent"&&r.jsx(Tn,{size:"sm",variant:V.priority==="High"?"warning":"secondary",children:V.priority}),V.status&&r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx("span",{className:`size-1.5 rounded-full ${V.status==="Done"?"bg-green-500":V.status==="In Progress"?"bg-amber-500":"bg-slate-300"}`}),V.status]}),V.dueDate&&r.jsxs("div",{className:`flex items-center gap-1 ${new Date(V.dueDate)<new Date&&!V.isCompleted?"text-rose-500 font-bold":""}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"calendar_today"}),r.jsx("span",{children:new Date(V.dueDate).toLocaleDateString(void 0,{month:"short",day:"numeric"})})]}),((Z=z[V.id])==null?void 0:Z.total)>0&&r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"checklist"}),r.jsxs("span",{children:[z[V.id].done,"/",z[V.id].total]})]})]})]}),r.jsx("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity z-10",children:r.jsx("div",{className:"p-2 rounded-full bg-[var(--color-surface-hover)] text-[var(--color-text-main)]",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"arrow_forward"})})})]},V.id)})}),E&&t&&B("canManageTasks")&&r.jsx(Lb,{projectId:t,onClose:()=>D(!1),onCreated:V=>{c(V),D(!1)}})]})},TM=()=>{const{id:t}=Yn(),[e,s]=w.useState(null),[o,i]=w.useState(!0);return w.useEffect(()=>{t&&(async()=>{try{const c=await $t(t);s(c)}catch(c){console.error("Failed to load project details",c)}finally{i(!1)}})()},[t]),o?r.jsx("div",{className:"flex justify-center py-12",children:r.jsx("span",{className:"material-symbols-outlined animate-spin text-3xl text-gray-400",children:"progress_activity"})}):e?r.jsxs("div",{className:"max-w-[900px] mx-auto flex flex-col gap-6 animate-fade-up",children:[r.jsxs("div",{children:[r.jsx("span",{className:"app-pill w-fit",children:"Details"}),r.jsx("h1",{className:"text-2xl font-display font-bold text-ink",children:"Project Details"}),r.jsx("p",{className:"text-muted text-sm",children:"Key metadata for this project."})]}),r.jsxs("div",{className:"app-card p-6 space-y-5",children:[r.jsx($o,{label:"Title",value:e.title}),r.jsx($o,{label:"Description",value:e.description||"Not set"}),r.jsx($o,{label:"Status",value:e.status||"Unknown"}),r.jsx($o,{label:"Priority",value:e.priority||"Medium"}),r.jsx($o,{label:"Start Date",value:e.startDate||"Not set"}),r.jsx($o,{label:"Due Date",value:e.dueDate||"Not set"})]})]}):r.jsx("div",{className:"p-4",children:"Project not found."})},$o=({label:t,value:e})=>r.jsxs("div",{className:"flex items-start justify-between gap-4",children:[r.jsx("span",{className:"text-sm font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wide",children:t}),r.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white text-right max-w-[60%] break-words",children:e})]}),CM=t=>{const e=Le(t);if(!e)return"";const o=Date.now()-e,i=Math.floor(o/6e4),c=Math.floor(o/36e5),u=Math.floor(o/864e5);return i<1?"Just now":i<60?`${i}m ago`:c<24?`${c}h ago`:`${u}d ago`},zm=({projectId:t,targetId:e,targetType:s,tenantId:o,isProjectOwner:i=!1,hideHeader:c=!1,onCountChange:u})=>{const[m,h]=w.useState([]),[x,v]=w.useState(""),[b,N]=w.useState(!0),[T,_]=w.useState(null),I=xe.currentUser,E=w.useRef(null);w.useEffect(()=>{const M=iy(t,e,B=>{h(B),N(!1),u&&u(B.length)},o);return()=>M()},[t,e,o,u]);const D=async()=>{if(x.trim())try{await oy(t,e,s,x.trim(),o),v("")}catch(M){console.error("Failed to add comment",M)}},z=M=>{_(M)},A=async()=>{T&&(await ly(T,t,o),_(null))};return b?r.jsx("div",{className:"text-xs text-[var(--color-text-subtle)]",children:"Loading comments..."}):r.jsxs("div",{className:"flex flex-col h-full bg-[var(--color-surface-bg)] rounded-xl border border-[var(--color-surface-border)] overflow-hidden",children:[!c&&r.jsx("div",{className:"p-3 border-b border-[var(--color-surface-border)] bg-[var(--color-surface-card)]",children:r.jsxs("h3",{className:"text-sm font-semibold flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-[16px] text-[var(--color-text-muted)]",children:"chat"}),"Comments (",m.length,")"]})}),r.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 max-h-[400px]",children:[m.length===0?r.jsx("div",{className:"text-center py-8 text-[var(--color-text-subtle)] text-sm",children:"No comments yet. Be the first to start the discussion!"}):m.map(M=>r.jsxs("div",{className:"flex items-start gap-3 group",children:[r.jsx("div",{className:"size-8 rounded-full bg-cover bg-center border border-[var(--color-surface-border)] shrink-0",style:{backgroundImage:M.userPhotoURL?`url("${M.userPhotoURL}")`:"none",backgroundColor:"#e5e7eb"},children:!M.userPhotoURL&&r.jsx("div",{className:"flex items-center justify-center w-full h-full text-[10px] font-bold text-gray-500",children:(M.userDisplayName||"U")[0].toUpperCase()})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("span",{className:"text-xs font-bold text-[var(--color-text-main)] truncate",children:M.userDisplayName}),r.jsx("span",{className:"text-[10px] text-[var(--color-text-subtle)]",children:CM(M.createdAt)}),(i||(I==null?void 0:I.uid)===M.userId)&&r.jsx("button",{onClick:()=>z(M.id),className:"ml-auto opacity-0 group-hover:opacity-100 text-[var(--color-text-muted)] hover:text-rose-500 transition-opacity",children:r.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"delete"})})]}),r.jsx("div",{className:"text-sm text-[var(--color-text-main)] whitespace-pre-wrap rounded-lg bg-[var(--color-surface-hover)] p-2.5",children:M.content})]})]},M.id)),r.jsx("div",{ref:E})]}),r.jsx("div",{className:"p-3 border-t border-[var(--color-surface-border)] bg-[var(--color-surface-card)]",children:r.jsxs("div",{className:"flex items-end gap-2",children:[r.jsx(An,{value:x,onChange:M=>v(M.target.value),placeholder:"Write a comment...",className:"flex-1 min-h-[40px] max-h-[120px] py-2.5 resize-none",rows:1,onKeyDown:M=>{M.key==="Enter"&&!M.shiftKey&&(M.preventDefault(),D())}}),r.jsx("button",{onClick:D,disabled:!x.trim(),className:`
                            p-2 rounded-lg flex items-center justify-center transition-colors
                            ${x.trim()?"bg-[var(--color-primary)] text-white hover:opacity-90":"bg-[var(--color-surface-hover)] text-[var(--color-text-muted)] cursor-not-allowed"}
                        `,children:r.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"send"})})]})}),T&&sr.createPortal(r.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",children:r.jsx("div",{className:"bg-[var(--color-surface-card)] rounded-2xl shadow-2xl max-w-sm w-full p-6 border border-[var(--color-surface-border)] animate-in fade-in zoom-in-95 duration-200",children:r.jsxs("div",{className:"space-y-4 text-center",children:[r.jsx("h3",{className:"text-lg font-bold text-[var(--color-text-main)]",children:"Delete Comment?"}),r.jsx("p",{className:"text-sm text-[var(--color-text-muted)]",children:"This action cannot be undone."}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsx(Ne,{variant:"ghost",onClick:()=>_(null),children:"Cancel"}),r.jsx(Ne,{variant:"danger",onClick:A,children:"Delete"})]})]})})}),document.body)]})},EM=({task:t,isOpen:e,onClose:s,onUpdate:o})=>{const[i,c]=w.useState(t.title),[u,m]=w.useState(t.description||""),[h,x]=w.useState(!1);w.useEffect(()=>{e&&(c(t.title),m(t.description||""))},[e,t]);const v=async b=>{b.preventDefault(),x(!0);try{await Xa(t.id,{title:i,description:u},t.projectId),o(),s()}catch(N){console.error(N)}finally{x(!1)}};return e?sr.createPortal(r.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-fade-in",onClick:s,children:r.jsxs("div",{className:"w-full max-w-2xl bg-[var(--color-surface-card)] rounded-xl shadow-2xl animate-scale-up border border-[var(--color-surface-border)] flex flex-col max-h-[90vh] overflow-y-auto",onClick:b=>b.stopPropagation(),children:[r.jsxs("div",{className:"p-4 border-b border-[var(--color-surface-border)] flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-bold text-[var(--color-text-main)]",children:"Edit Task"}),r.jsx("p",{className:"text-sm text-[var(--color-text-muted)] mt-1",children:"Update task details and assignments."})]}),r.jsx(Ne,{variant:"ghost",onClick:s,size:"sm",children:"Close"})]}),r.jsxs("form",{onSubmit:v,className:"p-6",children:[r.jsxs("div",{className:"flex flex-col gap-6",children:[r.jsx(st,{label:"Title",value:i,onChange:b=>c(b.target.value),placeholder:"Task title",required:!0,className:"text-lg font-medium"}),r.jsxs("div",{className:"flex flex-col gap-1.5",children:[r.jsx("label",{className:"text-xs font-bold uppercase tracking-wider text-[var(--color-text-muted)] ml-1",children:"Description"}),r.jsx(An,{value:u,onChange:b=>m(b.target.value),placeholder:"Describe the task...",rows:8,className:"min-h-[200px]"})]})]}),r.jsxs("div",{className:"flex justify-end gap-2 mt-8 pt-4 border-t border-[var(--color-surface-border)]",children:[r.jsx(Ne,{type:"button",variant:"ghost",onClick:s,disabled:h,children:"Cancel"}),r.jsx(Ne,{type:"submit",isLoading:h,disabled:!i.trim(),children:"Save Changes"})]})]})]})}),document.body):null},_M=()=>{var _t,un;const{id:t,taskId:e}=Yn(),[s]=xl(),o=s.get("tenant")||void 0,i=dn(),[c,u]=w.useState(null),[m,h]=w.useState([]),[x,v]=w.useState(!0),[b,N]=w.useState(!1),[T,_]=w.useState(""),[I,E]=w.useState(!1),[D,z]=w.useState(!1),[A,M]=w.useState(null),[B,L]=w.useState(!1),[X,de]=w.useState([]),[V,Z]=w.useState(!1),[K,F]=w.useState(null),[le,he]=w.useState([]),[re,q]=w.useState(null),[H,R]=w.useState(null),[ue,Y]=w.useState(0),[ye,je]=w.useState(!1),J=w.useMemo(()=>{var P;return(H==null?void 0:H.ownerId)===((P=xe.currentUser)==null?void 0:P.uid)},[H==null?void 0:H.ownerId]),we=m.filter(P=>P.isCompleted).length,be=m.length,me=be?Math.round(we/be*100):0,Ae=w.useMemo(()=>{if(!c)return[];const P=[];return c.assigneeIds&&c.assigneeIds.length>0&&P.push(...c.assigneeIds),c.assigneeId&&!P.includes(c.assigneeId)&&P.push(c.assigneeId),P},[c]),De=async()=>{if(e)try{let P=await $0(e,t,o);!P&&t&&(P=(await Ir(t,o)).find(ne=>ne.id===e)||null),u(P);const k=await Yc(e,t,o);if(h(k),t){const Q=await yl(t,o);de(Q);const ne=await $t(t,o);R(ne)}}catch(P){console.error("Failed to load task",P),M("Failed to load task details.")}finally{v(!1)}};w.useEffect(()=>{De()},[e,t]),w.useEffect(()=>{if(!(c!=null&&c.tenantId))return;const P=ba(k=>{he(k)},c.tenantId);return()=>{P()}},[c==null?void 0:c.tenantId]);const Ee=async()=>{if(!e)return;const P=await Yc(e,t);h(P)},ut=async P=>{if(P.preventDefault(),M(null),!(!e||!T.trim())){N(!0);try{await K0(e,T.trim(),t),_(""),await Ee()}catch(k){console.error("Failed to add subtask",k),M("Failed to add subtask. Please try again.")}finally{N(!1)}}},He=async(P,k)=>{h(Q=>Q.map(ne=>ne.id===P?{...ne,isCompleted:!k}:ne)),await W0(P,k,e,t)},Vt=P=>{F(P)},Et=async()=>{if(!(!K||!c))try{await Q0(K,c.id,t),F(null),De()}catch(P){console.error("Failed to delete subtask",P)}},Xe=async(P,k)=>{h(Q=>Q.map(ne=>ne.id===P?{...ne,assigneeId:k||void 0}:ne));try{await Z0(P,{assigneeId:k||Zw()},e,t)}catch(Q){console.error("Failed to update subtask assignee",Q)}q(null)},Jt=async()=>{if(!c)return;E(!0);const P=!c.isCompleted;u({...c,isCompleted:P,status:P?"Done":"In Progress"});try{await Nl(c.id,c.isCompleted,t),P?await Xa(c.id,{status:"Done"},t):await Xa(c.id,{status:"In Progress"},t)}finally{E(!1)}},ft=async()=>{if(!(!c||!e)){z(!0);try{await X0(e,t),i(`/project/${t}/tasks`)}catch(P){console.error("Failed to delete task",P),M("Failed to delete task."),z(!1),Z(!1)}}},Pt=async(P,k)=>{c&&(u({...c,[P]:k}),await Xa(c.id,{[P]:k},t))},Nt=async P=>{if(!c)return;const k=P.length>0?P[0]:"",Q={assigneeIds:P,assigneeId:k};u(ne=>ne?{...ne,...Q}:null),await Xa(c.id,Q,t)},{setTaskTitle:zt}=w0();return w.useEffect(()=>{c&&zt(c.title)},[c,zt]),x?r.jsx("div",{className:"flex justify-center items-center min-h-[50vh]",children:r.jsx("div",{className:"flex flex-col items-center gap-3",children:r.jsx("span",{className:"material-symbols-outlined animate-spin text-4xl text-[var(--color-primary)]",children:"progress_activity"})})}):c?r.jsxs("div",{className:"max-w-6xl mx-auto px-4 md:px-8 py-8 animate-fade-in pb-20",children:[B&&c&&r.jsx(EM,{task:c,isOpen:B,onClose:()=>L(!1),onUpdate:De,projectMembers:X}),V&&sr.createPortal(r.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",children:r.jsx("div",{className:"bg-[var(--color-surface-card)] rounded-2xl shadow-2xl max-w-sm w-full p-6 border border-[var(--color-surface-border)]",children:r.jsxs("div",{className:"space-y-4 text-center",children:[r.jsx("h3",{className:"text-lg font-bold text-[var(--color-text-main)]",children:"Delete Task?"}),r.jsxs("p",{className:"text-sm text-[var(--color-text-muted)]",children:["Are you sure you want to delete ",r.jsxs("strong",{children:['"',c.title,'"']}),"?"]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsx(Ne,{variant:"ghost",onClick:()=>Z(!1),children:"Cancel"}),r.jsx(Ne,{variant:"danger",onClick:ft,isLoading:D,children:"Delete"})]})]})})}),document.body),K&&sr.createPortal(r.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",children:r.jsx("div",{className:"bg-[var(--color-surface-card)] rounded-2xl shadow-2xl max-w-sm w-full p-6 border border-[var(--color-surface-border)] animate-in fade-in zoom-in-95 duration-200",children:r.jsxs("div",{className:"space-y-4 text-center",children:[r.jsx("h3",{className:"text-lg font-bold text-[var(--color-text-main)]",children:"Delete Subtask?"}),r.jsx("p",{className:"text-sm text-[var(--color-text-muted)]",children:"This action cannot be undone."}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsx(Ne,{variant:"ghost",onClick:()=>F(null),children:"Cancel"}),r.jsx(Ne,{variant:"danger",onClick:Et,children:"Delete"})]})]})})}),document.body),r.jsxs("header",{className:"relative mb-10 overflow-hidden rounded-3xl bg-gradient-to-br from-[var(--color-surface-card)] to-[var(--color-surface-bg)] border border-[var(--color-surface-border)] shadow-sm",children:[r.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-[var(--color-primary)]/5 blur-3xl rounded-full -mr-20 -mt-20 pointer-events-none"}),r.jsx("div",{className:"relative px-6 py-8 md:px-10 md:py-10",children:r.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-end justify-between gap-8",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-4 flex-wrap",children:[H&&r.jsxs(nt,{to:`/project/${H.id}`,className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-[var(--color-surface-hover)] border border-[var(--color-surface-border)] rounded-full transition-all group",children:[r.jsx("div",{className:"size-2 rounded-full bg-[var(--color-primary)]"}),r.jsx("span",{className:"text-xs font-bold text-[var(--color-text-subtle)] group-hover:text-[var(--color-primary)] uppercase tracking-wide",children:H.title}),r.jsx("span",{className:"material-symbols-outlined text-[14px] text-[var(--color-text-muted)] group-hover:text-[var(--color-primary)]",children:"arrow_forward"})]}),r.jsxs("span",{className:`flex items-center gap-1.5 px-3 py-1 rounded-full text-[10px] font-bold tracking-widest uppercase border ${c.status==="Done"?"bg-emerald-500/10 text-emerald-500 border-emerald-500/20":c.status==="In Progress"?"bg-blue-500/10 text-blue-500 border-blue-500/20":c.status==="On Hold"?"bg-orange-500/10 text-orange-500 border-orange-500/20":"bg-slate-500/10 text-slate-500 border-slate-500/20"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[14px] leading-none",children:c.status==="Done"?"check_circle":c.status==="On Hold"?"pause_circle":"radio_button_unchecked"}),c.status||"Open"]}),r.jsx(kM,{priority:c.priority})]}),r.jsx("h1",{className:"text-3xl md:text-4xl lg:text-5xl font-black text-[var(--color-text-main)] leading-[1.1] tracking-tight mb-8",children:c.title}),r.jsxs("div",{className:"flex flex-wrap items-center gap-6 text-sm",children:[r.jsxs("div",{className:"flex items-center gap-2.5 px-4 py-2 bg-[var(--color-surface-hover)] rounded-xl border border-[var(--color-surface-border)]",children:[r.jsx("span",{className:"material-symbols-outlined text-[20px] text-[var(--color-text-muted)]",children:"calendar_today"}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] leading-none uppercase font-bold text-[var(--color-text-subtle)] mb-0.5",children:"Due Date"}),r.jsx("span",{className:"text-[var(--color-text-main)] font-semibold whitespace-nowrap",children:c.dueDate?new Date(c.dueDate).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}):"No due date"})]})]}),be>0&&r.jsxs("div",{className:"flex items-center gap-2.5 px-4 py-2 bg-[var(--color-surface-hover)] rounded-xl border border-[var(--color-surface-border)]",children:[r.jsxs("div",{className:"relative size-6 flex items-center justify-center",children:[r.jsxs("svg",{className:"size-full -rotate-90",children:[r.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"none",stroke:"currentColor",strokeWidth:"2.5",className:"text-[var(--color-surface-border)]"}),r.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeDasharray:2*Math.PI*10,strokeDashoffset:2*Math.PI*10*(1-me/100),strokeLinecap:"round",className:"text-[var(--color-primary)] transition-all duration-700 ease-out"})]}),r.jsxs("span",{className:"absolute text-[8px] font-bold text-[var(--color-text-main)]",children:[Math.round(me),"%"]})]}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] leading-none uppercase font-bold text-[var(--color-text-subtle)] mb-0.5",children:"Subtasks"}),r.jsxs("span",{className:"text-[var(--color-text-main)] font-semibold",children:[we,"/",be]})]})]}),c.scheduledDate&&r.jsxs("div",{className:"flex items-center gap-2.5 px-4 py-2 bg-[var(--color-primary)]/5 rounded-xl border border-[var(--color-primary)]/10",children:[r.jsx("span",{className:"material-symbols-outlined text-[20px] text-[var(--color-primary)]",children:"event_available"}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] leading-none uppercase font-bold text-[var(--color-primary)] mb-0.5",children:"Smart Scheduled"}),r.jsx("span",{className:"text-[var(--color-text-main)] font-semibold",children:new Date(c.scheduledDate).toLocaleDateString(void 0,{month:"short",day:"numeric"})})]})]}),r.jsxs("div",{className:"hidden md:flex items-center gap-3 ml-2",children:[r.jsx("div",{className:"h-8 w-[1px] bg-[var(--color-surface-border)]"}),r.jsxs("div",{className:"flex -space-x-2",children:[(c.assigneeIds||[c.assigneeId]).filter(P=>P).map((P,k)=>{const Q=le.find(ne=>ne.id===P||ne.uid===P);return r.jsx("img",{src:(Q==null?void 0:Q.photoURL)||"https://www.gravatar.com/avatar/?d=mp",alt:"",className:"size-8 rounded-full border-2 border-[var(--color-surface-card)] shadow-sm",title:(Q==null?void 0:Q.displayName)||"Assignee"},P+k)}),!c.assigneeIds&&!c.assigneeId&&r.jsx("div",{className:"size-8 rounded-full border-2 border-dashed border-[var(--color-surface-border)] flex items-center justify-center text-[var(--color-text-subtle)]",children:r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"person"})})]})]})]})]}),r.jsxs("div",{className:"flex flex-col items-stretch lg:items-end gap-3 lg:mb-1",children:[r.jsxs("div",{className:"flex items-center gap-2 bg-[var(--color-surface-hover)] p-1 rounded-xl border border-[var(--color-surface-border)] w-full lg:w-fit",children:[r.jsx(Ne,{variant:"ghost",size:"sm",onClick:()=>L(!0),className:"flex-1 lg:flex-none hover:bg-[var(--color-surface-card)]",icon:r.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"edit"}),children:"Edit"}),r.jsx("div",{className:"w-[1px] h-4 bg-[var(--color-surface-border)]"}),r.jsx(Ne,{variant:"ghost",size:"sm",className:"flex-1 lg:flex-none text-rose-500 hover:text-rose-600 hover:bg-rose-50 dark:hover:bg-rose-950/30",onClick:()=>Z(!0),children:r.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"delete"})})]}),r.jsx(Ne,{variant:c.isCompleted?"secondary":"primary",onClick:Jt,size:"lg",className:"shadow-lg shadow-primary/10 w-full lg:w-fit",icon:r.jsx("span",{className:"material-symbols-outlined",children:c.isCompleted?"check_circle":"check"}),children:c.isCompleted?"Completed":"Mark as Done"})]})]})})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[r.jsxs("div",{className:"lg:col-span-8 space-y-8",children:[r.jsxs("div",{className:"p-0",children:[r.jsxs("h3",{className:"text-xs font-bold text-[var(--color-text-muted)] uppercase mb-3 flex items-center gap-2 tracking-wider",children:[r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"description"}),"Description"]}),r.jsx("div",{className:"app-card p-6 min-h-[120px]",children:c.description?r.jsx("div",{className:"prose prose-sm max-w-none text-[var(--color-text-main)]",children:r.jsx("p",{className:"whitespace-pre-wrap leading-relaxed",children:c.description})}):r.jsx("p",{className:"text-[var(--color-text-muted)] italic",children:"No description provided."})})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("h3",{className:"text-xs font-bold text-[var(--color-text-muted)] uppercase flex items-center gap-2 tracking-wider",children:[r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"checklist"}),"Subtasks"]}),be>0&&r.jsx("span",{className:"bg-[var(--color-surface-hover)] text-[var(--color-text-main)] text-[10px] font-bold px-1.5 py-0.5 rounded-full",children:be})]}),be>0&&r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-24 h-1.5 bg-[var(--color-surface-hover)] rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full bg-[var(--color-primary)] transition-all duration-500 rounded-full",style:{width:`${me}%`}})}),r.jsxs("span",{className:"text-xs font-medium text-[var(--color-text-muted)]",children:[Math.round(me),"%"]})]})]}),r.jsxs("div",{className:"app-card overflow-hidden",children:[r.jsx("div",{className:"divide-y divide-[var(--color-surface-border)]",children:m.map(P=>{var k,Q;return r.jsxs("div",{className:"group flex items-center gap-3 p-3 hover:bg-[var(--color-surface-hover)] transition-colors",children:[r.jsx("button",{onClick:()=>He(P.id,P.isCompleted),className:`size-5 rounded border flex items-center justify-center transition-all ${P.isCompleted?"bg-[var(--color-primary)] border-[var(--color-primary)] text-white":"border-[var(--color-text-muted)] text-transparent hover:border-[var(--color-primary)]"}`,children:r.jsx("span",{className:"material-symbols-outlined text-[14px] font-bold",children:"check"})}),r.jsx("span",{className:`flex-1 text-sm ${P.isCompleted?"text-[var(--color-text-muted)] line-through":"text-[var(--color-text-main)]"}`,children:P.title}),r.jsxs("div",{className:"relative",children:[r.jsx("button",{onClick:ne=>{ne.stopPropagation(),q(re===P.id?null:P.id)},className:`
                                                    size-7 rounded-full border border-dashed flex items-center justify-center transition-all bg-cover bg-center
                                                    ${P.assigneeId?"border-transparent":"border-[var(--color-surface-border)] text-[var(--color-text-subtle)] hover:border-[var(--color-primary)] hover:text-[var(--color-primary)]"}
                                                `,style:{backgroundImage:P.assigneeId?`url(${((k=le.find(ne=>ne.id===P.assigneeId))==null?void 0:k.photoURL)||"https://www.gravatar.com/avatar/?d=mp"})`:"none"},title:P.assigneeId?`Assigned to ${(Q=le.find(ne=>ne.id===P.assigneeId))==null?void 0:Q.displayName}`:"Assign user",children:!P.assigneeId&&r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"person_add"})}),re===P.id&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>q(null)}),r.jsxs("div",{className:"absolute right-0 top-full mt-1 w-48 bg-[var(--color-surface-card)] border border-[var(--color-surface-border)] rounded-xl shadow-xl z-50 overflow-hidden animate-in fade-in slide-in-from-top-2 duration-200",children:[r.jsx("div",{className:"p-2 border-b border-[var(--color-surface-border)] bg-[var(--color-surface-bg)]",children:r.jsx("p",{className:"px-2 text-[10px] font-bold text-[var(--color-text-subtle)] uppercase tracking-wider",children:"Assign to Task Member"})}),r.jsxs("div",{className:"max-h-60 overflow-y-auto p-1",children:[r.jsxs("button",{onClick:()=>Xe(P.id,null),className:"w-full flex items-center gap-2 px-3 py-2 text-xs font-medium text-rose-500 hover:bg-rose-50 dark:hover:bg-rose-900/10 rounded-lg transition-colors",children:[r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"person_remove"}),"Unassign"]}),Ae.map(ne=>{const se=le.find(Se=>Se.id===ne||Se.uid===ne);return r.jsxs("button",{onClick:()=>Xe(P.id,ne),className:`
                                                                            w-full flex items-center gap-2 px-3 py-2 text-xs font-medium rounded-lg transition-colors
                                                                            ${P.assigneeId===ne?"bg-[var(--color-primary-fade)] text-[var(--color-primary)]":"text-[var(--color-text-main)] hover:bg-[var(--color-surface-hover)]"}
                                                                        `,children:[r.jsx("img",{src:(se==null?void 0:se.photoURL)||"https://www.gravatar.com/avatar/?d=mp",alt:"",className:"size-5 rounded-full"}),r.jsx("span",{className:"truncate",children:(se==null?void 0:se.displayName)||(se==null?void 0:se.email)||ne.slice(0,8)}),P.assigneeId===ne&&r.jsx("span",{className:"material-symbols-outlined text-[14px] ml-auto",children:"check"})]},ne)}),Ae.length===0&&r.jsx("p",{className:"p-3 text-[10px] text-[var(--color-text-muted)] italic text-center",children:"No users assigned to parent task"})]})]})]})]}),r.jsx("button",{onClick:()=>Vt(P.id),className:"opacity-0 group-hover:opacity-100 p-1.5 text-[var(--color-text-subtle)] hover:text-rose-500 rounded-lg transition-all",title:"Delete subtask",children:r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"close"})})]},P.id)})}),r.jsx("div",{className:"p-3 bg-[var(--color-surface-bg)] border-t border-[var(--color-surface-border)]",children:r.jsxs("form",{onSubmit:ut,className:"flex gap-2",children:[r.jsx("div",{className:"relative flex-1",children:r.jsx(st,{value:T,onChange:P=>_(P.target.value),placeholder:"Add subtask...",className:"w-full bg-transparent border-none focus:ring-0",icon:r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"add"}),disabled:b})}),r.jsx(Ne,{type:"submit",size:"sm",variant:"secondary",disabled:!T.trim()||b,isLoading:b,children:"Add"})]})})]})]}),r.jsxs("div",{children:[r.jsxs("h3",{className:"text-xs font-bold text-[var(--color-text-muted)] uppercase mb-3 flex items-center gap-2 tracking-wider",children:[r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"chat"}),"Discussion (",ue,")"]}),r.jsx(zm,{projectId:t,targetId:e,targetType:"task",tenantId:c==null?void 0:c.tenantId,isProjectOwner:J,hideHeader:!0,onCountChange:Y})]})]}),r.jsxs("div",{className:"lg:col-span-4 space-y-6",children:[r.jsxs("div",{className:"app-card p-5",children:[r.jsx("h3",{className:"text-xs font-bold text-[var(--color-text-muted)] uppercase tracking-wider mb-3",children:"Status"}),r.jsxs(xn,{value:c.status||"Open",onChange:P=>{const k=P.target.value,Q=k==="Done";u(ne=>ne?{...ne,status:k,isCompleted:Q}:null),Xa(c.id,{status:k,isCompleted:Q},t)},className:"w-full",children:[r.jsx("option",{value:"Open",children:"Open"}),r.jsx("option",{value:"In Progress",children:"In Progress"}),r.jsx("option",{value:"On Hold",children:"On Hold"}),r.jsx("option",{value:"Review",children:"Review"}),r.jsx("option",{value:"Blocked",children:"Blocked"}),r.jsx("option",{value:"Done",children:"Done"})]})]}),r.jsxs("div",{className:"app-card p-5",children:[r.jsx("h3",{className:"text-xs font-bold text-[var(--color-text-muted)] uppercase tracking-wider mb-3",children:"Schedule"}),r.jsxs("div",{className:"flex flex-col gap-4",children:[r.jsxs("div",{className:"flex flex-col gap-1.5",children:[r.jsx("label",{className:"text-[11px] font-medium text-[var(--color-text-subtle)] uppercase",children:"Due Date"}),r.jsx(Pb,{value:c.dueDate||"",onChange:P=>Pt("dueDate",P),placeholder:"Set due date",align:"right"})]}),c.scheduledDate&&r.jsxs("div",{className:"pt-3 border-t border-[var(--color-surface-border)] flex flex-col gap-1.5",children:[r.jsx("label",{className:"text-[11px] font-medium text-[var(--color-text-subtle)] uppercase",children:"Smart Schedule"}),r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm text-[var(--color-text-main)] font-medium",children:[r.jsx("span",{className:"material-symbols-outlined text-[20px] text-[var(--color-primary)]",children:"event_available"}),new Date(c.scheduledDate).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})]}),r.jsxs(nt,{to:"/calendar",className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-[var(--color-primary)] bg-[var(--color-primary)]/10 hover:bg-[var(--color-primary)]/20 rounded-lg transition-colors whitespace-nowrap",children:[r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"calendar_month"}),"View in Calendar"]})]})]})]})]}),r.jsxs("div",{className:"app-card p-5",children:[r.jsx("h3",{className:"text-xs font-bold text-[var(--color-text-muted)] uppercase tracking-wider mb-3",children:"Assignees"}),r.jsx(Nd,{projectId:t,assigneeIds:c.assigneeIds||(c.assigneeId?[c.assigneeId]:[]),onChange:Nt})]}),r.jsxs("div",{className:"app-card p-5",children:[r.jsx("h3",{className:"text-xs font-bold text-[var(--color-text-muted)] uppercase tracking-wider mb-3",children:"Priority"}),r.jsx("div",{className:"flex flex-col gap-1",children:["Low","Medium","High","Urgent"].map(P=>r.jsxs("button",{onClick:()=>Pt("priority",P),className:`
                                        flex items-center justify-between px-3 py-2 rounded-lg text-sm font-medium transition-all
                                        ${c.priority===P?"bg-[var(--color-surface-hover)] text-[var(--color-text-main)] shadow-sm":"text-[var(--color-text-muted)] hover:bg-[var(--color-surface-hover)]"}
                                    `,children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(AM,{priority:P}),P]}),c.priority===P&&r.jsx("span",{className:"material-symbols-outlined text-[16px] text-[var(--color-primary)]",children:"check"})]},P))})]}),r.jsxs("div",{className:"app-card p-5",children:[r.jsx("h3",{className:"text-xs font-bold text-[var(--color-text-muted)] uppercase tracking-wider mb-4",children:"Task Details"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("span",{className:"text-[10px] font-bold text-[var(--color-text-subtle)] uppercase",children:"Task ID"}),r.jsxs("div",{className:"group relative",children:[r.jsx("code",{className:"block w-full text-[11px] font-mono text-[var(--color-text-main)] bg-[var(--color-surface-hover)] p-2 rounded-lg border border-[var(--color-surface-border)] break-all truncate hover:whitespace-normal transition-all cursor-pointer",title:"Click to copy ID",onClick:()=>{navigator.clipboard.writeText(c.id),je(!0),setTimeout(()=>je(!1),2e3)},children:c.id}),r.jsx("span",{className:`absolute right-2 top-2 transition-all material-symbols-outlined text-[14px] ${ye?"text-emerald-500 scale-110":"opacity-0 group-hover:opacity-100 text-[var(--color-text-muted)]"} pointer-events-none`,children:ye?"check_circle":"content_copy"}),ye&&r.jsx("span",{className:"absolute -top-7 right-0 text-[10px] font-bold text-emerald-500 bg-emerald-500/10 px-2 py-0.5 rounded-full border border-emerald-500/20 animate-fade-in-up",children:"Copied!"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("span",{className:"text-[10px] font-bold text-[var(--color-text-subtle)] uppercase",children:"Created"}),r.jsxs("span",{className:"text-xs font-semibold text-[var(--color-text-main)] flex items-center gap-1.5",children:[r.jsx("span",{className:"material-symbols-outlined text-[16px] text-[var(--color-text-muted)]",children:"history"}),c.createdAt?new Date(c.createdAt.toDate()).toLocaleDateString(void 0,{weekday:"short",year:"numeric",month:"long",day:"numeric"}):"-"]})]}),c.ownerId&&r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("span",{className:"text-[10px] font-bold text-[var(--color-text-subtle)] uppercase",children:"Reporter"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("img",{src:((_t=le.find(P=>P.id===c.ownerId||P.uid===c.ownerId))==null?void 0:_t.photoURL)||"https://www.gravatar.com/avatar/?d=mp",className:"size-5 rounded-full border border-[var(--color-surface-border)]",alt:""}),r.jsx("span",{className:"text-xs font-semibold text-[var(--color-text-main)]",children:((un=le.find(P=>P.id===c.ownerId||P.uid===c.ownerId))==null?void 0:un.displayName)||"Unknown User"})]})]}),r.jsxs("div",{className:"pt-3 border-t border-[var(--color-surface-border)] flex items-center justify-between",children:[r.jsx("span",{className:"text-[10px] font-bold text-[var(--color-text-subtle)] uppercase",children:"Completion"}),r.jsx("span",{className:`text-[10px] font-bold px-2 py-0.5 rounded-full border ${c.isCompleted?"bg-emerald-500/10 text-emerald-500 border-emerald-500/20":"bg-blue-500/10 text-blue-500 border-blue-500/20"}`,children:c.isCompleted?"Finished":"Active"})]}),c.linkedIssueId&&r.jsxs("div",{className:"pt-3 border-t border-[var(--color-surface-border)]",children:[r.jsx("span",{className:"text-[10px] font-bold text-[var(--color-text-subtle)] uppercase block mb-1",children:"Related Issue"}),r.jsxs(nt,{to:`/project/${t}/issues/${c.linkedIssueId}`,className:"text-xs font-bold text-[var(--color-primary)] hover:underline flex items-center gap-1.5",children:[r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"bug_report"}),"View Report"]})]})]})]})]})]})]})]}):r.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[50vh] gap-4",children:[r.jsx("h3",{className:"text-xl font-bold text-[var(--color-text-main)]",children:"Task not found"}),r.jsx(nt,{to:`/project/${t}/tasks`,className:"btn-secondary",children:"Return to Tasks"})]})},AM=({priority:t})=>{const e={Urgent:"error",High:"keyboard_double_arrow_up",Medium:"drag_handle",Low:"keyboard_arrow_down"},s={Urgent:"text-rose-500",High:"text-orange-500",Medium:"text-blue-500",Low:"text-slate-500"};return r.jsx("span",{className:`material-symbols-outlined text-[18px] ${s[t]}`,children:e[t]})},kM=({priority:t})=>{const e={Urgent:"bg-rose-500/10 text-rose-500 border-rose-500/20",High:"bg-amber-500/10 text-amber-500 border-amber-500/20",Medium:"bg-blue-500/10 text-blue-500 border-blue-500/20",Low:"bg-slate-500/10 text-slate-500 border-slate-500/20"},s={Urgent:"error",High:"keyboard_double_arrow_up",Medium:"drag_handle",Low:"keyboard_arrow_down"};return r.jsxs("span",{className:`px-2 py-0.5 rounded-full text-xs font-bold border flex items-center gap-1.5 ${e[t]||e.Medium}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[14px]",children:s[t]}),t]})},IM=({issue:t,isOpen:e,onClose:s,onUpdate:o})=>{const[i,c]=w.useState(t.title),[u,m]=w.useState(t.description||""),[h,x]=w.useState(!1);w.useEffect(()=>{e&&(c(t.title),m(t.description||""))},[e,t]);const v=async b=>{b.preventDefault(),x(!0);try{await Hs(t.id,{title:i,description:u},t.projectId,t.tenantId),o(),s()}catch(N){console.error(N)}finally{x(!1)}};return e?sr.createPortal(r.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-fade-in",onClick:s,children:r.jsxs("div",{className:"w-full max-w-2xl bg-[var(--color-surface-card)] rounded-xl shadow-2xl animate-scale-up border border-[var(--color-surface-border)] flex flex-col max-h-[90vh] overflow-y-auto",onClick:b=>b.stopPropagation(),children:[r.jsxs("div",{className:"p-4 border-b border-[var(--color-surface-border)] flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-bold text-[var(--color-text-main)]",children:"Edit Issue"}),r.jsx("p",{className:"text-sm text-[var(--color-text-muted)] mt-1",children:"Update issue details. Changes will sync to GitHub if linked."})]}),r.jsx(Ne,{variant:"ghost",onClick:s,size:"sm",children:"Close"})]}),r.jsxs("form",{onSubmit:v,className:"p-6",children:[r.jsxs("div",{className:"flex flex-col gap-6",children:[r.jsx(st,{label:"Title",value:i,onChange:b=>c(b.target.value),placeholder:"Issue title",required:!0,className:"text-lg font-medium"}),r.jsxs("div",{className:"flex flex-col gap-1.5",children:[r.jsx("label",{className:"text-xs font-bold uppercase tracking-wider text-[var(--color-text-muted)] ml-1",children:"Description"}),r.jsx(An,{value:u,onChange:b=>m(b.target.value),placeholder:"Describe the issue...",rows:8,className:"min-h-[200px]"})]})]}),r.jsxs("div",{className:"flex justify-end gap-2 mt-8 pt-4 border-t border-[var(--color-surface-border)]",children:[r.jsx(Ne,{type:"button",variant:"ghost",onClick:s,disabled:h,children:"Cancel"}),r.jsx(Ne,{type:"submit",isLoading:h,disabled:!i.trim(),children:"Save Changes"})]})]})]})}),document.body):null},MM=()=>{var ye,je;const{id:t,issueId:e}=Yn(),s=dn(),[o,i]=w.useState(null),[c,u]=w.useState(null),[m,h]=w.useState(!0),[x,v]=w.useState(!1),[b,N]=w.useState(!1),[T,_]=w.useState(!1),[I,E]=w.useState(!1),[D,z]=w.useState([]),[A,M]=w.useState(!1),[B,L]=w.useState([]),[X,de]=w.useState(0),[V,Z]=w.useState(!1),[K,F]=w.useState(!1),le=w.useMemo(()=>{var J;return(c==null?void 0:c.ownerId)===((J=xe.currentUser)==null?void 0:J.uid)},[c==null?void 0:c.ownerId]),{setTaskTitle:he}=w0(),re=async()=>{if(!(!t||!e))try{const J=await $t(t);u(J);const we=J==null?void 0:J.tenantId,be=await Kc(e,t,we);be&&(i(be),h(!1))}catch(J){console.error("Failed to load issue",J)}};w.useEffect(()=>{if(!t||!e)return;let J=!0,we;return(async()=>{try{const me=await $t(t);if(!J)return;u(me);const Ae=me==null?void 0:me.tenantId;if(we=wl(t,De=>{if(!J)return;const Ee=De.find(ut=>ut.id===e);i(Ee||null),h(!1)},Ae),!o){const De=await Kc(e,t,Ae);J&&De&&(i(De),h(!1))}}catch(me){console.error("Failed to load issue detail",me),J&&h(!1)}})(),()=>{J=!1,we&&we()}},[t,e]),w.useEffect(()=>{o&&he(o.title)},[o,he]),w.useEffect(()=>{if(!(c!=null&&c.tenantId))return;const J=ba(we=>{L(we)},c.tenantId);return()=>J()},[c==null?void 0:c.tenantId]),w.useEffect(()=>{o!=null&&o.githubIssueNumber&&(c!=null&&c.githubRepo)&&(async()=>{M(!0);try{const we=xe.currentUser;let be=c.githubToken;if(!be&&(we!=null&&we.uid)){const Ae=await Mn(we.uid,c.tenantId);be=Ae==null?void 0:Ae.githubToken}const me=await bS(c.githubRepo,be,o.githubIssueNumber);z(me)}catch(we){console.error("Failed to fetch related commits",we)}finally{M(!1)}})()},[o==null?void 0:o.githubIssueNumber,c==null?void 0:c.githubRepo]);const q=async J=>{!o||!t||await Hs(o.id,{status:J},t,c==null?void 0:c.tenantId)},H=async(J,we)=>{!o||!t||await Hs(o.id,{[J]:we},t,c==null?void 0:c.tenantId)},R=async J=>{if(!o||!t)return;const we=J.length>0?J[0]:"";await Hs(o.id,{assigneeIds:J,assigneeId:we},t,c==null?void 0:c.tenantId)},ue=async()=>{if(!(!o||!t)){v(!0);try{await ny(o.id,t,c==null?void 0:c.tenantId),s(`/project/${t}/issues`)}catch(J){console.error("Failed to delete issue",J),v(!1),N(!1)}}},Y=async()=>{if(!(!o||!t)){E(!0);try{const J=await xa(t,o.title,void 0,o.assignee,o.priority,{description:`[From Issue] ${o.description}`,status:"Open",assigneeId:o.assigneeId,assigneeIds:o.assigneeIds,linkedIssueId:o.id},c==null?void 0:c.tenantId);await Hs(o.id,{status:"Closed",linkedTaskId:J},t,c==null?void 0:c.tenantId),s(`/project/${t}/tasks`)}catch(J){console.error(J)}finally{E(!1),_(!1)}}};return m?r.jsx("div",{className:"flex justify-center items-center min-h-[50vh]",children:r.jsx("div",{className:"flex flex-col items-center gap-3",children:r.jsx("span",{className:"material-symbols-outlined animate-spin text-4xl text-[var(--color-primary)]",children:"progress_activity"})})}):o?r.jsxs("div",{className:"max-w-6xl mx-auto px-4 md:px-8 py-8 animate-fade-in pb-20",children:[V&&o&&r.jsx(IM,{issue:o,isOpen:V,onClose:()=>Z(!1),onUpdate:re}),b&&sr.createPortal(r.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",children:r.jsx("div",{className:"bg-[var(--color-surface-card)] rounded-2xl shadow-2xl max-w-sm w-full p-6 border border-[var(--color-surface-border)]",children:r.jsxs("div",{className:"space-y-4 text-center",children:[r.jsx("h3",{className:"text-lg font-bold text-[var(--color-text-main)]",children:"Delete Issue?"}),r.jsxs("p",{className:"text-sm text-[var(--color-text-muted)]",children:["Are you sure you want to delete ",r.jsxs("strong",{children:['"',o.title,'"']}),"? This action cannot be undone."]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsx(Ne,{variant:"ghost",onClick:()=>N(!1),children:"Cancel"}),r.jsx(Ne,{variant:"danger",onClick:ue,isLoading:x,children:"Delete"})]})]})})}),document.body),T&&sr.createPortal(r.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",children:r.jsx("div",{className:"bg-[var(--color-surface-card)] rounded-2xl shadow-2xl max-w-md w-full p-6 border border-[var(--color-surface-border)]",children:r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-xl font-bold text-[var(--color-text-main)]",children:"Convert to Task"}),r.jsxs("p",{className:"text-sm text-[var(--color-text-muted)]",children:["This will create a new task with the same title and description, and mark this issue as ",r.jsx("strong",{children:"Closed"}),"."]}),r.jsxs("div",{className:"bg-[var(--color-surface-hover)] p-4 rounded-xl text-sm border border-[var(--color-surface-border)]",children:[r.jsx("p",{className:"font-bold text-[var(--color-text-main)]",children:o.title}),r.jsxs("p",{className:"text-xs text-[var(--color-text-muted)] mt-1.5 flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"group"}),o.assigneeIds&&o.assigneeIds.length>0?`${o.assigneeIds.length} Assignees`:`Assignee: ${o.assignee||"Unassigned"}`]})]}),r.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[r.jsx(Ne,{variant:"ghost",onClick:()=>_(!1),children:"Cancel"}),r.jsx(Ne,{onClick:Y,isLoading:I,children:"Convert Issue"})]})]})})}),document.body),r.jsxs("header",{className:"relative mb-10 overflow-hidden rounded-3xl bg-gradient-to-br from-[var(--color-surface-card)] to-[var(--color-surface-bg)] border border-[var(--color-surface-border)] shadow-sm",children:[r.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-indigo-500/5 blur-3xl rounded-full -mr-20 -mt-20 pointer-events-none"}),r.jsx("div",{className:"relative px-6 py-8 md:px-10 md:py-10",children:r.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-end justify-between gap-8",children:[r.jsx("div",{className:"flex-1 min-w-0",children:r.jsxs("div",{className:"flex items-center gap-3 mb-4 flex-wrap",children:[c&&r.jsxs(nt,{to:`/project/${c.id}`,className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-[var(--color-surface-hover)] border border-[var(--color-surface-border)] transition-all group",children:[r.jsx("div",{className:"size-2 rounded-full bg-[var(--color-primary)]"}),r.jsx("span",{className:"text-xs font-bold text-[var(--color-text-subtle)] group-hover:text-[var(--color-primary)] uppercase tracking-wide",children:c.title}),r.jsx("span",{className:"material-symbols-outlined text-[14px] text-[var(--color-text-muted)] group-hover:text-[var(--color-primary)]",children:"arrow_forward"})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("span",{className:`flex items-center gap-1.5 px-3 py-1 rounded-full text-[10px] font-bold tracking-widest uppercase border ${o.status==="Resolved"?"bg-emerald-500/10 text-emerald-500 border-emerald-500/20":o.status==="Open"?"bg-blue-500/10 text-blue-500 border-blue-500/20":"bg-slate-500/10 text-slate-500 border-slate-500/20"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[14px] leading-none",children:o.status==="Resolved"?"check_circle":o.status==="Closed"?"cancel":"error"}),o.status||"Open"]}),r.jsx(DM,{priority:o.priority})]}),r.jsx("h1",{className:"text-3xl md:text-4xl lg:text-5xl font-black text-[var(--color-text-main)] leading-[1.1] tracking-tight mb-8",children:o.title}),r.jsxs("div",{className:"flex flex-wrap items-center gap-6 text-sm",children:[r.jsxs("div",{className:"flex items-center gap-2.5 px-4 py-2 bg-[var(--color-surface-hover)] rounded-xl border border-[var(--color-surface-border)]",children:[r.jsx("span",{className:"material-symbols-outlined text-[20px] text-[var(--color-text-muted)]",children:"calendar_today"}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[10px] leading-none uppercase font-bold text-[var(--color-text-subtle)] mb-0.5",children:"Reported"}),r.jsx("span",{className:"text-[var(--color-text-main)] font-semibold whitespace-nowrap",children:o.createdAt?new Date(Le(o.createdAt)).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}):"-"})]})]}),r.jsxs("div",{className:"hidden md:flex items-center gap-3 ml-2",children:[r.jsx("div",{className:"h-8 w-[1px] bg-[var(--color-surface-border)]"}),r.jsxs("div",{className:"flex -space-x-2",children:[(o.assigneeIds||(o.assigneeId?[o.assigneeId]:[])).filter(J=>J).map((J,we)=>{const be=B.find(me=>me.id===J||me.uid===J);return r.jsx("img",{src:(be==null?void 0:be.photoURL)||"https://www.gravatar.com/avatar/?d=mp",alt:"",className:"size-8 rounded-full border-2 border-[var(--color-surface-card)] shadow-sm",title:(be==null?void 0:be.displayName)||"Assignee"},J+we)}),(!o.assigneeIds||o.assigneeIds.length===0)&&!o.assigneeId&&r.jsx("div",{className:"size-8 rounded-full border-2 border-dashed border-[var(--color-surface-border)] flex items-center justify-center text-[var(--color-text-subtle)]",children:r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"person"})})]})]})]})]})}),r.jsxs("div",{className:"flex flex-col items-stretch lg:items-end gap-3 lg:mb-1",children:[r.jsxs("div",{className:"flex items-center gap-2 bg-[var(--color-surface-hover)] p-1 rounded-xl border border-[var(--color-surface-border)] w-full lg:w-fit",children:[r.jsx(Ne,{variant:"ghost",size:"sm",onClick:()=>Z(!0),className:"flex-1 lg:flex-none hover:bg-[var(--color-surface-card)]",icon:r.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"edit"}),children:"Edit"}),r.jsx("div",{className:"w-[1px] h-4 bg-[var(--color-surface-border)]"}),r.jsx(Ne,{variant:"ghost",size:"sm",className:"flex-1 lg:flex-none text-rose-500 hover:text-rose-600 hover:bg-rose-50 dark:hover:bg-rose-950/30",onClick:()=>N(!0),children:r.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"delete"})})]}),r.jsx(Ne,{variant:"primary",onClick:()=>_(!0),size:"lg",className:"shadow-lg shadow-indigo-500/10 w-full lg:w-fit",icon:r.jsx("span",{className:"material-symbols-outlined",children:"task_alt"}),children:"Convert to Task"})]})]})})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[r.jsxs("div",{className:"lg:col-span-8 space-y-8",children:[r.jsxs("div",{className:"p-0",children:[r.jsxs("h3",{className:"text-xs font-bold text-[var(--color-text-muted)] uppercase mb-3 flex items-center gap-2 tracking-wider",children:[r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"description"}),"Description"]}),r.jsx("div",{className:"app-card p-6 min-h-[120px]",children:o.description?r.jsx("div",{className:"prose prose-sm max-w-none text-[var(--color-text-main)]",children:r.jsx("p",{className:"whitespace-pre-wrap leading-relaxed",children:o.description})}):r.jsx("p",{className:"text-[var(--color-text-muted)] italic",children:"No description provided."})})]}),r.jsxs("div",{children:[r.jsxs("h3",{className:"text-xs font-bold text-[var(--color-text-muted)] uppercase mb-3 flex items-center gap-2 tracking-wider",children:[r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"chat"}),"Discussion (",X,")"]}),r.jsx(zm,{projectId:t,targetId:e,targetType:"issue",tenantId:c==null?void 0:c.tenantId,isProjectOwner:le,hideHeader:!0,onCountChange:de})]})]}),r.jsxs("div",{className:"lg:col-span-4 space-y-6",children:[o.githubIssueNumber&&r.jsxs("div",{className:"app-card overflow-hidden",children:[r.jsxs("div",{className:"p-4 flex items-center justify-between border-b border-[var(--color-surface-border)]",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-[20px] text-indigo-500",children:"terminal"}),r.jsx("h3",{className:"text-sm font-bold text-[var(--color-text-main)] tracking-wide uppercase",children:"GitHub Reference"})]}),r.jsx(Tn,{variant:"success",className:"bg-emerald-500/20 text-emerald-400 border-none text-[10px]",children:"SYNCED"})]}),r.jsxs("div",{className:"p-5 space-y-6",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-[10px] font-bold text-[var(--color-text-muted)] uppercase tracking-wider mb-2",children:"Linked Issue"}),r.jsxs("a",{href:o.githubIssueUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between p-3 rounded-xl bg-[var(--color-surface-hover)] border border-[var(--color-surface-border)] hover:border-[var(--color-primary)] transition-all group",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"size-8 bg-white dark:bg-zinc-800 rounded-lg flex items-center justify-center border border-[var(--color-surface-border)]",children:r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"open_in_new"})}),r.jsxs("div",{children:[r.jsxs("p",{className:"text-sm font-bold text-[var(--color-text-main)]",children:["Issue #",o.githubIssueNumber]}),r.jsx("p",{className:"text-[10px] text-[var(--color-text-muted)]",children:"View on GitHub"})]})]}),r.jsx("span",{className:"material-symbols-outlined text-[18px] text-[var(--color-text-subtle)] group-hover:text-[var(--color-primary)] transition-colors",children:"chevron_right"})]})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("p",{className:"text-[10px] font-bold text-[var(--color-text-muted)] uppercase tracking-wider",children:"Related Commits"}),r.jsxs("span",{className:"text-[10px] font-medium px-1.5 py-0.5 rounded bg-[var(--color-surface-hover)] text-[var(--color-text-muted)]",children:[D.length," Found"]})]}),A?r.jsxs("div",{className:"flex items-center gap-2 py-2",children:[r.jsx("span",{className:"material-symbols-outlined animate-spin text-[16px] text-[var(--color-primary)]",children:"progress_activity"}),r.jsx("span",{className:"text-[11px] text-[var(--color-text-muted)]",children:"Searching repository..."})]}):D.length>0?r.jsx("div",{className:"space-y-2 max-h-[250px] overflow-y-auto pr-1 custom-scrollbar",children:D.map(J=>{var we,be;return r.jsxs("a",{href:J.html_url,target:"_blank",rel:"noopener noreferrer",className:"block p-2.5 rounded-lg border border-[var(--color-surface-border)] bg-[var(--color-surface-paper)] hover:bg-[var(--color-surface-hover)] transition-all group",children:[r.jsx("p",{className:"text-[11px] font-medium text-[var(--color-text-main)] line-clamp-1 group-hover:text-[var(--color-primary)]",children:J.commit.message}),r.jsxs("div",{className:"flex items-center justify-between mt-1.5",children:[r.jsxs("div",{className:"flex items-center gap-1.5",children:[((we=J.author)==null?void 0:we.avatar_url)&&r.jsx("img",{src:J.author.avatar_url,className:"size-4 rounded-full border border-[var(--color-surface-border)]",alt:""}),r.jsxs("span",{className:"text-[9px] text-[var(--color-text-muted)]",children:["@",((be=J.author)==null?void 0:be.login)||"unknown"]})]}),r.jsxs("div",{className:"flex flex-col items-end",children:[r.jsx("span",{className:"text-[9px] font-mono text-[var(--color-text-subtle)]",children:J.sha.slice(0,7)}),r.jsx("span",{className:"text-[8px] text-[var(--color-text-subtle)]",children:Hc(J.commit.author.date)})]})]})]},J.sha)})}):r.jsx("div",{className:"py-4 text-center bg-[var(--color-surface-hover)]/50 rounded-xl border border-dashed border-[var(--color-surface-border)]",children:r.jsx("p",{className:"text-[10px] text-[var(--color-text-muted)]",children:"No commits found referencing this issue."})})]})]})]}),r.jsxs("div",{className:"app-card p-5",children:[r.jsx("h3",{className:"text-xs font-bold text-[var(--color-text-muted)] uppercase tracking-wider mb-3",children:"Status"}),r.jsx("div",{className:"relative",children:r.jsxs(xn,{value:o.status,onChange:J=>q(J.target.value),className:"w-full",children:[r.jsx("option",{value:"Open",children:"Open"}),r.jsx("option",{value:"In Progress",children:"In Progress"}),r.jsx("option",{value:"Resolved",children:"Resolved"}),r.jsx("option",{value:"Closed",children:"Closed"})]})})]}),r.jsxs("div",{className:"app-card p-5",children:[r.jsx("h3",{className:"text-xs font-bold text-[var(--color-text-muted)] uppercase tracking-wider mb-3",children:"Assignees"}),r.jsx(Nd,{projectId:t,assigneeIds:o.assigneeIds||(o.assigneeId?[o.assigneeId]:[]),onChange:R})]}),r.jsxs("div",{className:"app-card p-5",children:[r.jsx("h3",{className:"text-xs font-bold text-[var(--color-text-muted)] uppercase tracking-wider mb-3",children:"Priority"}),r.jsx("div",{className:"flex flex-col gap-1",children:["Low","Medium","High","Urgent"].map(J=>r.jsxs("button",{onClick:()=>H("priority",J),className:`
                                        flex items-center justify-between px-3 py-2 rounded-lg text-sm font-medium transition-all
                                        ${o.priority===J?"bg-[var(--color-surface-hover)] text-[var(--color-text-main)] shadow-sm":"text-[var(--color-text-muted)] hover:bg-[var(--color-surface-hover)]"}
                                    `,children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(RM,{priority:J}),J]}),o.priority===J&&r.jsx("span",{className:"material-symbols-outlined text-[16px] text-[var(--color-primary)]",children:"check"})]},J))})]}),r.jsxs("div",{className:"app-card p-5",children:[r.jsx("h3",{className:"text-xs font-bold text-[var(--color-text-muted)] uppercase tracking-wider mb-4",children:"Issue Details"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("span",{className:"text-[10px] font-bold text-[var(--color-text-subtle)] uppercase",children:"Issue ID"}),r.jsxs("div",{className:"group relative",children:[r.jsx("code",{className:"block w-full text-[11px] font-mono text-[var(--color-text-main)] bg-[var(--color-surface-hover)] p-2 rounded-lg border border-[var(--color-surface-border)] break-all truncate hover:whitespace-normal transition-all cursor-pointer",title:"Click to copy ID",onClick:()=>{navigator.clipboard.writeText(o.id),F(!0),setTimeout(()=>F(!1),2e3)},children:o.id}),r.jsx("span",{className:`absolute right-2 top-2 transition-all material-symbols-outlined text-[14px] ${K?"text-emerald-500 scale-110":"opacity-0 group-hover:opacity-100 text-[var(--color-text-muted)]"} pointer-events-none`,children:K?"check_circle":"content_copy"}),K&&r.jsx("span",{className:"absolute -top-7 right-0 text-[10px] font-bold text-emerald-500 bg-emerald-500/10 px-2 py-0.5 rounded-full border border-emerald-500/20 animate-fade-in-up",children:"Copied!"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("span",{className:"text-[10px] font-bold text-[var(--color-text-subtle)] uppercase",children:"Reported"}),r.jsxs("span",{className:"text-xs font-semibold text-[var(--color-text-main)] flex items-center gap-1.5",children:[r.jsx("span",{className:"material-symbols-outlined text-[16px] text-[var(--color-text-muted)]",children:"history"}),o.createdAt?new Date(Le(o.createdAt)).toLocaleDateString(void 0,{weekday:"short",year:"numeric",month:"long",day:"numeric"}):"-"]})]}),o.ownerId&&r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("span",{className:"text-[10px] font-bold text-[var(--color-text-subtle)] uppercase",children:"Reporter"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("img",{src:((ye=B.find(J=>J.id===o.ownerId||J.uid===o.ownerId))==null?void 0:ye.photoURL)||"https://www.gravatar.com/avatar/?d=mp",className:"size-5 rounded-full border border-[var(--color-surface-border)]",alt:""}),r.jsx("span",{className:"text-xs font-semibold text-[var(--color-text-main)]",children:((je=B.find(J=>J.id===o.ownerId||J.uid===o.ownerId))==null?void 0:je.displayName)||"Unknown User"})]})]}),r.jsxs("div",{className:"pt-3 border-t border-[var(--color-surface-border)] flex items-center justify-between",children:[r.jsx("span",{className:"text-[10px] font-bold text-[var(--color-text-subtle)] uppercase",children:"Status"}),r.jsx("span",{className:`text-[10px] font-bold px-2 py-0.5 rounded-full border ${o.status==="Resolved"?"bg-emerald-500/10 text-emerald-500 border-emerald-500/20":o.status==="Open"?"bg-blue-500/10 text-blue-500 border-blue-500/20":"bg-slate-500/10 text-slate-500 border-slate-500/20"}`,children:o.status})]}),o.linkedTaskId&&r.jsxs("div",{className:"pt-3 border-t border-[var(--color-surface-border)]",children:[r.jsx("span",{className:"text-[10px] font-bold text-[var(--color-text-subtle)] uppercase block mb-1",children:"Related Task"}),r.jsxs(nt,{to:`/project/${t}/tasks/${o.linkedTaskId}`,className:"text-xs font-bold text-[var(--color-primary)] hover:underline flex items-center gap-1.5",children:[r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"task_alt"}),"View Task"]})]})]})]})]})]})]})]}):r.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[50vh] gap-4",children:[r.jsx("h3",{className:"text-xl font-bold text-[var(--color-text-main)]",children:"Issue not found"}),r.jsx(nt,{to:`/project/${t}/issues`,className:"btn-secondary",children:"Return to Issues"})]})},RM=({priority:t})=>{const e={Urgent:"error",High:"keyboard_double_arrow_up",Medium:"drag_handle",Low:"keyboard_arrow_down"},s={Urgent:"text-rose-500",High:"text-orange-500",Medium:"text-blue-500",Low:"text-slate-500"};return r.jsx("span",{className:`material-symbols-outlined text-[18px] ${s[t]}`,children:e[t]})},DM=({priority:t})=>{const e={Urgent:"bg-rose-500/10 text-rose-500 border-rose-500/20",High:"bg-amber-500/10 text-amber-500 border-amber-500/20",Medium:"bg-blue-500/10 text-blue-500 border-blue-500/20",Low:"bg-slate-500/10 text-slate-500 border-slate-500/20"},s={Urgent:"error",High:"keyboard_double_arrow_up",Medium:"drag_handle",Low:"keyboard_arrow_down"};return r.jsxs("span",{className:`px-2 py-0.5 rounded-full text-xs font-bold border flex items-center gap-1.5 ${e[t]||e.Medium}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[14px]",children:s[t]}),t]})},y0=t=>(t||"").replace(/\*\*/g,""),UM=(t,e)=>((e||"").toLowerCase(),t==="task"?{icon:"task_alt",color:"text-emerald-600",bg:"bg-emerald-50"}:t==="status"?{icon:"flag",color:"text-indigo-600",bg:"bg-indigo-50"}:t==="report"?{icon:"article",color:"text-purple-600",bg:"bg-purple-50"}:t==="priority"?{icon:"priority_high",color:"text-rose-600",bg:"bg-rose-50"}:{icon:"history",color:"text-[var(--color-text-muted)]",bg:"bg-[var(--color-surface-hover)]"}),PM=()=>{const{id:t}=Yn(),[e,s]=w.useState([]),[o,i]=w.useState(!0);return w.useEffect(()=>{t&&(async()=>{const c=await ty(t);s(c),i(!1)})()},[t]),o?r.jsx("div",{className:"flex items-center justify-center p-12",children:r.jsx("span",{className:"material-symbols-outlined text-[var(--color-text-subtle)] animate-spin text-3xl",children:"rotate_right"})}):r.jsxs("div",{className:"max-w-4xl mx-auto flex flex-col gap-6 fade-in",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"h2 text-[var(--color-text-main)]",children:"Activity Log"}),r.jsx("p",{className:"text-[var(--color-text-muted)] text-sm",children:"History of changes and updates."})]}),r.jsx(nt,{to:`/project/${t}`,children:r.jsx("button",{className:"text-sm font-bold text-[var(--color-primary)] hover:underline",children:"Back to Overview"})})]}),r.jsx(Be,{padding:"lg",children:r.jsxs("div",{className:"space-y-8 relative",children:[r.jsx("div",{className:"absolute top-2 bottom-2 left-6 w-px bg-[var(--color-surface-border)]"}),e.length===0?r.jsx("p",{className:"text-[var(--color-text-muted)] pl-12",children:"No activity recorded yet."}):e.map(c=>{const{icon:u,color:m,bg:h}=UM(c.type,c.action);return r.jsxs("div",{className:"relative pl-12",children:[r.jsx("div",{className:`
                                        absolute left-1.5 top-0 size-9 rounded-full border-4 border-[var(--color-surface-paper)] 
                                        flex items-center justify-center ${h} ${m}
                                     `,children:r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:u})}),r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-bold text-[var(--color-text-main)] text-sm",children:c.user}),r.jsxs("span",{className:"text-xs text-[var(--color-text-subtle)]",children:[" ",new Date(Le(c.createdAt)).toLocaleString()]})]}),r.jsx("p",{className:"text-sm text-[var(--color-text-main)]",children:y0(c.action)}),r.jsx("div",{className:"p-3 rounded-lg bg-[var(--color-surface-hover)] border border-[var(--color-surface-border)] mt-1",children:r.jsx("p",{className:"text-sm text-[var(--color-text-muted)]",children:y0(c.details||c.target)})})]})]},c.id)})]})})]})},LM=()=>{const{id:t}=Yn(),[e,s]=w.useState([]),[o,i]=w.useState([]),[c,u]=w.useState([]),[m,h]=w.useState(null),[x,v]=w.useState(!0),[b,N]=w.useState(!1),T=w.useMemo(()=>{var R;return(m==null?void 0:m.ownerId)===((R=xe.currentUser)==null?void 0:R.uid)},[m==null?void 0:m.ownerId]),[_,I]=w.useState("grid"),[E,D]=w.useState("all"),[z,A]=w.useState(!1),[M,B]=w.useState(!1),[L,X]=w.useState({id:"",title:"",description:"",type:""}),[de,V]=w.useState(!1),[Z,K]=w.useState(null),F=async()=>{if(t){v(!0);try{const[R,ue,Y,ye]=await Promise.all([$t(t),ld(t),Ir(t),Ka(t)]);h(R),s(ue),i(Y),u(ye)}catch(R){console.error(R)}finally{v(!1)}}};w.useEffect(()=>{F()},[t]);const le=async()=>{var R;if(!(!m||!t)){N(!0);try{const ue=c.length?c:await Ka(t);c.length||u(ue);const Y=(R=ue[0])==null?void 0:R.id,ye=await mk(m,o);await Promise.all(ye.map(je=>Za({...je,projectId:t,mindmapId:Y}))),await F()}catch(ue){console.error(ue),K("AI generation failed.")}finally{N(!1)}}},he=async()=>{if(!(!t||!L.title.trim())){V(!0);try{L.id?await cs(L.id,{title:L.title,description:L.description,type:L.type||"Idea"},t):await Za({title:L.title,description:L.description,type:L.type||"Idea",projectId:t,generated:!1}),await F(),A(!1),B(!1),X({id:"",title:"",description:"",type:""})}catch(R){console.error(R)}finally{V(!1)}}},re=async R=>{if(confirm("Are you sure?"))try{await Jc(R,t),await F()}catch(ue){console.error(ue)}},q=async R=>{if(!(!t||R.convertedTaskId))try{const ue=await xa(t,R.title,void 0,void 0,"Medium",{description:R.description||"",category:R.type?[R.type]:void 0,status:"Backlog"});await cs(R.id,{convertedTaskId:ue,convertedAt:new Date().toISOString()},t),await F()}catch(ue){console.error(ue)}},H=e.filter(R=>{var Y;const ue=R.mindmapId||((Y=c[0])==null?void 0:Y.id)||null;return E==="all"?!0:E==="unassigned"?!ue:ue===E});return x?r.jsx("div",{className:"flex items-center justify-center p-12",children:r.jsx("span",{className:"material-symbols-outlined text-[var(--color-text-subtle)] animate-spin text-3xl",children:"rotate_right"})}):r.jsxs("div",{className:"flex flex-col gap-6 fade-in max-w-6xl mx-auto",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"h2 text-[var(--color-text-main)]",children:"Ideas Board"}),r.jsx("p",{className:"text-[var(--color-text-muted)] text-sm",children:"Capture, organize, and refine project concepts."})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-48",children:r.jsxs(xn,{value:E,onChange:R=>D(R.target.value),className:"h-10",children:[r.jsx("option",{value:"all",children:"All Groups"}),c.map(R=>r.jsx("option",{value:R.id,children:R.name},R.id))]})}),r.jsxs("div",{className:"flex items-center rounded-lg border border-[var(--color-surface-border)] bg-[var(--color-surface-paper)] overflow-hidden",children:[r.jsx("button",{onClick:()=>I("list"),className:`p-2 transition-colors ${_==="list"?"bg-[var(--color-surface-hover)] text-[var(--color-primary)]":"text-[var(--color-text-muted)] hover:text-[var(--color-text-main)]"}`,children:r.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"view_list"})}),r.jsx("div",{className:"w-px h-6 bg-[var(--color-surface-border)]"}),r.jsx("button",{onClick:()=>I("grid"),className:`p-2 transition-colors ${_==="grid"?"bg-[var(--color-surface-hover)] text-[var(--color-primary)]":"text-[var(--color-text-muted)] hover:text-[var(--color-text-main)]"}`,children:r.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"grid_view"})})]})]})]}),r.jsx(Be,{padding:"sm",className:"bg-gradient-to-br from-[var(--color-primary)]/5 to-transparent border-[var(--color-primary)]/20",children:r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 p-2",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"size-10 rounded-full bg-white flex items-center justify-center shadow-sm text-[var(--color-primary)]",children:r.jsx("span",{className:"material-symbols-outlined",children:"lightbulb"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-bold text-[var(--color-text-main)]",children:"Suggestion Engine"}),r.jsx("p",{className:"text-xs text-[var(--color-text-muted)]",children:"Use AI to generate ideas based on your tasks."})]})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx(Ne,{variant:"secondary",onClick:()=>{X({id:"",title:"",description:"",type:"Idea"}),A(!0)},children:"Add Manually"}),r.jsx(Ne,{onClick:le,loading:b,icon:r.jsx("span",{className:"material-symbols-outlined",children:"auto_awesome"}),children:"Generate Ideas"})]})]})}),H.length===0?r.jsx("div",{className:"text-center py-20 app-card-soft",children:r.jsx("p",{className:"text-[var(--color-text-muted)]",children:"No details visible for this filter."})}):_==="grid"?r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:H.map(R=>{var ye,je;const ue=R.mindmapId||((ye=c[0])==null?void 0:ye.id),Y=(je=c.find(J=>J.id===ue))==null?void 0:je.name;return r.jsxs(Be,{padding:"md",className:"flex flex-col group relative",children:[r.jsxs("div",{className:"flex items-start justify-between mb-3",children:[r.jsx(Tn,{size:"sm",variant:"secondary",children:R.type||"Idea"}),R.generated&&r.jsx("span",{className:"material-symbols-outlined text-[16px] text-indigo-500",title:"AI Generated",children:"auto_awesome"})]}),r.jsx("h4",{className:"text-lg font-bold text-[var(--color-text-main)] mb-2 leading-tight",children:R.title}),r.jsx("p",{className:"text-sm text-[var(--color-text-muted)] mb-6 flex-1 line-clamp-4",children:R.description}),r.jsxs("div",{className:"pt-4 border-t border-[var(--color-surface-border)] flex items-center justify-between mt-auto",children:[r.jsx("span",{className:"text-xs font-semibold text-[var(--color-text-subtle)] truncate max-w-[100px]",children:Y}),r.jsxs("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[r.jsx("button",{onClick:()=>{X({id:R.id,title:R.title,description:R.description||"",type:R.type||""}),B(!0)},className:"p-1.5 rounded-md hover:bg-[var(--color-surface-hover)] text-[var(--color-text-muted)] hover:text-[var(--color-primary)]",children:r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"edit"})}),r.jsx("button",{onClick:()=>re(R.id),className:"p-1.5 rounded-md hover:bg-rose-50 text-[var(--color-text-muted)] hover:text-rose-600",children:r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"delete"})})]})]}),!R.convertedTaskId&&r.jsx("div",{className:"absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity",children:r.jsx(Ne,{size:"sm",variant:"ghost",onClick:()=>q(R),icon:r.jsx("span",{className:"material-symbols-outlined",children:"add_task"}),children:"Convert"})}),R.convertedTaskId&&r.jsxs("div",{className:"absolute top-4 right-4 text-emerald-600 bg-emerald-50 px-2 py-1 rounded-md text-xs font-bold flex items-center gap-1 border border-emerald-100",children:[r.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"check"})," Task"]})]},R.id)})}):r.jsx(Be,{padding:"none",children:r.jsx("div",{className:"divide-y divide-[var(--color-surface-border)]",children:H.map(R=>r.jsxs("div",{className:"p-4 flex items-center gap-4 hover:bg-[var(--color-surface-hover)] group",children:[r.jsx("div",{className:"size-10 rounded-full bg-[var(--color-surface-paper)] border border-[var(--color-surface-border)] flex items-center justify-center text-[var(--color-text-muted)] shrink-0",children:r.jsx("span",{className:"material-symbols-outlined text-[20px]",children:R.type==="Bug"?"bug_report":"lightbulb"})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("h4",{className:"font-bold text-[var(--color-text-main)] truncate",children:R.title}),r.jsx("p",{className:"text-xs text-[var(--color-text-muted)] truncate",children:R.description})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[R.convertedTaskId?r.jsx(Tn,{variant:"success",children:"Task Created"}):r.jsx(Ne,{size:"sm",variant:"secondary",onClick:()=>q(R),children:"Convert"}),r.jsx("button",{onClick:()=>{X({id:R.id,title:R.title,description:R.description||"",type:R.type||""}),B(!0)},className:"p-2 text-[var(--color-text-muted)] hover:text-[var(--color-text-main)]",children:r.jsx("span",{className:"material-symbols-outlined",children:"edit"})})]})]},R.id))})}),r.jsx(_r,{isOpen:z||M,onClose:()=>{A(!1),B(!1)},title:z?"New Idea":"Edit Idea",footer:r.jsxs(r.Fragment,{children:[r.jsx(Ne,{variant:"ghost",onClick:()=>{A(!1),B(!1)},children:"Cancel"}),r.jsx(Ne,{onClick:he,loading:de,children:"Save Idea"})]}),children:r.jsxs("div",{className:"space-y-4",children:[r.jsx(st,{label:"Title",value:L.title,onChange:R=>X({...L,title:R.target.value}),placeholder:"e.g. Add dark mode"}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-sm font-medium text-[var(--color-text-main)]",children:"Description"}),r.jsx(An,{value:L.description,onChange:R=>X({...L,description:R.target.value}),rows:4,className:"w-full"})]}),r.jsx(st,{label:"Type",value:L.type,onChange:R=>X({...L,type:R.target.value}),placeholder:"e.g. Feature, Bug, Marketing"}),L.id&&r.jsxs("div",{className:"pt-4 border-t border-[var(--color-surface-border)]",children:[r.jsx("h4",{className:"text-sm font-bold text-[var(--color-text-main)] mb-2",children:"Comments"}),r.jsx("div",{className:"h-64",children:r.jsx(zm,{projectId:t||"",targetId:L.id,targetType:"idea",tenantId:m==null?void 0:m.tenantId,isProjectOwner:T})})]})]})})]})},zM=()=>{const{id:t}=Yn(),e=dn(),[s,o]=w.useState([]),[i,c]=w.useState(!0),[u,m]=w.useState("Active"),[h,x]=w.useState(""),[v,b]=w.useState(null),[N,T]=w.useState([]),[_,I]=w.useState(!1),[E,D]=w.useState(""),[z,A]=w.useState(""),[M,B]=w.useState("Medium"),[L,X]=w.useState([]),[de,V]=w.useState(!1),Z=xe.currentUser;w.useEffect(()=>{if(!t)return;let re=!0,q,H;return $t(t).then(R=>{if(!re||!R){re&&c(!1);return}b(R),q=wl(t,ue=>{re&&(o(ue),c(!1))},R.tenantId),R.tenantId&&(H=ba(ue=>{re&&T(ue)},R.tenantId))}).catch(R=>{console.error("Failed to load project for issues",R),re&&c(!1)}),()=>{re=!1,q&&q(),H&&H()}},[t]);const K=async re=>{if(re.preventDefault(),!(!Z||!t||!v||!E.trim())){V(!0);try{await ym(t,{title:E.trim(),description:z.trim(),priority:M,assigneeIds:L},v.tenantId),I(!1),F()}catch(q){console.error("Error creating issue:",q)}finally{V(!1)}}},F=()=>{D(""),A(""),B("Medium"),X([])},le=w.useMemo(()=>s.filter(re=>{var H;return re.title.toLowerCase().includes(h.toLowerCase())||((H=re.description)==null?void 0:H.toLowerCase().includes(h.toLowerCase()))?u==="Active"?re.status!=="Closed"&&re.status!=="Resolved":u==="Resolved"?re.status==="Resolved"||re.status==="Closed":!0:!1}),[s,u,h]),he=w.useMemo(()=>({open:s.filter(re=>re.status==="Open").length,inProgress:s.filter(re=>re.status==="In Progress").length,resolved:s.filter(re=>re.status==="Resolved"||re.status==="Closed").length,urgent:s.filter(re=>(re.priority==="Urgent"||re.priority==="High")&&re.status!=="Closed"&&re.status!=="Resolved").length}),[s]);return i?r.jsx("div",{className:"flex items-center justify-center p-12",children:r.jsx("span",{className:"material-symbols-outlined text-[var(--color-primary)] animate-spin text-4xl",children:"progress_activity"})}):r.jsxs("div",{className:"flex flex-col gap-6 fade-in max-w-5xl mx-auto pb-20",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"h2 text-[var(--color-text-main)]",children:"Issues"}),r.jsx("p",{className:"text-[var(--color-text-muted)] text-sm",children:"Track and resolve project bugs and improvements."})]}),r.jsx(Ne,{onClick:()=>I(!0),icon:r.jsx("span",{className:"material-symbols-outlined",children:"add"}),children:"Report Issue"})]}),r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{label:"Active",value:he.open+he.inProgress,icon:"bug_report",color:"text-blue-500",bg:"bg-blue-50 dark:bg-blue-900/10"},{label:"Resolved",value:he.resolved,icon:"check_circle",color:"text-emerald-500",bg:"bg-emerald-50 dark:bg-emerald-900/10"},{label:"Urgent",value:he.urgent,icon:"priority_high",color:"text-rose-500",bg:"bg-rose-50 dark:bg-rose-900/10"},{label:"Total",value:s.length,icon:"analytics",color:"text-slate-500",bg:"bg-slate-50 dark:bg-slate-900/10"}].map((re,q)=>r.jsxs(Be,{className:"p-4 flex items-center gap-3",children:[r.jsx("div",{className:`size-10 rounded-xl ${re.bg} ${re.color} flex items-center justify-center`,children:r.jsx("span",{className:"material-symbols-outlined text-[20px]",children:re.icon})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-[10px] font-bold text-[var(--color-text-muted)] uppercase tracking-wider",children:re.label}),r.jsx("p",{className:"text-xl font-bold text-[var(--color-text-main)] leading-tight",children:re.value})]})]},q))}),r.jsxs(Be,{padding:"none",className:"overflow-visible",children:[r.jsxs("div",{className:"p-4 border-b border-[var(--color-surface-border)] flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[r.jsx("div",{className:"flex bg-[var(--color-surface-hover)] rounded-lg p-1",children:["Active","Resolved","All"].map(re=>r.jsx("button",{onClick:()=>m(re),className:`
                                    px-4 py-1.5 rounded-md text-sm font-medium transition-all
                                    ${u===re?"bg-[var(--color-surface-paper)] text-[var(--color-text-main)] shadow-sm":"text-[var(--color-text-muted)] hover:text-[var(--color-text-main)]"}
                                `,children:re},re))}),r.jsx("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:r.jsx(st,{value:h,onChange:re=>x(re.target.value),placeholder:"Search issues...",className:"w-full sm:w-64",icon:r.jsx("span",{className:"material-symbols-outlined",children:"search"})})})]}),r.jsx("div",{className:"flex flex-col gap-2 p-2",children:le.length===0?r.jsxs("div",{className:"p-16 text-center flex flex-col items-center justify-center text-[var(--color-text-muted)] border-2 border-dashed border-[var(--color-surface-border)] rounded-2xl m-2",children:[r.jsx("div",{className:"size-16 rounded-full bg-[var(--color-surface-hover)] flex items-center justify-center mb-4",children:r.jsx("span",{className:"material-symbols-outlined text-4xl opacity-20",children:"bug_report"})}),r.jsx("h3",{className:"text-lg font-bold text-[var(--color-text-main)] mb-1",children:"No issues found"}),r.jsx("p",{className:"text-sm",children:"Try adjusting your filters or search terms."})]}):le.map(re=>r.jsxs("div",{onClick:()=>e(`/project/${t}/issues/${re.id}`),className:"group flex items-start gap-4 p-4 rounded-xl bg-[var(--color-surface-bg)] border border-[var(--color-surface-border)] hover:bg-[var(--color-surface-hover)] transition-all cursor-pointer",children:[r.jsxs("div",{className:"flex-1 min-w-0 space-y-2",children:[r.jsx("div",{className:"flex items-start justify-between gap-4",children:r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"text-xs font-mono text-[var(--color-text-muted)] bg-[var(--color-surface-hover)] px-1.5 py-0.5 rounded",children:["#",re.id.slice(0,6).toUpperCase()]}),r.jsx("span",{className:`text-sm font-semibold leading-tight group-hover:text-[var(--color-primary)] transition-colors ${re.status==="Closed"||re.status==="Resolved"?"text-[var(--color-text-muted)]":"text-[var(--color-text-main)]"}`,children:re.title})]}),re.description&&r.jsx("p",{className:"text-xs text-[var(--color-text-muted)] line-clamp-1",children:re.description})]})}),r.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[r.jsxs(Tn,{size:"sm",variant:re.status==="Open"?"primary":re.status==="Resolved"?"success":"secondary",children:[r.jsx("span",{className:"material-symbols-outlined text-[12px] mr-1",children:re.status==="Open"?"error":re.status==="Resolved"?"check_circle":"cancel"}),re.status]}),r.jsx(GM,{priority:re.priority}),r.jsxs("div",{className:"flex -space-x-2",children:[(re.assigneeIds||[]).slice(0,3).map(q=>{const H=N.find(R=>R.uid===q||R.id===q);return r.jsx("img",{src:(H==null?void 0:H.photoURL)||"https://www.gravatar.com/avatar/?d=mp",className:"size-5 rounded-full ring-2 ring-[var(--color-surface-bg)]",title:(H==null?void 0:H.displayName)||"Unknown"},q)}),re.assigneeIds&&re.assigneeIds.length>3&&r.jsxs("div",{className:"size-5 rounded-full bg-[var(--color-surface-hover)] ring-2 ring-[var(--color-surface-bg)] flex items-center justify-center text-[8px] font-bold text-[var(--color-text-muted)]",children:["+",re.assigneeIds.length-3]}),(!re.assigneeIds||re.assigneeIds.length===0)&&!re.assignee&&r.jsx("span",{className:"text-[10px] text-[var(--color-text-muted)] flex items-center gap-1",children:r.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"person_off"})})]}),r.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-[var(--color-text-muted)] ml-auto",children:[r.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"calendar_today"}),new Date(Le(re.createdAt)).toLocaleDateString()]})]})]}),r.jsx("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity self-center",children:r.jsx("span",{className:"material-symbols-outlined text-[var(--color-text-subtle)]",children:"chevron_right"})})]},re.id))})]}),_&&sr.createPortal(r.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",children:r.jsxs("div",{className:"bg-[var(--color-surface-card)] rounded-2xl shadow-2xl max-w-lg w-full p-6 border border-[var(--color-surface-border)] animate-in fade-in zoom-in-95 duration-200",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h2",{className:"text-xl font-bold text-[var(--color-text-main)]",children:"Report New Issue"}),r.jsx("button",{onClick:()=>I(!1),className:"text-[var(--color-text-muted)] hover:text-[var(--color-text-main)] transition-colors",children:r.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),r.jsxs("form",{onSubmit:K,className:"space-y-5",children:[r.jsx(st,{label:"Title",value:E,onChange:re=>D(re.target.value),placeholder:"Problem summary",className:"w-full",required:!0,autoFocus:!0}),r.jsx(An,{label:"Description",value:z,onChange:re=>A(re.target.value),placeholder:"Steps to reproduce, expected behavior, etc.",className:"w-full min-h-[120px]"}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs(xn,{label:"Priority",value:M,onChange:re=>B(re.target.value),className:"w-full",children:[r.jsx("option",{value:"Low",children:"Low"}),r.jsx("option",{value:"Medium",children:"Medium"}),r.jsx("option",{value:"High",children:"High"}),r.jsx("option",{value:"Urgent",children:"Urgent"})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("label",{className:"text-xs font-bold text-[var(--color-text-muted)] uppercase ml-1",children:"Assignees"}),r.jsx(Nd,{projectId:t,assigneeIds:L,onChange:X})]})]}),r.jsxs("div",{className:"flex justify-end gap-3 pt-4 mt-2",children:[r.jsx(Ne,{type:"button",variant:"ghost",onClick:()=>I(!1),children:"Cancel"}),r.jsx(Ne,{type:"submit",isLoading:de,children:"Report Issue"})]})]})]})}),document.body)]})},GM=({priority:t})=>{const e={Urgent:"bg-rose-50 text-rose-700 border-rose-200",High:"bg-amber-50 text-amber-700 border-amber-200",Medium:"bg-blue-50 text-blue-700 border-blue-200",Low:"bg-slate-100 text-slate-700 border-slate-200"},s={Urgent:"error",High:"keyboard_double_arrow_up",Medium:"drag_handle",Low:"keyboard_arrow_down"};return r.jsxs("span",{className:`px-2 py-0.5 rounded-full text-[10px] font-bold border flex items-center gap-1 ${e[t]||e.Medium}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[12px]",children:s[t]}),t]})},ul=2200,tr=ul/2,HM={project:160,group:120,idea:100},OM={project:70,group:56,idea:44},ls=t=>t&&t.trim()?t.trim():"",As=t=>`group-${t}`,ol=[{bg:"#f6f4ff",border:"#d9d0ff",text:"#2f2a4a"},{bg:"#eef7ff",border:"#cce5ff",text:"#0f3a63"},{bg:"#ebfff5",border:"#c9f3e2",text:"#0f3b2c"},{bg:"#fff6ed",border:"#ffd7b8",text:"#5b2a02"},{bg:"#fff1f4",border:"#ffc7d4",text:"#611126"},{bg:"#f0f9ff",border:"#b6e0fe",text:"#083c5a"}],b0={bg:"#f5f5f4",border:"#d4d4d4",text:"#111827"},qM=()=>{const{id:t}=Yn(),e=w.useRef(null),[s,o]=w.useState(null),[i,c]=w.useState([]),[u,m]=w.useState([]),[h,x]=w.useState(null),v=w.useMemo(()=>u.find(j=>j.id===h)||u[0],[u,h]),[b,N]=w.useState(!0),[T,_]=w.useState(!1),[I,E]=w.useState(!1),[D,z]=w.useState(null),[A,M]=w.useState(null),[B,L]=w.useState({}),[X,de]=w.useState(new Set),[V,Z]=w.useState({}),[K,F]=w.useState(null),[le,he]=w.useState(null),[re,q]=w.useState(""),[H,R]=w.useState(""),[ue,Y]=w.useState(""),[ye,je]=w.useState(""),[J,we]=w.useState(""),[be,me]=w.useState(""),[Ae,De]=w.useState(""),[Ee,ut]=w.useState(!1),[He,Vt]=w.useState(""),[Et,Xe]=w.useState(!1),[Jt,ft]=w.useState(!1),[Pt,Nt]=w.useState([]),[zt,_t]=w.useState({type:null}),[un,P]=w.useState(null),[k,Q]=w.useState(!1),[ne,se]=w.useState(!1),Se=w.useRef(null),Ce=w.useRef(null),[Te,Ge]=w.useState(!1),[et,tt]=w.useState(1),[gt,bt]=w.useState({x:0,y:0}),[gn,sn]=w.useState(!1),[fn,Mt]=w.useState(null),[Ln,rr]=w.useState({x:0,y:0}),[$s,ar]=w.useState({x:0,y:0}),[fs,Ur]=w.useState(!1),[Ys,lo]=w.useState(!1),[Jn,En]=w.useState("edit"),[Js,Pr]=w.useState(!1),[or,Ds]=w.useState(null),[wa,Sa]=w.useState({}),Xn=w.useRef(null),Xs=w.useRef(null),ms=w.useRef({x:0,y:0}),mn=w.useRef({}),Bt=w.useRef(null),wt=async j=>{if(t){j!=null&&j.silent||N(!0),z(null);try{const G=await $t(t);o(G);const[W,oe]=await Promise.all([Ka(t),ld(t)]);let pe=W;if(!pe.length){const _e=(G==null?void 0:G.title)||"Mindmap",qe=await qf(t,_e);pe=await Ka(t),x(qe)}m(pe),!h&&pe.length&&x(pe[0].id),c(oe)}catch(G){console.error(G),z("Failed to load mindmap data.")}finally{j!=null&&j.silent||N(!1)}}};w.useEffect(()=>{wt()},[t]);const Kn=j=>{const G=B[j];return G?{x:tr+G.x,y:tr+G.y}:null},ir=(j,G)=>{var pe;const W=(pe=e.current)==null?void 0:pe.getBoundingClientRect();return j!==void 0&&G!==void 0?{x:j,y:G}:ms.current.x!==0||ms.current.y!==0?ms.current:W?{x:W.left+W.width/2,y:W.top+W.height/2}:{x:0,y:0}},ja=j=>{const G=j.clientX,W=j.clientY;return ir(G,W)},co=j=>{const G=j.target;return G?!!G.closest('[data-panel-scroll="true"]'):!1},Ta=(j,G)=>{var pe;const W=(pe=e.current)==null?void 0:pe.getBoundingClientRect();if(!W)return;const oe={x:W.width/(2*et)-j,y:W.height/(2*et)-G};bt(oe)},ps=()=>{var G;const j=Kn(K||"project");if(j)Ta(j.x,j.y);else{const W=(G=e.current)==null?void 0:G.getBoundingClientRect();bt(W?{x:W.width/2-tr,y:W.height/2-tr}:{x:0,y:0})}};w.useEffect(()=>{fs||(ps(),Ur(!0))},[fs]);const Lr=j=>{if(!j)return;const G=Kn(j);G&&Ta(G.x,G.y)};w.useEffect(()=>{const j=document.body.style.overflow;return document.body.style.overflow=Te?"hidden":j,()=>{document.body.style.overflow=j}},[Te]),w.useEffect(()=>(Se.current&&(clearTimeout(Se.current),Se.current=null),A&&(Se.current=setTimeout(()=>M(null),3500)),()=>{Se.current&&(clearTimeout(Se.current),Se.current=null)}),[A]);const it=w.useMemo(()=>{var G;if(!v||!u.length)return[];const j=(G=u[0])==null?void 0:G.id;return v.id===j?i.filter(W=>!W.mindmapId||W.mindmapId===j):i.filter(W=>W.mindmapId===v.id)},[i,v,u]),hs=w.useMemo(()=>v?i.filter(j=>{var G;return j.mindmapId?j.mindmapId!==v.id:v.id!==((G=u[0])==null?void 0:G.id)}):[],[i,v,u]),lr=w.useMemo(()=>{const j={};return it.forEach(G=>{G.parentIdeaId&&(j[G.parentIdeaId]||(j[G.parentIdeaId]=[]),j[G.parentIdeaId].push(G))}),j},[it]),Xt=w.useMemo(()=>{const j=new Set;return Pt.forEach(G=>G.name&&j.add(G.name)),it.forEach(G=>{const W=ls(G.type);W&&j.add(W)}),Array.from(j)},[it,Pt]),Gt=w.useMemo(()=>{const j={};return Xt.forEach((G,W)=>{const oe=Pt.find(_e=>_e.name===G),pe=(oe==null?void 0:oe.colorIndex)??W;j[G]=ol[pe%ol.length]||b0}),j},[Xt,Pt]),Ca=w.useMemo(()=>{const j={};return it.forEach(G=>{const W=ls(G.type);W&&(j[W]=(j[W]||0)+1)}),j},[it]),qt=w.useMemo(()=>i.find(j=>j.id===K)||null,[i,K]),xs=w.useMemo(()=>({ideaCount:it.length,groupCount:Xt.length,collapsedCount:X.size,mindmapCount:u.length}),[it.length,Xt.length,X,u.length]),Wn=j=>Gt[j||""]||b0;w.useEffect(()=>{if(typeof ResizeObserver>"u")return;const j=new ResizeObserver(G=>{G.forEach(({target:W,contentRect:oe})=>{const pe=W.dataset.nodeId;if(!pe)return;const _e=oe.width,qe=oe.height;Sa(Pe=>{const Je=Pe[pe];return Je&&Math.abs(Je.w-_e)<1&&Math.abs(Je.h-qe)<1?Pe:{...Pe,[pe]:{w:_e,h:qe}}})})});return Bt.current=j,()=>j.disconnect()},[]),w.useEffect(()=>{Me(),!Ys&&it.length>0&&(de(new Set),lo(!0))},[Xt,it]),w.useEffect(()=>{mn.current=B},[B]),w.useEffect(()=>{it.length&&L(j=>{let G=!1;const W={...j};return it.forEach(oe=>{if(oe.posX===void 0||oe.posY===void 0)return;const pe=W[oe.id];(!pe||pe.x!==oe.posX||pe.y!==oe.posY)&&(W[oe.id]={x:oe.posX,y:oe.posY},G=!0)}),G?(mn.current=W,ur(W)):j})},[it]),w.useEffect(()=>{if(!h){Nt([]);return}const j=localStorage.getItem(`mindmap_branches_${h}`);if(j)try{const G=JSON.parse(j);if(Array.isArray(G)){const W=new Set,oe=G.map(Pe=>{const Je=typeof Pe.colorIndex=="number"?Pe.colorIndex:-1;return Je>=0&&W.add(Je),{name:Pe.name,parentId:Pe.parentId??null,colorIndex:Je}});let pe=0;const _e=()=>{for(;W.has(pe);)pe=(pe+1)%ol.length;const Pe=pe;return W.add(Pe),pe=(pe+1)%ol.length,Pe},qe=oe.map(Pe=>Pe.colorIndex===-1?{...Pe,colorIndex:_e()}:Pe);Nt(qe);return}}catch{Nt([]);return}Nt([])},[h]),w.useEffect(()=>{h&&localStorage.setItem(`mindmap_branches_${h}`,JSON.stringify(Pt))},[Pt,h]);const uo=j=>{const G=j.map(oe=>oe.colorIndex).filter(oe=>typeof oe=="number"&&oe>=0);return((G.length?Math.max(...G):-1)+1)%ol.length};w.useEffect(()=>{Me(),F(null),he(null),Xe(!1),ut(!1),ft(!1),_t({type:null})},[h]),w.useEffect(()=>{Jn==="map"&&q((v==null?void 0:v.name)||"")},[v==null?void 0:v.name,Jn]),w.useEffect(()=>{if(K){const j=i.find(G=>G.id===K);j&&(q(j.title),R(j.description),Y(ls(j.type)),je(""),En("edit")),Xe(!0),ft(!1),he(null)}_t({type:null})},[K,i]),w.useEffect(()=>{le&&(Vt(le),F(null),ft(!0),Xe(!1),_t({type:null}))},[le]);const zn=w.useMemo(()=>{const j=[{id:"project",label:(v==null?void 0:v.name)||(s==null?void 0:s.title)||"Mindmap",type:"project"}],G=new Set(it.map(oe=>oe.id)),W={};return Pt.forEach(oe=>{W[oe.name]={parentId:oe.parentId}}),Xt.forEach(oe=>{var pe;j.push({id:As(oe),label:oe,type:"group",parentId:((pe=W[oe])==null?void 0:pe.parentId)||"project",groupName:oe})}),it.forEach(oe=>{const pe=ls(oe.type),_e=oe.parentIdeaId&&G.has(oe.parentIdeaId)?oe.parentIdeaId:pe?As(pe):"project";j.push({id:oe.id,label:oe.title,type:"idea",parentId:_e,idea:oe,groupName:pe})}),j},[it,s==null?void 0:s.title,Xt,v==null?void 0:v.name,Pt]).filter(j=>j.type!=="idea"||!j.groupName?!0:!X.has(j.groupName)),Ea=w.useMemo(()=>zn.find(j=>{var G;return((G=j.idea)==null?void 0:G.id)===K})||null,[zn,K]);Ea&&Kn(Ea.id);const cr=(j,G)=>{const W=j/G*Math.PI*2-Math.PI/2,oe=320;return{x:Math.cos(W)*oe,y:Math.sin(W)*oe}},ae=(j,G,W)=>{const oe=Math.floor(G/5),pe=Math.max(W,5),_e=G%pe/pe*Math.PI*2+oe*.35,qe=140+oe*80;return{x:j.x+Math.cos(_e)*qe,y:j.y+Math.sin(_e)*qe}},Ie=(j,G,W)=>{const oe=G/Math.max(W,4)*Math.PI*2-Math.PI/2,pe=120;return{x:j.x+Math.cos(oe)*pe,y:j.y+Math.sin(oe)*pe}},Me=()=>{L(j=>{const G={...j};G.project||(G.project={x:0,y:0});const W={};Pt.forEach(pe=>{W[pe.name]={parentId:pe.parentId}}),Xt.forEach((pe,_e)=>{var Pe;const qe=As(pe);if(!G[qe]){const Je=((Pe=W[pe])==null?void 0:Pe.parentId)||"project",St=G[Je]||{x:0,y:0};G[qe]=Je==="project"?cr(_e,Math.max(Xt.length,3)):Ie(St,_e,Math.max(Xt.length,3))}}),Xt.forEach(pe=>{const _e=As(pe),qe=it.filter(Pe=>ls(Pe.type)===pe&&!Pe.parentIdeaId);qe.forEach((Pe,Je)=>{G[Pe.id]||(G[Pe.id]=ae(G[_e]||{x:0,y:0},Je,qe.length))})});const oe=pe=>{const _e=lr[pe];if(!_e||!_e.length)return;const qe=G[pe]||{x:0,y:0};_e.forEach((Pe,Je)=>{G[Pe.id]||(G[Pe.id]=Ie(qe,Je,_e.length)),oe(Pe.id)})};return oe("project"),it.filter(pe=>!pe.parentIdeaId||pe.parentIdeaId==="project").forEach(pe=>oe(pe.id)),ur(G)})},We={width:ul,height:ul,transform:`translate(${gt.x}px, ${gt.y}px) scale(${et})`,transformOrigin:"0 0"},Gn=Te?"100vh":"calc(100vh - 160px)",Ks=(j,G)=>{bt(W=>({x:W.x-j/et,y:W.y-G/et}))},dr=(j,G)=>{const W=wa[j.id],oe=HM[j.type],pe=OM[j.type],_e=((W==null?void 0:W.w)??oe*2)/2+G,qe=((W==null?void 0:W.h)??pe*2)/2+G;return{w:_e,h:qe}},zr=(j,G)=>{const W=zn.find(Pe=>Pe.id===G);if(!W)return j;const oe=12,pe=6;let _e=0,qe={...j};for(;_e<oe;){_e+=1;let Pe=!1,Je=qe[G];if(!Je||(zn.forEach(St=>{if(St.id===G||St.type==="project")return;const en=qe[St.id];if(!en)return;const $e=Je.x-en.x,Kt=Je.y-en.y,Zn=dr(W,pe),es=dr(St,pe),qr=Zn.w+es.w,Fr=Zn.h+es.h,fr=qr-Math.abs($e),Ps=Fr-Math.abs(Kt);if(fr>0&&Ps>0){if(Pe=!0,fr<Ps){const Hn=fr/2,ys=$e>=0?1:-1;Je={x:Je.x+ys*Hn,y:Je.y},qe[St.id]={x:en.x-ys*Hn,y:en.y}}else{const Hn=Ps/2,ys=Kt>=0?1:-1;Je={x:Je.x,y:Je.y+ys*Hn},qe[St.id]={x:en.x,y:en.y-ys*Hn}}qe[G]=Je;return}}),!Pe))break}return qe},ur=j=>{const W=zn.filter(_e=>_e.type!=="project");let oe={...j},pe=!1;for(let _e=0;_e<10;_e++){let qe=!1;for(let Pe=0;Pe<W.length;Pe++)for(let Je=Pe+1;Je<W.length;Je++){const St=W[Pe],en=W[Je],$e=oe[St.id],Kt=oe[en.id];if(!$e||!Kt)continue;const Zn=$e.x-Kt.x,es=$e.y-Kt.y,qr=dr(St,6),Fr=dr(en,6),fr=qr.w+Fr.w,Ps=qr.h+Fr.h,Hn=fr-Math.abs(Zn),ys=Ps-Math.abs(es);if(Hn>0&&ys>0)if(qe=!0,pe=!0,Hn<ys){const Aa=Hn/2,ka=Zn>=0?1:-1;oe[St.id]={x:$e.x+ka*Aa,y:$e.y},oe[en.id]={x:Kt.x-ka*Aa,y:Kt.y}}else{const Aa=ys/2,ka=es>=0?1:-1;oe[St.id]={x:$e.x,y:$e.y+ka*Aa},oe[en.id]={x:Kt.x,y:Kt.y-ka*Aa}}}if(!qe)break}return pe?oe:j},pn=(j,G,W)=>{var en;const oe=ir(G,W),pe=(en=e.current)==null?void 0:en.getBoundingClientRect();if(!pe)return;const _e=j<0?1:-1,qe=Math.min(Math.abs(j)/1600+.01,.045),Pe=_e*qe,Je=oe.x-pe.left,St=oe.y-pe.top;tt($e=>{const Kt=Math.min(1.6,Math.max(.6,$e+Pe));return bt(Zn=>{const es=Je/$e-Zn.x,qr=St/$e-Zn.y;return{x:Je/Kt-es,y:St/Kt-qr}}),Kt})},_a=j=>{if(co(j))return;j.preventDefault();const G=ja(j);ms.current=G;const W=j.deltaZ||0;if(j.ctrlKey||j.metaKey||Math.abs(W)>0){pn(j.deltaY??0,G.x,G.y);return}Ks(j.deltaX??0,j.deltaY??0)};w.useEffect(()=>{const j=e.current;if(!j)return;const G=W=>_a(W);return j.addEventListener("wheel",G,{passive:!1}),()=>j.removeEventListener("wheel",G)},[et]);const gs=j=>{j.target.closest("[data-node-id]")||(F(null),he(null),Ds(null),_t({type:null}),sn(!0),ar({x:j.clientX-gt.x,y:j.clientY-gt.y}),ms.current={x:j.clientX,y:j.clientY})},vs=(j,G)=>{fn&&(L(W=>{const oe=W[fn]||{x:0,y:0},pe=(j-Ln.x)/et,_e=(G-Ln.y)/et,qe={...W,[fn]:{x:oe.x+pe,y:oe.y+_e}},Pe=zr(qe,fn);return mn.current=Pe,Pe}),rr({x:j,y:G}))},Qn=j=>{if(ms.current={x:j.clientX,y:j.clientY},fn){vs(j.clientX,j.clientY);return}gn&&bt({x:j.clientX-$s.x,y:j.clientY-$s.y})},jl=j=>{const G=i.find(pe=>pe.id===j);if(!G)return;const W=mn.current[j];if(!W)return;let oe=null;Xt.forEach(pe=>{const _e=As(pe),qe=mn.current[_e];if(!qe)return;const Pe=qe.x-W.x,Je=qe.y-W.y,St=Math.hypot(Pe,Je);(!oe||St<oe.distance)&&(oe={group:pe,distance:St})}),oe&&oe.distance<160&&ls(G.type)!==oe.group&&wd(j,oe.group)},ui=async j=>{var G;if(!zt.type)return!1;try{if(zt.type==="branchParent"&&le){const W=j.type==="idea"||j.type==="group"?j.id:"project";Nt(oe=>oe.map(pe=>pe.name===le?{...pe,parentId:W}:pe)),M(`Branch linked to ${j.label}.`)}if(zt.type==="ideaLink"&&K){if(j.id===K)return z("Cannot link an item to itself."),_t({type:null}),!0;if(j.type==="group"&&j.groupName)await cs(K,{type:j.groupName,parentIdeaId:null},t),M(`Idea linked to branch "${j.groupName}".`);else if(j.type==="idea"&&j.idea){let W=ls(j.idea.type);!W&&((G=j.parentId)!=null&&G.startsWith("group-"))&&(W=j.parentId.replace("group-","")),await cs(K,{parentIdeaId:j.id,type:W},t),M(`Idea linked under "${j.label}".`)}else await cs(K,{parentIdeaId:null},t),M("Idea detached to root.");await wt()}}catch(W){console.error(W),z("Failed to link.")}finally{_t({type:null})}return!0},Gr=async()=>{if(!t)return;const j=[];if(it.forEach(G=>{if(!G.projectId||G.id.startsWith("gen-"))return;const W=mn.current[G.id];W&&(G.posX===W.x&&G.posY===W.y||j.push(cs(G.id,{posX:W.x,posY:W.y},t)))}),!!j.length)try{await Promise.all(j)}catch(G){console.error("Failed to persist node positions",G)}},fi=()=>{if(fn&&(jl(fn),Gr()),Mt(null),sn(!1),Xn.current!==null&&Xs.current)try{Xs.current.releasePointerCapture(Xn.current)}catch{}Xn.current=null,Xs.current=null};w.useEffect(()=>{fn||L(j=>ur(j))},[zn.length,fn]);const Tl=j=>{const G=As(j),W=new Set,oe=pe=>{Pt.forEach(_e=>{_e.parentId===pe&&(W.add(_e.name),oe(As(_e.name)))})};return oe(G),Array.from(W)},mo=j=>{const G=Tl(j);de(W=>{const oe=new Set(W);return oe.has(j)?(oe.delete(j),G.forEach(pe=>oe.delete(pe))):(oe.add(j),G.forEach(pe=>oe.add(pe))),oe})},mi=async()=>{if(!(!s||!it.length)){_(!0),z(null),M("Grouping ideas with Gemini...");try{const j=await pk(s,it);if(!j.length){M("Gemini could not infer better groups. Showing current layout.");return}const G=[];j.forEach(oe=>{oe.ideaIds.forEach(pe=>{const _e=it.find(qe=>qe.id===pe);_e&&ls(_e.type)!==oe.group&&G.push(cs(_e.id,{type:oe.group},t))})}),G.length&&await Promise.all(G);const W={};j.forEach(oe=>{W[oe.group]=oe.reason||""}),Z(W),M("Gemini proposed a new grouping. Drag to adjust or rename manually."),await wt()}catch(j){console.error(j),z("Failed to auto-group ideas.")}finally{_(!1)}}},wd=async(j,G)=>{E(!0),z(null);try{const W=i.find(pe=>pe.id===j),oe=W!=null&&W.parentIdeaId&&(W==null?void 0:W.parentIdeaId)!=="project"?W.parentIdeaId:null;await cs(j,{type:G,mindmapId:v==null?void 0:v.id,parentIdeaId:oe},t),M(`Moved idea to "${G}".`),await wt()}catch(W){console.error(W),z("Failed to move idea.")}finally{E(!1)}},Sd=async()=>{if(!K)return;const j=ye.trim()||ue||"Ideas";E(!0),z(null);try{const G=i.find(oe=>oe.id===K);!(G!=null&&G.projectId)||G.id.startsWith("gen-")?(await Za({title:re,description:H,type:j,projectId:t,mindmapId:v==null?void 0:v.id,parentIdeaId:(G==null?void 0:G.parentIdeaId)??null,votes:(G==null?void 0:G.votes)??0,comments:(G==null?void 0:G.comments)??0,generated:G==null?void 0:G.generated}),c(oe=>oe.filter(pe=>pe.id!==K)),M("Idea saved to project.")):(await cs(K,{title:re,description:H,type:j,mindmapId:v==null?void 0:v.id},t),M("Idea updated.")),je(""),await wt({silent:!0})}catch(G){console.error(G),z("Failed to update idea.")}finally{E(!1)}},po=async j=>{if(!(!t||!v)){E(!0),z(null);try{const G=K||null,W=G?it.find(_e=>_e.id===G):null,oe=W&&ls(W.type)||"";!j.projectId||j.id.startsWith("gen-")?(await Za({title:j.title,description:j.description,type:oe,projectId:t,mindmapId:v.id,parentIdeaId:G,votes:j.votes??0,comments:j.comments??0,generated:j.generated}),c(_e=>_e.filter(qe=>qe.id!==j.id))):await cs(j.id,{mindmapId:v.id,parentIdeaId:G,type:oe},t),M(`Added to ${v.name}${W?` under ${W.title}`:""}.`),await wt({silent:!0})}catch(G){console.error(G),z("Failed to add idea to this mindmap.")}finally{E(!1)}}},Us=async j=>{E(!0),z(null);try{await Jc(j,t||void 0),K===j&&F(null),M("Idea deleted."),await wt()}catch(G){console.error(G),z("Failed to delete idea.")}finally{E(!1),Ds(null)}},pi=async j=>{if(t){E(!0),z(null);try{await xa(t,j.title),!j.projectId||j.id.startsWith("gen-")?c(W=>W.filter(oe=>oe.id!==j.id)):await Jc(j.id,t),K===j.id&&F(null),M("Idea converted to a task."),await wt()}catch(G){console.error(G),z("Failed to convert idea.")}finally{E(!1)}}},ho=async()=>{if(!t||!J.trim()||!v)return;E(!0),z(null);const j=le?{type:"group",value:le}:K?{type:"idea",value:K}:null,G=K?Et||!0:!1,oe=(le?Jt||!0:!1)&&le?le:G&&qt?ls(qt.type):"",pe=G&&K?K:"project";try{await Za({title:J,description:be,type:oe,projectId:t,mindmapId:v.id,parentIdeaId:pe,votes:0,comments:0}),we(""),me(""),M("Idea added to the map."),await wt({silent:!0}),j&&(j.type==="idea"&&F(j.value),j.type==="group"&&he(j.value)),requestAnimationFrame(()=>{var _e;(_e=Ce.current)==null||_e.focus()})}catch(_e){console.error(_e),z("Failed to add idea.")}finally{E(!1)}},Hr=()=>{if(!Ae.trim())return;const j=Ae.trim(),G=Ee?K||(le?As(le):"project"):"project";Nt(W=>{if(W.find(_e=>_e.name===j))return W.map(_e=>_e.name===j?{..._e,parentId:G}:_e);const pe=uo(W);return[...W,{name:j,parentId:G,colorIndex:pe}]}),L(W=>{const oe={...W},pe=As(j);if(!oe[pe]){const _e=oe[G]||{x:0,y:0};oe[pe]=G==="project"?{x:_e.x+240,y:_e.y}:Ie(_e,0,1)}return ur(oe)}),De(""),ut(!1),M("Branch added.")},Or=async j=>{const G=j||le;if(G){E(!0),z(null);try{const W=it.filter(oe=>ls(oe.type)===G).map(oe=>cs(oe.id,{type:""},t));W.length&&await Promise.all(W),Nt(oe=>oe.filter(pe=>pe.name!==G)),L(oe=>{const pe={...oe};return delete pe[As(G)],mn.current=pe,ur(pe)}),he(null),Vt(""),P(null),M("Branch deleted."),await wt({silent:!0})}catch(W){console.error(W),z("Failed to delete branch.")}finally{E(!1)}}},Cl=async()=>{if(!le)return;const j=He.trim();if(!(!j||j===le)){E(!0),z(null);try{const G=it.filter(W=>ls(W.type)===le).map(W=>cs(W.id,{type:j},t));G.length&&await Promise.all(G),Nt(W=>W.map(oe=>oe.name===le?{...oe,name:j}:oe)),L(W=>{const oe={...W},pe=As(le),_e=As(j);return oe[pe]&&(oe[_e]=oe[pe],delete oe[pe]),mn.current=oe,oe}),he(j),Vt(j),M("Branch renamed."),await wt({silent:!0})}catch(G){console.error(G),z("Failed to rename branch.")}finally{E(!1)}}},hi=j=>{var St,en;const G=B[j.id];if(!G)return null;const W=tr+G.x,oe=tr+G.y,pe=K===((St=j.idea)==null?void 0:St.id),_e=j.type==="group"&&j.groupName?X.has(j.groupName):!1,qe=Wn(j.groupName),Pe={left:W,top:oe,transform:"translate(-50%, -50%)",cursor:"grab"};j.type!=="project"?(Pe.backgroundColor=qe.bg,Pe.borderColor=qe.border,Pe.color=qe.text,Pe.boxShadow="0 12px 32px rgba(0,0,0,0.08)"):(Pe.borderColor="#0f172a",Pe.boxShadow="0 18px 42px rgba(0,0,0,0.18)");const Je=((en=j.idea)==null?void 0:en.description)||"";return r.jsxs("div",{"data-node-id":j.id,className:`absolute rounded-2xl border backdrop-blur select-none ${j.type==="project"?"bg-gradient-to-r from-black to-slate-900 text-white px-5 py-4 shadow-2xl":"px-4 py-3 shadow-lg"} ${pe?"ring-2 ring-black ring-offset-2 ring-offset-white":""}`,style:Pe,ref:$e=>{$e&&Bt.current&&Bt.current.observe($e)},onPointerDown:$e=>{if(zt.type){ui(j);return}Mt(j.id),rr({x:$e.clientX,y:$e.clientY}),Xn.current=$e.pointerId,Xs.current=$e.currentTarget;try{$e.currentTarget.setPointerCapture($e.pointerId)}catch{}j.idea&&(F(j.idea.id),he(null),Xe(!0),ft(!1)),j.type==="group"&&(he(j.groupName||null),F(null),ft(!0),Xe(!1)),j.type==="project"&&(En("map"),q((v==null?void 0:v.name)||""),he(null))},onPointerMove:$e=>{fn===j.id&&($e.stopPropagation(),$e.preventDefault(),vs($e.clientX,$e.clientY))},onPointerUp:$e=>{fn===j.id&&($e.preventDefault(),fi())},onClick:$e=>{if($e.stopPropagation(),zt.type){ui(j);return}j.idea&&(F(j.idea.id),he(null),Xe(!0),ft(!1)),j.type==="group"&&(he(j.groupName||null),F(null),ft(!0),Xe(!1))},onDoubleClick:()=>{j.type==="group"&&j.groupName&&mo(j.groupName),j.type==="project"&&En("map")},children:[j.type==="project"&&r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"size-10 rounded-xl bg-white/10 border border-white/20 flex items-center justify-center",children:r.jsx("span",{className:"material-symbols-outlined text-white",children:"hub"})}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[11px] uppercase tracking-[0.12em] text-white/70 font-bold",children:"Root mindmap"}),r.jsx("span",{className:"text-lg font-black leading-tight",children:j.label}),r.jsx("span",{className:"text-xs text-white/70",children:"Double-click to rename this map"})]})]}),j.type==="group"&&r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsxs("div",{className:"flex items-start justify-between gap-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("button",{className:"size-7 rounded-full border border-black/10 bg-white/50 flex items-center justify-center text-[11px] font-bold text-slate-700",onClick:$e=>{$e.stopPropagation(),j.groupName&&mo(j.groupName)},title:_e?"Expand branch":"Collapse branch",children:_e?"+":""}),r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-[11px] uppercase tracking-[0.12em] text-slate-500 font-bold",children:"Branch"}),r.jsx("span",{className:"font-bold text-base leading-tight",children:j.label})]})]}),r.jsxs("span",{className:"text-[11px] font-bold px-2 py-1 rounded-full border border-black/10 bg-white/60 text-slate-700",children:[Ca[j.groupName||"Ideas"]||0," nodes"]})]}),j.groupName&&V[j.groupName]&&r.jsx("p",{className:"text-[11px] text-slate-600 leading-snug max-w-[240px]",children:V[j.groupName]})]}),j.type==="idea"&&r.jsx("div",{className:"flex flex-col gap-1",children:r.jsx("div",{className:"flex items-start gap-3",children:r.jsxs("div",{className:"flex flex-col gap-1",children:[r.jsx("span",{className:"text-sm font-bold leading-tight",children:j.label}),Je&&r.jsx("p",{className:"text-xs text-slate-700 leading-snug max-w-[220px]",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:Je})]})})})]},j.id)},El=zn.filter(j=>j.parentId).map(j=>{const G=B[j.parentId],W=B[j.id];if(!G||!W)return null;const oe=tr+G.x,pe=tr+G.y,_e=tr+W.x,qe=tr+W.y,Pe=j.type==="group"?3.2:2.4,Je=j.type==="group"?"#0b132b":Wn(j.groupName).border,St=j.type==="group"?.8:.72;return r.jsx("line",{x1:oe,y1:pe,x2:_e,y2:qe,stroke:Je,strokeWidth:Pe,strokeOpacity:St,strokeLinecap:"round"},`${j.parentId}-${j.id}`)});return r.jsx("div",{className:"w-full flex flex-col gap-3 pb-4 animate-fade-up",children:r.jsxs("div",{ref:e,className:`${Te?"fixed inset-0 z-50 rounded-none border-0":"relative rounded-3xl border border-line/70"} w-full bg-[var(--color-surface-card)]/80 backdrop-blur-sm overflow-hidden`,style:{touchAction:"none",height:Gn},onPointerDown:gs,onPointerMove:Qn,onPointerUp:fi,onPointerLeave:fi,children:[r.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_center,_#0000000d_1px,_transparent_0)] bg-[size:28px_28px] pointer-events-none"}),r.jsx("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 z-30",onPointerDown:j=>j.stopPropagation(),children:r.jsxs("div",{className:"app-panel rounded-full flex items-center gap-2 px-3 py-2 shadow-lift",children:[r.jsxs("button",{onClick:()=>{F(null)},className:"inline-flex items-center gap-1 px-3 py-1.5 rounded-full text-sm font-bold btn-secondary",children:[r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"add"}),"Add idea"]}),r.jsxs("button",{onClick:mi,disabled:T||b||!i.length,className:"inline-flex items-center gap-1 px-3 py-1.5 rounded-full text-sm font-bold btn-secondary disabled:opacity-50",children:[r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"auto_awesome"}),T?"Grouping":"Auto-group"]}),r.jsxs("button",{onClick:()=>ps(),className:"inline-flex items-center gap-1 px-3 py-1.5 rounded-full text-sm font-bold btn-secondary",children:[r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"center_focus_strong"}),"Center"]}),r.jsxs("button",{onClick:()=>{En("map"),q((v==null?void 0:v.name)||"")},className:"inline-flex items-center gap-1 px-3 py-1.5 rounded-full text-sm font-bold btn-secondary",children:[r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"edit_note"}),"Map settings"]}),r.jsxs("button",{onClick:()=>Ge(j=>!j),className:"inline-flex items-center gap-1 px-3 py-1.5 rounded-full text-sm font-bold btn-secondary",children:[r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:Te?"fullscreen_exit":"fullscreen"}),Te?"Exit":"Fullscreen"]})]})}),r.jsxs("button",{className:"absolute top-5 z-40 size-9 rounded-xl border border-slate-200 bg-white shadow-sm flex items-center justify-center gap-0",style:{left:k?"10px":"344px"},onPointerDown:j=>j.stopPropagation(),onClick:()=>Q(j=>!j),title:k?"Show left panel":"Hide left panel",children:[r.jsx("span",{className:"material-symbols-outlined text-[18px] leading-none",children:k?"chevron_right":"chevron_left"}),r.jsx("span",{className:"material-symbols-outlined text-[18px] leading-none -ml-[6px]",children:k?"chevron_right":"chevron_left"})]}),!k&&r.jsx("div",{className:"absolute top-4 left-4 z-30 w-[320px] overflow-y-auto pr-1","data-panel-scroll":"true",style:{maxHeight:"calc(100% - 32px)",touchAction:"auto",overscrollBehavior:"contain"},onWheelCapture:j=>{j.stopPropagation(),j.nativeEvent.stopImmediatePropagation&&j.nativeEvent.stopImmediatePropagation()},onWheel:j=>j.stopPropagation(),onPointerDown:j=>j.stopPropagation(),children:r.jsxs("div",{className:"flex flex-col gap-3 pb-2",children:[r.jsxs("div",{className:"app-panel overflow-hidden",children:[r.jsxs("div",{className:"flex items-start justify-between gap-3 px-4 py-3 border-b border-slate-200",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-[11px] uppercase tracking-[0.12em] text-slate-500 font-bold",children:"Map navigator"}),r.jsx("p",{className:"text-base font-extrabold text-slate-900",children:(v==null?void 0:v.name)||"Mindmap"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Switch layouts or create new ones."})]}),r.jsx("button",{onClick:()=>Pr(j=>!j),className:"size-9 rounded-xl border border-slate-200 bg-white flex items-center justify-center text-slate-700 hover:border-black",children:r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"unfold_more"})})]}),Js&&r.jsx("div",{className:"px-3 py-3 space-y-2 max-h-52 overflow-y-auto",children:u.map(j=>r.jsxs("button",{onClick:()=>{x(j.id),Pr(!1)},className:`w-full text-left px-3 py-2 rounded-xl border text-sm font-semibold flex items-center justify-between ${j.id===(v==null?void 0:v.id)?"border-black/60 bg-slate-50":"border-slate-200 hover:border-slate-400"}`,children:[r.jsx("span",{children:j.name}),j.id===(v==null?void 0:v.id)&&r.jsx("span",{className:"text-[11px] uppercase text-slate-500 font-bold",children:"Active"})]},j.id))}),r.jsxs("div",{className:"px-3 py-3 border-t border-slate-200 flex gap-2",children:[r.jsx("button",{onClick:async()=>{if(!t)return;const j=await qf(t,"New Mindmap"),G=await Ka(t);m(G),x(j),Pr(!1)},className:"flex-1 px-3 py-2 rounded-xl text-sm font-bold bg-black text-white hover:bg-slate-900",children:"+ New mindmap"}),r.jsx("button",{onClick:()=>{En("map"),q((v==null?void 0:v.name)||"")},className:"px-3 py-2 rounded-xl text-sm font-bold border border-slate-200 hover:border-black bg-white",children:"Rename"})]}),r.jsxs("div",{className:"px-3 py-3 border-t border-slate-200",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("span",{className:"text-[11px] uppercase tracking-[0.12em] text-slate-500 font-bold",children:"Branches"}),r.jsxs("span",{className:"text-xs text-slate-500",children:[xs.collapsedCount," collapsed"]})]}),r.jsx("div",{className:"grid gap-2 max-h-60 overflow-y-auto",children:Xt.map(j=>{const G=X.has(j),W=Wn(j);return r.jsxs("button",{onClick:()=>mo(j),className:"w-full text-left px-3 py-2 rounded-xl border text-sm font-semibold flex items-center justify-between gap-2 transition-transform hover:translate-x-[2px]",style:{backgroundColor:W.bg,borderColor:W.border,color:W.text},children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:"account_tree"}),r.jsx("span",{children:j})]}),r.jsxs("div",{className:"flex items-center gap-1 text-xs font-bold",children:[r.jsx("span",{children:Ca[j]||0}),r.jsx("span",{className:"material-symbols-outlined text-[16px]",children:G?"chevron_right":"expand_more"})]})]},j)})})]})]}),r.jsxs("div",{className:"app-panel overflow-hidden",children:[r.jsxs("div",{className:"flex items-start justify-between gap-3 px-4 py-3 border-b border-slate-200",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-[11px] uppercase tracking-[0.12em] text-slate-500 font-bold",children:"Quick add idea"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Drop ideas straight onto this map."})]}),r.jsx("button",{onClick:()=>{var j;F(null),(j=Ce.current)==null||j.focus()},className:"size-9 rounded-xl border border-slate-200 bg-white flex items-center justify-center text-slate-700 hover:border-black",children:r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"open_in_new"})})]}),r.jsxs("div",{className:"p-3 flex flex-col gap-2",children:[r.jsx(st,{value:J,onChange:j=>we(j.target.value),placeholder:"Idea title",className:"w-full text-sm",ref:Ce,onKeyDown:j=>{j.key==="Enter"&&(j.preventDefault(),ho())}}),r.jsx(An,{value:be,onChange:j=>me(j.target.value),placeholder:"Optional context, links, or acceptance criteria",className:"w-full text-sm min-h-[80px]"}),K&&qt&&r.jsx(Qa,{checked:Et,onChange:j=>Xe(j.target.checked),label:`Attach as child of ${qt.title}`,className:"text-xs text-slate-600"}),le&&r.jsx(Qa,{checked:Jt,onChange:j=>ft(j.target.checked),label:`Link to branch ${le}`,className:"text-xs text-slate-600"}),r.jsx("button",{onClick:ho,disabled:I||!J.trim(),className:"w-full px-4 py-2 btn-primary text-sm font-bold disabled:opacity-50",children:"Drop on map"})]})]}),r.jsxs("div",{className:"app-panel overflow-hidden",children:[r.jsx("div",{className:"flex items-start justify-between gap-3 px-4 py-3 border-b border-slate-200",children:r.jsxs("div",{children:[r.jsx("p",{className:"text-[11px] uppercase tracking-[0.12em] text-slate-500 font-bold",children:"Add branch"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Create a new branch node, optionally attached to a selected node."})]})}),r.jsxs("div",{className:"p-3 flex flex-col gap-2",children:[r.jsx(st,{value:Ae,onChange:j=>De(j.target.value),placeholder:"Branch name",className:"w-full text-sm"}),K&&qt&&r.jsx(Qa,{checked:Ee,onChange:j=>ut(j.target.checked),label:`Attach to ${qt.title}`,className:"text-xs text-slate-600"}),le&&r.jsx(Qa,{checked:Ee,onChange:j=>ut(j.target.checked),label:`Attach to branch ${le}`,className:"text-xs text-slate-600"}),r.jsx("button",{onClick:Hr,disabled:I||!Ae.trim(),className:"w-full px-4 py-2 btn-secondary text-sm font-bold disabled:opacity-50",children:"Add branch"})]})]})]})}),r.jsxs("button",{className:"absolute top-5 z-40 size-9 rounded-xl border border-slate-200 bg-white shadow-sm flex items-center justify-center gap-0",style:{right:ne?"10px":"344px"},onPointerDown:j=>j.stopPropagation(),onClick:()=>se(j=>!j),title:ne?"Show inspector":"Hide inspector",children:[r.jsx("span",{className:"material-symbols-outlined text-[18px] leading-none",children:ne?"chevron_left":"chevron_right"}),r.jsx("span",{className:"material-symbols-outlined text-[18px] leading-none -ml-[6px]",children:ne?"chevron_left":"chevron_right"})]}),!ne&&r.jsx("div",{className:"absolute top-4 right-4 z-30 w-[320px] overflow-y-auto","data-panel-scroll":"true",style:{maxHeight:"calc(100% - 32px)",touchAction:"auto",overscrollBehavior:"contain"},onWheelCapture:j=>{j.stopPropagation(),j.nativeEvent.stopImmediatePropagation&&j.nativeEvent.stopImmediatePropagation()},onWheel:j=>j.stopPropagation(),onPointerDown:j=>j.stopPropagation(),children:r.jsxs("div",{className:"app-panel overflow-hidden flex flex-col",children:[r.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-slate-200",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-[11px] uppercase tracking-[0.12em] text-slate-500 font-bold",children:"Idea inspector"}),r.jsx("p",{className:"font-bold text-slate-900",children:Jn==="map"?"Mindmap settings":le||(qt==null?void 0:qt.title)||"Select a node"})]}),r.jsx("button",{onClick:()=>qt?Lr(qt.id):ps(),className:"px-3 py-1.5 rounded-full border border-slate-200 text-sm font-bold hover:border-black bg-white",children:"Focus"})]}),r.jsxs("div",{className:"px-4 pt-3 flex flex-wrap gap-2",children:[r.jsx("button",{onClick:()=>{En("edit"),qt&&(q(qt.title),R(qt.description),Y(ls(qt.type)),je(""))},className:`px-3 py-1.5 rounded-full text-xs font-bold border ${Jn==="edit"?"border-black bg-black text-white":"border-slate-200 bg-white hover:border-black"}`,children:"Edit / branches"}),r.jsx("button",{onClick:()=>{En("map"),q((v==null?void 0:v.name)||"")},className:`px-3 py-1.5 rounded-full text-xs font-bold border ${Jn==="map"?"border-black bg-black text-white":"border-slate-200 bg-white hover:border-black"}`,children:"Map settings"})]}),r.jsxs("div",{className:"p-4 space-y-3 border-t border-slate-100",children:[Jn==="map"&&r.jsxs(r.Fragment,{children:[r.jsx(st,{value:re,onChange:j=>q(j.target.value),className:"w-full text-sm",placeholder:"Mindmap name"}),r.jsx("button",{onClick:async()=>{if(h){E(!0);try{await ey(h,re||(v==null?void 0:v.name)||"Mindmap",t);const j=await Ka(t);m(j),M("Mindmap renamed.")}catch(j){console.error(j),z("Failed to rename mindmap.")}finally{E(!1)}}},disabled:I||!re.trim(),className:"w-full px-4 py-2 rounded-lg bg-black text-white text-sm font-bold disabled:opacity-50",children:"Save name"})]}),Jn==="edit"&&(le?r.jsxs(r.Fragment,{children:[r.jsx(st,{value:He,onChange:j=>Vt(j.target.value),className:"w-full text-sm",placeholder:"Branch name"}),r.jsx("button",{onClick:()=>{_t({type:"branchParent"}),M("Select a node or branch to link this branch to.")},className:"w-full px-4 py-2 rounded-lg border border-slate-200 text-sm font-bold hover:border-black bg-white",children:"Change parent link"}),r.jsx("button",{onClick:Cl,disabled:I||!He.trim(),className:"w-full px-4 py-2 rounded-lg bg-black text-white text-sm font-bold disabled:opacity-50",children:"Rename branch"}),r.jsx("button",{onClick:()=>P(le),disabled:I,className:"w-full px-4 py-2 rounded-lg border border-rose-200 text-sm font-bold text-rose-600",children:"Delete branch"})]}):qt?r.jsxs(r.Fragment,{children:[r.jsx(st,{value:re,onChange:j=>q(j.target.value),className:"w-full text-sm",placeholder:"Title"}),r.jsx(An,{value:H,onChange:j=>R(j.target.value),className:"w-full text-sm min-h-[100px]",placeholder:"Description"}),r.jsx("button",{onClick:()=>{_t({type:"ideaLink"}),M("Select a branch or node to relink this idea.")},className:"w-full px-4 py-2 rounded-lg border border-slate-200 text-sm font-bold hover:border-black bg-white",children:"Relink (pick node/branch)"}),r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsx("button",{onClick:Sd,disabled:I,className:"px-4 py-2 rounded-lg bg-black text-white text-sm font-bold disabled:opacity-50",children:"Save"}),r.jsx("button",{onClick:()=>qt&&pi(qt),disabled:I,className:"px-4 py-2 rounded-lg border border-slate-200 text-sm font-bold col-span-2",children:"Convert to task"}),r.jsx("button",{onClick:()=>K&&Ds(K),disabled:I,className:"px-4 py-2 rounded-lg border border-rose-200 text-sm font-bold text-rose-600 col-span-2",children:"Delete idea"})]})]}):r.jsx("div",{className:"rounded-xl border border-dashed border-slate-200 bg-slate-50/80 px-3 py-4 text-sm text-slate-600",children:"Select a node or branch to edit."}))]}),hs.length>0&&r.jsxs("div",{className:"p-4 border-t border-slate-100 space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-[11px] uppercase tracking-[0.12em] text-slate-500 font-bold",children:"Ideas outside this map"}),r.jsx("p",{className:"text-xs text-slate-500",children:"Attach ideas from other mindmaps."})]}),r.jsx("span",{className:"text-xs font-bold text-slate-600",children:hs.length})]}),r.jsx("div",{className:"space-y-2 max-h-72 overflow-y-auto pr-1",children:hs.map(j=>{var G;return r.jsxs("div",{className:"rounded-xl border border-[var(--color-surface-border)] bg-[var(--color-surface-card)]/90 px-3 py-2 flex items-center justify-between gap-3",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("p",{className:"text-sm font-bold text-slate-900",children:j.title}),r.jsxs("p",{className:"text-xs text-slate-500",children:["From ",((G=u.find(W=>W.id===j.mindmapId))==null?void 0:G.name)||"Default mindmap"]})]}),r.jsx("button",{onClick:()=>po(j),disabled:I,className:"px-3 py-2 rounded-lg bg-black text-white text-sm font-bold disabled:opacity-50 shrink-0",title:K?"Add under the selected node":"Add to root",children:"+"})]},j.id)})})]})]})}),r.jsxs("div",{className:"absolute right-4 bottom-4 flex flex-col gap-2 z-30",onPointerDown:j=>j.stopPropagation(),children:[r.jsx("button",{className:"size-10 rounded-full border border-black bg-white shadow-sm flex items-center justify-center",onClick:j=>{const G=ja(j);pn(-120,G.x,G.y)},children:r.jsx("span",{className:"material-symbols-outlined text-base",children:"add"})}),r.jsx("button",{className:"size-10 rounded-full border border-black bg-white shadow-sm flex items-center justify-center",onClick:j=>{const G=ja(j);pn(120,G.x,G.y)},children:r.jsx("span",{className:"material-symbols-outlined text-base",children:"remove"})}),r.jsx("button",{className:"size-10 rounded-full border border-black bg-white shadow-sm flex items-center justify-center",onClick:()=>ps(),title:"Center selection",children:r.jsx("span",{className:"material-symbols-outlined text-base",children:"center_focus_strong"})})]}),(A||D||zt.type)&&r.jsxs("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 z-40 flex flex-col items-center gap-2 pointer-events-none",children:[zt.type&&r.jsxs("div",{className:"pointer-events-auto px-4 py-3 rounded-2xl bg-black text-white text-sm font-bold shadow-2xl flex items-center gap-2 animate-pulse",children:[r.jsx("span",{className:"material-symbols-outlined text-[18px] text-white",children:"share"}),zt.type==="branchParent"?"Link mode: pick a node/branch for this branch.":"Link mode: pick a branch or node for this idea.",r.jsx("button",{className:"text-xs font-bold ml-1 underline",onClick:()=>_t({type:null}),children:"Cancel"})]}),A&&r.jsxs("div",{className:"pointer-events-auto px-4 py-3 rounded-2xl border border-slate-300 bg-white text-sm font-bold text-slate-800 shadow-2xl flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-[18px] text-slate-700",children:"info"}),r.jsx("span",{children:A}),r.jsx("button",{onClick:()=>M(null),className:"text-xs font-bold text-slate-500 ml-1",children:"Dismiss"})]}),D&&r.jsxs("div",{className:"pointer-events-auto px-4 py-3 rounded-2xl border border-rose-200 bg-rose-50 text-sm font-bold text-rose-700 shadow-2xl flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-[18px] text-rose-600",children:"error"}),r.jsx("span",{children:D}),r.jsx("button",{onClick:()=>z(null),className:"text-xs font-bold text-rose-600 ml-1",children:"Dismiss"})]})]}),r.jsx("svg",{className:"absolute top-0 left-0 pointer-events-none",width:ul,height:ul,style:We,children:El}),r.jsx("div",{className:"absolute top-0 left-0",style:We,children:b?r.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:r.jsx("span",{className:"material-symbols-outlined animate-spin text-3xl text-gray-400",children:"progress_activity"})}):zn.map(hi)}),or&&r.jsx("div",{className:"absolute inset-0 z-40 bg-black/20 flex items-center justify-center",onPointerDown:j=>{j.stopPropagation(),Ds(null)},children:r.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-2xl max-w-sm w-full p-5 flex flex-col gap-3",onPointerDown:j=>j.stopPropagation(),children:[r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsx("div",{className:"size-9 rounded-xl bg-rose-50 border border-rose-100 flex items-center justify-center text-rose-600",children:r.jsx("span",{className:"material-symbols-outlined",children:"warning"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-lg font-bold text-slate-900",children:"Delete this idea?"}),r.jsx("p",{className:"text-sm text-slate-600",children:"This cannot be undone. The node will be removed from the map."})]})]}),r.jsxs("div",{className:"flex gap-2 justify-end",children:[r.jsx("button",{onClick:()=>Ds(null),className:"px-4 py-2 rounded-lg border border-slate-200 text-sm font-bold hover:border-black bg-white",children:"Cancel"}),r.jsx("button",{onClick:()=>or&&Us(or),disabled:I,className:"px-4 py-2 rounded-lg btn-primary text-sm font-bold disabled:opacity-60",children:"Delete"})]})]})}),un&&r.jsx("div",{className:"absolute inset-0 z-40 bg-black/20 flex items-center justify-center",onPointerDown:j=>{j.stopPropagation(),P(null)},children:r.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-2xl max-w-sm w-full p-5 flex flex-col gap-3",onPointerDown:j=>j.stopPropagation(),children:[r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsx("div",{className:"size-9 rounded-xl bg-rose-50 border border-rose-100 flex items-center justify-center text-rose-600",children:r.jsx("span",{className:"material-symbols-outlined",children:"warning"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-lg font-bold text-slate-900",children:"Delete this branch?"}),r.jsx("p",{className:"text-sm text-slate-600",children:"Ideas in this branch will be detached to root."})]})]}),r.jsxs("div",{className:"flex gap-2 justify-end",children:[r.jsx("button",{onClick:()=>P(null),className:"px-4 py-2 rounded-lg border border-slate-200 text-sm font-bold hover:border-black bg-white",children:"Cancel"}),r.jsx("button",{onClick:()=>un&&Or(un),disabled:I,className:"px-4 py-2 rounded-lg btn-primary text-sm font-bold disabled:opacity-60",children:"Delete branch"})]})]})})]})})},FM=()=>{var M,B;const[t,e]=w.useState(!1),[s,o]=w.useState(""),[i,c]=w.useState(""),[u,m]=w.useState(""),[h,x]=w.useState(""),[v,b]=w.useState(!1),N=dn(),T=ai(),[_]=xl(),I=_.get("redirect")||((B=(M=T.state)==null?void 0:M.from)==null?void 0:B.pathname)||"/";w.useEffect(()=>{xe.currentUser&&I!==window.location.pathname&&E()},[xe.currentUser,I]),w.useEffect(()=>{var X;(((X=T.state)==null?void 0:X.inviteTenantId)||Ar()||_.get("redirect"))&&e(!0)},[T.state,_]);const E=async()=>{if(I.startsWith("http"))try{const L=new URL(I);N(L.pathname+L.search)}catch{N("/")}else N(I)},D=async L=>{L.preventDefault(),x(""),b(!0);try{if(t){const X=await eS(xe,s,i);u&&await j0(X.user,{displayName:u}),await il(Ar()||void 0)}else await tS(xe,s,i),await il();await E()}catch(X){console.error(X),x(X.message||"An error occurred.")}finally{b(!1)}},z=async()=>{try{const L=new nS;await fg(xe,L),await il(),await E()}catch(L){console.error(L),x("Failed to sign in with Google.")}},A=async()=>{try{const L=new zf;await fg(xe,L),await il(),await E()}catch(L){console.error(L),x("Failed to sign in with GitHub.")}};return r.jsxs("div",{className:"min-h-screen w-full flex bg-[var(--color-surface-bg)] text-[var(--color-text-main)] font-sans",children:[r.jsxs("div",{className:"hidden lg:flex w-1/2 p-12 bg-zinc-950 text-white relative overflow-hidden flex-col justify-between border-r border-zinc-900",children:[r.jsx("div",{className:"absolute inset-0 opacity-10",style:{backgroundImage:"radial-gradient(circle at 1px 1px, white 1px, transparent 0)",backgroundSize:"40px 40px"}}),r.jsx("div",{className:"relative z-10",children:r.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[r.jsx("div",{className:"size-10 rounded-lg bg-white text-black flex items-center justify-center font-bold text-xl shadow-[0_0_15px_rgba(255,255,255,0.3)]",children:"PF"}),r.jsx("span",{className:"font-bold text-xl tracking-tight",children:"ProjectFlow"})]})}),r.jsxs("div",{className:"relative z-10 max-w-lg",children:[r.jsxs("h1",{className:"text-6xl font-extrabold tracking-tighter leading-tight mb-6",children:["Focus.",r.jsx("br",{}),"Build.",r.jsx("br",{}),"Ship."]}),r.jsx("p",{className:"text-xl text-zinc-400 font-light leading-relaxed mb-12",children:"The minimalist workspace for creators. No clutter, just clarity."}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-start gap-4",children:[r.jsx("div",{className:"mt-1 size-8 rounded-full bg-white/10 flex items-center justify-center border border-white/20",children:r.jsx("span",{className:"material-symbols-outlined text-sm",children:"check"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-bold text-lg",children:"Streamlined Tasks"}),r.jsx("p",{className:"text-zinc-500 text-sm",children:"Kanban, lists, and focus modes."})]})]}),r.jsxs("div",{className:"flex items-start gap-4",children:[r.jsx("div",{className:"mt-1 size-8 rounded-full bg-white/10 flex items-center justify-center border border-white/20",children:r.jsx("span",{className:"material-symbols-outlined text-sm",children:"hub"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-bold text-lg",children:"Idea Mapping"}),r.jsx("p",{className:"text-zinc-500 text-sm",children:"Connect thoughts visually."})]})]})]})]}),r.jsx("div",{className:"relative z-10 text-xs text-zinc-600 uppercase tracking-widest",children:" 2024 ProjectFlow Scorp."})]}),r.jsx("div",{className:"flex-1 flex flex-col items-center justify-center p-6 md:p-12 bg-[var(--color-surface-bg)]",children:r.jsxs("div",{className:"w-full max-w-sm space-y-8",children:[r.jsxs("div",{className:"text-center md:text-left",children:[r.jsx("h2",{className:"text-3xl font-bold tracking-tight mb-2 text-[var(--color-text-main)]",children:t?"Join ProjectFlow":"Welcome back"}),r.jsx("p",{className:"text-[var(--color-text-muted)]",children:t?"Create your workspace today.":"Enter your credentials to access your projects."})]}),r.jsxs("form",{onSubmit:D,className:"space-y-5",children:[t&&r.jsx(st,{label:"Full Name",value:u,onChange:L=>m(L.target.value),placeholder:"e.g. John Doe"}),r.jsx(st,{label:"Email Address",type:"email",value:s,onChange:L=>o(L.target.value),placeholder:"name@example.com"}),r.jsx(st,{label:"Password",type:"password",value:i,onChange:L=>c(L.target.value),placeholder:""}),h&&r.jsxs("div",{className:"p-3 rounded bg-[var(--color-error)]/10 border border-[var(--color-error)]/20 text-[var(--color-error)] text-sm font-medium flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-lg",children:"error"}),h]}),r.jsx(Ne,{type:"submit",loading:v,variant:"primary",className:"w-full h-12 text-base shadow-xl",children:t?"Create Account":"Sign In"})]}),r.jsxs("div",{className:"relative flex items-center justify-center py-2",children:[r.jsx("div",{className:"absolute inset-0 flex items-center",children:r.jsx("div",{className:"w-full border-t border-[var(--color-surface-border)]"})}),r.jsx("div",{className:"relative bg-[var(--color-surface-bg)] px-4 text-xs font-semibold text-[var(--color-text-subtle)] uppercase tracking-widest",children:"Or continue with"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("button",{onClick:z,className:"flex items-center justify-center gap-2 h-12 rounded-xl border border-[var(--color-surface-border)] hover:border-[var(--color-text-muted)] hover:bg-[var(--color-surface-hover)] transition-all font-medium text-sm text-[var(--color-text-main)]",children:[r.jsx("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",className:"w-5 h-5",alt:"Google"}),"Google"]}),r.jsxs("button",{onClick:A,className:"flex items-center justify-center gap-2 h-12 rounded-xl border border-[var(--color-surface-border)] hover:border-[var(--color-text-muted)] hover:bg-[var(--color-surface-hover)] transition-all font-medium text-sm text-[var(--color-text-main)]",children:[r.jsx("img",{src:"https://www.svgrepo.com/show/512317/github-142.svg",className:"w-5 h-5 dark:invert",alt:"GitHub"}),"GitHub"]})]}),r.jsxs("p",{className:"text-center text-sm text-[var(--color-text-muted)] mt-8",children:[t?"Already have an account?":"New to ProjectFlow?",r.jsx("button",{onClick:()=>{e(!t),x("")},className:"ml-1 font-bold text-[var(--color-primary)] hover:underline",children:t?"Log in":"Create account"})]})]})})]})},N0={Urgent:4,High:3,Medium:2,Low:1,None:0},VM=(t,e,s={maxItemsPerDay:5,includeWeekends:!1,prioritizeOverdue:!0},o=[])=>{const i=[],c=(_,I)=>{if(I==="task"?_.isCompleted:_.status==="Resolved"||_.status==="Closed")return;let D=1;_.priority&&_.priority in N0&&(D=N0[_.priority]);const z=_.scheduledDate||(I==="task"?_.dueDate:void 0);let A=[];_.assigneeIds&&_.assigneeIds.length>0?A=_.assigneeIds:_.assigneeId?A=[_.assigneeId]:_.ownerId&&(A=[_.ownerId]),i.push({id:_.id,type:I,title:_.title,dueDate:z?new Date(z):void 0,priorityWeight:D,originalItem:_,assigneeIds:A})};t.forEach(_=>c(_,"task")),e.forEach(_=>c(_,"issue")),o.forEach(_=>c(_,"task"));const u=new Map;i.forEach(_=>{u.has(_.id)||u.set(_.id,_)});const m=Array.from(u.values()),h=eo(new Date);m.sort((_,I)=>{const E=_.dueDate&&Df(_.dueDate,h),D=I.dueDate&&Df(I.dueDate,h);if(s.prioritizeOverdue){if(E&&!D)return-1;if(!E&&D)return 1}return _.priorityWeight!==I.priorityWeight?I.priorityWeight-_.priorityWeight:_.dueDate&&I.dueDate?_.dueDate.getTime()-I.dueDate.getTime():_.dueDate&&!I.dueDate?-1:!_.dueDate&&I.dueDate?1:0});const x={},v=(_,I)=>{const E=eo(_).toISOString();return(x[E]&&x[E][I]||0)<s.maxItemsPerDay},b=(_,I)=>{const E=eo(_).toISOString();x[E]||(x[E]={}),x[E][I]=(x[E][I]||0)+1},N=[],T=(_,I)=>{let E=_;for(;;){if(!s.includeWeekends&&Kk(E)){E=Ko(E,1);continue}if(I.every(z=>v(E,z)))return E;E=Ko(E,1)}};return m.forEach(_=>{const I=T(h,_.assigneeIds),E=_.dueDate;(!E||!Wa(E,I))&&N.push({taskId:_.id,type:_.type,newDate:I,originalDate:E,reason:E&&Df(E,h)?"Overdue":"Global Optimization"}),_.assigneeIds.forEach(z=>b(I,z))}),N},BM=()=>{var un;const{theme:t}=wy(),e=dn(),[s,o]=w.useState([]),[i,c]=w.useState([]),[u,m]=w.useState([]),[h,x]=w.useState([]),[v,b]=w.useState(!0),[N,T]=w.useState(!1),[_,I]=w.useState("week"),[E,D]=w.useState(new Date),[z,A]=w.useState(new Date),[M,B]=w.useState(!1),[L,X]=w.useState([]),[de,V]=w.useState(new Set),[Z,K]=w.useState(!0),{showError:F,showSuccess:le,showToast:he}=vd(),[re,q]=w.useState(null),[H,R]=w.useState(!1),ue=(P,k,Q)=>{P.dataTransfer.setData("application/json",JSON.stringify({id:k.id,type:Q,projectId:k.projectId,tenantId:k.tenantId,path:k.path})),P.dataTransfer.effectAllowed="move"},Y=(P,k)=>{P.preventDefault(),P.dataTransfer.dropEffect="move",R(!1),k&&re!==k&&q(k)},ye=P=>{P.preventDefault(),P.dataTransfer.dropEffect="move",q(null),R(!0)},je=P=>{const k=P.currentTarget.getBoundingClientRect(),Q=P.clientX,ne=P.clientY;(Q<k.left||Q>k.right||ne<k.top||ne>k.bottom)&&R(!1)},J=async(P,k)=>{P.preventDefault(),q(null);try{const Q=P.dataTransfer.getData("application/json");if(!Q)return;const ne=JSON.parse(Q),{id:se,type:Se,projectId:Ce,tenantId:Te,path:Ge}=ne,et=k.toISOString(),tt=xe.currentUser,gt={scheduledDate:et};Se==="task"&&tt&&u.some(gn=>gn.id===se)&&(gt.assignee=tt.displayName||tt.email,gt.assigneeIds=[tt.uid]),Se==="task"?await $a(se,gt,Ce,Te,Ge):await Hs(se,gt,Ce,Te,Ge),He()}catch(Q){console.error("Drop failed",Q),F(`Failed to move item: ${Q.message}`)}},we=async P=>{P.preventDefault(),R(!1),q(null);try{const k=P.dataTransfer.getData("application/json");if(!k)return;const Q=JSON.parse(k),{id:ne,type:se,projectId:Se,tenantId:Ce,path:Te}=Q;if(console.log("Dropping item to inbox",{id:ne,type:se,projectId:Se,tenantId:Ce,path:Te}),(!ne||!Se)&&!Te)throw new Error("Missing item ID or Project ID and path");se==="task"?await $a(ne,{scheduledDate:null},Se,Ce,Te):await Hs(ne,{scheduledDate:null},Se,Ce,Te),He()}catch(k){console.error("Drop to unscheduled failed",k),F(`Failed to unschedule item: ${k.message}`)}},be=async()=>{try{const P=s.filter(k=>k.scheduledDate&&!k.assigneeId&&(!k.assigneeIds||k.assigneeIds.length===0)&&!k.isCompleted);if(P.length===0){he("No unassigned tasks to clear from calendar.");return}await Promise.all(P.map(k=>$a(k.id,{scheduledDate:null},k.projectId,k.tenantId,k.path))),le(`Moved ${P.length} unassigned task(s) to inbox.`),He()}catch(P){console.error("Failed to clear unassigned tasks",P),F(`Failed to clear unassigned tasks: ${P.message}`)}},me=async()=>{try{const P=new Date,k=s.filter(se=>se.scheduledDate&&g0(new Date(se.scheduledDate),P)&&!se.isCompleted),Q=i.filter(se=>se.scheduledDate&&g0(new Date(se.scheduledDate),P)&&se.status!=="Resolved"&&se.status!=="Closed"),ne=[...k,...Q];if(ne.length===0){he("No future items found on the calendar.");return}await Promise.all(ne.map(se=>{const Se=!("reporter"in se),Ce=se.tenantId,Te=se.path;return Se?$a(se.id,{scheduledDate:null},se.projectId,Ce,Te):Hs(se.id,{scheduledDate:null},se.projectId,Ce,Te)})),le(`Successfully unscheduled ${ne.length} future items.`),He()}catch(P){console.error("Failed to unschedule future items",P),F(`Failed to unschedule: ${P.message}`)}},Ae=(P,k,Q)=>{P.stopPropagation();const ne=k.tenantId;e(Q==="task"?`/project/${k.projectId}/tasks/${k.id}${ne?`?tenant=${ne}`:""}`:`/project/${k.projectId}/issues/${k.id}${ne?`?tenant=${ne}`:""}`)},De=async(P,k,Q)=>{P.stopPropagation(),P.preventDefault();try{const ne=k.tenantId,se=k.path;Q==="task"?await $a(k.id,{scheduledDate:null},k.projectId,ne,se):await Hs(k.id,{scheduledDate:null},k.projectId,ne,se),He()}catch(ne){console.error("Failed to unschedule",ne),F(`Failed to unschedule: ${ne.message}`)}},[Ee,ut]=w.useState(null),He=async()=>{b(!0);try{const[P,k,Q]=await Promise.all([si(),wm(),Y0()]);console.log("Calendar: Fetched tasks",P.length),o(P),c(k),m(Q),P.length===0&&console.log("Debug: No tasks found. verifying current tenant...")}catch(P){console.error("Failed to fetch calendar data",P),F(`Error loading data: ${P.message}`)}finally{b(!1)}};w.useEffect(()=>{He()},[]);const Vt=async()=>{T(!0);try{const P=new Set;s.forEach(Te=>{Te.assigneeId&&P.add(Te.assigneeId),Te.assigneeIds&&Te.assigneeIds.forEach(Ge=>P.add(Ge))}),i.forEach(Te=>{Te.assigneeId&&P.add(Te.assigneeId),Te.assigneeIds&&Te.assigneeIds.forEach(Ge=>P.add(Ge))});const k=xe.currentUser;k&&P.delete(k.uid);const Q=P.size>0?await J0(Array.from(P)):[];x(Q);const ne=u.filter(Te=>!Te.scheduledDate&&!Te.isCompleted),se=[...s,...ne],Ce=VM(se,i,void 0,Q).filter(Te=>{const Ge=Te.originalDate?new Date(Te.originalDate):null;return!Ge||!Wa(Ge,Te.newDate)});if(Ce.length===0){le("Your schedule is already optimized! No changes needed.");return}X(Ce),V(new Set(Ce.map(Te=>Te.taskId))),B(!0)}catch(P){console.error("Failed to prepare schedule",P),F(`Preparation failed: ${P.message}`)}finally{T(!1)}},Et=async()=>{T(!0);try{const P=L.filter(k=>de.has(k.taskId)).map(async k=>{const Q=k.newDate.toISOString(),ne=xe.currentUser;if(k.type==="task"){const se=s.find(Se=>Se.id===k.taskId)||h.find(Se=>Se.id===k.taskId)||u.find(Se=>Se.id===k.taskId);if(se){const Se={scheduledDate:Q};u.some(Te=>Te.id===se.id)&&ne&&(Se.assignee=ne.displayName||ne.email,Se.assigneeIds=[ne.uid]),await $a(se.id,Se,se.projectId,se.tenantId)}}else if(k.type==="issue"){const se=i.find(Se=>Se.id===k.taskId);se&&await Hs(se.id,{scheduledDate:Q},se.projectId,se.tenantId)}});await Promise.all(P),await He(),B(!1),x([]),le("Successfully optimized schedule for you and your team!")}catch(P){console.error("Distribution failed",P),F("Failed to optimize schedule: "+P.message),B(!1)}finally{T(!1)}},Jt=(()=>{if(_==="week")return am({start:ga(E,{weekStartsOn:1}),end:im(E,{weekStartsOn:1})});{const P=ga(om(E),{weekStartsOn:1}),k=im(rm(E),{weekStartsOn:1});return am({start:P,end:k})}})(),ft=P=>P.scheduledDate?new Date(P.scheduledDate):P.dueDate?new Date(P.dueDate):null,Pt=P=>{const k=s.filter(ne=>{const se=ft(ne);if(!se||!hl(se))return!1;const Se=ne.status||"Open";return Se!=="Open"&&Se!=="In Progress"?!1:Wa(se,P)&&!ne.isCompleted}),Q=i.filter(ne=>{const se=ft(ne);return!se||!hl(se)?!1:Wa(se,P)&&(ne.status==="Open"||ne.status==="In Progress")});return[...k,...Q]},Nt=w.useMemo(()=>{const P=s.filter(se=>!ft(se)&&!se.isCompleted),k=i.filter(se=>!ft(se)&&se.status!=="Resolved"&&se.status!=="Closed"),Q=new Set(P.map(se=>se.id)),ne=u.filter(se=>!ft(se)&&!se.isCompleted&&!Q.has(se.id));return[...P,...k,...ne]},[s,i,u]),zt="grid-cols-7",_t=_==="week"?"grid-rows-1":"auto-rows-fr";return r.jsxs("div",{className:"relative h-full overflow-hidden text-[var(--color-text-main)]",children:[r.jsx("div",{className:`
                absolute inset-0 z-[100] flex items-center justify-center bg-[var(--color-surface-bg)] transition-opacity duration-700 ease-in-out pointer-events-none
                ${v?"opacity-100 pointer-events-auto":"opacity-0"}
            `,children:r.jsxs("div",{className:"flex flex-col items-center gap-4",children:[r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"absolute inset-0 bg-[var(--color-primary)]/20 rounded-full blur-xl animate-pulse"}),r.jsx("span",{className:"material-symbols-outlined animate-spin text-5xl text-[var(--color-primary)] relative z-10",children:"progress_activity"})]}),r.jsx("p",{className:"text-[var(--color-text-muted)] font-medium animate-pulse",children:"Loading calendar..."})]})}),r.jsxs("div",{className:"flex h-full w-full overflow-hidden",children:[r.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[r.jsxs("header",{className:"flex items-center justify-between p-4 border-b border-[var(--color-surface-border)] bg-[var(--color-surface-card)] shrink-0",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("button",{onClick:()=>D(P=>_==="week"?Ko(P,-7):Ko(om(P),-1)),className:"p-2 hover:bg-[var(--color-surface-hover)] rounded-full transition-colors",children:r.jsx("span",{className:"material-symbols-outlined",children:"chevron_left"})}),r.jsx("h2",{className:"text-xl font-bold min-w-[200px] text-center",children:_==="week"?`${$n(Jt[0],"MMM d")} - ${$n(Jt[Jt.length-1],"MMM d, yyyy")}`:$n(E,"MMMM yyyy")}),r.jsx("button",{onClick:()=>D(P=>_==="week"?Ko(P,7):Ko(rm(P),1)),className:"p-2 hover:bg-[var(--color-surface-hover)] rounded-full transition-colors",children:r.jsx("span",{className:"material-symbols-outlined",children:"chevron_right"})})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("div",{className:"flex bg-[var(--color-surface-bg)] rounded-lg p-1 border border-[var(--color-surface-border)]",children:[r.jsx("button",{onClick:()=>I("week"),className:`px-3 py-1 rounded-md text-sm font-medium transition-all ${_==="week"?"bg-white dark:bg-slate-700 shadow-sm":"text-[var(--color-text-muted)] hover:text-[var(--color-text-main)]"}`,children:"Week"}),r.jsx("button",{onClick:()=>I("month"),className:`px-3 py-1 rounded-md text-sm font-medium transition-all ${_==="month"?"bg-white dark:bg-slate-700 shadow-sm":"text-[var(--color-text-muted)] hover:text-[var(--color-text-main)]"}`,children:"Month"})]}),r.jsxs("button",{onClick:Vt,disabled:N,className:"flex items-center gap-2 px-4 py-2 bg-[var(--color-primary)] text-white dark:text-neutral-900 rounded-xl hover:opacity-90 transition-all font-semibold disabled:opacity-50 shadow-sm",children:[r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:N?"hourglass_top":"auto_fix_high"}),r.jsx("span",{className:"hidden sm:inline",children:N?"Optimizing...":"Smart Schedule"})]}),r.jsxs("button",{onClick:()=>K(!Z),className:`h-10 w-10 flex items-center justify-center rounded-xl transition-all relative ${Z?"bg-[var(--color-primary)]/10 text-[var(--color-primary)]":"bg-transparent text-[var(--color-text-muted)] hover:text-[var(--color-text-main)] hover:bg-[var(--color-surface-hover)]"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"inbox"}),Nt.length>0&&r.jsx("span",{className:"absolute -top-1 -right-1 flex h-4 w-4 items-center justify-center rounded-full bg-red-500 text-[10px] font-bold text-white shadow-sm ring-2 ring-[var(--color-surface-bg)]",children:Nt.length})]})]})]}),r.jsx("div",{className:`flex-1 grid ${zt} ${_t} overflow-hidden bg-[var(--color-surface-border)] gap-[1px]`,children:Jt.map(P=>{Wa(P,z);const k=Db(P),Q=Rb(P,E),ne=Pt(P),se=$n(P,"d"),Se=$n(P,"EEE");return r.jsxs("div",{onClick:()=>A(P),onDragOver:Ce=>Y(Ce,P.toISOString()),onDrop:Ce=>J(Ce,P),className:`
                                    flex flex-col transition-all cursor-pointer overflow-hidden
                                    ${!Q&&_==="month"?"bg-[var(--color-surface-bg)] opacity-60":"bg-[var(--color-surface-card)]"}
                                    ${_==="week"?"min-h-[200px]":"min-h-[120px]"}
                                    ${re===P.toISOString()?"ring-2 ring-inset ring-[var(--color-primary)] bg-[var(--color-primary)]/5":""}
                                `,children:[r.jsxs("div",{className:`p-2 flex items-center justify-between shrink-0 ${k?"bg-[var(--color-primary)]/5":""}`,children:[r.jsx("span",{className:"text-xs font-medium uppercase text-[var(--color-text-muted)]",children:_==="week"?Se:""}),r.jsx("div",{className:`flex items-center justify-center w-7 h-7 rounded-full text-sm font-medium ${k?"bg-[var(--color-primary)] text-white shadow-sm":"text-[var(--color-text-main)]"}`,children:se})]}),r.jsx("div",{className:"flex-1 overflow-y-auto p-2 min-h-0 custom-scrollbar",children:r.jsx("div",{className:"flex flex-col gap-2",children:ne.map(Ce=>{const Te="reporter"in Ce?"issue":"task";return r.jsxs("div",{draggable:!0,onDragStart:Ge=>ue(Ge,Ce,Te),onClick:Ge=>Ae(Ge,Ce,Te),className:`
                                                    group p-2 text-xs rounded border shadow-sm hover:shadow-md transition-all cursor-pointer relative
                                                    bg-white dark:bg-slate-800 border-[var(--color-surface-border)]
                                                    ${Ce.status&&!Ce.isCompleted?"border-l-4 border-l-purple-500":""}
                                                    active:cursor-grabbing hover:scale-[1.02]
                                                `,onMouseEnter:Ge=>{const et=Ge.currentTarget.getBoundingClientRect();ut({item:Ce,x:et.right+8,y:et.top})},onMouseLeave:()=>ut(null),children:[r.jsx("div",{className:"font-semibold line-clamp-2 mb-1 pr-5",children:Ce.title}),r.jsx("div",{className:"flex items-center justify-between text-[var(--color-text-muted)]",children:r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("span",{className:`size-2 rounded-full ${Ce.priority==="Urgent"?"bg-red-500":Ce.priority==="High"?"bg-orange-500":Ce.priority==="Medium"?"bg-yellow-500":"bg-green-500"}`}),r.jsx("span",{className:"scale-75 origin-left",children:Ce.dueDate?$n(new Date(Ce.dueDate),"HH:mm"):""})]})}),r.jsx("button",{onClick:Ge=>De(Ge,Ce,Te),className:"absolute top-1 right-1 opacity-0 group-hover:opacity-100 p-1 rounded hover:bg-[var(--color-surface-hover)] transition-opacity",title:"Unschedule",children:r.jsx("span",{className:"material-symbols-outlined text-[14px] text-[var(--color-text-muted)]",children:"event_busy"})})]},Ce.id)})})})]},P.toISOString())})})]}),Z&&r.jsxs("div",{className:`w-80 border-l border-[var(--color-surface-border)] bg-[var(--color-surface-card)] flex flex-col shrink-0 transition-all relative ${H?"ring-2 ring-inset ring-[var(--color-primary)] bg-[var(--color-primary)]/5":""}`,onDragOver:ye,onDragLeave:je,onDrop:we,children:[H&&r.jsx("div",{className:"absolute inset-0 pointer-events-none bg-[var(--color-primary)]/10 flex items-center justify-center z-10",children:r.jsxs("div",{className:"text-[var(--color-primary)] font-bold text-sm flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined",children:"inbox"}),"Drop to unschedule"]})}),r.jsxs("div",{className:"p-4 border-b border-[var(--color-surface-border)] flex items-center justify-between",children:[r.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[r.jsx("span",{className:"material-symbols-outlined text-[var(--color-text-muted)]",children:"inbox"}),"Unscheduled",r.jsx("span",{className:"bg-[var(--color-surface-hover)] text-[var(--color-text-muted)] text-xs px-2 py-0.5 rounded-full",children:Nt.length})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("button",{onClick:me,className:"p-1.5 rounded-lg hover:bg-[var(--color-surface-hover)] text-[var(--color-text-muted)] hover:text-[var(--color-text-main)] transition-colors",title:"Unschedule all future items (tomorrow onwards)",children:r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"event_busy"})}),r.jsx("button",{onClick:be,className:"p-1.5 rounded-lg hover:bg-[var(--color-surface-hover)] text-[var(--color-text-muted)] hover:text-[var(--color-text-main)] transition-colors",title:"Clear unassigned tasks from calendar",children:r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"playlist_remove"})}),r.jsx("button",{onClick:()=>K(!1),className:"hover:bg-[var(--color-surface-hover)] p-1 rounded",children:r.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"close"})})]})]}),r.jsx("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar",children:Nt.length===0?r.jsxs("div",{className:"text-center py-10 text-[var(--color-text-muted)]",children:[r.jsx("span",{className:"material-symbols-outlined text-[48px] opacity-20 block mb-2",children:"check_circle"}),r.jsx("p",{className:"text-sm",children:"All caught up!"})]}):r.jsx("div",{className:"flex flex-col gap-3",children:Nt.map(P=>r.jsxs("div",{draggable:!0,onDragStart:k=>ue(k,P,"reporter"in P?"issue":"task"),onClick:k=>Ae(k,P,"reporter"in P?"issue":"task"),className:"p-3 bg-[var(--color-surface-bg)] rounded-xl transition-all text-sm group cursor-grab active:cursor-grabbing hover:bg-[var(--color-surface-hover)] hover:translate-y-[-2px] hover:shadow-md",children:[r.jsx("div",{className:"font-medium mb-1 line-clamp-2",children:P.title}),r.jsxs("div",{className:"flex items-center justify-between text-xs text-[var(--color-text-muted)]",children:[r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${P.priority==="Urgent"?"bg-red-500":P.priority==="High"?"bg-orange-500":"bg-green-500"}`}),"reporter"in P?"Issue":"Task"]}),r.jsx("button",{className:"opacity-0 group-hover:opacity-100 text-[var(--color-primary)] font-bold transition-opacity",children:"Drag to Schedule"})]})]},P.id))})}),r.jsx("div",{className:"p-4 border-t border-[var(--color-surface-border)] bg-[var(--color-surface-bg)]",children:r.jsx("p",{className:"text-xs text-[var(--color-text-muted)] text-center",children:'Use "Smart Schedule" to automatically assign dates to these items.'})})]}),M&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-fade-in",children:r.jsxs("div",{className:"bg-[var(--color-surface-card)] rounded-2xl shadow-2xl max-w-4xl w-full overflow-hidden flex flex-col max-h-[85vh] animate-scale-up border-[3px] border-[var(--color-surface-border)]",children:[r.jsxs("div",{className:"p-6 border-b border-[var(--color-surface-border)] flex items-center justify-between bg-[var(--color-surface-bg)]/50",children:[r.jsxs("div",{children:[r.jsxs("h3",{className:"text-xl font-bold flex items-center gap-3 text-[var(--color-text-main)]",children:[r.jsx("div",{className:"p-2 rounded-lg bg-[var(--color-primary)]/10 text-[var(--color-primary)]",children:r.jsx("span",{className:"material-symbols-outlined text-[24px]",children:"auto_fix_high"})}),"Optimized Schedule"]}),r.jsxs("p",{className:"text-[var(--color-text-muted)] text-sm mt-1 ml-14",children:["Review proposed changes (",de.size," selected)"]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>V(new Set(L.map(P=>P.taskId))),className:"px-4 py-2 text-xs font-bold uppercase tracking-wider bg-[var(--color-surface-hover)] text-[var(--color-text-main)] rounded-lg hover:bg-[var(--color-surface-border)] transition-colors",children:"Select All"}),r.jsx("button",{onClick:()=>V(new Set),className:"px-4 py-2 text-xs font-bold uppercase tracking-wider bg-transparent text-[var(--color-text-muted)] rounded-lg hover:bg-[var(--color-surface-hover)] transition-colors border border-[var(--color-surface-border)] hover:border-[var(--color-text-muted)]",children:"Deselect All"})]})]}),r.jsxs("div",{className:"bg-[var(--color-surface-bg)] border-b border-[var(--color-surface-border)] px-6 py-3 grid grid-cols-[24px_minmax(0,2fr)_minmax(0,1fr)_minmax(0,1.5fr)_minmax(0,1fr)] gap-6 items-center text-xs font-bold text-[var(--color-text-muted)] uppercase tracking-wider",children:[r.jsx("div",{className:"w-6 flex justify-center",children:r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"check_box"})}),r.jsx("div",{children:"Task Details"}),r.jsx("div",{children:"Assignee"}),r.jsx("div",{children:"Schedule Change"}),r.jsx("div",{className:"text-right",children:"Action"})]}),r.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar bg-[var(--color-surface-bg)]/30",children:L.length===0?r.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-[var(--color-text-muted)]",children:[r.jsx("span",{className:"material-symbols-outlined text-5xl mb-4 opacity-20",children:"check_circle"}),r.jsx("p",{className:"text-lg font-medium",children:"No schedule changes needed!"}),r.jsx("p",{className:"text-sm opacity-60",children:"Your calendar is already optimized."})]}):r.jsx("div",{className:"flex flex-col",children:L.map((P,k)=>{const Q=P.type==="issue",ne=u.some(tt=>tt.id===P.taskId),se=Q?i.find(tt=>tt.id===P.taskId):s.find(tt=>tt.id===P.taskId)||h.find(tt=>tt.id===P.taskId)||u.find(tt=>tt.id===P.taskId),Se=se==null?void 0:se.title,Ce=ne?"Unassigned":(se==null?void 0:se.assignee)||"Me",Te=de.has(P.taskId),Ge=(se==null?void 0:se.priority)||"Medium",et=Ge==="Urgent"?"bg-red-500":Ge==="High"?"bg-orange-500":Ge==="Medium"?"bg-yellow-500":"bg-green-500";return r.jsxs("div",{onClick:()=>{const tt=new Set(de);Te?tt.delete(P.taskId):tt.add(P.taskId),V(tt)},className:`
                                                    px-6 py-4 grid grid-cols-[24px_minmax(0,2fr)_minmax(0,1fr)_minmax(0,1.5fr)_minmax(0,1fr)] gap-6 items-center border-b border-[var(--color-surface-border)] cursor-pointer transition-all duration-200 group
                                                    ${Te?"bg-[var(--color-primary)]/5 hover:bg-[var(--color-primary)]/10":"bg-[var(--color-surface-card)] hover:bg-[var(--color-surface-hover)] opacity-75 hover:opacity-100"}
                                                `,children:[r.jsx("div",{className:"w-6 flex justify-center",children:r.jsx("div",{className:`
                                                        size-6 rounded-lg flex items-center justify-center transition-all duration-200 border
                                                        ${Te?"bg-indigo-600 border-indigo-600 shadow-md shadow-indigo-500/30 scale-100":"bg-[var(--color-surface-bg)] border-[var(--color-surface-border)] group-hover:border-[var(--color-text-muted)] scale-90"}
                                                    `,children:Te&&r.jsx("span",{className:"material-symbols-outlined text-[16px] text-white font-bold",children:"check"})})}),r.jsxs("div",{className:"min-w-0 pr-4",children:[r.jsxs("div",{className:"font-semibold text-[var(--color-text-main)] truncate text-sm mb-1 flex items-center gap-2",children:[r.jsx("span",{className:`material-symbols-outlined text-[18px] shrink-0 ${Q?"text-purple-500":"text-blue-500"}`,children:Q?"bug_report":"check_circle"}),r.jsx("span",{className:"truncate",children:Se||"Unknown Item"})]}),r.jsxs("div",{className:"flex items-center gap-2 mt-1.5 ml-6",children:[r.jsx("span",{className:`h-1.5 w-1.5 rounded-full ${et}`}),r.jsxs("span",{className:"text-[11px] font-medium text-[var(--color-text-muted)] uppercase tracking-wide opacity-80",children:[Ge," Priority"]})]})]}),r.jsx("div",{children:r.jsxs("div",{className:`
                                                        px-2.5 py-1 rounded-md text-xs font-semibold inline-flex items-center gap-1.5 border
                                                        ${ne?"bg-orange-500/10 text-orange-600 border-orange-500/20":"bg-[var(--color-surface-bg)] text-[var(--color-text-muted)] border-[var(--color-surface-border)]"}
                                                    `,children:[r.jsx("span",{className:"material-symbols-outlined text-[14px] shrink-0",children:ne?"person_add":"person"}),r.jsx("span",{className:"truncate max-w-[120px] block font-medium",children:Ce})]})}),r.jsxs("div",{className:"flex flex-col justify-center",children:[r.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[r.jsx("span",{className:`font-medium ${P.originalDate?"text-[var(--color-text-muted)] line-through opacity-70":"text-[var(--color-text-muted)] italic"}`,children:P.originalDate?$n(new Date(P.originalDate),"MMM d"):"Unscheduled"}),r.jsx("span",{className:"material-symbols-outlined text-[16px] text-[var(--color-text-muted)] opacity-50",children:"arrow_forward"}),r.jsx("span",{className:"font-bold text-[var(--color-primary)]",children:$n(P.newDate,"MMM d")})]}),r.jsxs("div",{className:"text-[10px] text-[var(--color-text-muted)] mt-1 opacity-70 flex items-center gap-1",children:[r.jsx("span",{className:"material-symbols-outlined text-[12px]",children:"info"}),P.reason]})]}),r.jsx("div",{className:"text-right",children:ne?r.jsx("span",{className:`
                                                            inline-flex items-center px-2.5 py-1 rounded-md text-xs font-semibold shadow-sm transition-all border
                                                            ${Te?"bg-orange-500/10 text-orange-600 border-orange-500/20 shadow-orange-500/10":"bg-[var(--color-surface-border)] text-[var(--color-text-muted)] border-transparent opacity-50"}
                                                        `,children:"Assign & Schedule"}):r.jsx("span",{className:`
                                                            inline-flex items-center px-2.5 py-1 rounded-md text-xs font-semibold shadow-sm transition-all border
                                                            ${Te?"bg-indigo-500/10 text-indigo-600 border-indigo-500/20 shadow-indigo-500/10":"bg-[var(--color-surface-border)] text-[var(--color-text-muted)] border-transparent opacity-50"}
                                                        `,children:"Reschedule"})})]},k)})})}),r.jsxs("div",{className:"p-6 border-t border-[var(--color-surface-border)] bg-[var(--color-surface-card)] flex justify-end gap-3 shadow-[0_-4px_20px_rgba(0,0,0,0.2)] z-10",children:[r.jsx("button",{onClick:()=>B(!1),className:"px-6 py-3 rounded-xl font-semibold text-[var(--color-text-muted)] hover:text-[var(--color-text-main)] hover:bg-[var(--color-surface-hover)] transition-all",children:"Cancel"}),r.jsxs("button",{onClick:Et,disabled:L.length===0||de.size===0,className:"px-8 py-3 rounded-xl font-bold bg-[var(--color-primary)] text-white dark:text-black hover:brightness-110 active:scale-95 transition-all shadow-lg shadow-indigo-500/30 disabled:opacity-50 disabled:shadow-none disabled:cursor-not-allowed flex items-center gap-2",children:[de.size>0&&r.jsx("span",{className:"flex items-center justify-center bg-white/20 text-white dark:text-black w-5 h-5 rounded-full text-[10px]",children:de.size}),r.jsx("span",{children:"Start Schedule"})]})]})]})}),Ee&&r.jsx("div",{className:"fixed z-[70] pointer-events-none animate-fade-in",style:{left:`${Ee.x}px`,top:`${Ee.y}px`,maxWidth:"320px"},children:r.jsxs("div",{className:"bg-[var(--color-surface-card)] rounded-xl shadow-2xl border border-[var(--color-surface-border)] p-4 backdrop-blur-sm",children:[r.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[r.jsx("div",{className:`
                                p-2 rounded-lg shrink-0
                                ${Ee.item.status?"bg-purple-100 dark:bg-purple-900/30 text-purple-600":"bg-blue-100 dark:bg-blue-900/30 text-blue-600"}
                            `,children:r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:Ee.item.status!==void 0?"bug_report":"check_circle"})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("h4",{className:"font-bold text-sm mb-1 line-clamp-2",children:Ee.item.title}),r.jsxs("div",{className:"flex items-center gap-2 text-xs text-[var(--color-text-muted)]",children:[r.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-bold ${Ee.item.priority==="Urgent"?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":Ee.item.priority==="High"?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400":Ee.item.priority==="Medium"?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400":"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400"}`,children:Ee.item.priority||"Low"}),r.jsx("span",{className:"text-[10px] opacity-60",children:""}),r.jsx("span",{children:Ee.item.status!==void 0?`Issue: ${Ee.item.status}`:`Task: ${Ee.item.status||"Open"}`})]})]})]}),(Ee.item.description||Ee.item.description)&&r.jsx("p",{className:"text-xs text-[var(--color-text-muted)] line-clamp-3 mb-3 leading-relaxed",children:Ee.item.description||Ee.item.description}),r.jsxs("div",{className:"flex items-center justify-between text-xs pt-3 border-t border-[var(--color-surface-border)]",children:[r.jsxs("div",{className:"flex items-center gap-1 text-[var(--color-text-muted)]",children:[r.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"schedule"}),r.jsx("span",{children:Ee.item.scheduledDate?$n(new Date(Ee.item.scheduledDate),"MMM d, HH:mm"):Ee.item.dueDate?$n(new Date(Ee.item.dueDate),"MMM d, HH:mm"):"No date"})]}),(((un=Ee.item.assigneeIds)==null?void 0:un.length)>0||Ee.item.assigneeId)&&r.jsxs("div",{className:"flex items-center gap-1 text-[var(--color-text-muted)]",children:[r.jsx("span",{className:"material-symbols-outlined text-[14px]",children:"person"}),r.jsx("span",{className:"text-[10px]",children:"Assigned"})]})]})]})})]})]})},$M=({isOpen:t,onClose:e,onCreate:s})=>{const[o,i]=w.useState(""),[c,u]=w.useState(""),[m,h]=w.useState("#3b82f6"),[x,v]=w.useState(!1),b=async T=>{if(T.preventDefault(),!!o.trim())try{v(!0),await s(o,c,m),e(),i(""),u(""),h("#3b82f6")}catch(_){console.error(_)}finally{v(!1)}},N=["#ef4444","#f97316","#f59e0b","#10b981","#3b82f6","#6366f1","#8b5cf6","#ec4899"];return r.jsx(_r,{isOpen:t,onClose:e,title:"Create New Group",children:r.jsxs("form",{onSubmit:b,className:"flex flex-col gap-4",children:[r.jsx(st,{label:"Group Name",value:o,onChange:T=>i(T.target.value),placeholder:"e.g. Designers, Backend Team",required:!0}),r.jsx(An,{label:"Description (Optional)",value:c,onChange:T=>u(T.target.value),placeholder:"What is this group for?"}),r.jsxs("div",{className:"flex flex-col gap-2",children:[r.jsx("label",{className:"text-sm font-medium text-[var(--color-text-secondary)]",children:"Group Color"}),r.jsx("div",{className:"flex gap-2 flex-wrap",children:N.map(T=>r.jsx("button",{type:"button",onClick:()=>h(T),className:`w-8 h-8 rounded-full border-2 transition-transform ${m===T?"border-[var(--color-text-main)] scale-110":"border-transparent hover:scale-105"}`,style:{backgroundColor:T}},T))})]}),r.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[r.jsx(Ne,{type:"button",variant:"ghost",onClick:e,disabled:x,children:"Cancel"}),r.jsx(Ne,{type:"submit",variant:"primary",disabled:x||!o.trim(),children:x?"Creating...":"Create Group"})]})]})})},YM=()=>{const t=dn(),[e,s]=w.useState([]),[o,i]=w.useState([]),[c,u]=w.useState([]),[m,h]=w.useState([]),[x,v]=w.useState({}),[b,N]=w.useState(!1),[T,_]=w.useState(!1),[I,E]=w.useState("projects"),[D,z]=w.useState({}),A=w.useMemo(()=>{var Y;return Ar()||((Y=xe.currentUser)==null?void 0:Y.uid)||""},[]),{can:M,isAdmin:B}=Um(),L=BA(),{showError:X,showSuccess:de}=vd();w.useEffect(()=>{if(!A)return;const Y=ba(J=>{const we=J.map(be=>({...be,uid:be.id,role:be.role||"Member",groupIds:be.groupIds||[]}));s(we)},A),ye=cy(i,A),je=uy(h,A);return xm().then(u).catch(J=>console.error("Failed to fetch shared projects",J)),()=>{Y(),ye(),je()}},[A]),w.useEffect(()=>{const Y=[...o,...c].flatMap(be=>(be.members||[]).map(Ae=>({id:typeof Ae=="string"?Ae:Ae.userId,tenantId:be.tenantId}))),ye=new Set(e.map(be=>be.id)),je=Y.filter(be=>!ye.has(be.id)&&!x[be.id]),J=Array.from(new Map(je.map(be=>[be.id,be])).values());if(J.length===0)return;(async()=>{const be={...x};let me=!1;for(const{id:Ae,tenantId:De}of J)if(De)try{const Ee=await Mn(Ae,De);Ee&&(be[Ae]={...Ee,id:Ae},me=!0)}catch(Ee){console.error(`Failed to fetch profile for ${Ae} in tenant ${De}`,Ee)}me&&v(be)})()},[o,c,e]);const{projectGroups:V,workspaceUsers:Z}=w.useMemo(()=>{const Y=new Set,J=[...o,...c].map(be=>{const Ae=(be.members||[]).map(De=>typeof De=="string"?De:De.userId).map(De=>e.find(Ee=>Ee.id===De)||x[De]).filter(De=>!!De);return{project:be,users:Ae}}).filter(be=>be.users.length>0);J.forEach(be=>{be.users.forEach(me=>{e.find(Ae=>Ae.id===me.id)&&Y.add(me.id)})});const we=e.filter(be=>!Y.has(be.id));return{projectGroups:J,workspaceUsers:we}},[e,o,c,x]),K=async(Y,ye)=>{if(M("canManageMembers"))try{await dy(Y,ye,A)}catch(je){console.error("Failed to update role",je),X("Failed to update role")}},F=async(Y,ye,je)=>{try{await fy(Y,je,ye,A),de("Group created")}catch(J){console.error(J),X("Failed to create group")}},le=async Y=>{if(await L("Delete Group","Are you sure you want to delete this group?"))try{await my(Y,A)}catch(ye){console.error(ye)}},he=async Y=>{const ye=D[Y];if(ye)try{await py(ye,Y,A),z(je=>({...je,[Y]:""}))}catch(je){console.error(je)}},re=async(Y,ye)=>{if(await L("Remove Member","Remove user from group?"))try{await Sm(ye,Y,A)}catch(je){console.error(je)}},q=async(Y,ye,je)=>{if(await L("Remove Member","Are you sure you want to remove this member from the project?"))try{await $c(Y,ye,je||A),de("Member removed from project")}catch(J){console.error("Failed to remove member from project:",J),X(J.message||"Failed to remove member")}},H=async Y=>{if(await L("Remove User","Are you sure you want to remove this user from the workspace? This will remove them from all groups."))try{await hy(Y,A),de("User removed from workspace")}catch(ye){console.error("Failed to remove user from workspace:",ye),X(ye.message||"Failed to remove user")}},R=async(Y,ye,je,J)=>{try{await yy(Y,ye,je,J||A),de(`Role updated to ${je}`)}catch(we){console.error(we),X(we.message||"Failed to update project role")}},ue=(Y,ye,je=!1,J,we,be)=>{var me,Ae,De;return r.jsxs("div",{className:"flex items-center gap-4 px-4 py-3 hover:bg-[var(--color-surface-hover)] transition-colors rounded-lg group",children:[r.jsx("div",{className:"w-10 h-10 rounded-full bg-center bg-cover bg-gray-200 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 shrink-0",style:{backgroundImage:Y.photoURL?`url("${Y.photoURL}")`:"none"},children:!Y.photoURL&&r.jsx("div",{className:"w-full h-full flex items-center justify-center text-[var(--color-text-subtle)] font-bold",children:(Y.displayName||"?").charAt(0).toUpperCase()})}),r.jsxs("div",{className:"flex flex-col min-w-0 flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-semibold text-[var(--color-text-main)] truncate",children:Y.displayName||"Member"}),Y.id===A&&r.jsx("span",{className:"px-2 py-0.5 text-[10px] font-bold uppercase tracking-wider rounded-md bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-400",children:"Workspace Owner"}),ye&&r.jsx("span",{className:"px-2 py-0.5 text-[10px] font-bold uppercase tracking-wider rounded-md bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-400",children:ye}),Y.id===((me=xe.currentUser)==null?void 0:me.uid)&&r.jsx("span",{className:"px-2 py-0.5 text-[10px] font-bold uppercase tracking-wider rounded-md bg-gray-100 dark:bg-gray-800 text-gray-500",children:"You"})]}),r.jsxs("div",{className:"flex items-center gap-2 text-xs text-[var(--color-text-subtle)] mt-1 flex-wrap",children:[r.jsx("span",{className:"truncate",children:Y.email||Y.id}),Y.groupIds&&Y.groupIds.map(Ee=>{const ut=m.find(He=>He.id===Ee);return ut?r.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-medium text-white",style:{backgroundColor:ut.color||"#9ca3af"},children:ut.name},Ee):null})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[je&&(we||M("canManageMembers")&&Y.id!==A)&&r.jsx("div",{className:"w-32",children:r.jsx(xn,{value:we?ye||"Viewer":Y.role||"Member",onChange:Ee=>we?we(Ee.target.value):K(Y.id,Ee.target.value),disabled:Y.id===((Ae=xe.currentUser)==null?void 0:Ae.uid)&&!we,children:be?be.map(Ee=>r.jsx("option",{value:Ee.value,children:Ee.label},Ee.value)):r.jsxs(r.Fragment,{children:[r.jsx("option",{value:"Admin",children:"Admin"}),r.jsx("option",{value:"Member",children:"Member"}),r.jsx("option",{value:"Guest",children:"Guest"})]})})}),(!je||!we&&(!M("canManageMembers")||Y.id===A))&&!ye&&r.jsx("span",{className:"text-xs font-medium text-[var(--color-text-muted)] border px-2 py-1 rounded",children:Y.role||"Member"}),J&&Y.id!==((De=xe.currentUser)==null?void 0:De.uid)&&Y.id!==A&&r.jsx("button",{onClick:J,className:"text-[var(--color-text-subtle)] hover:text-rose-500 transition-colors opacity-0 group-hover:opacity-100",title:"Remove member",children:r.jsx("span",{className:"material-symbols-outlined",children:"delete"})})]})]},Y.id)};return r.jsxs("div",{className:"max-w-5xl mx-auto p-6 flex flex-col gap-8 animate-fade-in",children:[r.jsxs("div",{className:"flex items-center justify-between gap-4 flex-wrap",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("span",{className:"material-symbols-outlined text-[var(--color-primary)]",children:"groups"}),r.jsx("span",{className:"text-xs font-bold uppercase tracking-wider text-[var(--color-primary)]",children:"Workspace"})]}),r.jsx("h1",{className:"h2 text-[var(--color-text-main)]",children:"Team"}),r.jsx("p",{className:"text-[var(--color-text-muted)]",children:"Manage your team, permissions, and groups."})]}),r.jsx("div",{children:M("canManageMembers")&&r.jsx(Ne,{onClick:()=>N(!0),variant:"primary",icon:r.jsx("span",{className:"material-symbols-outlined",children:"person_add"}),children:"Invite Member"})})]}),r.jsx("div",{className:"flex items-center gap-1 border-b border-[var(--color-border)]",children:[{id:"projects",label:"By Project",icon:"folder"},{id:"groups",label:"Groups",icon:"diversity_3"},{id:"members",label:"All Members",icon:"group"}].map(Y=>r.jsxs("button",{onClick:()=>E(Y.id),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium border-b-2 transition-colors ${I===Y.id?"border-[var(--color-primary)] text-[var(--color-primary)]":"border-transparent text-[var(--color-text-muted)] hover:text-[var(--color-text-main)]"}`,children:[r.jsx("span",{className:"material-symbols-outlined text-[18px]",children:Y.icon}),Y.label]},Y.id))}),I==="projects"&&r.jsxs("div",{className:"flex flex-col gap-8",children:[V.map(Y=>r.jsxs("section",{children:[r.jsxs("div",{className:"flex items-center justify-between mb-3 px-1",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-8 h-8 rounded bg-[var(--color-primary)]/10 text-[var(--color-primary)] flex items-center justify-center",children:r.jsx("span",{className:"material-symbols-outlined text-lg",children:"folder"})}),r.jsx("h3",{className:"text-base font-bold text-[var(--color-text-main)]",children:Y.project.title||"Untitled Project"})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(Ne,{size:"sm",variant:"outline",onClick:()=>t(`/project/${Y.project.id}`),icon:r.jsx("span",{className:"material-symbols-outlined",children:"arrow_forward"}),children:"Go to Project"}),r.jsxs("span",{className:"text-xs font-medium bg-[var(--color-surface-paper)] px-2 py-0.5 rounded-full text-[var(--color-text-muted)] border border-[var(--color-surface-border)]",children:[Y.users.length," members"]})]})]}),r.jsx(Be,{padding:"none",className:"flex flex-col gap-1 p-1",children:Y.users.length>0?Y.users.map(ye=>{var Ee;const J=(Y.project.members||[]).find(ut=>(typeof ut=="object"?ut.userId:ut)===ye.id),we=ye.id===Y.project.ownerId,be=we?"Owner":typeof J=="object"?J.role:void 0,Ae=Y.project.ownerId===((Ee=xe.currentUser)==null?void 0:Ee.uid)||B,De=Ae&&!we;return ue(ye,be,Ae,De&&!we?()=>q(Y.project.id,ye.id,Y.project.tenantId):void 0,De?ut=>R(Y.project.id,ye.id,ut,Y.project.tenantId):void 0,[{label:"Owner",value:"Owner"},{label:"Editor",value:"Editor"},{label:"Viewer",value:"Viewer"}])}):r.jsx("div",{className:"p-4 text-sm text-[var(--color-text-muted)] italic",children:"No members assigned"})})]},Y.project.id)),Z.length>0&&r.jsxs("section",{children:[r.jsxs("div",{className:"flex items-center gap-3 mb-3 px-1",children:[r.jsx("span",{className:"material-symbols-outlined text-gray-400",children:"domain"}),r.jsx("h3",{className:"text-base font-bold text-[var(--color-text-main)]",children:"Unassigned Members"})]}),r.jsx(Be,{padding:"none",className:"flex flex-col gap-1 p-1",children:Z.map(Y=>ue(Y,void 0,!1,M("canManageMembers")?()=>H(Y.id):void 0))})]})]}),I==="groups"&&r.jsxs("div",{className:"flex flex-col gap-6",children:[M("canManageGroups")&&r.jsx("div",{className:"flex justify-end",children:r.jsx(Ne,{onClick:()=>_(!0),variant:"outline",icon:r.jsx("span",{className:"material-symbols-outlined",children:"add"}),children:"Create Group"})}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[m.map(Y=>{const ye=e.filter(J=>{var we;return(we=Y.memberIds)==null?void 0:we.includes(J.id)}),je=e.filter(J=>{var we;return!((we=Y.memberIds)!=null&&we.includes(J.id))});return r.jsxs(Be,{className:"flex flex-col h-full",children:[r.jsxs("div",{className:"flex justify-between items-start mb-4",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:Y.color}}),r.jsx("h3",{className:"font-bold text-lg",children:Y.name})]}),Y.description&&r.jsx("p",{className:"text-sm text-[var(--color-text-muted)] leading-relaxed",children:Y.description})]}),M("canManageGroups")&&r.jsx("button",{onClick:()=>le(Y.id),className:"text-[var(--color-text-subtle)] hover:text-rose-500 transition-colors",title:"Delete Group",children:r.jsx("span",{className:"material-symbols-outlined",children:"delete"})})]}),r.jsxs("div",{className:"flex-1 flex flex-col gap-3",children:[r.jsx("div",{className:"text-xs font-semibold uppercase tracking-wider text-[var(--color-text-muted)] border-b border-[var(--color-border)] pb-2 flex justify-between items-center",children:r.jsxs("span",{children:["Members (",ye.length,")"]})}),r.jsx("div",{className:"flex flex-col gap-2 max-h-48 overflow-y-auto pr-1",children:ye.length>0?ye.map(J=>r.jsxs("div",{className:"flex items-center justify-between group/item p-1 hover:bg-[var(--color-surface-hover)] rounded",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-6 h-6 rounded-full bg-gray-200 bg-center bg-cover",style:{backgroundImage:J.photoURL?`url(${J.photoURL})`:void 0}}),r.jsx("span",{className:"text-sm truncate max-w-[120px]",children:J.displayName})]}),M("canManageGroups")&&r.jsx("button",{onClick:()=>re(Y.id,J.id),className:"opacity-0 group-hover/item:opacity-100 text-rose-500 hover:text-rose-700 transition-opacity",children:r.jsx("span",{className:"material-symbols-outlined text-base",children:"remove_circle"})})]},J.id)):r.jsx("p",{className:"text-sm text-[var(--color-text-subtle)] italic",children:"No members yet."})}),M("canManageGroups")&&r.jsxs("div",{className:"mt-auto pt-4 flex gap-2",children:[r.jsx("div",{className:"flex-1",children:r.jsxs(xn,{value:D[Y.id]||"",onChange:J=>z(we=>({...we,[Y.id]:J.target.value})),placeholder:"Add user...",children:[r.jsx("option",{value:"",disabled:!0,children:"Select User"}),je.map(J=>r.jsx("option",{value:J.id,children:J.displayName},J.id))]})}),r.jsx(Ne,{size:"sm",disabled:!D[Y.id],onClick:()=>he(Y.id),icon:r.jsx("span",{className:"material-symbols-outlined",children:"add"}),children:"Add"})]})]})]},Y.id)}),m.length===0&&r.jsx("div",{className:"col-span-full text-center p-8 text-[var(--color-text-muted)] border-2 border-dashed border-[var(--color-border)] rounded-xl",children:r.jsx("p",{children:"No groups created yet."})})]})]}),I==="members"&&r.jsx("div",{children:r.jsx(Be,{padding:"none",className:"flex flex-col gap-1 p-1",children:e.map(Y=>ue(Y,void 0,!0,M("canManageMembers")?()=>H(Y.id):void 0))})}),r.jsx(zb,{isOpen:b,onClose:()=>N(!1),projectTitle:"Workspace",isWorkspace:!0,onGenerateLink:async(Y,ye,je)=>q0(Y,ye,je,A)}),r.jsx($M,{isOpen:T,onClose:()=>_(!1),onCreate:F})]})},JM=()=>{const{tenantId:t}=Yn(),e=dn(),[s,o]=w.useState(null);w.useEffect(()=>{(async()=>{if(!(!t||!xe.currentUser))try{o("Joining workspace..."),await id(t),o("Joined! Redirecting..."),e("/")}catch(u){console.error(u),o("Could not join automatically. Try again.")}})()},[t,e]);const i=()=>{if(!t)return;gl(t);const c=window.location.pathname+window.location.search;e(`/login?redirect=${encodeURIComponent(c)}`,{state:{inviteTenantId:t}})};return t?r.jsx("div",{className:"min-h-screen flex items-center justify-center px-6",children:r.jsxs("div",{className:"app-panel max-w-md w-full p-8 space-y-4 animate-fade-up",children:[r.jsx("span",{className:"app-pill w-fit",children:"Invitation"}),r.jsx("h1",{className:"text-2xl font-display font-bold text-ink",children:"Join this Team"}),r.jsxs("p",{className:"text-muted text-sm",children:["You have been invited to join workspace ",r.jsx("span",{className:"font-semibold text-ink",children:t}),"."]}),s&&r.jsx("div",{className:"text-sm text-muted",children:s}),!xe.currentUser&&r.jsx("button",{onClick:i,className:"w-full h-11 btn-primary font-bold text-sm",children:"Accept & Continue"}),xe.currentUser&&r.jsx("p",{className:"text-sm text-muted",children:"You are signed in. Attempting to join automatically..."})]})}):r.jsx("div",{className:"p-8 text-center",children:"Invalid invite link."})},XM=()=>{const{projectId:t}=Yn(),[e]=xl(),s=e.get("tenantId"),o=dn(),[i,c]=w.useState(null);w.useEffect(()=>{(async()=>{if(!(!t||!s||!xe.currentUser))try{c("Joining workspace..."),await id(s),c("Joining project team..."),await G0(t,s),c("Success! Redirecting..."),o(`/project/${t}`)}catch(h){console.error(h),c(`Failed to join: ${h.message}`)}})()},[t,s,o]);const u=()=>{if(!s)return;gl(s);const m=window.location.pathname+window.location.search;o(`/login?redirect=${encodeURIComponent(m)}`,{state:{from:m,inviteTenantId:s}})};return!t||!s?r.jsx("div",{className:"p-8 text-center",children:"Invalid project invite link."}):r.jsx("div",{className:"min-h-screen flex items-center justify-center px-6",children:r.jsxs("div",{className:"app-panel max-w-md w-full p-8 space-y-4 animate-fade-up",children:[r.jsx("span",{className:"app-pill w-fit animate-pulse",children:"Checking Access..."}),r.jsx("h1",{className:"text-2xl font-display font-bold text-ink",children:"Join Project"}),r.jsxs("p",{className:"text-muted text-sm",children:["You have been invited to collaborate on a project in workspace ",r.jsx("span",{className:"font-semibold text-ink",children:s}),"."]}),i&&r.jsx("div",{className:"p-3 bg-indigo-50 text-indigo-700 rounded-lg text-sm font-medium",children:i}),!xe.currentUser&&r.jsx("div",{className:"pt-4",children:r.jsx("button",{onClick:u,className:"w-full h-11 btn-primary font-bold text-sm",children:"Log In to Accept"})}),xe.currentUser&&!i&&r.jsx("p",{className:"text-sm text-muted",children:"You are signed in. We are adding you to the team..."})]})})},KM=()=>{const{inviteLinkId:t}=Yn(),[e]=xl(),s=dn(),o=w.useRef(!1),[i,c]=w.useState("loading"),[u,m]=w.useState(""),[h,x]=w.useState("");return w.useEffect(()=>{(async()=>{if(o.current)return;if(!xe.currentUser){const T=window.location.href;s(`/login?redirect=${encodeURIComponent(T)}`);return}if(o.current=!0,!t){m("Invalid invite link"),c("error");return}const b=e.get("projectId"),N=e.get("tenantId");if(!b||!N){m("Invalid invite link - missing parameters"),c("error");return}try{c("loading"),await O0(t,b,N),x(b),c("success"),setTimeout(()=>{s(`/project/${b}`)},1500)}catch(T){console.error("Failed to join project:",T),T.message&&T.message.includes("already a member")?(x(b),c("success"),setTimeout(()=>{s(`/project/${b}`)},1500)):(m(T.message||"Failed to join project"),c("error"))}})()},[t,e,s]),r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[var(--color-surface-bg)] p-4",children:r.jsxs("div",{className:"max-w-md w-full",children:[i==="loading"&&r.jsxs("div",{className:"bg-[var(--color-surface-paper)] rounded-2xl shadow-xl p-8 text-center",children:[r.jsx("div",{className:"size-16 mx-auto mb-4 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center",children:r.jsx("span",{className:"material-symbols-outlined text-3xl text-blue-600 dark:text-blue-400 animate-spin",children:"progress_activity"})}),r.jsx("h2",{className:"text-2xl font-bold text-[var(--color-text-main)] mb-2",children:"Joining Project..."}),r.jsx("p",{className:"text-[var(--color-text-muted)]",children:"Please wait while we add you to the project."})]}),i==="success"&&r.jsxs("div",{className:"bg-[var(--color-surface-paper)] rounded-2xl shadow-xl p-8 text-center",children:[r.jsx("div",{className:"size-16 mx-auto mb-4 rounded-full bg-emerald-100 dark:bg-emerald-900/30 flex items-center justify-center",children:r.jsx("span",{className:"material-symbols-outlined text-3xl text-emerald-600 dark:text-emerald-400",children:"check_circle"})}),r.jsx("h2",{className:"text-2xl font-bold text-[var(--color-text-main)] mb-2",children:"Successfully Joined!"}),r.jsx("p",{className:"text-[var(--color-text-muted)] mb-4",children:"You've been added to the project. Redirecting..."}),r.jsx("div",{className:"h-1 bg-[var(--color-surface-hover)] rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full bg-emerald-500 animate-pulse",style:{width:"100%"}})})]}),i==="error"&&r.jsxs("div",{className:"bg-[var(--color-surface-paper)] rounded-2xl shadow-xl p-8 text-center",children:[r.jsx("div",{className:"size-16 mx-auto mb-4 rounded-full bg-rose-100 dark:bg-rose-900/30 flex items-center justify-center",children:r.jsx("span",{className:"material-symbols-outlined text-3xl text-rose-600 dark:text-rose-400",children:"error"})}),r.jsx("h2",{className:"text-2xl font-bold text-[var(--color-text-main)] mb-2",children:"Unable to Join"}),r.jsx("p",{className:"text-[var(--color-text-muted)] mb-6",children:u}),r.jsxs("div",{className:"flex gap-3 justify-center",children:[r.jsx("button",{onClick:()=>s("/projects"),className:"px-6 py-2 rounded-lg bg-[var(--color-primary)] text-white font-semibold hover:opacity-90 transition-opacity",children:"Go to Projects"}),r.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-2 rounded-lg border border-[var(--color-surface-border)] text-[var(--color-text-main)] font-semibold hover:bg-[var(--color-surface-hover)] transition-colors",children:"Try Again"})]})]})]})})},WM=()=>{const{inviteLinkId:t}=Yn(),[e]=xl(),s=dn(),o=w.useRef(!1),[i,c]=w.useState("loading"),[u,m]=w.useState("");return w.useEffect(()=>{(async()=>{if(o.current)return;if(!xe.currentUser){const v=window.location.href;s(`/login?redirect=${encodeURIComponent(v)}`);return}if(o.current=!0,!t){m("Invalid invite link"),c("error");return}const x=e.get("tenantId");if(!x){m("Invalid invite link - missing parameters"),c("error");return}try{c("loading"),await V0(t,x),c("success"),setTimeout(()=>{s("/")},1500)}catch(v){console.error("Failed to join workspace:",v),m(v.message||"Failed to join workspace"),c("error")}})()},[t,e,s]),r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[var(--color-surface-bg)] p-4",children:r.jsxs("div",{className:"max-w-md w-full",children:[i==="loading"&&r.jsxs("div",{className:"bg-[var(--color-surface-paper)] rounded-2xl shadow-xl p-8 text-center",children:[r.jsx("div",{className:"size-16 mx-auto mb-4 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center",children:r.jsx("span",{className:"material-symbols-outlined text-3xl text-blue-600 dark:text-blue-400 animate-spin",children:"progress_activity"})}),r.jsx("h2",{className:"text-2xl font-bold text-[var(--color-text-main)] mb-2",children:"Joining Workspace..."}),r.jsx("p",{className:"text-[var(--color-text-muted)]",children:"Please wait while we add you to the workspace."})]}),i==="success"&&r.jsxs("div",{className:"bg-[var(--color-surface-paper)] rounded-2xl shadow-xl p-8 text-center",children:[r.jsx("div",{className:"size-16 mx-auto mb-4 rounded-full bg-emerald-100 dark:bg-emerald-900/30 flex items-center justify-center",children:r.jsx("span",{className:"material-symbols-outlined text-3xl text-emerald-600 dark:text-emerald-400",children:"check_circle"})}),r.jsx("h2",{className:"text-2xl font-bold text-[var(--color-text-main)] mb-2",children:"Successfully Joined!"}),r.jsx("p",{className:"text-[var(--color-text-muted)] mb-4",children:"You've been added to the workspace. Redirecting..."}),r.jsx("div",{className:"h-1 bg-[var(--color-surface-hover)] rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full bg-emerald-500 animate-pulse",style:{width:"100%"}})})]}),i==="error"&&r.jsxs("div",{className:"bg-[var(--color-surface-paper)] rounded-2xl shadow-xl p-8 text-center",children:[r.jsx("div",{className:"size-16 mx-auto mb-4 rounded-full bg-rose-100 dark:bg-rose-900/30 flex items-center justify-center",children:r.jsx("span",{className:"material-symbols-outlined text-3xl text-rose-600 dark:text-rose-400",children:"error"})}),r.jsx("h2",{className:"text-2xl font-bold text-[var(--color-text-main)] mb-2",children:"Unable to Join"}),r.jsx("p",{className:"text-[var(--color-text-muted)] mb-6",children:u}),r.jsxs("div",{className:"flex gap-3 justify-center",children:[r.jsx("button",{onClick:()=>s("/"),className:"px-6 py-2 rounded-lg bg-[var(--color-primary)] text-white font-semibold hover:opacity-90 transition-opacity",children:"Go to Dashboard"}),r.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-2 rounded-lg border border-[var(--color-surface-border)] text-[var(--color-text-main)] font-semibold hover:bg-[var(--color-surface-hover)] transition-colors",children:"Try Again"})]})]})]})})},QM=()=>{const t=xe.currentUser,[e,s]=w.useState((t==null?void 0:t.displayName)||""),[o,i]=w.useState(""),[c,u]=w.useState(""),[m,h]=w.useState((t==null?void 0:t.photoURL)||""),[x,v]=w.useState(null),[b,N]=w.useState(!1),[T,_]=w.useState(!1),[I,E]=w.useState(null),[D,z]=w.useState({x:0,y:0}),[A,M]=w.useState(1),[B,L]=w.useState(null);w.useEffect(()=>{if(!t)return;const K=Ar();if(K){N(!0);const F=ba(le=>{const he=le.find(re=>re.id===t.uid);he&&(i(he.title||""),u(he.bio||"")),N(!1)},K);return()=>F()}},[t]);const X=K=>{if(K.target.files&&K.target.files[0]){const F=K.target.files[0],le=new FileReader;le.onload=()=>{E(le.result)},le.readAsDataURL(F)}K.target.value=""},de=w.useCallback((K,F)=>{L(F)},[]),V=w.useCallback(async()=>{if(!(!I||!B))try{const K=await Sb(I,B);if(K){const F=new File([K],"avatar.jpg",{type:"image/jpeg"});v(F),h(URL.createObjectURL(K)),E(null)}}catch(K){console.error(K)}},[I,B]),Z=async()=>{_(!0);try{const K=await sy({displayName:e,title:o,bio:c,file:x||void 0});K&&h(K),alert("Profile updated successfully!")}catch(K){console.error(K),alert(`Failed to update profile: ${K.message}`)}finally{_(!1)}};return t?r.jsxs("div",{className:"max-w-2xl mx-auto p-6 fade-in space-y-6",children:[r.jsx("h1",{className:"h2 text-[var(--color-text-main)]",children:"My Profile"}),r.jsxs(Be,{className:"p-8 space-y-8",children:[r.jsxs("div",{className:"flex flex-col items-center gap-4",children:[r.jsxs("div",{className:"relative group",children:[r.jsx("div",{className:"size-32 rounded-full overflow-hidden border-4 border-[var(--color-surface-bg)] shadow-lg bg-gray-100 dark:bg-gray-800",children:m?r.jsx("img",{src:m,alt:"Profile",className:"w-full h-full object-cover"}):r.jsx("div",{className:"w-full h-full flex items-center justify-center text-4xl font-bold text-gray-300",children:e[0]})}),r.jsxs("label",{className:"absolute bottom-0 right-0 p-2 bg-[var(--color-primary)] text-white rounded-full cursor-pointer hover:bg-[var(--color-primary-dark)] shadow transition-colors",children:[r.jsx("span",{className:"material-symbols-outlined text-[20px]",children:"photo_camera"}),r.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:X})]})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("h2",{className:"text-xl font-bold text-[var(--color-text-main)]",children:e||"User"}),r.jsx("p",{className:"text-[var(--color-text-muted)]",children:t.email})]})]}),r.jsxs("div",{className:"space-y-4 max-w-lg mx-auto w-full",children:[r.jsx(st,{label:"Display Name",value:e,onChange:K=>s(K.target.value),placeholder:"How your name appears to others"}),r.jsx(st,{label:"Job Title",value:o,onChange:K=>i(K.target.value),placeholder:"e.g. Senior Developer"}),r.jsx(An,{label:"Bio",value:c,onChange:K=>u(K.target.value),placeholder:"Tell a bit about yourself...",rows:4}),r.jsx("div",{className:"pt-4 flex justify-end",children:r.jsx(Ne,{onClick:Z,loading:T,children:"Save Changes"})})]})]}),I&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4",children:r.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl overflow-hidden w-full max-w-md flex flex-col max-h-[90vh]",children:[r.jsxs("div",{className:"p-4 border-b dark:border-gray-800 flex justify-between items-center",children:[r.jsx("h3",{className:"font-bold",children:"Crop Profile Photo"}),r.jsx("button",{onClick:()=>E(null),className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-full",children:r.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),r.jsx("div",{className:"relative h-64 sm:h-80 bg-black",children:r.jsx(Nb,{image:I,crop:D,zoom:A,aspect:1,cropShape:"round",showGrid:!1,onCropChange:z,onCropComplete:de,onZoomChange:M})}),r.jsxs("div",{className:"p-4 space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Zoom"}),r.jsx("input",{type:"range",value:A,min:1,max:3,step:.1,"aria-labelledby":"Zoom",onChange:K=>M(Number(K.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer mt-2"})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx(Ne,{variant:"secondary",onClick:()=>E(null),className:"flex-1",children:"Cancel"}),r.jsx(Ne,{onClick:V,className:"flex-1",children:"Apply Crop"})]})]})]})})]}):r.jsx("div",{children:"Please login."})},ZM=()=>{const[t,e]=w.useState("general"),[s,o]=w.useState({}),[i,c]=w.useState(!0),[u,m]=w.useState(!1),[h,x]=w.useState(null),[v,b]=w.useState(null),[N,T]=w.useState(""),[_,I]=w.useState(""),[E,D]=w.useState(""),[z,A]=w.useState(""),[M,B]=w.useState(!1),[L,X]=w.useState(""),[de,V]=w.useState(!1);w.useEffect(()=>{const he=async()=>{var q;try{const H=Ar()||((q=xe.currentUser)==null?void 0:q.uid);if(!H)return;x(H);const R=await M0(H);R&&(o(R),T(R.name||""),I(R.description||""),D(R.website||""),A(R.contactEmail||""))}catch(H){console.error("Failed to load settings",H)}finally{c(!1)}},re=async()=>{const q=xe.currentUser;if(q){const H=await vl(q.uid);b(H);const R=await Mn(q.uid);R!=null&&R.githubToken&&(B(!0),X(R.githubToken))}};he(),re()},[]);const Z=async()=>{if(h){m(!0);try{await R0(h,{name:N,description:_,website:E,contactEmail:z}),alert("Settings saved successfully!")}catch(he){console.error("Failed to save settings",he),alert("Failed to save settings. Please try again.")}finally{m(!1)}}},K=async()=>{const he=xe.currentUser;if(he){V(!0);try{const re=await fm();await ni(he.uid,{githubToken:re}),X(re),B(!0),alert("GitHub account linked successfully!")}catch(re){console.error("Failed to link GitHub",re),alert(re.message||"Failed to link GitHub account.")}finally{V(!1)}}};if(i)return r.jsx("div",{className:"h-full flex items-center justify-center text-[var(--color-text-muted)]",children:"Loading settings..."});const F=()=>{switch(t){case"general":return r.jsxs("div",{className:"space-y-6 animate-fade-in",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-display font-bold text-[var(--color-text-main)]",children:"General Settings"}),r.jsx("p",{className:"text-[var(--color-text-muted)] text-sm",children:"Manage your workspace's public profile and details."})]}),r.jsxs(Be,{className:"p-6 space-y-4 max-w-2xl",children:[r.jsx(st,{label:"Team Name",value:N,onChange:he=>T(he.target.value),placeholder:"e.g. Acme Corp"}),r.jsx(An,{label:"Description",value:_,onChange:he=>I(he.target.value),placeholder:"What does your team do?",rows:3}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsx(st,{label:"Website",value:E,onChange:he=>D(he.target.value),placeholder:"https://example.com"}),r.jsx(st,{label:"Contact Email",value:z,onChange:he=>A(he.target.value),placeholder:"admin@example.com"})]}),r.jsx("div",{className:"pt-4 flex justify-end border-t border-[var(--color-surface-border)]",children:r.jsx(Ne,{onClick:Z,loading:u,children:"Save Changes"})})]})]});case"integrations":return r.jsxs("div",{className:"space-y-6 animate-fade-in",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-display font-bold text-[var(--color-text-main)]",children:"Integrations"}),r.jsx("p",{className:"text-[var(--color-text-muted)] text-sm",children:"Connect your personal account with third-party tools."})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[r.jsxs(Be,{className:"p-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"size-12 bg-zinc-900 rounded-xl flex items-center justify-center text-white",children:r.jsx("span",{className:"material-symbols-outlined text-2xl",children:"terminal"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-bold text-[var(--color-text-main)]",children:"GitHub"}),r.jsx("p",{className:"text-sm text-[var(--color-text-muted)]",children:"Link your account to browse and connect repositories."})]})]}),r.jsx("div",{className:`px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider ${M?"bg-emerald-100 text-emerald-700 dark:bg-emerald-500/10 dark:text-emerald-400":"bg-zinc-100 text-zinc-500 dark:bg-zinc-800"}`,children:M?"Connected":"Not Connected"})]}),r.jsxs("div",{className:"space-y-4 pt-4 border-t border-[var(--color-surface-border)]",children:[r.jsx("div",{className:"flex gap-3",children:M?r.jsxs(r.Fragment,{children:[r.jsx(Ne,{variant:"secondary",onClick:K,loading:de,children:"Reconnect Account"}),r.jsx(Ne,{variant:"ghost",onClick:async()=>{X(""),B(!1),await ni(xe.currentUser.uid,{githubToken:""})},children:"Disconnect"})]}):r.jsx(Ne,{onClick:K,loading:de,children:"Connect GitHub"})}),r.jsx("p",{className:"text-[10px] text-[var(--color-text-muted)]",children:"We use this connection to list your repositories and create issues on your behalf."})]})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 opacity-50",children:["Slack","Notion","Google Drive","Figma","Linear"].map(he=>r.jsxs(Be,{className:"p-4 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"size-10 bg-[var(--color-surface-hover)] rounded-lg flex items-center justify-center font-bold text-[var(--color-text-muted)]",children:he[0]}),r.jsx("span",{className:"font-semibold text-[var(--color-text-main)]",children:he})]}),r.jsx(Ne,{variant:"secondary",size:"sm",disabled:!0,children:"Connect"})]},he))})]})]});case"billing":return r.jsxs("div",{className:"space-y-6 animate-fade-in",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-display font-bold text-[var(--color-text-main)]",children:"Billing & Plans"}),r.jsx("p",{className:"text-[var(--color-text-muted)] text-sm",children:"Manage subscription and billing details."})]}),r.jsxs(Be,{className:"p-8 flex flex-col items-center justify-center text-center space-y-4 border-dashed",children:[r.jsx("div",{className:"size-16 bg-blue-50 dark:bg-blue-900/20 rounded-full flex items-center justify-center text-blue-500 mb-2",children:r.jsx("span",{className:"material-symbols-outlined text-3xl",children:"credit_card"})}),r.jsx("h3",{className:"text-lg font-bold",children:"Personal License"}),r.jsx("p",{className:"text-[var(--color-text-muted)] max-w-sm",children:"You are currently on the Personal plan (29.99/month). Enjoy full access to AI Studio and advanced project features."}),v&&r.jsxs("div",{className:"w-full max-w-md pt-6 border-t border-[var(--color-surface-border)] mt-4",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsxs("div",{className:"flex items-center gap-2 font-semibold text-sm",children:[r.jsx("span",{className:"material-symbols-outlined text-[18px] text-[var(--color-primary)]",children:"auto_awesome"}),"AI Usage this month"]}),r.jsxs("span",{className:"text-xs font-mono font-bold",children:[v.tokensUsed.toLocaleString()," / ",v.tokenLimit.toLocaleString()]})]}),r.jsx("div",{className:"w-full h-3 bg-zinc-100 dark:bg-zinc-800 rounded-full overflow-hidden border border-[var(--color-surface-border)]",children:r.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${v.tokensUsed/v.tokenLimit>.9?"bg-rose-500":"bg-[var(--color-primary)]"}`,style:{width:`${Math.min(100,v.tokensUsed/v.tokenLimit*100)}%`}})}),r.jsx("p",{className:"text-[10px] text-[var(--color-text-muted)] mt-2 italic",children:"Token usage resets at the beginning of each calendar month."})]}),r.jsx("div",{className:"pt-4",children:r.jsx(Ne,{disabled:!0,className:"opacity-50",children:"Manage Subscription"})})]})]});case"security":return r.jsxs("div",{className:"space-y-6 animate-fade-in",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-display font-bold text-[var(--color-text-main)]",children:"Security"}),r.jsx("p",{className:"text-[var(--color-text-muted)] text-sm",children:"Audit logs and security controls."})]}),r.jsxs(Be,{className:"divide-y divide-[var(--color-surface-border)]",children:[r.jsxs("div",{className:"p-4 flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-semibold text-[var(--color-text-main)]",children:"Two-Factor Authentication"}),r.jsx("p",{className:"text-xs text-[var(--color-text-muted)]",children:"Require 2FA for all team members."})]}),r.jsx("div",{className:"w-10 h-6 bg-[var(--color-surface-hover)] rounded-full border border-[var(--color-surface-border)] relative cursor-not-allowed",children:r.jsx("div",{className:"absolute left-1 top-1 size-4 bg-[var(--color-text-muted)] rounded-full opacity-50"})})]}),r.jsxs("div",{className:"p-4 flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"font-semibold text-[var(--color-text-main)]",children:"Single Sign-On (SSO)"}),r.jsx("p",{className:"text-xs text-[var(--color-text-muted)]",children:"Enable SAML/OIDC authentication."})]}),r.jsx("div",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-800 rounded text-[10px] font-bold uppercase text-gray-500",children:"Enterprise"})]})]})]});case"members":return r.jsxs("div",{className:"space-y-6 animate-fade-in",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-display font-bold text-[var(--color-text-main)]",children:"Team Members"}),r.jsx("p",{className:"text-[var(--color-text-muted)] text-sm",children:"Manage access and roles."})]}),r.jsxs(Be,{className:"p-8 text-center text-[var(--color-text-muted)]",children:[r.jsx("p",{children:"Members management is located in the dedicated Team page."}),r.jsx(nt,{to:"/team",className:"text-[var(--color-primary)] font-bold mt-2 inline-block hover:underline",children:"Go to Team Page"})]})]})}},le=({id:he,label:re,icon:q})=>r.jsxs("button",{onClick:()=>e(he),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-all ${t===he?"bg-[var(--color-surface-hover)] text-[var(--color-text-main)] shadow-sm":"text-[var(--color-text-muted)] hover:bg-[var(--color-surface-hover)] hover:text-[var(--color-text-main)]"}`,children:[r.jsx("span",{className:`material-symbols-outlined text-[20px] ${t===he?"text-[var(--color-primary)]":""}`,children:q}),re]});return r.jsx("div",{className:"max-w-6xl mx-auto p-4 md:p-8 animate-fade-up min-h-screen",children:r.jsxs("div",{className:"flex flex-col md:flex-row gap-8 items-start",children:[r.jsxs("aside",{className:"w-full md:w-64 shrink-0 space-y-1",children:[r.jsx("h1",{className:"text-2xl font-display font-bold text-[var(--color-text-main)] px-2 mb-6",children:"Settings"}),r.jsx(le,{id:"general",label:"General",icon:"settings"}),r.jsx(le,{id:"members",label:"Members",icon:"group"}),r.jsx(le,{id:"integrations",label:"Integrations",icon:"extension"}),r.jsx(le,{id:"billing",label:"Billing",icon:"credit_card"}),r.jsx(le,{id:"security",label:"Security",icon:"security"})]}),r.jsx("main",{className:"flex-1 w-full min-w-0",children:F()})]})})},eR=({children:t})=>{const e=ai();return xe?xe.currentUser?r.jsx(r.Fragment,{children:t}):r.jsx(Pf,{to:"/login",state:{from:e},replace:!0}):r.jsx("div",{className:"p-10 text-center",children:"Firebase Authentication is not available."})},tR=()=>{const[t,e]=w.useState(null),[s,o]=w.useState(!0),[i,c]=w.useState(null);return w.useEffect(()=>{if(!xe){c("Firebase Configuration Error: Auth service failed to initialize."),o(!1);return}try{const u=C0(xe,m=>{e(m),o(!1)});return()=>u()}catch(u){console.error("Auth State Change Error:",u),c(u.message||"Failed to connect to authentication service."),o(!1)}},[]),s?r.jsx("div",{className:"h-screen w-full flex items-center justify-center bg-[var(--color-surface-bg)]",children:r.jsxs("div",{className:"flex flex-col items-center gap-4",children:[r.jsx("span",{className:"material-symbols-outlined text-4xl animate-spin text-[var(--color-primary)]",children:"progress_activity"}),r.jsx("span",{className:"text-sm font-semibold text-[var(--color-text-muted)]",children:"Connecting to workspace..."})]})}):i?r.jsx("div",{className:"h-screen w-full flex flex-col items-center justify-center gap-4 p-4 bg-[var(--color-surface-bg)]",children:r.jsxs("div",{className:"p-6 text-center space-y-3 bg-white rounded-2xl shadow-xl border border-red-100 max-w-md",children:[r.jsx("span",{className:"material-symbols-outlined text-4xl text-rose-500",children:"error"}),r.jsx("p",{className:"text-rose-600 font-bold text-center",children:i}),r.jsx("p",{className:"text-[var(--color-text-muted)] text-sm text-center",children:"Please check the console for more details."})]})}):r.jsx(CS,{defaultTheme:"light",storageKey:"vite-ui-theme",children:r.jsxs(VA,{children:[r.jsx(XA,{}),r.jsx(KA,{}),r.jsx(Hw,{children:r.jsxs(Ow,{children:[r.jsx(Dt,{path:"/login",element:r.jsx(FM,{})}),r.jsx(Dt,{path:"/invite/:tenantId",element:r.jsx(JM,{})}),r.jsx(Dt,{path:"/invite-project/:projectId",element:r.jsx(XM,{})}),r.jsx(Dt,{path:"/join/:inviteLinkId",element:r.jsx(KM,{})}),r.jsx(Dt,{path:"/join-workspace/:inviteLinkId",element:r.jsx(WM,{})}),r.jsxs(Dt,{element:t?r.jsx(eR,{children:r.jsx(YA,{})}):r.jsx(Pf,{to:"/login",replace:!0}),children:[r.jsx(Dt,{path:"/",element:r.jsx(ek,{})}),r.jsx(Dt,{path:"/projects",element:r.jsx(ik,{})}),r.jsx(Dt,{path:"/tasks",element:r.jsx(lk,{})}),r.jsx(Dt,{path:"/calendar",element:r.jsx(BM,{})}),r.jsx(Dt,{path:"/brainstorm",element:r.jsx(Nk,{})}),r.jsx(Dt,{path:"/create",element:r.jsx(wk,{})}),r.jsx(Dt,{path:"/create/form",element:r.jsx($k,{})}),r.jsx(Dt,{path:"/team",element:r.jsx(YM,{})}),r.jsx(Dt,{path:"/profile",element:r.jsx(QM,{})}),r.jsx(Dt,{path:"/settings",element:r.jsx(ZM,{})}),r.jsxs(Dt,{path:"/project/:id",children:[r.jsx(Dt,{index:!0,element:r.jsx(SM,{})}),r.jsx(Dt,{path:"tasks",element:r.jsx(jM,{})}),r.jsx(Dt,{path:"tasks/:taskId",element:r.jsx(_M,{})}),r.jsx(Dt,{path:"details",element:r.jsx(TM,{})}),r.jsx(Dt,{path:"activity",element:r.jsx(PM,{})}),r.jsx(Dt,{path:"ideas",element:r.jsx(LM,{})}),r.jsx(Dt,{path:"issues",element:r.jsx(zM,{})}),r.jsx(Dt,{path:"issues/:issueId",element:r.jsx(MM,{})}),r.jsx(Dt,{path:"mindmap",element:r.jsx(qM,{})})]})]}),r.jsx(Dt,{path:"*",element:r.jsx(Pf,{to:"/",replace:!0})})]})})]})})},Gb=document.getElementById("root");if(!Gb)throw new Error("Could not find root element to mount to");const nR=cS.createRoot(Gb);nR.render(r.jsx(nr.StrictMode,{children:r.jsx(tR,{})}));
